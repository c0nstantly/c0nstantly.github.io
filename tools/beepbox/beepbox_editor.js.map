{"version":3,"file":"beepbox_editor.js","sources":["../synth/SynthConfig.ts","../editor/EditorConfig.ts","../node_modules/imperative-html/src/elements-base.ts","../node_modules/imperative-html/src/elements-strict.ts","../editor/ColorConfig.ts","../editor/style.ts","../editor/Layout.ts","../synth/FFT.ts","../synth/Deque.ts","../synth/filtering.ts","../synth/synth.ts","../editor/TipPrompt.ts","../editor/Change.ts","../editor/changes.ts","../editor/PatternEditor.ts","../editor/EnvelopeEditor.ts","../editor/FadeInOutEditor.ts","../editor/FilterEditor.ts","../editor/MuteEditor.ts","../editor/TrackEditor.ts","../editor/LayoutPrompt.ts","../editor/LoopEditor.ts","../editor/SpectrumEditor.ts","../editor/HarmonicsEditor.ts","../editor/BarScrollBar.ts","../editor/OctaveScrollBar.ts","../editor/Piano.ts","../editor/BeatsPerBarPrompt.ts","../editor/MoveNotesSidewaysPrompt.ts","../editor/SongDurationPrompt.ts","../editor/ChannelSettingsPrompt.ts","../editor/ArrayBufferWriter.ts","../editor/Midi.ts","../editor/ExportPrompt.ts","../editor/ArrayBufferReader.ts","../editor/ImportPrompt.ts","../editor/SongRecovery.ts","../editor/SongRecoveryPrompt.ts","../editor/SongEditor.ts","../editor/Selection.ts","../editor/ChangeNotifier.ts","../editor/SongDocument.ts","../editor/main.ts"],"sourcesContent":["/*!\nCopyright (C) 2021 John Nesky\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of \nthis software and associated documentation files (the \"Software\"), to deal in \nthe Software without restriction, including without limitation the rights to \nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \nof the Software, and to permit persons to whom the Software is furnished to do \nso, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all \ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \nSOFTWARE.\n*/\n\nexport interface Dictionary<T> {\n\t[K: string]: T;\n}\n\nexport interface DictionaryArray<T> extends ReadonlyArray<T> {\n\tdictionary: Dictionary<T>;\n}\n\nexport const enum FilterType {\n\tlowPass,\n\thighPass,\n\tpeak,\n\tlength,\n}\n\nexport const enum EnvelopeType {\n\tnoteSize,\n\tnone,\n\tpunch,\n\tflare,\n\ttwang,\n\tswell,\n\ttremolo,\n\ttremolo2,\n\tdecay,\n}\n\nexport const enum InstrumentType {\n\tchip,\n\tfm,\n\tnoise,\n\tspectrum,\n\tdrumset,\n\tharmonics,\n\tpwm,\n\tpickedString,\n\tlength,\n}\n\nexport const enum EffectType {\n\treverb,\n\tchorus,\n\tpanning,\n\tdistortion,\n\tbitcrusher,\n\tnoteFilter,\n\techo,\n\tpitchShift,\n\tdetune,\n\tvibrato,\n\ttransition,\n\tchord,\n\t// If you add more, you'll also have to extend the bitfield used in Base64 which currently uses two six-bit characters.\n\tlength,\n}\n\nexport const enum NoteAutomationIndex {\n\tnoteVolume,\n\tnoteFilterAllFreqs,\n\tpulseWidth,\n\tstringSustain,\n\tunison,\n\toperatorFrequency0, operatorFrequency1, operatorFrequency2, operatorFrequency3,\n\toperatorAmplitude0, operatorAmplitude1, operatorAmplitude2, operatorAmplitude3,\n\tfeedbackAmplitude,\n\tpitchShift,\n\tdetune,\n\tvibratoDepth,\n\tnoteFilterFreq0, noteFilterFreq1, noteFilterFreq2, noteFilterFreq3, noteFilterFreq4, noteFilterFreq5, noteFilterFreq6, noteFilterFreq7,\n\tnoteFilterGain0, noteFilterGain1, noteFilterGain2, noteFilterGain3, noteFilterGain4, noteFilterGain5, noteFilterGain6, noteFilterGain7,\n\tlength,\n}\n\n/*\nexport const enum InstrumentAutomationIndex {\n\tmixVolume,\n\teqFilterAllFreqs,\n\teqFilterFreq0, eqFilterFreq1, eqFilterFreq2, eqFilterFreq3, eqFilterFreq4, eqFilterFreq5, eqFilterFreq6, eqFilterFreq7,\n\teqFilterGain0, eqFilterGain1, eqFilterGain2, eqFilterGain3, eqFilterGain4, eqFilterGain5, eqFilterGain6, eqFilterGain7,\n\tdistortion,\n\tbitcrusherQuantization,\n\tbitcrusherFrequency,\n\tpanning,\n\tchorus,\n\techoSustain,\n\t//echoDelay, // Wait until tick settings can be computed once for multiple run lengths.\n\treverb,\n\tlength,\n}\n*/\n\nexport interface BeepBoxOption {\n\treadonly index: number;\n\treadonly name: string;\n}\n\nexport interface Scale extends BeepBoxOption {\n\treadonly flags: ReadonlyArray<boolean>;\n\treadonly realName: string;\n}\n\nexport interface Key extends BeepBoxOption {\n\treadonly isWhiteKey: boolean;\n\treadonly basePitch: number;\n}\n\nexport interface Rhythm extends BeepBoxOption {\n\treadonly stepsPerBeat: number;\n\treadonly ticksPerArpeggio: number;\n\treadonly arpeggioPatterns: ReadonlyArray<ReadonlyArray<number>>;\n\treadonly roundUpThresholds: number[] | null;\n}\n\nexport interface ChipWave extends BeepBoxOption {\n\treadonly expression: number;\n\treadonly samples: Float64Array;\n}\n\nexport interface ChipNoise extends BeepBoxOption {\n\treadonly expression: number;\n\treadonly basePitch: number;\n\treadonly pitchFilterMult: number;\n\treadonly isSoft: boolean;\n\tsamples: Float32Array | null;\n}\n\nexport interface Transition extends BeepBoxOption {\n\treadonly isSeamless: boolean;\n\treadonly continues: boolean;\n\treadonly slides: boolean;\n\treadonly slideTicks: number;\n\treadonly includeAdjacentPatterns: boolean;\n}\n\nexport interface Vibrato extends BeepBoxOption {\n\treadonly amplitude: number;\n\treadonly periodsSeconds: ReadonlyArray<number>;\n\treadonly delayTicks: number;\n}\n\nexport interface Unison extends BeepBoxOption {\n\treadonly voices: number;\n\treadonly spread: number;\n\treadonly offset: number;\n\treadonly expression: number;\n\treadonly sign: number;\n}\n\nexport interface Chord extends BeepBoxOption {\n\treadonly customInterval: boolean;\n\treadonly arpeggiates: boolean;\n\treadonly strumParts: number;\n\treadonly singleTone: boolean;\n}\n\nexport interface Algorithm extends BeepBoxOption {\n\treadonly carrierCount: number;\n\treadonly associatedCarrier: ReadonlyArray<number>;\n\treadonly modulatedBy: ReadonlyArray<ReadonlyArray<number>>;\n}\n\nexport interface OperatorFrequency extends BeepBoxOption {\n\treadonly mult: number;\n\treadonly hzOffset: number;\n\treadonly amplitudeSign: number;\n}\n\nexport interface Feedback extends BeepBoxOption {\n\treadonly indices: ReadonlyArray<ReadonlyArray<number>>;\n}\n\nexport interface Envelope extends BeepBoxOption {\n\treadonly type: EnvelopeType;\n\treadonly speed: number;\n}\n\nexport interface AutomationTarget extends BeepBoxOption {\n\treadonly computeIndex: NoteAutomationIndex /*| InstrumentAutomationIndex*/ | null;\n\treadonly displayName: string;\n\t//readonly perNote: boolean; // Whether to compute envelopes on a per-note basis.\n\treadonly interleave: boolean; // Whether to interleave this target with the next one in the menu.\n\treadonly isFilter: boolean; // Filters have a variable maxCount in practice.\n\t//readonly range: number | null; // set if automation is allowed.\n\treadonly maxCount: number;\n\treadonly effect: EffectType | null;\n\treadonly compatibleInstruments: InstrumentType[] | null;\n}\n\nexport class Config {\n\tpublic static readonly scales: DictionaryArray<Scale> = toNameMap([\n\t\t{name: \"easy :)\",         realName: \"pentatonic major\",      flags: [true, false,  true, false,  true, false, false,  true, false,  true, false, false]},\n\t\t{name: \"easy :(\",         realName: \"pentatonic minor\",      flags: [true, false, false,  true, false,  true, false,  true, false, false,  true, false]},\n\t\t{name: \"island :)\",       realName: \"ryukyu\",                flags: [true, false, false, false,  true,  true, false,  true, false, false, false,  true]},\n\t\t{name: \"island :(\",       realName: \"pelog selisir\",         flags: [true,  true, false,  true, false, false, false,  true,  true, false, false, false]},\n\t\t{name: \"blues :)\",        realName: \"blues major\",           flags: [true, false,  true,  true,  true, false, false,  true, false,  true, false, false]},\n\t\t{name: \"blues :(\",        realName: \"blues\",                 flags: [true, false, false,  true, false,  true,  true,  true, false, false,  true, false]},\n\t\t{name: \"normal :)\",       realName: \"ionian\",                flags: [true, false,  true, false,  true,  true, false,  true, false,  true, false,  true]},\n\t\t{name: \"normal :(\",       realName: \"aeolian\",               flags: [true, false,  true,  true, false,  true, false,  true,  true, false,  true, false]},\n\t\t{name: \"dbl harmonic :)\", realName: \"double harmonic major\", flags: [true,  true, false, false,  true,  true, false,  true,  true, false, false,  true]},\n\t\t{name: \"dbl harmonic :(\", realName: \"double harmonic minor\", flags: [true, false,  true,  true, false, false,  true,  true,  true, false, false,  true]},\n\t\t{name: \"strange\",         realName: \"whole tone\",            flags: [true, false,  true, false,  true, false,  true, false,  true, false,  true, false]},\n\t\t{name: \"expert\",          realName: \"chromatic\",             flags: [true,  true,  true,  true,  true,  true,  true,  true,  true,  true,  true,  true]},\n\t]);\n\tpublic static readonly keys: DictionaryArray<Key> = toNameMap([\n\t\t{name: \"C\",  isWhiteKey:  true, basePitch: 12}, // C0 has index 12 on the MIDI scale. C7 is 96, and C9 is 120. C10 is barely in the audible range.\n\t\t{name: \"C♯\", isWhiteKey: false, basePitch: 13},\n\t\t{name: \"D\",  isWhiteKey:  true, basePitch: 14},\n\t\t{name: \"D♯\", isWhiteKey: false, basePitch: 15},\n\t\t{name: \"E\",  isWhiteKey:  true, basePitch: 16},\n\t\t{name: \"F\",  isWhiteKey:  true, basePitch: 17},\n\t\t{name: \"F♯\", isWhiteKey: false, basePitch: 18},\n\t\t{name: \"G\",  isWhiteKey:  true, basePitch: 19},\n\t\t{name: \"G♯\", isWhiteKey: false, basePitch: 20},\n\t\t{name: \"A\",  isWhiteKey:  true, basePitch: 21},\n\t\t{name: \"A♯\", isWhiteKey: false, basePitch: 22},\n\t\t{name: \"B\",  isWhiteKey:  true, basePitch: 23},\n\t]);\n\tpublic static readonly blackKeyNameParents: ReadonlyArray<number> = [-1, 1, -1, 1, -1, 1, -1, -1, 1, -1, 1, -1];\n\tpublic static readonly tempoMin: number = 30;\n\tpublic static readonly tempoMax: number = 300;\n\tpublic static readonly echoDelayRange: number = 24;\n\tpublic static readonly echoDelayStepTicks: number = 4;\n\tpublic static readonly echoSustainRange: number = 8;\n\tpublic static readonly echoShelfHz: number = 4000.0; // The cutoff freq of the shelf filter that is used to decay echoes.\n\tpublic static readonly echoShelfGain: number = Math.pow(2.0, -0.5);\n\tpublic static readonly reverbShelfHz: number = 8000.0; // The cutoff freq of the shelf filter that is used to decay reverb.\n\tpublic static readonly reverbShelfGain: number = Math.pow(2.0, -1.5);\n\tpublic static readonly reverbRange: number = 4;\n\tpublic static readonly reverbDelayBufferSize: number = 16384; // TODO: Compute a buffer size based on sample rate.\n\tpublic static readonly reverbDelayBufferMask: number = Config.reverbDelayBufferSize - 1; // TODO: Compute a buffer size based on sample rate.\n\tpublic static readonly beatsPerBarMin: number = 3;\n\tpublic static readonly beatsPerBarMax: number = 16;\n\tpublic static readonly barCountMin: number = 1;\n\tpublic static readonly barCountMax: number = 128;\n\tpublic static readonly instrumentCountMin: number = 1;\n\tpublic static readonly layeredInstrumentCountMax: number = 4;\n\tpublic static readonly patternInstrumentCountMax: number = 10;\n\tpublic static readonly partsPerBeat: number = 24;\n\tpublic static readonly ticksPerPart: number = 2;\n\tpublic static readonly rhythms: DictionaryArray<Rhythm> = toNameMap([\n\t\t{name: \"÷3 (triplets)\", stepsPerBeat: 3, ticksPerArpeggio: 4, arpeggioPatterns: [[0], [0, 0, 1, 1], [0, 1, 2, 1]], roundUpThresholds: [/*0*/ 5, /*8*/ 12, /*16*/ 18 /*24*/]},\n\t\t{name: \"÷4 (standard)\", stepsPerBeat: 4, ticksPerArpeggio: 3, arpeggioPatterns: [[0], [0, 0, 1, 1], [0, 1, 2, 1]], roundUpThresholds: [/*0*/ 3, /*6*/ 9, /*12*/ 17, /*18*/ 21 /*24*/]},\n\t\t{name: \"÷6\",            stepsPerBeat: 6, ticksPerArpeggio: 4, arpeggioPatterns: [[0], [0, 1],       [0, 1, 2, 1]], roundUpThresholds: null},\n\t\t{name: \"÷8\",            stepsPerBeat: 8, ticksPerArpeggio: 3, arpeggioPatterns: [[0], [0, 1],       [0, 1, 2, 1]], roundUpThresholds: null},\n\t\t{name: \"freehand\",      stepsPerBeat:24, ticksPerArpeggio: 3, arpeggioPatterns: [[0], [0, 1],       [0, 1, 2, 1]], roundUpThresholds: null},\n\t]);\n\t\n\tpublic static readonly instrumentTypeNames: ReadonlyArray<string> = [\"chip\", \"FM\", \"noise\", \"spectrum\", \"drumset\", \"harmonics\", \"PWM\", \"Picked String\"]; // See InstrumentType enum above.\n\tpublic static readonly instrumentTypeHasSpecialInterval: ReadonlyArray<boolean> = [true, true, false, false, false, true, false, false];\n\tpublic static readonly chipBaseExpression:      number = 0.03375; // Doubled by unison feature, but affected by expression adjustments per unison setting and wave shape.\n\tpublic static readonly fmBaseExpression:        number = 0.03;\n\tpublic static readonly noiseBaseExpression:     number = 0.19;\n\tpublic static readonly spectrumBaseExpression:  number = 0.3; // Spectrum can be in pitch or noise channels, the expression is doubled for noise.\n\tpublic static readonly drumsetBaseExpression:   number = 0.45; // Drums tend to be loud but brief!\n\tpublic static readonly harmonicsBaseExpression: number = 0.025;\n\tpublic static readonly pwmBaseExpression:       number = 0.04725; // It's actually closer to half of this, the synthesized pulse amplitude range is only .5 to -.5, but also note that the fundamental sine partial amplitude of a square wave is 4/π times the measured square wave amplitude.\n\tpublic static readonly pickedStringBaseExpression: number = 0.025; // Same as harmonics.\n\tpublic static readonly distortionBaseVolume:    number = 0.011; // Distortion is not affected by pitchDamping, which otherwise approximately halves expression for notes around the middle of the range.\n\tpublic static readonly bitcrusherBaseVolume:    number = 0.010; // Also not affected by pitchDamping, used when bit crushing is maxed out (aka \"1-bit\" output).\n\t\n\tpublic static readonly chipWaves: DictionaryArray<ChipWave> = toNameMap([\n\t\t{name: \"rounded\",      expression: 0.94, samples: centerWave([0.0, 0.2, 0.4, 0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.95, 0.9, 0.85, 0.8, 0.7, 0.6, 0.5, 0.4, 0.2, 0.0, -0.2, -0.4, -0.5, -0.6, -0.7, -0.8, -0.85, -0.9, -0.95, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -0.95, -0.9, -0.85, -0.8, -0.7, -0.6, -0.5, -0.4, -0.2])},\n\t\t{name: \"triangle\",     expression: 1.0,  samples: centerWave([1.0/15.0, 3.0/15.0, 5.0/15.0, 7.0/15.0, 9.0/15.0, 11.0/15.0, 13.0/15.0, 15.0/15.0, 15.0/15.0, 13.0/15.0, 11.0/15.0, 9.0/15.0, 7.0/15.0, 5.0/15.0, 3.0/15.0, 1.0/15.0, -1.0/15.0, -3.0/15.0, -5.0/15.0, -7.0/15.0, -9.0/15.0, -11.0/15.0, -13.0/15.0, -15.0/15.0, -15.0/15.0, -13.0/15.0, -11.0/15.0, -9.0/15.0, -7.0/15.0, -5.0/15.0, -3.0/15.0, -1.0/15.0])},\n\t\t{name: \"square\",       expression: 0.5,  samples: centerWave([1.0, -1.0])},\n\t\t{name: \"1/4 pulse\",    expression: 0.5,  samples: centerWave([1.0, -1.0, -1.0, -1.0])},\n\t\t{name: \"1/8 pulse\",    expression: 0.5,  samples: centerWave([1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0])},\n\t\t{name: \"sawtooth\",     expression: 0.65, samples: centerWave([1.0/31.0, 3.0/31.0, 5.0/31.0, 7.0/31.0, 9.0/31.0, 11.0/31.0, 13.0/31.0, 15.0/31.0, 17.0/31.0, 19.0/31.0, 21.0/31.0, 23.0/31.0, 25.0/31.0, 27.0/31.0, 29.0/31.0, 31.0/31.0, -31.0/31.0, -29.0/31.0, -27.0/31.0, -25.0/31.0, -23.0/31.0, -21.0/31.0, -19.0/31.0, -17.0/31.0, -15.0/31.0, -13.0/31.0, -11.0/31.0, -9.0/31.0, -7.0/31.0, -5.0/31.0, -3.0/31.0, -1.0/31.0])},\n\t\t{name: \"double saw\",   expression: 0.5,  samples: centerWave([0.0, -0.2, -0.4, -0.6, -0.8, -1.0, 1.0, -0.8, -0.6, -0.4, -0.2, 1.0, 0.8, 0.6, 0.4, 0.2])},\n\t\t{name: \"double pulse\", expression: 0.4,  samples: centerWave([1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, 1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0])},\n\t\t{name: \"spiky\",        expression: 0.4,  samples: centerWave([1.0, -1.0, 1.0, -1.0, 1.0, 0.0])},\n\t]);\n\t// Noise waves have too many samples to write by hand, they're generated on-demand by getDrumWave instead.\n\tpublic static readonly chipNoises: DictionaryArray<ChipNoise> = toNameMap([\n\t\t{name: \"retro\",   expression: 0.25, basePitch: 69,  pitchFilterMult: 1024.0, isSoft: false, samples: null},\n\t\t{name: \"white\",   expression: 1.0,  basePitch: 69,  pitchFilterMult:    8.0, isSoft: true,  samples: null},\n\t\t// The \"clang\" and \"buzz\" noises are based on similar noises in the modded beepbox! :D\n\t\t{name: \"clang\",   expression: 0.4,  basePitch: 69,  pitchFilterMult: 1024.0, isSoft: false, samples: null},\n\t\t{name: \"buzz\",    expression: 0.3,  basePitch: 69,  pitchFilterMult: 1024.0, isSoft: false, samples: null},\n\t\t{name: \"hollow\",  expression: 1.5,  basePitch: 96,  pitchFilterMult:    1.0, isSoft: true,  samples: null},\n\t]);\n\t\n\tpublic static readonly filterFreqStep: number = 1.0/4.0;\n\tpublic static readonly filterFreqRange: number = 34;\n\tpublic static readonly filterFreqReferenceSetting: number = 28;\n\tpublic static readonly filterFreqReferenceHz: number = 8000.0;\n\tpublic static readonly filterFreqMaxHz: number = Config.filterFreqReferenceHz * Math.pow(2.0, Config.filterFreqStep * (Config.filterFreqRange - 1 - Config.filterFreqReferenceSetting)); // ~19khz\n\tpublic static readonly filterFreqMinHz: number = 8.0;\n\tpublic static readonly filterGainRange: number = 15;\n\tpublic static readonly filterGainCenter: number = 7;\n\tpublic static readonly filterGainStep: number = 1.0/2.0;\n\tpublic static readonly filterMaxPoints: number = 8;\n\tpublic static readonly filterTypeNames: ReadonlyArray<string> = [\"low-pass\", \"high-pass\", \"peak\"]; // See FilterType enum above.\n\t\n\tpublic static readonly fadeInRange: number = 10;\n\tpublic static readonly fadeOutTicks: ReadonlyArray<number> = [-24, -12, -6, -3, -1, 6, 12, 24, 48, 72, 96];\n\tpublic static readonly fadeOutNeutral: number = 4;\n\tpublic static readonly drumsetFadeOutTicks: number = 48;\n\tpublic static readonly transitions: DictionaryArray<Transition> = toNameMap([\n\t\t{name: \"normal\",        isSeamless: false, continues: false, slides: false, slideTicks: 3, includeAdjacentPatterns: false},\n\t\t{name: \"interrupt\",     isSeamless: true,  continues: false, slides: false, slideTicks: 3, includeAdjacentPatterns: true},\n\t\t{name: \"continue\",      isSeamless: true,  continues: true,  slides: false, slideTicks: 3, includeAdjacentPatterns: true},\n\t\t{name: \"slide\",         isSeamless: true,  continues: false, slides: true,  slideTicks: 3, includeAdjacentPatterns: true},\n\t\t{name: \"slide in pattern\", isSeamless: true,  continues: false, slides: true,  slideTicks: 3, includeAdjacentPatterns: false},\n\t]);\n\tpublic static readonly vibratos: DictionaryArray<Vibrato> = toNameMap([\n\t\t{name: \"none\",    amplitude: 0.0,  periodsSeconds: [0.14], delayTicks: 0},\n\t\t{name: \"light\",   amplitude: 0.15, periodsSeconds: [0.14], delayTicks: 0},\n\t\t{name: \"delayed\", amplitude: 0.3,  periodsSeconds: [0.14], delayTicks: 37}, // It will fade in over the previous two ticks.\n\t\t{name: \"heavy\",   amplitude: 0.45, periodsSeconds: [0.14], delayTicks: 0},\n\t\t{name: \"shaky\",   amplitude: 0.1,  periodsSeconds: [0.11, 1.618*0.11, 3*0.11], delayTicks: 0},\n\t]);\n\tpublic static readonly unisons: DictionaryArray<Unison> = toNameMap([\n\t\t{name: \"none\",       voices: 1, spread: 0.0,  offset: 0.0, expression: 1.4, sign: 1.0},\n\t\t{name: \"shimmer\",    voices: 2, spread: 0.018,offset: 0.0, expression: 0.8, sign: 1.0},\n\t\t{name: \"hum\",        voices: 2, spread: 0.045,offset: 0.0, expression: 1.0, sign: 1.0},\n\t\t{name: \"honky tonk\", voices: 2, spread: 0.09, offset: 0.0, expression: 1.0, sign: 1.0},\n\t\t{name: \"dissonant\",  voices: 2, spread: 0.25, offset: 0.0, expression: 0.9, sign: 1.0},\n\t\t{name: \"fifth\",      voices: 2, spread: 3.5,  offset: 3.5, expression: 0.9, sign: 1.0},\n\t\t{name: \"octave\",     voices: 2, spread: 6.0,  offset: 6.0, expression: 0.8, sign: 1.0},\n\t\t{name: \"bowed\",      voices: 2, spread: 0.02, offset: 0.0, expression: 1.0, sign:-1.0},\n\t\t{name: \"piano\",      voices: 2, spread: 0.01, offset: 0.0, expression: 1.0, sign: 0.7},\n\t]);\n\tpublic static readonly effectNames: ReadonlyArray<string> = [\"reverb\", \"chorus\", \"panning\", \"distortion\", \"bitcrusher\", \"note filter\", \"echo\", \"pitch shift\", \"detune\", \"vibrato\", \"transition type\", \"chord type\"];\n\tpublic static readonly effectOrder: ReadonlyArray<EffectType> = [EffectType.transition, EffectType.chord, EffectType.pitchShift, EffectType.detune, EffectType.vibrato, EffectType.noteFilter, EffectType.distortion, EffectType.bitcrusher, EffectType.panning, EffectType.chorus, EffectType.echo, EffectType.reverb];\n\tpublic static readonly noteSizeMax: number = 3;\n\tpublic static readonly volumeRange: number = 8;\n\tpublic static readonly volumeLogScale: number = -0.5;\n\tpublic static readonly panCenter: number = 4;\n\tpublic static readonly panMax: number = Config.panCenter * 2;\n\tpublic static readonly panDelaySecondsMax: number = 0.0005;\n\tpublic static readonly chorusRange: number = 4;\n\tpublic static readonly chorusPeriodSeconds: number = 2.0;\n\tpublic static readonly chorusDelayRange: number = 0.0034;\n\tpublic static readonly chorusDelayOffsets: ReadonlyArray<ReadonlyArray<number>> = [[1.51, 2.10, 3.35], [1.47, 2.15, 3.25]];\n\tpublic static readonly chorusPhaseOffsets: ReadonlyArray<ReadonlyArray<number>> = [[0.0, 2.1, 4.2], [3.2, 5.3, 1.0]];\n\tpublic static readonly chorusMaxDelay: number = Config.chorusDelayRange * (1.0 + Config.chorusDelayOffsets[0].concat(Config.chorusDelayOffsets[1]).reduce((x,y)=>Math.max(x,y)));\n\tpublic static readonly chords: DictionaryArray<Chord> = toNameMap([\n\t\t{name: \"simultaneous\",    customInterval: false, arpeggiates: false, strumParts: 0, singleTone: false},\n\t\t{name: \"strum\",           customInterval: false, arpeggiates: false, strumParts: 1, singleTone: false},\n\t\t{name: \"arpeggio\",        customInterval: false, arpeggiates:  true, strumParts: 0, singleTone:  true},\n\t\t{name: \"custom interval\", customInterval:  true, arpeggiates: false, strumParts: 0, singleTone:  true},\n\t]);\n\tpublic static readonly maxChordSize: number = 4;\n\tpublic static readonly operatorCount: number = 4;\n\tpublic static readonly algorithms: DictionaryArray<Algorithm> = toNameMap([\n\t\t{name: \"1←(2 3 4)\",   carrierCount: 1, associatedCarrier: [1, 1, 1, 1], modulatedBy: [[2, 3, 4], [],     [],  []]},\n\t\t{name: \"1←(2 3←4)\",   carrierCount: 1, associatedCarrier: [1, 1, 1, 1], modulatedBy: [[2, 3],    [],     [4], []]},\n\t\t{name: \"1←2←(3 4)\",   carrierCount: 1, associatedCarrier: [1, 1, 1, 1], modulatedBy: [[2],       [3, 4], [],  []]},\n\t\t{name: \"1←(2 3)←4\",   carrierCount: 1, associatedCarrier: [1, 1, 1, 1], modulatedBy: [[2, 3],    [4],    [4], []]},\n\t\t{name: \"1←2←3←4\",     carrierCount: 1, associatedCarrier: [1, 1, 1, 1], modulatedBy: [[2],       [3],    [4], []]},\n\t\t{name: \"1←3 2←4\",     carrierCount: 2, associatedCarrier: [1, 2, 1, 2], modulatedBy: [[3],       [4],    [],  []]},\n\t\t{name: \"1 2←(3 4)\",   carrierCount: 2, associatedCarrier: [1, 2, 2, 2], modulatedBy: [[],        [3, 4], [],  []]},\n\t\t{name: \"1 2←3←4\",     carrierCount: 2, associatedCarrier: [1, 2, 2, 2], modulatedBy: [[],        [3],    [4], []]},\n\t\t{name: \"(1 2)←3←4\",   carrierCount: 2, associatedCarrier: [1, 2, 2, 2], modulatedBy: [[3],       [3],    [4], []]},\n\t\t{name: \"(1 2)←(3 4)\", carrierCount: 2, associatedCarrier: [1, 2, 2, 2], modulatedBy: [[3, 4],    [3, 4], [],  []]},\n\t\t{name: \"1 2 3←4\",     carrierCount: 3, associatedCarrier: [1, 2, 3, 3], modulatedBy: [[],        [],     [4], []]},\n\t\t{name: \"(1 2 3)←4\",   carrierCount: 3, associatedCarrier: [1, 2, 3, 3], modulatedBy: [[4],       [4],    [4], []]},\n\t\t{name: \"1 2 3 4\",     carrierCount: 4, associatedCarrier: [1, 2, 3, 4], modulatedBy: [[],        [],     [],  []]},\n\t]);\n\tpublic static readonly operatorCarrierInterval: ReadonlyArray<number> = [0.0, 0.04, -0.073, 0.091];\n\tpublic static readonly operatorAmplitudeMax: number = 15;\n\tpublic static readonly operatorFrequencies: DictionaryArray<OperatorFrequency> = toNameMap([\n\t\t{name:  \"1×\", mult:  1.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name: \"~1×\", mult:  1.0, hzOffset: 1.5, amplitudeSign:-1.0},\n\t\t{name:  \"2×\", mult:  2.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name: \"~2×\", mult:  2.0, hzOffset:-1.3, amplitudeSign:-1.0},\n\t\t{name:  \"3×\", mult:  3.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name:  \"4×\", mult:  4.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name:  \"5×\", mult:  5.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name:  \"6×\", mult:  6.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name:  \"7×\", mult:  7.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name:  \"8×\", mult:  8.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name:  \"9×\", mult:  9.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name: \"11×\", mult: 11.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name: \"13×\", mult: 13.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name: \"16×\", mult: 16.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t\t{name: \"20×\", mult: 20.0, hzOffset: 0.0, amplitudeSign: 1.0},\n\t]);\n\tpublic static readonly envelopes: DictionaryArray<Envelope> = toNameMap([\n\t\t{name: \"none\",     type: EnvelopeType.none,     speed:  0.0},\n\t\t{name: \"note size\",type: EnvelopeType.noteSize, speed:  0.0},\n\t\t{name: \"punch\",    type: EnvelopeType.punch,    speed:  0.0},\n\t\t{name: \"flare 1\",  type: EnvelopeType.flare,    speed: 32.0},\n\t\t{name: \"flare 2\",  type: EnvelopeType.flare,    speed:  8.0},\n\t\t{name: \"flare 3\",  type: EnvelopeType.flare,    speed:  2.0},\n\t\t{name: \"twang 1\",  type: EnvelopeType.twang,    speed: 32.0},\n\t\t{name: \"twang 2\",  type: EnvelopeType.twang,    speed:  8.0},\n\t\t{name: \"twang 3\",  type: EnvelopeType.twang,    speed:  2.0},\n\t\t{name: \"swell 1\",  type: EnvelopeType.swell,    speed: 32.0},\n\t\t{name: \"swell 2\",  type: EnvelopeType.swell,    speed:  8.0},\n\t\t{name: \"swell 3\",  type: EnvelopeType.swell,    speed:  2.0},\n\t\t{name: \"tremolo1\", type: EnvelopeType.tremolo,  speed:  4.0},\n\t\t{name: \"tremolo2\", type: EnvelopeType.tremolo,  speed:  2.0},\n\t\t{name: \"tremolo3\", type: EnvelopeType.tremolo,  speed:  1.0},\n\t\t{name: \"tremolo4\", type: EnvelopeType.tremolo2, speed:  4.0},\n\t\t{name: \"tremolo5\", type: EnvelopeType.tremolo2, speed:  2.0},\n\t\t{name: \"tremolo6\", type: EnvelopeType.tremolo2, speed:  1.0},\n\t\t{name: \"decay 1\",  type: EnvelopeType.decay,    speed: 10.0},\n\t\t{name: \"decay 2\",  type: EnvelopeType.decay,    speed:  7.0},\n\t\t{name: \"decay 3\",  type: EnvelopeType.decay,    speed:  4.0},\n\t]);\n\tpublic static readonly feedbacks: DictionaryArray<Feedback> = toNameMap([\n\t\t{name: \"1⟲\",          indices: [[1],  [],  [],  []]},\n\t\t{name: \"2⟲\",          indices: [ [], [2],  [],  []]},\n\t\t{name: \"3⟲\",          indices: [ [],  [], [3],  []]},\n\t\t{name: \"4⟲\",          indices: [ [],  [],  [], [4]]},\n\t\t{name: \"1⟲ 2⟲\",       indices: [[1], [2],  [],  []]},\n\t\t{name: \"3⟲ 4⟲\",       indices: [ [],  [], [3], [4]]},\n\t\t{name: \"1⟲ 2⟲ 3⟲\",    indices: [[1], [2], [3],  []]},\n\t\t{name: \"2⟲ 3⟲ 4⟲\",    indices: [ [], [2], [3], [4]]},\n\t\t{name: \"1⟲ 2⟲ 3⟲ 4⟲\", indices: [[1], [2], [3], [4]]},\n\t\t{name: \"1→2\",         indices: [ [], [1],  [],  []]},\n\t\t{name: \"1→3\",         indices: [ [],  [], [1],  []]},\n\t\t{name: \"1→4\",         indices: [ [],  [],  [], [1]]},\n\t\t{name: \"2→3\",         indices: [ [],  [], [2],  []]},\n\t\t{name: \"2→4\",         indices: [ [],  [],  [], [2]]},\n\t\t{name: \"3→4\",         indices: [ [],  [],  [], [3]]},\n\t\t{name: \"1→3 2→4\",     indices: [ [],  [], [1], [2]]},\n\t\t{name: \"1→4 2→3\",     indices: [ [],  [], [2], [1]]},\n\t\t{name: \"1→2→3→4\",     indices: [ [], [1], [2], [3]]},\n\t]);\n\tpublic static readonly chipNoiseLength: number = 1 << 15; // 32768\n\tpublic static readonly spectrumNoiseLength: number = 1 << 15; // 32768\n\tpublic static readonly spectrumBasePitch: number = 24;\n\tpublic static readonly spectrumControlPoints: number = 30;\n\tpublic static readonly spectrumControlPointsPerOctave: number = 7;\n\tpublic static readonly spectrumControlPointBits: number = 3;\n\tpublic static readonly spectrumMax: number = (1 << Config.spectrumControlPointBits) - 1;\n\tpublic static readonly harmonicsControlPoints: number = 28;\n\tpublic static readonly harmonicsRendered: number = 64;\n\tpublic static readonly harmonicsRenderedForPickedString: number = 1 << 8; // 256\n\tpublic static readonly harmonicsControlPointBits: number = 3;\n\tpublic static readonly harmonicsMax: number = (1 << Config.harmonicsControlPointBits) - 1;\n\tpublic static readonly harmonicsWavelength: number = 1 << 11; // 2048\n\tpublic static readonly pulseWidthRange: number = 8;\n\tpublic static readonly pulseWidthStepPower: number = 0.5;\n\tpublic static readonly pitchChannelCountMin: number = 1;\n\tpublic static readonly pitchChannelCountMax: number = 10;\n\tpublic static readonly noiseChannelCountMin: number = 0;\n\tpublic static readonly noiseChannelCountMax: number = 5;\n\tpublic static readonly noiseInterval: number = 6;\n\tpublic static readonly pitchesPerOctave: number = 12; // TODO: Use this for converting pitch to frequency.\n\tpublic static readonly drumCount: number = 12;\n\tpublic static readonly pitchOctaves: number = 7;\n\tpublic static readonly maxPitch: number = Config.pitchOctaves * Config.pitchesPerOctave;\n\tpublic static readonly maximumTonesPerChannel: number = Config.maxChordSize * 2;\n\tpublic static readonly justIntonationSemitones: number[] = [1.0/2.0, 8.0/15.0, 9.0/16.0, 3.0/5.0, 5.0/8.0, 2.0/3.0, 32.0/45.0, 3.0/4.0, 4.0/5.0, 5.0/6.0, 8.0/9.0, 15.0/16.0, 1.0, 16.0/15.0, 9.0/8.0, 6.0/5.0, 5.0/4.0, 4.0/3.0, 45.0/32.0, 3.0/2.0, 8.0/5.0, 5.0/3.0, 16.0/9.0, 15.0/8.0, 2.0].map(x=>Math.log2(x) * Config.pitchesPerOctave);\n\tpublic static readonly pitchShiftRange: number = Config.justIntonationSemitones.length;\n\tpublic static readonly pitchShiftCenter: number = Config.pitchShiftRange >> 1;\n\tpublic static readonly detuneCenter: number = 9;\n\tpublic static readonly detuneMax: number = Config.detuneCenter * 2;\n\tpublic static readonly sineWaveLength: number = 1 << 8; // 256\n\tpublic static readonly sineWaveMask: number = Config.sineWaveLength - 1;\n\tpublic static readonly sineWave: Float64Array = generateSineWave();\n\t\n\t// Picked strings have an all-pass filter with a corner frequency based on the tone fundamental frequency, in order to add a slight inharmonicity. (Which is important for distortion.)\n\tpublic static readonly pickedStringDispersionCenterFreq: number = 6000.0; // The tone fundamental freq is pulled toward this freq for computing the all-pass corner freq.\n\tpublic static readonly pickedStringDispersionFreqScale: number = 0.3; // The tone fundamental freq freq moves this much toward the center freq for computing the all-pass corner freq.\n\tpublic static readonly pickedStringDispersionFreqMult: number = 4.0; // The all-pass corner freq is based on this times the adjusted tone fundamental freq.\n\tpublic static readonly pickedStringShelfHz: number = 4000.0; // The cutoff freq of the shelf filter that is used to decay the high frequency energy in the picked string.\n\t\n\tpublic static readonly distortionRange: number = 8;\n\tpublic static readonly stringSustainRange: number = 15;\n\tpublic static readonly stringDecayRate: number = 0.12;\n\tpublic static readonly bitcrusherFreqRange: number = 14;\n\tpublic static readonly bitcrusherOctaveStep: number = 0.5;\n\tpublic static readonly bitcrusherQuantizationRange: number = 8;\n\t\n\tpublic static readonly maxEnvelopeCount: number = 12;\n\tpublic static readonly defaultAutomationRange: number = 13;\n\tpublic static readonly instrumentAutomationTargets: DictionaryArray<AutomationTarget> = toNameMap([\n\t\t{name: \"none\",                   computeIndex:                           null,                   displayName: \"none\",             /*perNote: false,*/ interleave: false, isFilter: false, /*range: 0,                              */    maxCount: 1,    effect: null,                    compatibleInstruments: null},\n\t\t{name: \"noteVolume\",             computeIndex:       NoteAutomationIndex.noteVolume,             displayName: \"note volume\",      /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.volumeRange,             */    maxCount: 1,    effect: null,                    compatibleInstruments: null},\n\t\t{name: \"pulseWidth\",             computeIndex:       NoteAutomationIndex.pulseWidth,             displayName: \"pulse width\",      /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.pulseWidthRange,         */    maxCount: 1,    effect: null,                    compatibleInstruments: [InstrumentType.pwm]},\n\t\t{name: \"stringSustain\",          computeIndex:       NoteAutomationIndex.stringSustain,          displayName: \"sustain\",          /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.stringSustainRange,      */    maxCount: 1,    effect: null,                    compatibleInstruments: [InstrumentType.pickedString]},\n\t\t{name: \"unison\",                 computeIndex:       NoteAutomationIndex.unison,                 displayName: \"unison\",           /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.defaultAutomationRange,  */    maxCount: 1,    effect: null,                    compatibleInstruments: [InstrumentType.chip, InstrumentType.harmonics, InstrumentType.pickedString]},\n\t\t{name: \"operatorFrequency\",      computeIndex:       NoteAutomationIndex.operatorFrequency0,     displayName: \"fm# freq\",         /*perNote:  true,*/ interleave:  true, isFilter: false, /*range: Config.defaultAutomationRange,  */    maxCount: Config.operatorCount, effect: null,    compatibleInstruments: [InstrumentType.fm]},\n\t\t{name: \"operatorAmplitude\",      computeIndex:       NoteAutomationIndex.operatorAmplitude0,     displayName: \"fm# volume\",       /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.operatorAmplitudeMax + 1,*/    maxCount: Config.operatorCount, effect: null,    compatibleInstruments: [InstrumentType.fm]},\n\t\t{name: \"feedbackAmplitude\",      computeIndex:       NoteAutomationIndex.feedbackAmplitude,      displayName: \"fm feedback\",      /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.operatorAmplitudeMax + 1,*/    maxCount: 1,    effect: null,                    compatibleInstruments: [InstrumentType.fm]},\n\t\t{name: \"pitchShift\",             computeIndex:       NoteAutomationIndex.pitchShift,             displayName: \"pitch shift\",      /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.pitchShiftRange,         */    maxCount: 1,    effect: EffectType.pitchShift,   compatibleInstruments: null},\n\t\t{name: \"detune\",                 computeIndex:       NoteAutomationIndex.detune,                 displayName: \"detune\",           /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.detuneMax + 1,           */    maxCount: 1,    effect: EffectType.detune,       compatibleInstruments: null},\n\t\t{name: \"vibratoDepth\",           computeIndex:       NoteAutomationIndex.vibratoDepth,           displayName: \"vibrato range\",    /*perNote:  true,*/ interleave: false, isFilter: false, /*range: Config.defaultAutomationRange,  */    maxCount: 1,    effect: EffectType.vibrato,      compatibleInstruments: null},\n\t\t{name: \"noteFilterAllFreqs\",     computeIndex:       NoteAutomationIndex.noteFilterAllFreqs,     displayName: \"n. filter freqs\",  /*perNote:  true,*/ interleave: false, isFilter:  true, /*range: null,                           */    maxCount: 1,    effect: EffectType.noteFilter,   compatibleInstruments: null},\n\t\t{name: \"noteFilterFreq\",         computeIndex:       NoteAutomationIndex.noteFilterFreq0,        displayName: \"n. filter # freq\", /*perNote:  true,*/ interleave: false/*true*/, isFilter:  true, /*range: Config.filterFreqRange,     */        maxCount: Config.filterMaxPoints, effect: EffectType.noteFilter, compatibleInstruments: null},\n\t\t// Controlling filter gain is less obvious and intuitive than controlling filter freq, so to avoid confusion I've disabled it for now...\n\t\t//{name: \"noteFilterGain\",         computeIndex:       NoteAutomationIndex.noteFilterGain0,        displayName: \"n. filter # vol\",  /*perNote:  true,*/ interleave: false, isFilter:  true, range: Config.filterGainRange,             maxCount: Config.filterMaxPoints, effect: EffectType.noteFilter, compatibleInstruments: null},\n\t\t/*\n\t\t{name: \"distortion\",             computeIndex: InstrumentAutomationIndex.distortion,             displayName: \"distortion\",       perNote: false, interleave: false, isFilter: false, range: Config.distortionRange,             maxCount: 1,    effect: EffectType.distortion,   compatibleInstruments: null},\n\t\t{name: \"bitcrusherQuantization\", computeIndex: InstrumentAutomationIndex.bitcrusherQuantization, displayName: \"bit crush\",        perNote: false, interleave: false, isFilter: false, range: Config.bitcrusherQuantizationRange, maxCount: 1,    effect: EffectType.bitcrusher,   compatibleInstruments: null},\n\t\t{name: \"bitcrusherFrequency\",    computeIndex: InstrumentAutomationIndex.bitcrusherFrequency,    displayName: \"freq crush\",       perNote: false, interleave: false, isFilter: false, range: Config.bitcrusherFreqRange,         maxCount: 1,    effect: EffectType.bitcrusher,   compatibleInstruments: null},\n\t\t{name: \"eqFilterAllFreqs\",       computeIndex: InstrumentAutomationIndex.eqFilterAllFreqs,       displayName: \"eq filter freqs\",  perNote: false, interleave: false, isFilter:  true, range: null,                               maxCount: 1,    effect: null,                    compatibleInstruments: null},\n\t\t{name: \"eqFilterFreq\",           computeIndex: InstrumentAutomationIndex.eqFilterFreq0,          displayName: \"eq filter # freq\", perNote: false, interleave:  true, isFilter:  true, range: Config.filterFreqRange,             maxCount: Config.filterMaxPoints, effect: null,  compatibleInstruments: null},\n\t\t{name: \"eqFilterGain\",           computeIndex: InstrumentAutomationIndex.eqFilterGain0,          displayName: \"eq filter # vol\",  perNote: false, interleave: false, isFilter:  true, range: Config.filterGainRange,             maxCount: Config.filterMaxPoints, effect: null,  compatibleInstruments: null},\n\t\t{name: \"panning\",                computeIndex: InstrumentAutomationIndex.panning,                displayName: \"panning\",          perNote: false, interleave: false, isFilter: false, range: Config.panMax + 1,                  maxCount: 1,    effect: EffectType.panning,      compatibleInstruments: null},\n\t\t{name: \"chorus\",                 computeIndex: InstrumentAutomationIndex.chorus,                 displayName: \"chorus\",           perNote: false, interleave: false, isFilter: false, range: Config.chorusRange,                 maxCount: 1,    effect: EffectType.chorus,       compatibleInstruments: null},\n\t\t{name: \"echoSustain\",            computeIndex: InstrumentAutomationIndex.echoSustain,            displayName: \"echo\",             perNote: false, interleave: false, isFilter: false, range: Config.echoSustainRange,            maxCount: 1,    effect: EffectType.echo,         compatibleInstruments: null},\n\t\t{name: \"echoDelay\",              computeIndex: InstrumentAutomationIndex.echoDelay,              displayName: \"echo delay\",       perNote: false, interleave: false, isFilter: false, range: Config.echoDelayRange,              maxCount: 1,    effect: EffectType.echo,         compatibleInstruments: null}, // wait until after we're computing a tick's settings for multiple run lengths.\n\t\t{name: \"reverb\",                 computeIndex: InstrumentAutomationIndex.reverb,                 displayName: \"reverb\",           perNote: false, interleave: false, isFilter: false, range: Config.reverbRange,                 maxCount: 1,    effect: EffectType.reverb,       compatibleInstruments: null},\n\t\t{name: \"mixVolume\",              computeIndex: InstrumentAutomationIndex.mixVolume,              displayName: \"mix volume\",       perNote: false, interleave: false, isFilter: false, range: Config.volumeRange,                 maxCount: 1,    effect: null,                    compatibleInstruments: null},\n\t\t{name: \"envelope#\",              computeIndex: null,                                             displayName: \"envelope\",         perNote: false, interleave: false, isFilter: false, range: Config.defaultAutomationRange,      maxCount: Config.maxEnvelopeCount, effect: null, compatibleInstruments: null}, // maxCount special case for envelopes to be allowed to target earlier ones.\n\t\t*/\n\t]);\n}\n\nfunction centerWave(wave: Array<number>): Float64Array {\n\tlet sum: number = 0.0;\n\tfor (let i: number = 0; i < wave.length; i++) sum += wave[i];\n\tconst average: number = sum / wave.length;\n\tfor (let i: number = 0; i < wave.length; i++) wave[i] -= average;\n\tperformIntegral(wave);\n\t// The first sample should be zero, and we'll duplicate it at the end for easier interpolation.\n\twave.push(0);\n\treturn new Float64Array(wave);\n}\n\nexport function performIntegral(wave: {length: number, [index: number]: number}): void {\n\t// Perform the integral on the wave. The synth function will perform the derivative to get the original wave back but with antialiasing.\n\tlet cumulative: number = 0.0;\n\tfor (let i: number = 0; i < wave.length; i++) {\n\t\tconst temp = wave[i];\n\t\twave[i] = cumulative;\n\t\tcumulative += temp;\n\t}\n}\n\nexport function getPulseWidthRatio(pulseWidth: number): number {\n\treturn Math.pow(0.5, (Config.pulseWidthRange - 1 - pulseWidth) * Config.pulseWidthStepPower) * 0.5;\n}\n\n// The function arguments will be defined in FFT.ts, but I want\n// SynthConfig.ts to be at the top of the compiled JS so I won't directly\n// depend on FFT here. synth.ts will take care of importing FFT.ts.\n//function inverseRealFourierTransform(array: {length: number, [index: number]: number}, fullArrayLength: number): void;\n//function scaleElementsByFactor(array: {length: number, [index: number]: number}, factor: number): void;\nexport function getDrumWave(index: number, inverseRealFourierTransform: Function | null, scaleElementsByFactor: Function | null): Float32Array {\n\tlet wave: Float32Array | null = Config.chipNoises[index].samples;\n\tif (wave == null) {\n\t\twave = new Float32Array(Config.chipNoiseLength + 1);\n\t\tConfig.chipNoises[index].samples = wave;\n\t\t\n\t\tif (index == 0) {\n\t\t\t// The \"retro\" drum uses a \"Linear Feedback Shift Register\" similar to the NES noise channel.\n\t\t\tlet drumBuffer: number = 1;\n\t\t\tfor (let i: number = 0; i < Config.chipNoiseLength; i++) {\n\t\t\t\twave[i] = (drumBuffer & 1) * 2.0 - 1.0;\n\t\t\t\tlet newBuffer: number = drumBuffer >> 1;\n\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\n\t\t\t\t\tnewBuffer += 1 << 14;\n\t\t\t\t}\n\t\t\t\tdrumBuffer = newBuffer;\n\t\t\t}\n\t\t} else if (index == 1) {\n\t\t\t// White noise is just random values for each sample.\n\t\t\tfor (let i: number = 0; i < Config.chipNoiseLength; i++) {\n\t\t\t\twave[i] = Math.random() * 2.0 - 1.0;\n\t\t\t}\n\t\t} else if (index == 2) {\n\t\t\t// The \"clang\" noise wave is based on a similar noise wave in the modded beepbox made by DAzombieRE.\n\t\t\tlet drumBuffer: number = 1;\n\t\t\tfor (let i: number = 0; i < Config.chipNoiseLength; i++) {\n\t\t\t\twave[i] = (drumBuffer & 1) * 2.0 - 1.0;\n\t\t\t\tlet newBuffer: number = drumBuffer >> 1;\n\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\n\t\t\t\t\tnewBuffer += 2 << 14;\n\t\t\t\t}\n\t\t\t\tdrumBuffer = newBuffer;\n\t\t\t}\n\t\t} else if (index == 3) {\n\t\t\t// The \"buzz\" noise wave is based on a similar noise wave in the modded beepbox made by DAzombieRE.\n\t\t\tlet drumBuffer: number = 1;\n\t\t\tfor (let i: number = 0; i < Config.chipNoiseLength; i++) {\n\t\t\t\twave[i] = (drumBuffer & 1) * 2.0 - 1.0;\n\t\t\t\tlet newBuffer: number = drumBuffer >> 1;\n\t\t\t\tif (((drumBuffer + newBuffer) & 1) == 1) {\n\t\t\t\t\tnewBuffer += 10 << 2;\n\t\t\t\t}\n\t\t\t\tdrumBuffer = newBuffer;\n\t\t\t}\n\t\t} else if (index == 4) {\n\t\t\t// \"hollow\" drums, designed in frequency space and then converted via FFT:\n\t\t\tdrawNoiseSpectrum(wave, Config.chipNoiseLength, 10, 11, 1, 1, 0);\n\t\t\tdrawNoiseSpectrum(wave, Config.chipNoiseLength, 11, 14, .6578, .6578, 0);\n\t\t\tinverseRealFourierTransform!(wave, Config.chipNoiseLength);\n\t\t\tscaleElementsByFactor!(wave, 1.0 / Math.sqrt(Config.chipNoiseLength));\n\t\t} else {\n\t\t\tthrow new Error(\"Unrecognized drum index: \" + index);\n\t\t}\n\t\t\n\t\twave[Config.chipNoiseLength] = wave[0];\n\t}\n\t\n\treturn wave;\n}\n\nexport function drawNoiseSpectrum(wave: Float32Array, waveLength: number, lowOctave: number, highOctave: number, lowPower: number, highPower: number, overallSlope: number): number {\n\tconst referenceOctave: number = 11;\n\tconst referenceIndex: number = 1 << referenceOctave;\n\tconst lowIndex: number = Math.pow(2, lowOctave) | 0;\n\tconst highIndex: number = Math.min(waveLength >> 1, Math.pow(2, highOctave) | 0);\n\tconst retroWave: Float32Array = getDrumWave(0, null, null);\n\tlet combinedAmplitude: number = 0.0;\n\tfor (let i: number = lowIndex; i < highIndex; i++) {\n\t\t\n\t\tlet lerped: number = lowPower + (highPower - lowPower) * (Math.log2(i) - lowOctave) / (highOctave - lowOctave);\n\t\tlet amplitude: number = Math.pow(2, (lerped - 1) * 7 + 1) * lerped;\n\t\t\n\t\tamplitude *= Math.pow(i / referenceIndex, overallSlope);\n\t\t\n\t\tcombinedAmplitude += amplitude;\n\t\t\n\t\t// Add two different sources of psuedo-randomness to the noise\n\t\t// (individually they aren't random enough) but in a deterministic\n\t\t// way so that live spectrum editing doesn't result in audible pops.\n\t\t// Multiply all the sine wave amplitudes by 1 or -1 based on the\n\t\t// LFSR retro wave (effectively random), and also rotate the phase\n\t\t// of each sine wave based on the golden angle to disrupt the symmetry.\n\t\tamplitude *= retroWave[i];\n\t\tconst radians: number = 0.61803398875 * i * i * Math.PI * 2.0;\n\t\t\n\t\twave[i] = Math.cos(radians) * amplitude;\n\t\twave[waveLength - i] = Math.sin(radians) * amplitude;\n\t}\n\t\n\treturn combinedAmplitude;\n}\n\nfunction generateSineWave(): Float64Array {\n\tconst wave: Float64Array = new Float64Array(Config.sineWaveLength + 1);\n\tfor (let i: number = 0; i < Config.sineWaveLength + 1; i++) {\n\t\twave[i] = Math.sin(i * Math.PI * 2.0 / Config.sineWaveLength);\n\t}\n\treturn wave;\n}\n\nexport function getArpeggioPitchIndex(pitchCount: number, rhythm: number, arpeggio: number): number {\n\tconst arpeggioPattern: ReadonlyArray<number> = Config.rhythms[rhythm].arpeggioPatterns[pitchCount - 1];\n\tif (arpeggioPattern != null) {\n\t\treturn arpeggioPattern[arpeggio % arpeggioPattern.length];\n\t} else {\n\t\treturn arpeggio % pitchCount;\n\t}\n}\n\n// Pardon the messy type casting. This allows accessing array members by numerical index or string name.\nexport function toNameMap<T extends BeepBoxOption>(array: Array<Pick<T, Exclude<keyof T, \"index\">>>): DictionaryArray<T> {\n\tconst dictionary: Dictionary<T> = {};\n\tfor (let i: number = 0; i < array.length; i++) {\n\t\tconst value: any = array[i];\n\t\tvalue.index = i;\n\t\tdictionary[value.name] = <T> value;\n\t}\n\tconst result: DictionaryArray<T> = <DictionaryArray<T>> <any> array;\n\tresult.dictionary = dictionary;\n\treturn result;\n}\n\nexport function effectsIncludeTransition(effects: number): boolean {\n\treturn (effects & (1 << EffectType.transition)) != 0;\n}\nexport function effectsIncludeChord(effects: number): boolean {\n\treturn (effects & (1 << EffectType.chord)) != 0;\n}\nexport function effectsIncludePitchShift(effects: number): boolean {\n\treturn (effects & (1 << EffectType.pitchShift)) != 0;\n}\nexport function effectsIncludeDetune(effects: number): boolean {\n\treturn (effects & (1 << EffectType.detune)) != 0;\n}\nexport function effectsIncludeVibrato(effects: number): boolean {\n\treturn (effects & (1 << EffectType.vibrato)) != 0;\n}\nexport function effectsIncludeNoteFilter(effects: number): boolean {\n\treturn (effects & (1 << EffectType.noteFilter)) != 0;\n}\nexport function effectsIncludeDistortion(effects: number): boolean {\n\treturn (effects & (1 << EffectType.distortion)) != 0;\n}\nexport function effectsIncludeBitcrusher(effects: number): boolean {\n\treturn (effects & (1 << EffectType.bitcrusher)) != 0;\n}\nexport function effectsIncludePanning(effects: number): boolean {\n\treturn (effects & (1 << EffectType.panning)) != 0;\n}\nexport function effectsIncludeChorus(effects: number): boolean {\n\treturn (effects & (1 << EffectType.chorus)) != 0;\n}\nexport function effectsIncludeEcho(effects: number): boolean {\n\treturn (effects & (1 << EffectType.echo)) != 0;\n}\nexport function effectsIncludeReverb(effects: number): boolean {\n\treturn (effects & (1 << EffectType.reverb)) != 0;\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {DictionaryArray, BeepBoxOption, InstrumentType, toNameMap} from \"../synth/SynthConfig\";\n\nexport interface PresetCategory extends BeepBoxOption {\n\treadonly presets: DictionaryArray<Preset>;\n}\n\nexport interface Preset extends BeepBoxOption {\n\treadonly isNoise?: boolean;\n\treadonly generalMidi?: boolean;\n\treadonly midiProgram?: number;\n\treadonly midiSubharmonicOctaves?: number;\n\treadonly customType?: InstrumentType;\n\treadonly settings?: any;\n}\n\nexport const isMobile: boolean = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|android|ipad|playbook|silk/i.test(navigator.userAgent);\n\nexport function prettyNumber(value: number): string {\n\treturn value.toFixed(2).replace(/\\.?0*$/, \"\");\n}\n\nexport class EditorConfig {\n\tpublic static readonly version: string = \"4.0.1\";\n\t\n\tpublic static readonly versionDisplayName: string = \"BeepBox\";\n\tpublic static readonly releaseNotesURL: string = \"https://github.com/johnnesky/beepbox/releases/tag/v\" + EditorConfig.version;\n\t\n\tpublic static readonly isOnMac: boolean = /^Mac/i.test(navigator.platform) || /Mac OS X/i.test(navigator.userAgent) || /^(iPhone|iPad|iPod)/i.test(navigator.platform) || /(iPhone|iPad|iPod)/i.test(navigator.userAgent);\n\tpublic static readonly ctrlSymbol: string = EditorConfig.isOnMac ? \"⌘\" : \"Ctrl+\";\n\t\n\tpublic static readonly presetCategories: DictionaryArray<PresetCategory> = toNameMap([\n\t\t{name: \"Custom Instruments\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"chip wave\",        customType: InstrumentType.chip},\n\t\t\t{name: \"FM (expert)\",      customType: InstrumentType.fm},\n\t\t\t{name: \"basic noise\",      customType: InstrumentType.noise},\n\t\t\t{name: \"spectrum\",         customType: InstrumentType.spectrum},\n\t\t\t{name: \"drumset\",          customType: InstrumentType.drumset},\n\t\t\t{name: \"harmonics\",        customType: InstrumentType.harmonics},\n\t\t\t{name: \"pulse width\",      customType: InstrumentType.pwm},\n\t\t\t{name: \"picked string\",    customType: InstrumentType.pickedString},\n\t\t])},\n\t\t{name: \"Retro Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"square wave\",      midiProgram:  80, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[],\"transition\":\"interrupt\",\"fadeInSeconds\":0,\"fadeOutTicks\":-1,\"chord\":\"arpeggio\",\"wave\":\"square\",\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"triangle wave\",    midiProgram:  71, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[],\"transition\":\"interrupt\",\"fadeInSeconds\":0,\"fadeOutTicks\":-1,\"chord\":\"arpeggio\",\"wave\":\"triangle\",\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"square lead\",      midiProgram:  80, generalMidi: true, settings: {\"type\":\"chip\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":8000,\"linearGain\":0.3536}],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"wave\":\"square\",\"unison\":\"hum\",\"envelopes\":[]}},\n\t\t\t{name: \"sawtooth lead 1\",  midiProgram:  81, generalMidi: true, settings: {\"type\":\"chip\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":0.5}],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"wave\":\"sawtooth\",\"unison\":\"shimmer\",\"envelopes\":[]}},\n\t\t\t{name: \"sawtooth lead 2\",  midiProgram:  81, settings: {\"type\":\"chip\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":6727.17,\"linearGain\":1}],\"effects\":[\"vibrato\"],\"vibrato\":\"light\",\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":72,\"chord\":\"simultaneous\",\"wave\":\"sawtooth\",\"unison\":\"hum\",\"envelopes\":[]}},\n\t\t\t{name: \"chip noise\",       midiProgram: 116, isNoise: true, settings: {\"type\":\"noise\",\"transition\":\"hard\",\"effects\":\"none\",\"chord\":\"arpeggio\",\"filterCutoffHz\":4000,\"filterResonance\":0,\"filterEnvelope\":\"steady\",\"wave\":\"retro\"}},\n\t\t\t{name: \"FM twang\",         midiProgram:  32, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":0},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 2\",\"index\":1}]}},\n\t\t\t{name: \"FM bass\",          midiProgram:  36, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"custom interval\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"2×\",\"amplitude\":11},{\"frequency\":\"1×\",\"amplitude\":7},{\"frequency\":\"1×\",\"amplitude\":9},{\"frequency\":\"20×\",\"amplitude\":3}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 2\",\"index\":1},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 3\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 2\",\"index\":3}]}},\n\t\t\t{name: \"FM flute\",         midiProgram:  73, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":6},{\"frequency\":\"1×\",\"amplitude\":0},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 2\",\"index\":1}]}},\n\t\t\t{name: \"FM organ\",         midiProgram:  16, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"vibrato\"],\"vibrato\":\"delayed\",\"transition\":\"normal\",\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-3,\"chord\":\"custom interval\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14},{\"frequency\":\"2×\",\"amplitude\":14},{\"frequency\":\"1×\",\"amplitude\":11},{\"frequency\":\"2×\",\"amplitude\":11}],\"envelopes\":[]}},\n\t\t])},\n\t\t{name: \"Keyboard Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"grand piano\",      midiProgram:   0, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"high-pass\",\"cutoffHz\":148.65,\"linearGain\":0.7071},{\"type\":\"peak\",\"cutoffHz\":2000,\"linearGain\":2.8284}],\"effects\":[\"note filter\",\"reverb\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":8000,\"linearGain\":0.125}],\"reverb\":67,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"harmonics\":[100,100,86,86,86,71,71,71,0,86,71,71,71,57,57,71,57,14,57,57,57,57,57,57,57,57,29,57],\"unison\":\"piano\",\"stringSustain\":79,\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"note size\"}]}},\n\t\t\t{name: \"bright piano\",     midiProgram:   1, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":1681.79,\"linearGain\":0.7071},{\"type\":\"high-pass\",\"cutoffHz\":148.65,\"linearGain\":0.5},{\"type\":\"peak\",\"cutoffHz\":3363.59,\"linearGain\":1.4142}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":24,\"chord\":\"simultaneous\",\"harmonics\":[100,100,86,86,71,71,0,71,71,71,71,71,71,14,57,57,57,57,57,57,29,57,57,57,57,57,57,57],\"unison\":\"piano\",\"stringSustain\":86,\"envelopes\":[]}},\n\t\t\t{name: \"electric grand\",   midiProgram:   2, generalMidi: true, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2378.41,\"linearGain\":0.5}],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"wave\":\"1/8 pulse\",\"unison\":\"shimmer\",\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 3\"}]}},\n\t\t\t{name: \"honky-tonk piano\", midiProgram:   3, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":5656.85,\"linearGain\":0.3536}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"harmonics\":[100,100,86,71,86,71,43,71,43,43,57,57,57,29,57,57,57,57,57,57,43,57,57,57,43,43,43,43],\"unison\":\"honky tonk\",\"stringSustain\":71,\"envelopes\":[]}},\n\t\t\t{name: \"electric piano 1\", midiProgram:   4, generalMidi: true, settings: {\"type\":\"harmonics\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":3363.59,\"linearGain\":0.5}],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"harmonics\":[86,100,100,71,71,57,57,43,43,43,29,29,29,14,14,14,0,0,0,0,0,57,0,0,0,0,0,0],\"unison\":\"none\",\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 2\"}]}},\n\t\t\t{name: \"electric piano 2\", midiProgram:   5, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":13454.34,\"linearGain\":0.25}],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":12},{\"frequency\":\"1×\",\"amplitude\":6},{\"frequency\":\"1×\",\"amplitude\":9},{\"frequency\":\"16×\",\"amplitude\":6}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 3\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 3\",\"index\":3}]}},\n\t\t\t{name: \"harpsichord\",      midiProgram:   6, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"high-pass\",\"cutoffHz\":250,\"linearGain\":0.3536},{\"type\":\"peak\",\"cutoffHz\":11313.71,\"linearGain\":2.8284}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":24,\"chord\":\"simultaneous\",\"harmonics\":[100,100,100,86,57,86,86,86,86,57,57,71,71,86,86,71,71,86,86,71,71,71,71,71,71,71,71,71],\"unison\":\"none\",\"stringSustain\":79,\"envelopes\":[]}},\n\t\t\t{name: \"clavinet\",         midiProgram:   7, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":19027.31,\"linearGain\":0.3536}],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"3⟲\",\"feedbackAmplitude\":6,\"operators\":[{\"frequency\":\"3×\",\"amplitude\":15},{\"frequency\":\"~1×\",\"amplitude\":6},{\"frequency\":\"8×\",\"amplitude\":4},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 2\"},{\"target\":\"feedbackAmplitude\",\"envelope\":\"twang 2\"}]}},\n\t\t\t{name: \"dulcimer\",         midiProgram:  15, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":8000,\"linearGain\":0.3536}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"strum\",\"harmonics\":[100,100,100,86,100,86,57,100,100,86,100,86,100,86,100,71,57,71,71,100,86,71,86,86,100,86,86,86],\"unison\":\"piano\",\"stringSustain\":79,\"envelopes\":[]}},\n\t\t])},\n\t\t{name: \"Idiophone Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"celesta\",          midiProgram:   8, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":5657,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"none\",\"algorithm\":\"(1 2)←(3 4)\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"~1×\",\"amplitude\":11,\"envelope\":\"custom\"},{\"frequency\":\"8×\",\"amplitude\":6,\"envelope\":\"custom\"},{\"frequency\":\"20×\",\"amplitude\":3,\"envelope\":\"twang 1\"},{\"frequency\":\"3×\",\"amplitude\":1,\"envelope\":\"twang 2\"}]}},\n\t\t\t{name: \"glockenspiel\",     midiProgram:   9, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":5657,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"none\",\"algorithm\":\"(1 2 3)←4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲\",\"feedbackAmplitude\":2,\"feedbackEnvelope\":\"decay 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"5×\",\"amplitude\":11,\"envelope\":\"custom\"},{\"frequency\":\"8×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"20×\",\"amplitude\":2,\"envelope\":\"twang 1\"}]}},\n\t\t\t{name: \"music box 1\",      midiProgram:  10, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4756.83,\"linearGain\":0.5}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"strum\",\"harmonics\":[100,0,0,100,0,0,0,0,0,0,100,0,0,0,0,0,0,0,0,86,0,0,0,0,0,0,71,0],\"unison\":\"none\",\"stringSustain\":64,\"envelopes\":[]}},\n\t\t\t{name: \"music box 2\",      midiProgram:  10, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2828.43,\"linearGain\":0.7071}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"strum\",\"harmonics\":[100,57,57,0,0,0,0,0,0,57,0,0,0,0,0,0,0,0,0,43,0,0,0,0,0,0,0,0],\"unison\":\"none\",\"stringSustain\":29,\"envelopes\":[]}},\n\t\t\t{name: \"vibraphone\",       midiProgram:  11, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"none\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1→2→3→4\",\"feedbackAmplitude\":3,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"~1×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"9×\",\"amplitude\":3,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":9,\"envelope\":\"custom\"}]}},\n\t\t\t{name: \"marimba\",          midiProgram:  12, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2000,\"filterResonance\":29,\"filterEnvelope\":\"decay 1\",\"vibrato\":\"none\",\"algorithm\":\"1 2←(3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":6,\"envelope\":\"custom\"},{\"frequency\":\"13×\",\"amplitude\":6,\"envelope\":\"twang 1\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"kalimba\",          midiProgram: 108, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"decay 1\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":11,\"envelope\":\"custom\"},{\"frequency\":\"5×\",\"amplitude\":3,\"envelope\":\"twang 2\"},{\"frequency\":\"20×\",\"amplitude\":3,\"envelope\":\"twang 1\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"xylophone\",        midiProgram:  13, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"(1 2 3)←4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"6×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"11×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"20×\",\"amplitude\":6,\"envelope\":\"twang 1\"}]}},\n\t\t\t{name: \"tubular bell\",     midiProgram:  14, generalMidi: true, midiSubharmonicOctaves: 1, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":0.5},{\"type\":\"high-pass\",\"cutoffHz\":105.11,\"linearGain\":0.3536}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":96,\"chord\":\"strum\",\"harmonics\":[43,71,0,100,0,100,0,86,0,0,86,0,14,71,14,14,57,14,14,43,14,14,43,14,14,43,14,14],\"unison\":\"shimmer\",\"stringSustain\":86,\"envelopes\":[]}},\n\t\t\t{name: \"bell synth\",       midiProgram:  14, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2000,\"filterResonance\":29,\"filterEnvelope\":\"twang 3\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"~2×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"7×\",\"amplitude\":6,\"envelope\":\"twang 3\"},{\"frequency\":\"20×\",\"amplitude\":1,\"envelope\":\"twang 1\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"rain drop\",        midiProgram:  96, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":4000,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"(1 2)←(3 4)\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"6×\",\"amplitude\":4,\"envelope\":\"custom\"},{\"frequency\":\"20×\",\"amplitude\":3,\"envelope\":\"twang 1\"},{\"frequency\":\"1×\",\"amplitude\":6,\"envelope\":\"tremolo1\"}]}},\n\t\t\t{name: \"crystal\",          midiProgram:  98, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"delayed\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":4,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"3×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"6×\",\"amplitude\":4,\"envelope\":\"custom\"},{\"frequency\":\"13×\",\"amplitude\":4,\"envelope\":\"custom\"}]}},\n\t\t\t{name: \"tinkle bell\",      midiProgram: 112, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"none\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1→2→3→4\",\"feedbackAmplitude\":5,\"feedbackEnvelope\":\"twang 3\",\"operators\":[{\"frequency\":\"~2×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"5×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"7×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"16×\",\"amplitude\":7,\"envelope\":\"custom\"}]}},\n\t\t\t{name: \"agogo\",            midiProgram: 113, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":4000,\"filterResonance\":14,\"filterEnvelope\":\"decay 1\",\"vibrato\":\"none\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1→4\",\"feedbackAmplitude\":15,\"feedbackEnvelope\":\"decay 1\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"5×\",\"amplitude\":6,\"envelope\":\"custom\"},{\"frequency\":\"8×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"13×\",\"amplitude\":11,\"envelope\":\"custom\"}]}},\n\t\t])},\n\t\t{name: \"Guitar Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"nylon guitar\",     midiProgram:  24, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":5657,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"1←2←3←4\",\"feedbackType\":\"3⟲\",\"feedbackAmplitude\":6,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":6,\"envelope\":\"steady\"},{\"frequency\":\"5×\",\"amplitude\":2,\"envelope\":\"steady\"},{\"frequency\":\"7×\",\"amplitude\":4,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"steel guitar\",     midiProgram:  25, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"strum\",\"harmonics\":[100,100,86,71,71,71,86,86,71,57,43,43,43,57,57,57,57,57,43,43,43,43,43,43,43,43,43,43],\"unison\":\"none\",\"stringSustain\":71,\"envelopes\":[]}},\n\t\t\t{name: \"jazz guitar\",      midiProgram:  26, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[100,100,86,71,57,71,71,43,57,71,57,43,29,29,29,29,29,29,29,29,14,14,14,14,14,14,14,0]}},\n\t\t\t{name: \"clean guitar\",     midiProgram:  27, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[86,100,100,100,86,57,86,100,100,100,71,57,43,71,86,71,57,57,71,71,71,71,57,57,57,57,57,43]}},\n\t\t\t{name: \"muted guitar\",     midiProgram:  28, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":7,\"feedbackEnvelope\":\"twang 2\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":13,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":4,\"envelope\":\"twang 3\"},{\"frequency\":\"4×\",\"amplitude\":4,\"envelope\":\"twang 2\"},{\"frequency\":\"16×\",\"amplitude\":4,\"envelope\":\"twang 1\"}]}},\n\t\t])},\n\t\t{name: \"Picked Bass Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"acoustic bass\",    midiProgram:  32, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":4000,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[100,86,71,71,71,71,57,57,57,57,43,43,43,43,43,29,29,29,29,29,29,14,14,14,14,14,14,14]}},\n\t\t\t{name: \"fingered bass\",    midiProgram:  33, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[100,86,71,57,71,43,57,29,29,29,29,29,29,14,14,14,14,14,14,14,14,14,14,14,14,14,14,0]}},\n\t\t\t{name: \"picked bass\",      midiProgram:  34, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":0,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"3⟲\",\"feedbackAmplitude\":4,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":5,\"envelope\":\"steady\"},{\"frequency\":\"11×\",\"amplitude\":1,\"envelope\":\"twang 3\"},{\"frequency\":\"1×\",\"amplitude\":9,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"fretless bass\",    midiProgram:  35, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":1000,\"filterResonance\":14,\"filterEnvelope\":\"flare 2\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[100,100,86,71,71,57,57,71,71,71,57,57,57,57,57,57,57,43,43,43,43,43,43,43,43,29,29,14]}},\n\t\t\t{name: \"slap bass 1\",      midiProgram:  36, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":4000,\"filterResonance\":0,\"filterEnvelope\":\"twang 1\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[100,100,100,100,86,71,57,29,29,43,43,57,71,57,29,29,43,57,57,57,43,43,43,57,71,71,71,71]}},\n\t\t\t{name: \"slap bass 2\",      midiProgram:  37, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":5657,\"filterResonance\":0,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"1←2←3←4\",\"feedbackType\":\"3⟲\",\"feedbackAmplitude\":4,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"3×\",\"amplitude\":13,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":7,\"envelope\":\"steady\"},{\"frequency\":\"13×\",\"amplitude\":3,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":11,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"bass synth 1\",     midiProgram:  38, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"strum\",\"filterCutoffHz\":4000,\"filterResonance\":43,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"none\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"3⟲ 4⟲\",\"feedbackAmplitude\":9,\"feedbackEnvelope\":\"twang 2\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"twang 1\"},{\"frequency\":\"~1×\",\"amplitude\":13,\"envelope\":\"twang 2\"}]}},\n\t\t\t{name: \"bass synth 2\",     midiProgram:  39, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":1000,\"filterResonance\":57,\"filterEnvelope\":\"punch\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1→2\",\"feedbackAmplitude\":4,\"feedbackEnvelope\":\"twang 3\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":9,\"envelope\":\"steady\"},{\"frequency\":\"3×\",\"amplitude\":0,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"bass & lead\",      midiProgram:  87, generalMidi: true, settings: {\"type\":\"chip\",\"transition\":\"hard\",\"effects\":\"reverb\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":86,\"filterEnvelope\":\"twang 2\",\"wave\":\"sawtooth\",\"interval\":\"shimmer\",\"vibrato\":\"none\"}},\n\t\t\t{name: \"dubstep yoi yoi\",  midiProgram:  87, settings: {\"type\":\"chip\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":6727.17,\"linearGain\":0.7071}],\"effects\":[\"note filter\",\"bitcrusher\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":594.6,\"linearGain\":11.3137}],\"bitcrusherOctave\":1.5,\"bitcrusherQuantization\":0,\"transition\":\"slide\",\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-3,\"chord\":\"arpeggio\",\"wave\":\"sawtooth\",\"unison\":\"none\",\"envelopes\":[{\"target\":\"noteFilterFreq\",\"envelope\":\"flare 2\",\"index\":0}]}},\n\t\t])},\n\t\t{name: \"Picked String Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"pizzicato strings\",midiProgram:  45, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"medium fade\",\"chord\":\"harmony\",\"filterCutoffHz\":1000,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"(1 2 3)←4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":7,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"3×\",\"amplitude\":11,\"envelope\":\"custom\"},{\"frequency\":\"6×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"~1×\",\"amplitude\":10,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"harp\",             midiProgram:  46, generalMidi: true, settings: {\"type\":\"FM\",\"transition\":\"hard fade\",\"effects\":\"reverb\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":0,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"3⟲\",\"feedbackAmplitude\":6,\"feedbackEnvelope\":\"twang 2\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":6,\"envelope\":\"custom\"},{\"frequency\":\"~2×\",\"amplitude\":3,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":6,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"sitar\",            midiProgram: 104, generalMidi: true, settings: {\"type\":\"FM\",\"transition\":\"hard fade\",\"effects\":\"reverb\",\"chord\":\"strum\",\"filterCutoffHz\":8000,\"filterResonance\":57,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"twang 3\"},{\"frequency\":\"9×\",\"amplitude\":3,\"envelope\":\"twang 3\"},{\"frequency\":\"16×\",\"amplitude\":9,\"envelope\":\"swell 3\"}]}},\n\t\t\t{name: \"banjo\",            midiProgram: 105, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"2⟲\",\"feedbackAmplitude\":4,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"4×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"steady\"},{\"frequency\":\"11×\",\"amplitude\":3,\"envelope\":\"twang 3\"},{\"frequency\":\"1×\",\"amplitude\":11,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"ukulele\",          midiProgram: 105, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2000,\"filterResonance\":0,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"3⟲\",\"feedbackAmplitude\":5,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":6,\"envelope\":\"steady\"},{\"frequency\":\"9×\",\"amplitude\":4,\"envelope\":\"twang 2\"},{\"frequency\":\"1×\",\"amplitude\":11,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"shamisen\",         midiProgram: 106, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"harmony\",\"filterCutoffHz\":8000,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"3⟲\",\"feedbackAmplitude\":9,\"feedbackEnvelope\":\"twang 3\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":12,\"envelope\":\"steady\"},{\"frequency\":\"16×\",\"amplitude\":4,\"envelope\":\"twang 3\"},{\"frequency\":\"1×\",\"amplitude\":7,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"koto\",             midiProgram: 107, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"vibrato\":\"none\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":5,\"feedbackEnvelope\":\"twang 2\",\"operators\":[{\"frequency\":\"~1×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"6×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":8,\"envelope\":\"twang 3\"},{\"frequency\":\"~2×\",\"amplitude\":8,\"envelope\":\"twang 3\"}]}},\n\t\t])},\n\t\t{name: \"Distortion Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"overdrive guitar\", midiProgram:  29, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4756.83,\"linearGain\":0.7071},{\"type\":\"high-pass\",\"cutoffHz\":210.22,\"linearGain\":1},{\"type\":\"low-pass\",\"cutoffHz\":5656.85,\"linearGain\":1},{\"type\":\"peak\",\"cutoffHz\":840.9,\"linearGain\":0.5}],\"effects\":[\"note filter\",\"distortion\"],\"noteFilter\":[{\"type\":\"high-pass\",\"cutoffHz\":297.3,\"linearGain\":2},{\"type\":\"low-pass\",\"cutoffHz\":2378.41,\"linearGain\":0.7071}],\"distortion\":71,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":12,\"chord\":\"strum\",\"harmonics\":[86,100,100,86,86,86,86,71,71,71,71,71,71,71,71,71,71,57,57,57,57,57,57,57,57,57,57,57],\"unison\":\"none\",\"stringSustain\":71,\"envelopes\":[{\"target\":\"noteFilterFreq\",\"envelope\":\"note size\",\"index\":1}]}},\n\t\t\t{name: \"distortion guitar\",midiProgram:  30, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4756.83,\"linearGain\":0.7071},{\"type\":\"high-pass\",\"cutoffHz\":210.22,\"linearGain\":1},{\"type\":\"low-pass\",\"cutoffHz\":5656.85,\"linearGain\":1},{\"type\":\"peak\",\"cutoffHz\":594.6,\"linearGain\":0.3536},{\"type\":\"peak\",\"cutoffHz\":1000,\"linearGain\":0.25}],\"effects\":[\"note filter\",\"distortion\",\"reverb\"],\"noteFilter\":[{\"type\":\"high-pass\",\"cutoffHz\":353.55,\"linearGain\":2},{\"type\":\"low-pass\",\"cutoffHz\":2000,\"linearGain\":1}],\"distortion\":86,\"reverb\":67,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":12,\"chord\":\"strum\",\"harmonics\":[86,100,100,86,86,86,86,71,71,71,71,71,71,71,71,71,71,57,57,57,57,57,57,57,57,57,57,57],\"unison\":\"none\",\"stringSustain\":71,\"envelopes\":[{\"target\":\"noteFilterFreq\",\"envelope\":\"note size\",\"index\":1}]}},\n\t\t\t{name: \"charango synth\",   midiProgram:  84, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":11313.71,\"linearGain\":1}],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"strum\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1→2→3→4\",\"feedbackAmplitude\":8,\"operators\":[{\"frequency\":\"3×\",\"amplitude\":13},{\"frequency\":\"~1×\",\"amplitude\":5},{\"frequency\":\"4×\",\"amplitude\":6},{\"frequency\":\"3×\",\"amplitude\":7}],\"envelopes\":[{\"target\":\"feedbackAmplitude\",\"envelope\":\"twang 3\"}]}},\n\t\t\t{name: \"guitar harmonics\", midiProgram:  31, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":2}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"strum\",\"algorithm\":\"1←(2 3)←4\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":2,\"operators\":[{\"frequency\":\"4×\",\"amplitude\":12},{\"frequency\":\"16×\",\"amplitude\":5},{\"frequency\":\"1×\",\"amplitude\":2},{\"frequency\":\"~1×\",\"amplitude\":12}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 1\",\"index\":1},{\"target\":\"operatorAmplitude\",\"envelope\":\"punch\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 1\",\"index\":3}]}},\n\t\t\t{name: \"PWM overdrive\",    midiProgram:  29, settings: {\"type\":\"PWM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":5656.85,\"linearGain\":1.4142}],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"strum\",\"pulseWidth\":17.67767,\"envelopes\":[{\"target\":\"pulseWidth\",\"envelope\":\"punch\"}]}},\n\t\t\t{name: \"PWM distortion\",   midiProgram:  30, settings: {\"type\":\"PWM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":3363.59,\"linearGain\":2}],\"effects\":[\"vibrato\"],\"vibrato\":\"delayed\",\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"strum\",\"pulseWidth\":50,\"envelopes\":[{\"target\":\"pulseWidth\",\"envelope\":\"swell 1\"}]}},\n\t\t\t{name: \"FM overdrive\",     midiProgram:  29, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4756.83,\"linearGain\":1}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"strum\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1→2\",\"feedbackAmplitude\":2,\"operators\":[{\"frequency\":\"~1×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":12},{\"frequency\":\"~2×\",\"amplitude\":6},{\"frequency\":\"1×\",\"amplitude\":12}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 1\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 3\",\"index\":3},{\"target\":\"feedbackAmplitude\",\"envelope\":\"punch\"}]}},\n\t\t\t{name: \"FM distortion\",    midiProgram:  30, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":2}],\"effects\":[\"reverb\"],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"strum\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1→2\",\"feedbackAmplitude\":4,\"operators\":[{\"frequency\":\"~1×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":11},{\"frequency\":\"1×\",\"amplitude\":9},{\"frequency\":\"~2×\",\"amplitude\":4}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 1\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 3\",\"index\":3}]}},\n\t\t])},\n\t\t{name: \"Bellows Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"drawbar organ 1\",  midiProgram:  16, generalMidi: true, midiSubharmonicOctaves: 1, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"steady\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[86,86,0,86,0,0,0,86,0,0,0,0,0,0,0,86,0,0,0,0,0,0,0,0,0,0,0,0]}},\n\t\t\t{name: \"drawbar organ 2\",  midiProgram:  16, midiSubharmonicOctaves: 1, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"steady\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[86,29,71,86,71,14,0,100,0,0,0,86,0,0,0,71,0,0,0,57,0,0,0,29,0,0,0,0]}},\n\t\t\t{name: \"percussive organ\", midiProgram:  17, generalMidi: true, midiSubharmonicOctaves: 1, settings: {\"type\":\"FM\",\"transition\":\"hard\",\"effects\":\"reverb\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"punch\",\"vibrato\":\"light\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1→3 2→4\",\"feedbackAmplitude\":7,\"feedbackEnvelope\":\"decay 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"3×\",\"amplitude\":8,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":8,\"envelope\":\"custom\"}]}},\n\t\t\t{name: \"rock organ\",       midiProgram:  18, generalMidi: true, midiSubharmonicOctaves: 1, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"hard\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":14,\"filterEnvelope\":\"punch\",\"vibrato\":\"delayed\",\"algorithm\":\"(1 2 3)←4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲\",\"feedbackAmplitude\":2,\"feedbackEnvelope\":\"flare 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"6×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":5,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"pipe organ\",       midiProgram:  19, generalMidi: true, midiSubharmonicOctaves: 1, settings: {\"type\":\"FM\",\"transition\":\"cross fade\",\"effects\":\"reverb\",\"chord\":\"harmony\",\"filterCutoffHz\":5657,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":5,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":8,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"8×\",\"amplitude\":8,\"envelope\":\"custom\"}]}},\n\t\t\t{name: \"reed organ\",       midiProgram:  20, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":29,\"filterEnvelope\":\"steady\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[71,86,100,86,71,100,57,71,71,71,43,43,43,71,43,71,57,57,57,57,57,57,57,29,43,29,29,14]}},\n\t\t\t{name: \"accordion\",        midiProgram:  21, generalMidi: true, settings: {\"type\":\"chip\",\"effects\":\"reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":5657,\"filterResonance\":0,\"filterEnvelope\":\"swell 1\",\"wave\":\"double saw\",\"interval\":\"honky tonk\",\"vibrato\":\"none\"}},\n\t\t\t{name: \"bandoneon\",        midiProgram:  23, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":29,\"filterEnvelope\":\"swell 1\",\"interval\":\"hum\",\"vibrato\":\"none\",\"harmonics\":[86,86,86,57,71,86,57,71,71,71,57,43,57,43,71,43,71,57,57,43,43,43,57,43,43,29,29,29]}},\n\t\t\t{name: \"bagpipe\",          midiProgram: 109, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":5657,\"filterResonance\":43,\"filterEnvelope\":\"punch\",\"interval\":\"hum\",\"vibrato\":\"none\",\"harmonics\":[71,86,86,100,100,86,57,100,86,71,71,71,57,57,57,71,57,71,57,71,43,57,57,43,43,43,43,43]}},\n\t\t])},\n\t\t{name: \"String Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"violin\",           midiProgram:  40, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":1.4142},{\"type\":\"high-pass\",\"cutoffHz\":105.11,\"linearGain\":0.3536}],\"effects\":[\"vibrato\",\"reverb\"],\"vibrato\":\"delayed\",\"reverb\":67,\"transition\":\"normal\",\"fadeInSeconds\":0.0413,\"fadeOutTicks\":6,\"chord\":\"simultaneous\",\"algorithm\":\"(1 2)←(3 4)\",\"feedbackType\":\"1→2\",\"feedbackAmplitude\":5,\"operators\":[{\"frequency\":\"4×\",\"amplitude\":9},{\"frequency\":\"3×\",\"amplitude\":9},{\"frequency\":\"2×\",\"amplitude\":7},{\"frequency\":\"7×\",\"amplitude\":5}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 1\",\"index\":3},{\"target\":\"feedbackAmplitude\",\"envelope\":\"twang 3\"}]}},\n\t\t\t{name: \"viola\",            midiProgram:  41, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":29,\"filterEnvelope\":\"steady\",\"vibrato\":\"delayed\",\"algorithm\":\"(1 2 3)←4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲\",\"feedbackAmplitude\":8,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":11,\"envelope\":\"custom\"},{\"frequency\":\"7×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"13×\",\"amplitude\":4,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":5,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"cello\",            midiProgram:  42, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":0.1768},{\"type\":\"high-pass\",\"cutoffHz\":297.3,\"linearGain\":0.7071},{\"type\":\"peak\",\"cutoffHz\":4756.83,\"linearGain\":5.6569}],\"effects\":[\"note filter\",\"reverb\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":16000,\"linearGain\":0.0884}],\"reverb\":67,\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":12,\"chord\":\"simultaneous\",\"algorithm\":\"(1 2)←3←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":3,\"operators\":[{\"frequency\":\"16×\",\"amplitude\":5},{\"frequency\":\"~1×\",\"amplitude\":10},{\"frequency\":\"1×\",\"amplitude\":9},{\"frequency\":\"6×\",\"amplitude\":3}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"swell 1\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 1\",\"index\":3}]}},\n\t\t\t{name: \"contrabass\",       midiProgram:  43, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":29,\"filterEnvelope\":\"steady\",\"vibrato\":\"delayed\",\"algorithm\":\"(1 2)←3←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"16×\",\"amplitude\":5,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"steady\"},{\"frequency\":\"6×\",\"amplitude\":3,\"envelope\":\"swell 1\"}]}},\n\t\t\t{name: \"fiddle\",           midiProgram: 110, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":29,\"filterEnvelope\":\"steady\",\"vibrato\":\"delayed\",\"algorithm\":\"(1 2)←(3 4)\",\"feedbackType\":\"3⟲ 4⟲\",\"feedbackAmplitude\":5,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"8×\",\"amplitude\":8,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":8,\"envelope\":\"steady\"},{\"frequency\":\"16×\",\"amplitude\":3,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"tremolo strings\",  midiProgram:  44, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"medium fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":0,\"filterEnvelope\":\"tremolo4\",\"vibrato\":\"none\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1→2→3→4\",\"feedbackAmplitude\":12,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":8,\"envelope\":\"custom\"},{\"frequency\":\"~2×\",\"amplitude\":8,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":8,\"envelope\":\"custom\"},{\"frequency\":\"7×\",\"amplitude\":8,\"envelope\":\"custom\"}]}},\n\t\t\t{name: \"strings\",          midiProgram:  48, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"(1 2)←(3 4)\",\"feedbackType\":\"4⟲\",\"feedbackAmplitude\":5,\"feedbackEnvelope\":\"twang 3\",\"operators\":[{\"frequency\":\"4×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"3×\",\"amplitude\":9,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":7,\"envelope\":\"steady\"},{\"frequency\":\"7×\",\"amplitude\":3,\"envelope\":\"swell 1\"}]}},\n\t\t\t{name: \"slow strings\",     midiProgram:  49, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"soft fade\",\"chord\":\"harmony\",\"filterCutoffHz\":1414,\"filterResonance\":0,\"filterEnvelope\":\"swell 2\",\"vibrato\":\"none\",\"algorithm\":\"(1 2)←(3 4)\",\"feedbackType\":\"4⟲\",\"feedbackAmplitude\":6,\"feedbackEnvelope\":\"flare 3\",\"operators\":[{\"frequency\":\"4×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"3×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":7,\"envelope\":\"steady\"},{\"frequency\":\"7×\",\"amplitude\":4,\"envelope\":\"swell 1\"}]}},\n\t\t\t{name: \"strings synth 1\",  midiProgram:  50, generalMidi: true, settings: {\"type\":\"chip\",\"transition\":\"soft fade\",\"effects\":\"chorus & reverb\",\"chord\":\"harmony\",\"filterCutoffHz\":1414,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"wave\":\"sawtooth\",\"interval\":\"hum\",\"vibrato\":\"delayed\"}},\n\t\t\t{name: \"strings synth 2\",  midiProgram:  51, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"soft fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":12,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"3×\",\"amplitude\":6,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":8,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":9,\"envelope\":\"custom\"}]}},\n\t\t\t{name: \"orchestra hit 1\",  midiProgram:  55, generalMidi: true, midiSubharmonicOctaves: 1, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"hard fade\",\"chord\":\"harmony\",\"filterCutoffHz\":8000,\"filterResonance\":14,\"filterEnvelope\":\"custom\",\"vibrato\":\"none\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":14,\"feedbackEnvelope\":\"twang 3\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"twang 3\"},{\"frequency\":\"2×\",\"amplitude\":15,\"envelope\":\"flare 3\"},{\"frequency\":\"4×\",\"amplitude\":15,\"envelope\":\"flare 2\"},{\"frequency\":\"8×\",\"amplitude\":15,\"envelope\":\"flare 1\"}]}},\n\t\t\t{name: \"orchestra hit 2\",  midiProgram:  55, midiSubharmonicOctaves: 1, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"medium fade\",\"chord\":\"harmony\",\"filterCutoffHz\":8000,\"filterResonance\":0,\"filterEnvelope\":\"decay 1\",\"vibrato\":\"delayed\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":14,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"3×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":14,\"envelope\":\"custom\"}]}},\n\t\t])},\n\t\t{name: \"Vocal Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"choir soprano\",    midiProgram:  94, generalMidi: true, settings: {\"type\":\"harmonics\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2828.43,\"linearGain\":2},{\"type\":\"peak\",\"cutoffHz\":1189.21,\"linearGain\":5.6569},{\"type\":\"high-pass\",\"cutoffHz\":707.11,\"linearGain\":2.8284},{\"type\":\"peak\",\"cutoffHz\":2000,\"linearGain\":0.0884},{\"type\":\"peak\",\"cutoffHz\":840.9,\"linearGain\":0.25},{\"type\":\"low-pass\",\"cutoffHz\":6727.17,\"linearGain\":11.3137}],\"effects\":[\"vibrato\",\"chorus\",\"reverb\"],\"vibrato\":\"shaky\",\"chorus\":100,\"reverb\":33,\"fadeInSeconds\":0.0413,\"fadeOutTicks\":24,\"harmonics\":[100,100,86,57,29,29,57,71,57,29,14,14,14,29,43,57,43,29,14,14,14,14,14,14,0,0,0,0],\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"choir tenor\",      midiProgram:  52, generalMidi: true, settings: {\"type\":\"harmonics\",\"eqFilter\":[{\"type\":\"peak\",\"cutoffHz\":1000,\"linearGain\":11.3137},{\"type\":\"peak\",\"cutoffHz\":707.11,\"linearGain\":5.6569},{\"type\":\"peak\",\"cutoffHz\":840.9,\"linearGain\":0.0884},{\"type\":\"peak\",\"cutoffHz\":1681.79,\"linearGain\":0.0884},{\"type\":\"high-pass\",\"cutoffHz\":297.3,\"linearGain\":0.7071},{\"type\":\"low-pass\",\"cutoffHz\":2828.43,\"linearGain\":11.3137}],\"effects\":[\"vibrato\",\"chorus\",\"reverb\"],\"vibrato\":\"shaky\",\"chorus\":100,\"reverb\":67,\"transition\":\"normal\",\"fadeInSeconds\":0.0413,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"harmonics\":[86,100,100,86,71,57,43,29,29,29,29,43,43,43,29,29,29,29,29,29,29,29,29,14,14,14,14,14],\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"choir bass\",       midiProgram:  52, settings: {\"type\":\"harmonics\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2378.41,\"linearGain\":11.3137},{\"type\":\"peak\",\"cutoffHz\":594.6,\"linearGain\":5.6569},{\"type\":\"peak\",\"cutoffHz\":1681.79,\"linearGain\":0.0884},{\"type\":\"peak\",\"cutoffHz\":707.11,\"linearGain\":0.0884},{\"type\":\"peak\",\"cutoffHz\":840.9,\"linearGain\":11.3137}],\"effects\":[\"vibrato\",\"chorus\",\"reverb\"],\"vibrato\":\"shaky\",\"chorus\":100,\"reverb\":67,\"transition\":\"normal\",\"fadeInSeconds\":0.0413,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"harmonics\":[71,86,100,100,86,86,57,43,29,29,29,29,29,29,43,43,43,43,43,29,29,29,29,14,14,14,14,14],\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"solo soprano\",     midiProgram:  85, settings: {\"type\":\"harmonics\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2828.43,\"linearGain\":2},{\"type\":\"peak\",\"cutoffHz\":1189.21,\"linearGain\":5.6569},{\"type\":\"high-pass\",\"cutoffHz\":707.11,\"linearGain\":2.8284},{\"type\":\"peak\",\"cutoffHz\":2000,\"linearGain\":0.0884},{\"type\":\"peak\",\"cutoffHz\":840.9,\"linearGain\":0.25}],\"effects\":[\"vibrato\",\"reverb\"],\"vibrato\":\"shaky\",\"reverb\":33,\"fadeInSeconds\":0.0413,\"fadeOutTicks\":12,\"harmonics\":[86,100,86,43,14,14,57,71,57,14,14,14,14,14,43,57,43,14,14,14,14,14,14,14,0,0,0,0],\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"solo tenor\",       midiProgram:  85, settings: {\"type\":\"harmonics\",\"eqFilter\":[{\"type\":\"peak\",\"cutoffHz\":1000,\"linearGain\":11.3137},{\"type\":\"peak\",\"cutoffHz\":707.11,\"linearGain\":5.6569},{\"type\":\"peak\",\"cutoffHz\":840.9,\"linearGain\":0.0884},{\"type\":\"peak\",\"cutoffHz\":1681.79,\"linearGain\":0.0884},{\"type\":\"high-pass\",\"cutoffHz\":297.3,\"linearGain\":0.7071},{\"type\":\"low-pass\",\"cutoffHz\":2828.43,\"linearGain\":11.3137}],\"effects\":[\"vibrato\",\"reverb\"],\"vibrato\":\"shaky\",\"reverb\":33,\"fadeInSeconds\":0.0413,\"fadeOutTicks\":12,\"harmonics\":[86,100,100,86,71,57,43,29,29,29,29,43,43,43,29,29,29,29,29,29,29,29,29,14,14,14,14,14],\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"solo bass\",        midiProgram:  85, settings: {\"type\":\"harmonics\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2378.41,\"linearGain\":5.6569},{\"type\":\"peak\",\"cutoffHz\":594.6,\"linearGain\":8},{\"type\":\"peak\",\"cutoffHz\":1681.79,\"linearGain\":0.0884},{\"type\":\"peak\",\"cutoffHz\":707.11,\"linearGain\":0.0884},{\"type\":\"peak\",\"cutoffHz\":840.9,\"linearGain\":8},{\"type\":\"high-pass\",\"cutoffHz\":210.22,\"linearGain\":1.4142}],\"effects\":[\"vibrato\",\"reverb\"],\"vibrato\":\"shaky\",\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0.0263,\"fadeOutTicks\":12,\"chord\":\"simultaneous\",\"harmonics\":[71,86,100,100,86,86,57,43,29,29,29,29,29,29,43,43,43,43,43,29,29,29,29,14,14,14,14,14],\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"voice ooh\",        midiProgram:  53, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":1414,\"filterResonance\":57,\"filterEnvelope\":\"steady\",\"interval\":\"union\",\"vibrato\":\"shaky\",\"harmonics\":[100,57,43,43,14,14,0,0,0,14,29,29,14,0,14,29,29,14,0,0,0,0,0,0,0,0,0,0]}},\n\t\t\t{name: \"voice synth\",      midiProgram:  54, generalMidi: true, settings: {\"type\":\"chip\",\"transition\":\"medium fade\",\"effects\":\"chorus & reverb\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":57,\"filterEnvelope\":\"steady\",\"wave\":\"rounded\",\"interval\":\"union\",\"vibrato\":\"light\"}},\n\t\t\t{name: \"vox synth lead\",   midiProgram:  85, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"steady\",\"vibrato\":\"light\",\"algorithm\":\"(1 2 3)←4\",\"feedbackType\":\"1→2→3→4\",\"feedbackAmplitude\":2,\"feedbackEnvelope\":\"punch\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"9×\",\"amplitude\":5,\"envelope\":\"custom\"},{\"frequency\":\"20×\",\"amplitude\":1,\"envelope\":\"custom\"},{\"frequency\":\"~1×\",\"amplitude\":4,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"tiny robot\",       midiProgram:  85, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"vibrato\",\"reverb\"],\"vibrato\":\"delayed\",\"reverb\":33,\"transition\":\"slide\",\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":2,\"operators\":[{\"frequency\":\"2×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":7},{\"frequency\":\"~1×\",\"amplitude\":7},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"punch\",\"index\":1},{\"target\":\"feedbackAmplitude\",\"envelope\":\"twang 3\"}]}},\n\t\t\t{name: \"yowie\",            midiProgram:  85, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":86,\"filterEnvelope\":\"tremolo5\",\"vibrato\":\"none\",\"algorithm\":\"1←2←(3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":12,\"feedbackEnvelope\":\"tremolo3\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"16×\",\"amplitude\":5,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":5,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"mouse\",            midiProgram:  85, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"vibrato\",\"reverb\"],\"vibrato\":\"light\",\"reverb\":33,\"transition\":\"slide in pattern\",\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":5,\"operators\":[{\"frequency\":\"2×\",\"amplitude\":13},{\"frequency\":\"5×\",\"amplitude\":12},{\"frequency\":\"1×\",\"amplitude\":0},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"noteVolume\",\"envelope\":\"note size\"},{\"target\":\"feedbackAmplitude\",\"envelope\":\"flare 2\"}]}},\n\t\t\t{name: \"gumdrop\",          midiProgram:  85, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"harmony\",\"filterCutoffHz\":8000,\"filterResonance\":0,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"(1 2 3)←4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲\",\"feedbackAmplitude\":0,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":15,\"envelope\":\"punch\"},{\"frequency\":\"4×\",\"amplitude\":15,\"envelope\":\"punch\"},{\"frequency\":\"7×\",\"amplitude\":15,\"envelope\":\"punch\"},{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"twang 1\"}]}},\n\t\t\t{name: \"echo drop\",        midiProgram: 102, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"hard\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"punch\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":2,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"~2×\",\"amplitude\":11,\"envelope\":\"custom\"},{\"frequency\":\"~1×\",\"amplitude\":5,\"envelope\":\"steady\"},{\"frequency\":\"11×\",\"amplitude\":2,\"envelope\":\"steady\"},{\"frequency\":\"16×\",\"amplitude\":5,\"envelope\":\"swell 3\"}]}},\n\t\t\t{name: \"dark choir\",       midiProgram:  85, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":29,\"filterEnvelope\":\"swell 1\",\"spectrum\":[43,14,14,14,14,14,14,100,14,14,14,57,14,14,100,14,43,14,43,14,14,43,14,29,14,29,14,14,29,0]}},\n\t\t])},\n\t\t{name: \"Brass Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"trumpet\",          midiProgram:  56, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":9,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":8,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":5,\"envelope\":\"flare 2\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"trombone\",         midiProgram:  57, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"2⟲\",\"feedbackAmplitude\":7,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":8,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"tuba\",             midiProgram:  58, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"2⟲\",\"feedbackAmplitude\":8,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":6,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"muted trumpet\",    midiProgram:  59, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":8000,\"linearGain\":2.8284},{\"type\":\"peak\",\"cutoffHz\":4000,\"linearGain\":2.8284}],\"effects\":[\"note filter\",\"reverb\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":3363.59,\"linearGain\":1}],\"reverb\":33,\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-3,\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":5,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":13},{\"frequency\":\"1×\",\"amplitude\":5},{\"frequency\":\"9×\",\"amplitude\":5},{\"frequency\":\"13×\",\"amplitude\":7}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"swell 1\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 1\",\"index\":3},{\"target\":\"feedbackAmplitude\",\"envelope\":\"flare 2\"}]}},\n\t\t\t{name: \"french horn\",      midiProgram:  60, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":1},{\"type\":\"peak\",\"cutoffHz\":2378.41,\"linearGain\":2.8284}],\"effects\":[\"reverb\"],\"reverb\":33,\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-3,\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":3,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":12},{\"frequency\":\"1×\",\"amplitude\":10},{\"frequency\":\"~1×\",\"amplitude\":8}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 1\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"flare 2\",\"index\":3},{\"target\":\"feedbackAmplitude\",\"envelope\":\"swell 1\"}]}},\n\t\t\t{name: \"brass section\",    midiProgram:  61, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"punch\",\"vibrato\":\"none\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":6,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"swell 1\"},{\"frequency\":\"~1×\",\"amplitude\":10,\"envelope\":\"swell 1\"}]}},\n\t\t\t{name: \"brass synth 1\",    midiProgram:  62, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":29,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":11,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":12,\"envelope\":\"flare 1\"},{\"frequency\":\"~1×\",\"amplitude\":8,\"envelope\":\"flare 2\"}]}},\n\t\t\t{name: \"brass synth 2\",    midiProgram:  63, generalMidi: true, settings: {\"type\":\"FM\",\"transition\":\"soft\",\"effects\":\"reverb\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":43,\"filterEnvelope\":\"twang 3\",\"vibrato\":\"none\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":9,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"flare 1\"},{\"frequency\":\"~1×\",\"amplitude\":7,\"envelope\":\"flare 1\"}]}},\n\t\t\t{name: \"pulse brass\",      midiProgram:  62, settings: {\"type\":\"PWM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":29,\"filterEnvelope\":\"swell 1\",\"pulseWidth\":50,\"pulseEnvelope\":\"flare 3\",\"vibrato\":\"none\"}},\n\t\t])},\n\t\t{name: \"Reed Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"soprano sax\",      midiProgram:  64, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":29,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←2←3←4\",\"feedbackType\":\"4⟲\",\"feedbackAmplitude\":5,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":13,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":4,\"envelope\":\"swell 1\"},{\"frequency\":\"1×\",\"amplitude\":7,\"envelope\":\"steady\"},{\"frequency\":\"5×\",\"amplitude\":4,\"envelope\":\"punch\"}]}},\n\t\t\t{name: \"alto sax\",         midiProgram:  65, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":4,\"feedbackEnvelope\":\"punch\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":13,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":6,\"envelope\":\"steady\"},{\"frequency\":\"4×\",\"amplitude\":6,\"envelope\":\"swell 1\"},{\"frequency\":\"1×\",\"amplitude\":12,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"tenor sax\",        midiProgram:  66, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":29,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←2←3←4\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":6,\"feedbackEnvelope\":\"swell 1\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"3×\",\"amplitude\":7,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":3,\"envelope\":\"steady\"},{\"frequency\":\"8×\",\"amplitude\":3,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"baritone sax\",     midiProgram:  67, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":0,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":2,\"feedbackEnvelope\":\"swell 2\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"8×\",\"amplitude\":4,\"envelope\":\"steady\"},{\"frequency\":\"4×\",\"amplitude\":5,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":4,\"envelope\":\"punch\"}]}},\n\t\t\t{name: \"sax synth\",        midiProgram:  64, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":8000,\"filterResonance\":0,\"filterEnvelope\":\"steady\",\"vibrato\":\"light\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":4,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"4×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"shehnai\",          midiProgram: 111, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":8000,\"filterResonance\":0,\"filterEnvelope\":\"steady\",\"vibrato\":\"light\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":3,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"4×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":8,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"oboe\",             midiProgram:  68, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":14,\"filterEnvelope\":\"swell 1\",\"vibrato\":\"none\",\"algorithm\":\"1 2←(3 4)\",\"feedbackType\":\"2⟲\",\"feedbackAmplitude\":2,\"feedbackEnvelope\":\"tremolo5\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":7,\"envelope\":\"custom\"},{\"frequency\":\"4×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":6,\"envelope\":\"steady\"},{\"frequency\":\"6×\",\"amplitude\":2,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"english horn\",     midiProgram:  69, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1 2←(3 4)\",\"feedbackType\":\"2⟲\",\"feedbackAmplitude\":2,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"4×\",\"amplitude\":12,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":8,\"envelope\":\"punch\"},{\"frequency\":\"8×\",\"amplitude\":4,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"bassoon\",          midiProgram:  70, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":707,\"filterResonance\":57,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":2,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":11,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":6,\"envelope\":\"steady\"},{\"frequency\":\"6×\",\"amplitude\":6,\"envelope\":\"swell 1\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"clarinet\",         midiProgram:  71, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":1414,\"filterResonance\":14,\"filterEnvelope\":\"steady\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[100,43,86,57,86,71,86,71,71,71,71,71,71,43,71,71,57,57,57,57,57,57,43,43,43,29,14,0]}},\n\t\t\t{name: \"harmonica\",        midiProgram:  22, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":5657,\"filterResonance\":29,\"filterEnvelope\":\"swell 1\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":9,\"feedbackEnvelope\":\"tremolo5\",\"operators\":[{\"frequency\":\"2×\",\"amplitude\":14,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"steady\"},{\"frequency\":\"~2×\",\"amplitude\":2,\"envelope\":\"twang 3\"},{\"frequency\":\"1×\",\"amplitude\":0,\"envelope\":\"steady\"}]}},\n\t\t])},\n\t\t{name: \"Flute Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"flute\",            midiProgram:  73, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":5657,\"filterResonance\":14,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"4⟲\",\"feedbackAmplitude\":7,\"feedbackEnvelope\":\"decay 2\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":4,\"envelope\":\"steady\"},{\"frequency\":\"1×\",\"amplitude\":3,\"envelope\":\"steady\"},{\"frequency\":\"~1×\",\"amplitude\":1,\"envelope\":\"punch\"}]}},\n\t\t\t{name: \"recorder\",         midiProgram:  74, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":29,\"filterEnvelope\":\"swell 2\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[100,43,57,43,57,43,43,43,43,43,43,43,43,29,29,29,29,29,29,29,14,14,14,14,14,14,14,0]}},\n\t\t\t{name: \"whistle\",          midiProgram:  78, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"chorus & reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"interval\":\"union\",\"vibrato\":\"delayed\",\"harmonics\":[100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},\n\t\t\t{name: \"ocarina\",          midiProgram:  79, generalMidi: true, settings: {\"type\":\"harmonics\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"interval\":\"union\",\"vibrato\":\"none\",\"harmonics\":[100,14,57,14,29,14,14,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},\n\t\t\t{name: \"piccolo\",          midiProgram:  72, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":5657,\"filterResonance\":43,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"4⟲\",\"feedbackAmplitude\":15,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"1×\",\"amplitude\":10,\"envelope\":\"custom\"},{\"frequency\":\"~2×\",\"amplitude\":3,\"envelope\":\"punch\"},{\"frequency\":\"~1×\",\"amplitude\":5,\"envelope\":\"punch\"}]}},\n\t\t\t{name: \"shakuhachi\",       midiProgram:  77, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":14,\"filterEnvelope\":\"steady\",\"vibrato\":\"delayed\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"3→4\",\"feedbackAmplitude\":15,\"feedbackEnvelope\":\"steady\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"2×\",\"amplitude\":3,\"envelope\":\"punch\"},{\"frequency\":\"~1×\",\"amplitude\":4,\"envelope\":\"twang 1\"},{\"frequency\":\"20×\",\"amplitude\":15,\"envelope\":\"steady\"}]}},\n\t\t\t{name: \"pan flute\",        midiProgram:  75, generalMidi: true, settings: {\"type\":\"spectrum\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":9513.66,\"linearGain\":5.6569}],\"effects\":[\"note filter\",\"reverb\"],\"noteFilter\":[{\"type\":\"high-pass\",\"cutoffHz\":4756.83,\"linearGain\":0.7071}],\"reverb\":33,\"fadeInSeconds\":0.0125,\"fadeOutTicks\":-3,\"spectrum\":[100,0,0,0,0,0,0,14,0,0,0,71,0,0,14,0,57,0,29,14,29,14,14,29,14,29,14,14,29,14],\"envelopes\":[{\"target\":\"noteFilterFreq\",\"envelope\":\"twang 1\",\"index\":0},{\"target\":\"noteVolume\",\"envelope\":\"punch\"}]}},\n\t\t\t{name: \"blown bottle\",     midiProgram:  76, generalMidi: true, settings: {\"type\":\"FM\",\"effects\":\"chorus & reverb\",\"transition\":\"cross fade\",\"chord\":\"harmony\",\"filterCutoffHz\":5657,\"filterResonance\":57,\"filterEnvelope\":\"steady\",\"vibrato\":\"none\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":7,\"feedbackEnvelope\":\"twang 1\",\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15,\"envelope\":\"custom\"},{\"frequency\":\"3×\",\"amplitude\":4,\"envelope\":\"custom\"},{\"frequency\":\"6×\",\"amplitude\":2,\"envelope\":\"custom\"},{\"frequency\":\"11×\",\"amplitude\":2,\"envelope\":\"custom\"}]}},\n\t\t\t{name: \"calliope\",         midiProgram:  82, generalMidi: true, settings: {\"type\":\"spectrum\",\"transition\":\"cross fade\",\"effects\":\"reverb\",\"chord\":\"harmony\",\"filterCutoffHz\":5657,\"filterResonance\":14,\"filterEnvelope\":\"steady\",\"spectrum\":[100,0,0,0,0,0,0,86,0,0,0,71,0,0,57,0,43,0,29,14,14,29,14,14,14,14,14,14,14,14]}},\n\t\t\t{name: \"chiffer\",          midiProgram:  83, generalMidi: true, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"punch\",\"spectrum\":[86,0,0,0,0,0,0,71,0,0,0,71,0,0,57,0,57,0,43,14,14,43,14,29,14,29,29,29,29,14]}},\n\t\t\t{name: \"breath noise\",     midiProgram: 121, generalMidi: true, settings: {\"type\":\"spectrum\",\"eqFilter\":[],\"effects\":[\"chord type\",\"note filter\",\"reverb\"],\"chord\":\"strum\",\"noteFilter\":[{\"type\":\"high-pass\",\"cutoffHz\":840.9,\"linearGain\":0.3536},{\"type\":\"low-pass\",\"cutoffHz\":16000,\"linearGain\":0.3536}],\"reverb\":33,\"fadeInSeconds\":0.0413,\"fadeOutTicks\":12,\"spectrum\":[71,0,0,0,0,0,0,29,0,0,0,71,0,0,29,0,100,29,14,29,100,29,100,14,14,71,0,29,0,0],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 1\"}]}},\n\t\t])},\n\t\t{name: \"Pad Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"new age pad\",      midiProgram:  88, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"chorus\"],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":3,\"operators\":[{\"frequency\":\"2×\",\"amplitude\":14},{\"frequency\":\"~1×\",\"amplitude\":4},{\"frequency\":\"6×\",\"amplitude\":3},{\"frequency\":\"13×\",\"amplitude\":3}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 2\",\"index\":1},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 3\",\"index\":2},{\"target\":\"feedbackAmplitude\",\"envelope\":\"swell 3\"}]}},\n\t\t\t{name: \"warm pad\",         midiProgram:  89, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"note filter\",\"chorus\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":3363.59,\"linearGain\":1}],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0.0575,\"fadeOutTicks\":96,\"chord\":\"simultaneous\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":7,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14},{\"frequency\":\"1×\",\"amplitude\":6},{\"frequency\":\"1×\",\"amplitude\":0},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"swell 3\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 1\",\"index\":1}]}},\n\t\t\t{name: \"polysynth pad\",    midiProgram:  90, generalMidi: true, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[\"vibrato\",\"note filter\",\"chorus\"],\"vibrato\":\"delayed\",\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2828.43,\"linearGain\":1}],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"wave\":\"sawtooth\",\"unison\":\"honky tonk\",\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 3\"}]}},\n\t\t\t{name: \"space voice pad\",  midiProgram:  91, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":6727.17,\"linearGain\":5.6569},{\"type\":\"peak\",\"cutoffHz\":2828.43,\"linearGain\":5.6569},{\"type\":\"peak\",\"cutoffHz\":1414.21,\"linearGain\":0.1768}],\"effects\":[\"chorus\"],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":72,\"chord\":\"simultaneous\",\"algorithm\":\"(1 2 3)←4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":5,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":10},{\"frequency\":\"2×\",\"amplitude\":8},{\"frequency\":\"3×\",\"amplitude\":7},{\"frequency\":\"11×\",\"amplitude\":2}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"punch\",\"index\":3},{\"target\":\"feedbackAmplitude\",\"envelope\":\"swell 2\"}]}},\n\t\t\t{name: \"bowed glass pad\",  midiProgram:  92, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4756.83,\"linearGain\":0.5}],\"transition\":\"normal\",\"fadeInSeconds\":0.0575,\"fadeOutTicks\":96,\"chord\":\"simultaneous\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":10},{\"frequency\":\"2×\",\"amplitude\":12},{\"frequency\":\"3×\",\"amplitude\":7},{\"frequency\":\"7×\",\"amplitude\":4}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 3\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 3\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"flare 3\",\"index\":3}]}},\n\t\t\t{name: \"metallic pad\",     midiProgram:  93, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":6727.17,\"linearGain\":0.5}],\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":72,\"chord\":\"simultaneous\",\"algorithm\":\"1←3 2←4\",\"feedbackType\":\"1⟲ 2⟲\",\"feedbackAmplitude\":13,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"~1×\",\"amplitude\":9},{\"frequency\":\"1×\",\"amplitude\":7},{\"frequency\":\"11×\",\"amplitude\":7}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 3\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 2\",\"index\":2},{\"target\":\"feedbackAmplitude\",\"envelope\":\"twang 3\"}]}},\n\t\t\t{name: \"sweep pad\",        midiProgram:  95, generalMidi: true, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[\"note filter\",\"chorus\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":4}],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0.0575,\"fadeOutTicks\":96,\"chord\":\"simultaneous\",\"wave\":\"sawtooth\",\"unison\":\"hum\",\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"flare 3\"}]}},\n\t\t\t{name: \"atmosphere\",       midiProgram:  99, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4756.83,\"linearGain\":1}],\"effects\":[\"chorus\",\"reverb\"],\"chorus\":100,\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"strum\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"3⟲ 4⟲\",\"feedbackAmplitude\":3,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":14},{\"frequency\":\"~1×\",\"amplitude\":10},{\"frequency\":\"3×\",\"amplitude\":7},{\"frequency\":\"1×\",\"amplitude\":7}],\"envelopes\":[{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 3\",\"index\":1},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 2\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 3\",\"index\":3}]}},\n\t\t\t{name: \"brightness\",       midiProgram: 100, generalMidi: true, settings: {\"type\":\"Picked String\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4756.83,\"linearGain\":2}],\"effects\":[\"chorus\"],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":72,\"chord\":\"simultaneous\",\"harmonics\":[100,86,86,86,43,57,43,71,43,43,43,57,43,43,57,71,57,43,29,43,57,57,43,29,29,29,29,14],\"unison\":\"octave\",\"stringSustain\":86,\"envelopes\":[]}},\n\t\t\t{name: \"goblins\",          midiProgram: 101, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"peak\",\"cutoffHz\":2828.43,\"linearGain\":11.3137}],\"effects\":[\"note filter\",\"chorus\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":1681.79,\"linearGain\":0.5}],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0.0575,\"fadeOutTicks\":96,\"chord\":\"simultaneous\",\"algorithm\":\"1←2←3←4\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":10,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"4×\",\"amplitude\":5},{\"frequency\":\"1×\",\"amplitude\":10},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"swell 2\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 3\",\"index\":1},{\"target\":\"operatorAmplitude\",\"envelope\":\"tremolo1\",\"index\":2},{\"target\":\"feedbackAmplitude\",\"envelope\":\"flare 3\"}]}},\n\t\t\t{name: \"sci-fi\",           midiProgram: 103, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"peak\",\"cutoffHz\":9513.66,\"linearGain\":2.8284}],\"effects\":[\"note filter\",\"chorus\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":6727.17,\"linearGain\":0.5}],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"algorithm\":\"(1 2)←3←4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":8,\"operators\":[{\"frequency\":\"~1×\",\"amplitude\":13},{\"frequency\":\"2×\",\"amplitude\":10},{\"frequency\":\"5×\",\"amplitude\":5},{\"frequency\":\"11×\",\"amplitude\":8}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 3\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"twang 3\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"tremolo5\",\"index\":3},{\"target\":\"feedbackAmplitude\",\"envelope\":\"twang 3\"}]}},\n\t\t\t{name: \"flutter pad\",      midiProgram:  90, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"vibrato\",\"note filter\",\"chorus\"],\"vibrato\":\"delayed\",\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4000,\"linearGain\":4}],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"algorithm\":\"(1 2)←(3 4)\",\"feedbackType\":\"1⟲ 2⟲ 3⟲\",\"feedbackAmplitude\":9,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":13},{\"frequency\":\"5×\",\"amplitude\":7},{\"frequency\":\"7×\",\"amplitude\":5},{\"frequency\":\"~1×\",\"amplitude\":6}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 3\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"tremolo1\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"punch\",\"index\":3}]}},\n\t\t\t{name: \"feedback pad\",     midiProgram:  89, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"peak\",\"cutoffHz\":2378.41,\"linearGain\":8}],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0.0575,\"fadeOutTicks\":96,\"chord\":\"custom interval\",\"algorithm\":\"1 2 3 4\",\"feedbackType\":\"1⟲ 2⟲ 3⟲ 4⟲\",\"feedbackAmplitude\":8,\"operators\":[{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":15},{\"frequency\":\"~1×\",\"amplitude\":15}],\"envelopes\":[{\"target\":\"feedbackAmplitude\",\"envelope\":\"swell 2\"}]}},\n\t\t])},\n\t\t{name: \"Drum Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"standard drumset\", midiProgram: 116, isNoise: true, settings: {\"type\":\"drumset\",\"effects\":\"reverb\",\"drums\":[{\"filterEnvelope\":\"twang 1\",\"spectrum\":[57,71,71,86,86,86,71,71,71,71,57,57,57,57,43,43,43,43,29,29,29,29,29,29,29,29,29,29,29,29]},{\"filterEnvelope\":\"twang 1\",\"spectrum\":[0,0,0,100,71,71,57,86,57,57,57,71,43,43,57,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43]},{\"filterEnvelope\":\"twang 1\",\"spectrum\":[0,0,0,0,100,57,43,43,29,57,43,29,71,43,43,43,43,57,43,43,43,43,43,43,43,43,29,43,43,43]},{\"filterEnvelope\":\"twang 1\",\"spectrum\":[0,0,0,0,0,71,57,43,43,43,57,57,43,29,57,43,43,43,29,43,57,43,43,43,43,43,43,29,43,43]},{\"filterEnvelope\":\"decay 2\",\"spectrum\":[0,14,29,43,86,71,29,43,43,43,43,29,71,29,71,29,43,43,43,43,57,43,43,57,43,43,43,57,57,57]},{\"filterEnvelope\":\"decay 1\",\"spectrum\":[0,0,14,14,14,14,29,29,29,43,43,43,57,57,57,71,71,71,71,71,71,71,71,57,57,57,57,43,43,43]},{\"filterEnvelope\":\"twang 3\",\"spectrum\":[43,43,43,71,29,29,43,43,43,29,43,43,43,29,29,43,43,29,29,29,57,14,57,43,43,57,43,43,57,57]},{\"filterEnvelope\":\"decay 3\",\"spectrum\":[29,43,43,43,43,29,29,43,29,29,43,29,14,29,43,29,43,29,57,29,43,57,43,71,43,71,57,57,71,71]},{\"filterEnvelope\":\"twang 3\",\"spectrum\":[43,29,29,43,29,29,29,57,29,29,29,57,43,43,29,29,57,43,43,43,71,43,43,71,57,71,71,71,71,71]},{\"filterEnvelope\":\"decay 3\",\"spectrum\":[57,57,57,43,57,57,43,43,57,43,43,43,71,57,43,57,86,71,57,86,71,57,86,100,71,86,86,86,86,86]},{\"filterEnvelope\":\"flare 1\",\"spectrum\":[0,0,14,14,14,14,29,29,29,43,43,43,57,57,71,71,86,86,100,100,100,100,100,100,100,100,86,57,29,0]},{\"filterEnvelope\":\"decay 2\",\"spectrum\":[14,14,14,14,29,14,14,29,14,43,14,43,57,86,57,57,100,57,43,43,57,100,57,43,29,14,0,0,0,0]}]}},\n\t\t\t{name: \"steel pan\",        midiProgram: 114, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"high-pass\",\"cutoffHz\":62.5,\"linearGain\":0.1768}],\"effects\":[\"note filter\",\"chorus\",\"reverb\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":13454.34,\"linearGain\":0.25}],\"chorus\":67,\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":24,\"chord\":\"simultaneous\",\"algorithm\":\"1←(2 3←4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"~1×\",\"amplitude\":14},{\"frequency\":\"7×\",\"amplitude\":3},{\"frequency\":\"3×\",\"amplitude\":5},{\"frequency\":\"4×\",\"amplitude\":4}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"decay 2\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"flare 1\",\"index\":1},{\"target\":\"operatorAmplitude\",\"envelope\":\"flare 2\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"swell 2\",\"index\":3}]}},\n\t\t\t{name: \"steel pan synth\",  midiProgram: 114, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":13454.34,\"linearGain\":0.25}],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"algorithm\":\"1 2 3←4\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":5,\"operators\":[{\"frequency\":\"~1×\",\"amplitude\":12},{\"frequency\":\"2×\",\"amplitude\":15},{\"frequency\":\"4×\",\"amplitude\":14},{\"frequency\":\"~1×\",\"amplitude\":3}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 1\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"note size\",\"index\":0},{\"target\":\"operatorAmplitude\",\"envelope\":\"note size\",\"index\":1},{\"target\":\"operatorAmplitude\",\"envelope\":\"flare 1\",\"index\":2},{\"target\":\"operatorAmplitude\",\"envelope\":\"flare 2\",\"index\":3},{\"target\":\"feedbackAmplitude\",\"envelope\":\"flare 1\"}]}},\n\t\t\t{name: \"timpani\",          midiProgram:  47, generalMidi: true, settings: {\"type\":\"spectrum\",\"eqFilter\":[{\"type\":\"peak\",\"cutoffHz\":6727.17,\"linearGain\":5.6569}],\"effects\":[\"pitch shift\",\"note filter\",\"reverb\"],\"pitchShiftSemitones\":15,\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":19027.31,\"linearGain\":0.5}],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"spectrum\":[100,0,0,0,86,0,0,71,0,14,43,14,43,43,0,29,43,29,29,29,43,29,43,29,43,43,43,43,43,43],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 1\"},{\"target\":\"pitchShift\",\"envelope\":\"twang 1\"}]}},\n\t\t\t{name: \"dark strike\",      midiProgram:  47, settings: {\"type\":\"spectrum\",\"eqFilter\":[],\"effects\":[\"note filter\",\"reverb\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":4756.83,\"linearGain\":0.7071}],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"spectrum\":[0,0,14,14,14,29,29,43,43,86,43,43,43,29,86,29,29,29,86,29,14,14,14,14,0,0,0,0,0,0],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 2\"}]}},\n\t\t\t{name: \"woodblock\",        midiProgram: 115, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -2.5, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"spectrum\":[0,14,29,43,43,57,86,86,71,57,57,43,43,57,86,86,43,43,71,57,57,57,57,57,86,86,71,71,71,71]}},\n\t\t\t{name: \"taiko drum\",       midiProgram: 116, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -0.5, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":29,\"filterEnvelope\":\"twang 1\",\"spectrum\":[71,100,100,43,43,71,71,43,43,43,43,43,43,57,29,57,43,57,43,43,57,43,43,43,43,43,43,43,43,43]}},\n\t\t\t{name: \"melodic drum\",     midiProgram: 117, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -1.5, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2828,\"filterResonance\":43,\"filterEnvelope\":\"twang 1\",\"spectrum\":[100,71,71,57,57,43,43,71,43,43,43,57,43,43,57,43,43,43,43,29,29,29,29,29,29,29,29,29,29,29]}},\n\t\t\t{name: \"drum synth\",       midiProgram: 118, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -2, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":43,\"filterEnvelope\":\"decay 1\",\"spectrum\":[100,86,71,57,43,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29]}},\n\t\t\t{name: \"tom-tom\",          midiProgram: 116, isNoise: true, midiSubharmonicOctaves: -1, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"twang 1\",\"spectrum\":[100,29,14,0,0,86,14,43,29,86,29,14,29,57,43,43,43,43,57,43,43,43,29,57,43,43,43,43,43,43]}},\n\t\t\t{name: \"metal pipe\",       midiProgram: 117, isNoise: true, midiSubharmonicOctaves: -1.5, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":8000,\"filterResonance\":14,\"filterEnvelope\":\"twang 2\",\"spectrum\":[29,43,86,43,43,43,43,43,100,29,14,14,100,14,14,0,0,0,0,0,14,29,29,14,0,0,14,29,0,0]}},\n\t\t\t{name: \"synth kick\",       midiProgram:  47, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":-6,\"chord\":\"simultaneous\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"8×\",\"amplitude\":15},{\"frequency\":\"1×\",\"amplitude\":0},{\"frequency\":\"1×\",\"amplitude\":0},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"operatorFrequency\",\"envelope\":\"twang 1\",\"index\":0},{\"target\":\"noteVolume\",\"envelope\":\"twang 2\"}]}},\n\t\t])},\n\t\t{name: \"Novelty Presets\", presets: <DictionaryArray<Preset>> toNameMap([\n\t\t\t{name: \"guitar fret noise\",midiProgram: 120, generalMidi: true, settings: {\"type\":\"spectrum\",\"eqFilter\":[{\"type\":\"high-pass\",\"cutoffHz\":1000,\"linearGain\":0.1768}],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":6727.17,\"linearGain\":5.6569}],\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"spectrum\":[0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,29,14,0,0,43,0,43,0,71,43,0,57,0],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"flare 1\"},{\"target\":\"noteVolume\",\"envelope\":\"twang 2\"}]}},\n\t\t\t{name: \"fifth saw lead\",   midiProgram:  86, generalMidi: true, midiSubharmonicOctaves: 1, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[\"note filter\",\"chorus\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2828.43,\"linearGain\":1.4142}],\"chorus\":67,\"transition\":\"normal\",\"fadeInSeconds\":0,\"fadeOutTicks\":48,\"chord\":\"simultaneous\",\"wave\":\"sawtooth\",\"unison\":\"fifth\",\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 3\"}]}},\n\t\t\t{name: \"fifth swell\",      midiProgram:  86, midiSubharmonicOctaves: 1, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[\"note filter\",\"chorus\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2000,\"linearGain\":2}],\"chorus\":100,\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":72,\"chord\":\"simultaneous\",\"wave\":\"sawtooth\",\"unison\":\"fifth\",\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"swell 3\"}]}},\n\t\t\t{name: \"soundtrack\",       midiProgram:  97, generalMidi: true, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[\"note filter\",\"chorus\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2378.41,\"linearGain\":0.5}],\"chorus\":67,\"transition\":\"normal\",\"fadeInSeconds\":0.0413,\"fadeOutTicks\":72,\"chord\":\"simultaneous\",\"wave\":\"sawtooth\",\"unison\":\"fifth\",\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"flare 3\"}]}},\n\t\t\t{name: \"reverse cymbal\",   midiProgram: 119, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -3, settings: {\"type\":\"spectrum\",\"effects\":\"none\",\"transition\":\"soft\",\"chord\":\"harmony\",\"filterCutoffHz\":4000,\"filterResonance\":14,\"filterEnvelope\":\"swell 3\",\"spectrum\":[29,57,57,29,57,57,29,29,43,29,29,43,29,29,57,57,14,57,14,57,71,71,57,86,57,100,86,86,86,86]}},\n\t\t\t{name: \"seashore\",         midiProgram: 122, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -3, settings: {\"type\":\"spectrum\",\"transition\":\"soft fade\",\"effects\":\"reverb\",\"chord\":\"harmony\",\"filterCutoffHz\":2828,\"filterResonance\":0,\"filterEnvelope\":\"swell 3\",\"spectrum\":[14,14,29,29,43,43,43,57,57,57,57,57,57,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,57]}},\n\t\t\t{name: \"bird tweet\",       midiProgram: 123, generalMidi: true, settings: {\"type\":\"harmonics\",\"eqFilter\":[],\"effects\":[\"chord type\",\"vibrato\",\"reverb\"],\"chord\":\"strum\",\"vibrato\":\"heavy\",\"reverb\":67,\"fadeInSeconds\":0.0575,\"fadeOutTicks\":-6,\"harmonics\":[0,0,0,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"unison\":\"hum\",\"envelopes\":[{\"target\":\"noteVolume\",\"envelope\":\"decay 1\"}]}},\n\t\t\t{name: \"telephone ring\",   midiProgram: 124, generalMidi: true, settings: {\"type\":\"FM\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":5656.85,\"linearGain\":1}],\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":-3,\"chord\":\"arpeggio\",\"algorithm\":\"1←(2 3 4)\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":0,\"operators\":[{\"frequency\":\"2×\",\"amplitude\":12},{\"frequency\":\"1×\",\"amplitude\":4},{\"frequency\":\"20×\",\"amplitude\":1},{\"frequency\":\"1×\",\"amplitude\":0}],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"tremolo4\"},{\"target\":\"operatorAmplitude\",\"envelope\":\"tremolo1\",\"index\":1}]}},\n\t\t\t{name: \"helicopter\",       midiProgram: 125, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -0.5, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"seamless\",\"chord\":\"arpeggio\",\"filterCutoffHz\":1414,\"filterResonance\":14,\"filterEnvelope\":\"tremolo4\",\"spectrum\":[14,43,43,57,57,57,71,71,71,71,86,86,86,86,86,86,86,86,86,86,86,71,71,71,71,71,71,71,57,57]}},\n\t\t\t{name: \"applause\",         midiProgram: 126, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -3, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"soft fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"swell 3\",\"spectrum\":[14,14,29,29,29,43,43,57,71,71,86,86,86,71,71,57,57,57,71,86,86,86,86,86,71,71,57,57,57,57]}},\n\t\t\t{name: \"gunshot\",          midiProgram: 127, generalMidi: true, isNoise: true, midiSubharmonicOctaves: -2, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"strum\",\"filterCutoffHz\":1414,\"filterResonance\":29,\"filterEnvelope\":\"twang 1\",\"spectrum\":[14,29,43,43,57,57,57,71,71,71,86,86,86,86,86,86,86,86,86,86,86,71,71,71,71,57,57,57,57,43]}},\n\t\t\t{name: \"scoot\",            midiProgram:  92, settings: {\"type\":\"chip\",\"eqFilter\":[],\"effects\":[\"note filter\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":707.11,\"linearGain\":4}],\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":-3,\"chord\":\"simultaneous\",\"wave\":\"double saw\",\"unison\":\"shimmer\",\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"flare 1\"}]}},\n\t\t\t{name: \"buzz saw\",         midiProgram:  30, settings: {\"type\":\"FM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":9513.66,\"linearGain\":0.5}],\"effects\":[],\"transition\":\"normal\",\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-3,\"chord\":\"custom interval\",\"algorithm\":\"1←2←3←4\",\"feedbackType\":\"1⟲\",\"feedbackAmplitude\":4,\"operators\":[{\"frequency\":\"5×\",\"amplitude\":13},{\"frequency\":\"1×\",\"amplitude\":10},{\"frequency\":\"~1×\",\"amplitude\":6},{\"frequency\":\"11×\",\"amplitude\":12}],\"envelopes\":[]}},\n\t\t\t{name: \"mosquito\",         midiProgram:  93, settings: {\"type\":\"PWM\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":2828.43,\"linearGain\":2}],\"effects\":[\"vibrato\"],\"vibrato\":\"shaky\",\"transition\":\"normal\",\"fadeInSeconds\":0.0575,\"fadeOutTicks\":-6,\"chord\":\"simultaneous\",\"pulseWidth\":4.41942,\"envelopes\":[{\"target\":\"pulseWidth\",\"envelope\":\"tremolo6\"}]}},\n\t\t\t{name: \"breathing\",        midiProgram: 126, isNoise: true, midiSubharmonicOctaves: -1, settings: {\"type\":\"spectrum\",\"effects\":\"reverb\",\"transition\":\"hard fade\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":14,\"filterEnvelope\":\"swell 2\",\"spectrum\":[14,14,14,29,29,29,29,29,43,29,29,43,43,43,29,29,71,43,86,86,57,100,86,86,86,86,71,86,71,57]}},\n\t\t\t{name: \"klaxon synth\",     midiProgram: 125, isNoise: true, midiSubharmonicOctaves: -1, settings: {\"type\":\"noise\",\"effects\":\"reverb\",\"transition\":\"slide\",\"chord\":\"harmony\",\"filterCutoffHz\":2000,\"filterResonance\":86,\"filterEnvelope\":\"steady\",\"wave\":\"buzz\"}},\n\t\t\t{name: \"theremin\",         midiProgram:  40, settings: {\"type\":\"harmonics\",\"eqFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":8000,\"linearGain\":0.7071}],\"effects\":[\"vibrato\",\"reverb\"],\"vibrato\":\"heavy\",\"reverb\":33,\"transition\":\"slide in pattern\",\"fadeInSeconds\":0.0263,\"fadeOutTicks\":-6,\"chord\":\"simultaneous\",\"harmonics\":[100,71,57,43,29,29,14,14,14,14,14,14,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"unison\":\"none\",\"envelopes\":[]}},\n\t\t\t{name: \"sonar ping\",       midiProgram: 121, settings: {\"type\":\"spectrum\",\"eqFilter\":[],\"effects\":[\"note filter\",\"reverb\"],\"noteFilter\":[{\"type\":\"low-pass\",\"cutoffHz\":1681.79,\"linearGain\":0.5}],\"reverb\":33,\"transition\":\"normal\",\"fadeInSeconds\":0.0125,\"fadeOutTicks\":72,\"chord\":\"simultaneous\",\"spectrum\":[100,43,29,29,14,14,14,14,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"envelopes\":[{\"target\":\"noteFilterAllFreqs\",\"envelope\":\"twang 2\"}]}},\n\t\t])},\n\t]);\n\t\n\tpublic static valueToPreset(presetValue: number): Preset | null {\n\t\tconst categoryIndex: number = presetValue >> 6;\n\t\tconst presetIndex: number = presetValue & 0x3F;\n\t\treturn EditorConfig.presetCategories[categoryIndex].presets[presetIndex];\n\t}\n\t\n\tpublic static midiProgramToPresetValue(program: number): number | null {\n\t\tfor (let categoryIndex: number = 0; categoryIndex < EditorConfig.presetCategories.length; categoryIndex++) {\n\t\t\tconst category: PresetCategory = EditorConfig.presetCategories[categoryIndex];\n\t\t\tfor (let presetIndex: number = 0; presetIndex < category.presets.length; presetIndex++) {\n\t\t\t\tconst preset: Preset = category.presets[presetIndex];\n\t\t\t\tif (preset.generalMidi && preset.midiProgram == program) return (categoryIndex << 6) + presetIndex;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\t\n\tpublic static nameToPresetValue(presetName: string): number | null {\n\t\tfor (let categoryIndex: number = 0; categoryIndex < EditorConfig.presetCategories.length; categoryIndex++) {\n\t\t\tconst category: PresetCategory = EditorConfig.presetCategories[categoryIndex];\n\t\t\tfor (let presetIndex: number = 0; presetIndex < category.presets.length; presetIndex++) {\n\t\t\t\tconst preset: Preset = category.presets[presetIndex];\n\t\t\t\tif (preset.name == presetName) return (categoryIndex << 6) + presetIndex;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n","// Copyright (C) 2020 John Nesky, distributed under the MIT license.\n\nexport function applyElementArgs<T extends HTMLElement | SVGElement | DocumentFragment>(element: T, args: Array<any>): T {\n\tfor (const arg of args) {\n\t\tif (arg instanceof Node) {\n\t\t\telement.appendChild(arg);\n\t\t} else if (typeof arg === \"string\") {\n\t\t\telement.appendChild(document.createTextNode(arg));\n\t\t} else if (typeof arg === \"function\") {\n\t\t\tapplyElementArgs(element, [arg()]);\n\t\t} else if (Array.isArray(arg)) {\n\t\t\tapplyElementArgs(element, arg);\n\t\t} else if (arg && typeof Symbol !== \"undefined\" && typeof arg[Symbol.iterator] === \"function\") {\n\t\t\tapplyElementArgs(element, [...arg]);\n\t\t} else if (arg && arg.constructor === Object && element instanceof Element) {\n\t\t\t// If the argument is a literal {} Object\n\t\t\tfor (const key of Object.keys(arg)) {\n\t\t\t\tconst value = arg[key];\n\t\t\t\t/*if (key === \"classList\") {\n\t\t\t\t\tif (typeof value === \"string\") {\n\t\t\t\t\t\telement.classList.add(...value.split(\" \"));\n\t\t\t\t\t} else if (Array.isArray(arg) || (value && typeof Symbol !== \"undefined\" && typeof value[Symbol.iterator] === \"function\")) {\n\t\t\t\t\t\telement.classList.add(...value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"Invalid classList value \\\"\" + value + \"\\\" on \" + element.tagName + \" element.\");\n\t\t\t\t\t}\n\t\t\t\t} else*/ if (key === \"class\" /* || key === \"className\" */) {\n\t\t\t\t\tif (typeof value === \"string\") {\n\t\t\t\t\t\telement.setAttribute(\"class\", value);\n\t\t\t\t\t} else if (Array.isArray(arg) || (value && typeof Symbol !== \"undefined\" && typeof value[Symbol.iterator] === \"function\")) {\n\t\t\t\t\t\telement.setAttribute(\"class\", [...value].join(\" \"));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"Invalid \" + key + \" value \\\"\" + value + \"\\\" on \" + element.tagName + \" element.\");\n\t\t\t\t\t}\n\t\t\t\t} else if (key === \"style\") {\n\t\t\t\t\tif (value && value.constructor === Object) {\n\t\t\t\t\t\tfor (const styleKey of Object.keys(value)) {\n\t\t\t\t\t\t\tif (styleKey in (<HTMLElement | SVGElement>element).style) {\n\t\t\t\t\t\t\t\t// In practice, camelCase and kebab-case properties both work as properties on CSSStyleDeclaration objects.\n\t\t\t\t\t\t\t\t(<any> element).style[styleKey] = value[styleKey];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// CSS variables start with -- and must be set with setProperty.\n\t\t\t\t\t\t\t\t(<HTMLElement | SVGElement>element).style.setProperty(styleKey, value[styleKey]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.setAttribute(key, value);\n\t\t\t\t\t}\n\t\t\t\t} else if (typeof(value) === \"function\") {\n\t\t\t\t\t// If value is a callback, set as a property instead trying to coerce to string.\n\t\t\t\t\t(<any>element)[key] = value;\n\t\t\t\t} else if (typeof(value) === \"boolean\") {\n\t\t\t\t\t// If value is boolean, set attribute if true, remove if false.\n\t\t\t\t\tif (value) element.setAttribute(key, \"\");\n\t\t\t\t\telse element.removeAttribute(key);\n\t\t\t\t} else {\n\t\t\t\t\t// Default to setting attribute, as if writing html directly.\n\t\t\t\t\telement.setAttribute(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Just convert unrecognized objects to text and append them.\n\t\t\telement.appendChild(document.createTextNode(arg));\n\t\t}\n\t}\n\treturn element;\n}\n\nexport const svgNS: string = \"http://www.w3.org/2000/svg\";\n\nexport function parseHTML(...args: Array<any>): DocumentFragment {\n\treturn document.createRange().createContextualFragment(args.join());\n}\n\n//let svgParser: SVGSVGElement | null = null;\nexport function parseSVG(...args: Array<any>): DocumentFragment {\n\tconst fragment: DocumentFragment = document.createDocumentFragment();\n\t\n\t// Internet Explorer doesn't support the first method here, so I commented it out and used a slightly more complex one involving DOMParser below.\n\t/*\n\tif (svgParser === null) svgParser = <SVGSVGElement>document.createElementNS(svgNS, \"svg\");\n\tsvgParser.innerHTML = args.join();\n\twhile (svgParser.firstChild !== null) fragment.appendChild(svgParser.firstChild);\n\t*/\n\tconst svgParser: Element = new DOMParser().parseFromString(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\">\" + args.join() + \"</svg>\", \"image/svg+xml\").documentElement;\n\twhile (svgParser.firstChild !== null) {\n\t\tdocument.importNode(svgParser.firstChild, true);\n\t\tfragment.appendChild(svgParser.firstChild);\n\t}\n\t\n\treturn fragment;\n}\n\nexport function replaceScriptWith(...args: Array<any>): void {\n\tlet currentScript: HTMLScriptElement | SVGScriptElement | null = document.currentScript;\n\tif (currentScript == null) { // double-equals to intentionally include undefined in Internet Explorer.\n\t\t\n\t\t// Internet Explorer doens't support currentScript, try this method instead:\n\t\tif (document.readyState === \"loading\") {\n\t\t\tconst scripts: HTMLCollectionOf<HTMLScriptElement> = document.getElementsByTagName(\"script\");\n\t\t\tcurrentScript = scripts[scripts.length - 1];\n\t\t}\n\t\t\n\t\tif (currentScript == null) {\n\t\t\tconsole.warn(\"Couldn't replace script because no script is currently being parsed and executed, maybe this is happening in a callback function or event handler instead?\");\n\t\t\treturn;\n\t\t}\n\t}\n\tif (currentScript.parentNode === null) {\n\t\tconsole.warn(\"Couldn't replace script element because it is not attached to a parent anymore, did you try to replace the same script more than once?\");\n\t\treturn;\n\t}\n\tcurrentScript.parentNode.replaceChild(applyElementArgs(document.createDocumentFragment(), args), currentScript);\n}\n\nexport function applyToElement<T extends HTMLElement | SVGElement | DocumentFragment>(element: T, ...args: Array<any>): T {\n\tif (!(element instanceof Element || element instanceof DocumentFragment)) {\n\t\tconsole.warn(\"Couldn't apply to provided argument because it's not an element or DocumentFragment.\");\n\t\treturn element;\n\t}\n\treturn applyElementArgs(element, args);\n}\n","// Copyright (C) 2020 John Nesky, distributed under the MIT license.\n\nimport {applyElementArgs, svgNS, parseHTML, parseSVG, replaceScriptWith, applyToElement} from \"./elements-base\";\nexport {replaceScriptWith, applyToElement};\n\ninterface HTMLElementFactory {\n\t(...args: Array<string>): DocumentFragment;\n\t//readonly [key: string]: (...args: Array<any>) => HTMLElement;\n\ta(...args: Array<any>): HTMLAnchorElement;\n\tabbr(...args: Array<any>): HTMLElement;\n\taddress(...args: Array<any>): HTMLElement;\n\tarea(...args: Array<any>): HTMLAreaElement;\n\tarticle(...args: Array<any>): HTMLElement;\n\taside(...args: Array<any>): HTMLElement;\n\taudio(...args: Array<any>): HTMLAudioElement;\n\tb(...args: Array<any>): HTMLElement;\n\tbase(...args: Array<any>): HTMLBaseElement;\n\tbdi(...args: Array<any>): HTMLElement;\n\tbdo(...args: Array<any>): HTMLElement;\n\tblockquote(...args: Array<any>): HTMLQuoteElement;\n\tbr(...args: Array<any>): HTMLBRElement;\n\tbutton(...args: Array<any>): HTMLButtonElement;\n\tcanvas(...args: Array<any>): HTMLCanvasElement;\n\tcaption(...args: Array<any>): HTMLTableCaptionElement;\n\tcite(...args: Array<any>): HTMLElement;\n\tcode(...args: Array<any>): HTMLElement;\n\tcol(...args: Array<any>): HTMLTableColElement;\n\tcolgroup(...args: Array<any>): HTMLTableColElement;\n\tdatalist(...args: Array<any>): HTMLDataListElement;\n\tdd(...args: Array<any>): HTMLElement;\n\tdel(...args: Array<any>): HTMLModElement;\n\tdetails(...args: Array<any>): HTMLDetailsElement;\n\tdfn(...args: Array<any>): HTMLElement;\n\tdialog(...args: Array<any>): HTMLDialogElement;\n\tdiv(...args: Array<any>): HTMLDivElement;\n\tdl(...args: Array<any>): HTMLDListElement;\n\tdt(...args: Array<any>): HTMLElement;\n\tem(...args: Array<any>): HTMLElement;\n\tembed(...args: Array<any>): HTMLEmbedElement;\n\tfieldset(...args: Array<any>): HTMLFieldSetElement;\n\tfigcaption(...args: Array<any>): HTMLElement;\n\tfigure(...args: Array<any>): HTMLElement;\n\tfooter(...args: Array<any>): HTMLElement;\n\tform(...args: Array<any>): HTMLFormElement;\n\th1(...args: Array<any>): HTMLHeadingElement;\n\th2(...args: Array<any>): HTMLHeadingElement;\n\th3(...args: Array<any>): HTMLHeadingElement;\n\th4(...args: Array<any>): HTMLHeadingElement;\n\th5(...args: Array<any>): HTMLHeadingElement;\n\th6(...args: Array<any>): HTMLHeadingElement;\n\theader(...args: Array<any>): HTMLElement;\n\thr(...args: Array<any>): HTMLHRElement;\n\ti(...args: Array<any>): HTMLElement;\n\tiframe(...args: Array<any>): HTMLIFrameElement;\n\timg(...args: Array<any>): HTMLImageElement;\n\tinput(...args: Array<any>): HTMLInputElement;\n\tins(...args: Array<any>): HTMLModElement;\n\tkbd(...args: Array<any>): HTMLElement;\n\tlabel(...args: Array<any>): HTMLLabelElement;\n\tlegend(...args: Array<any>): HTMLLegendElement;\n\tli(...args: Array<any>): HTMLLIElement;\n\tlink(...args: Array<any>): HTMLLinkElement;\n\tmain(...args: Array<any>): HTMLElement;\n\tmap(...args: Array<any>): HTMLMapElement;\n\tmark(...args: Array<any>): HTMLElement;\n\tmenu(...args: Array<any>): HTMLMenuElement;\n\tmenuitem(...args: Array<any>): HTMLUnknownElement;\n\tmeta(...args: Array<any>): HTMLMetaElement;\n\tmeter(...args: Array<any>): HTMLMeterElement;\n\tnav(...args: Array<any>): HTMLElement;\n\tnoscript(...args: Array<any>): HTMLElement;\n\tobject(...args: Array<any>): HTMLObjectElement;\n\tol(...args: Array<any>): HTMLOListElement;\n\toptgroup(...args: Array<any>): HTMLOptGroupElement;\n\toption(...args: Array<any>): HTMLOptionElement;\n\toutput(...args: Array<any>): HTMLOutputElement;\n\tp(...args: Array<any>): HTMLParagraphElement;\n\tparam(...args: Array<any>): HTMLParamElement;\n\tpicture(...args: Array<any>): HTMLPictureElement;\n\tpre(...args: Array<any>): HTMLPreElement;\n\tprogress(...args: Array<any>): HTMLProgressElement;\n\tq(...args: Array<any>): HTMLQuoteElement;\n\trp(...args: Array<any>): HTMLElement;\n\trt(...args: Array<any>): HTMLElement;\n\truby(...args: Array<any>): HTMLElement;\n\ts(...args: Array<any>): HTMLElement;\n\tsamp(...args: Array<any>): HTMLElement;\n\tscript(...args: Array<any>): HTMLScriptElement;\n\tsection(...args: Array<any>): HTMLElement;\n\tselect(...args: Array<any>): HTMLSelectElement;\n\tsmall(...args: Array<any>): HTMLElement;\n\tsource(...args: Array<any>): HTMLSourceElement;\n\tspan(...args: Array<any>): HTMLSpanElement;\n\tstrong(...args: Array<any>): HTMLElement;\n\tstyle(...args: Array<any>): HTMLStyleElement;\n\tsub(...args: Array<any>): HTMLElement;\n\tsummary(...args: Array<any>): HTMLElement;\n\tsup(...args: Array<any>): HTMLElement;\n\ttable(...args: Array<any>): HTMLTableElement;\n\ttbody(...args: Array<any>): HTMLTableSectionElement;\n\ttd(...args: Array<any>): HTMLTableCellElement;\n\ttemplate(...args: Array<any>): HTMLTemplateElement;\n\ttextarea(...args: Array<any>): HTMLTextAreaElement;\n\ttfoot(...args: Array<any>): HTMLTableSectionElement;\n\tth(...args: Array<any>): HTMLTableCellElement;\n\tthead(...args: Array<any>): HTMLTableSectionElement;\n\ttime(...args: Array<any>): HTMLTimeElement;\n\ttitle(...args: Array<any>): HTMLTitleElement;\n\ttr(...args: Array<any>): HTMLTableRowElement;\n\ttrack(...args: Array<any>): HTMLTrackElement;\n\tu(...args: Array<any>): HTMLElement;\n\tul(...args: Array<any>): HTMLUListElement;\n\tvar(...args: Array<any>): HTMLElement;\n\tvideo(...args: Array<any>): HTMLVideoElement;\n\twbr(...args: Array<any>): HTMLElement;\n}\n\ninterface SVGElementFactory {\n\t(...args: Array<string>): DocumentFragment;\n\t//readonly [key: string]: (...args: Array<any>) => SVGElement;\n\ta(...args: Array<any>): SVGAElement;\n\taltGlyph(...args: Array<any>): SVGElement;\n\taltGlyphDef(...args: Array<any>): SVGElement;\n\taltGlyphItem(...args: Array<any>): SVGElement;\n\tanimate(...args: Array<any>): SVGAnimateElement;\n\tanimateMotion(...args: Array<any>): SVGAnimateMotionElement;\n\tanimateTransform(...args: Array<any>): SVGAnimateTransformElement;\n\tcircle(...args: Array<any>): SVGCircleElement;\n\tclipPath(...args: Array<any>): SVGClipPathElement;\n\t\"color-profile\"(...args: Array<any>): SVGElement;\n\tcolor_profile(...args: Array<any>): SVGElement;\n\tcursor(...args: Array<any>): SVGElement;\n\tdefs(...args: Array<any>): SVGDefsElement;\n\tdesc(...args: Array<any>): SVGDescElement;\n\tdiscard(...args: Array<any>): SVGElement;\n\tellipse(...args: Array<any>): SVGEllipseElement;\n\tfeBlend(...args: Array<any>): SVGFEBlendElement;\n\tfeColorMatrix(...args: Array<any>): SVGFEColorMatrixElement;\n\tfeComponentTransfer(...args: Array<any>): SVGFEComponentTransferElement;\n\tfeComposite(...args: Array<any>): SVGFECompositeElement;\n\tfeConvolveMatrix(...args: Array<any>): SVGFEConvolveMatrixElement;\n\tfeDiffuseLighting(...args: Array<any>): SVGFEDiffuseLightingElement;\n\tfeDisplacementMap(...args: Array<any>): SVGFEDisplacementMapElement;\n\tfeDistantLight(...args: Array<any>): SVGFEDistantLightElement;\n\tfeDropShadow(...args: Array<any>): SVGElement;\n\tfeFlood(...args: Array<any>): SVGFEFloodElement;\n\tfeFuncA(...args: Array<any>): SVGFEFuncAElement;\n\tfeFuncB(...args: Array<any>): SVGFEFuncBElement;\n\tfeFuncG(...args: Array<any>): SVGFEFuncGElement;\n\tfeFuncR(...args: Array<any>): SVGFEFuncRElement;\n\tfeGaussianBlur(...args: Array<any>): SVGFEGaussianBlurElement;\n\tfeImage(...args: Array<any>): SVGFEImageElement;\n\tfeMerge(...args: Array<any>): SVGFEMergeElement;\n\tfeMergeNode(...args: Array<any>): SVGFEMergeNodeElement;\n\tfeMorphology(...args: Array<any>): SVGFEMorphologyElement;\n\tfeOffset(...args: Array<any>): SVGFEOffsetElement;\n\tfePointLight(...args: Array<any>): SVGFEPointLightElement;\n\tfeSpecularLighting(...args: Array<any>): SVGFESpecularLightingElement;\n\tfeSpotLight(...args: Array<any>): SVGFESpotLightElement;\n\tfeTile(...args: Array<any>): SVGFETileElement;\n\tfeTurbulence(...args: Array<any>): SVGFETurbulenceElement;\n\tfilter(...args: Array<any>): SVGFilterElement;\n\tfont(...args: Array<any>): SVGElement;\n\t\"font-face\"(...args: Array<any>): SVGElement;\n\tfont_face(...args: Array<any>): SVGElement;\n\t\"font-face-format\"(...args: Array<any>): SVGElement;\n\tfont_face_format(...args: Array<any>): SVGElement;\n\t\"font-face-name\"(...args: Array<any>): SVGElement;\n\tfont_face_name(...args: Array<any>): SVGElement;\n\t\"font-face-src\"(...args: Array<any>): SVGElement;\n\tfont_face_src(...args: Array<any>): SVGElement;\n\t\"font-face-uri\"(...args: Array<any>): SVGElement;\n\tfont_face_uri(...args: Array<any>): SVGElement;\n\tforeignObject(...args: Array<any>): SVGForeignObjectElement;\n\tg(...args: Array<any>): SVGGElement;\n\tglyph(...args: Array<any>): SVGElement;\n\tglyphRef(...args: Array<any>): SVGElement;\n\thkern(...args: Array<any>): SVGElement;\n\timage(...args: Array<any>): SVGImageElement;\n\tline(...args: Array<any>): SVGLineElement;\n\tlinearGradient(...args: Array<any>): SVGLinearGradientElement;\n\tmarker(...args: Array<any>): SVGMarkerElement;\n\tmask(...args: Array<any>): SVGMaskElement;\n\tmetadata(...args: Array<any>): SVGMetadataElement;\n\t\"missing-glyph\"(...args: Array<any>): SVGElement;\n\tmissing_glyph(...args: Array<any>): SVGElement;\n\tmpath(...args: Array<any>): SVGElement;\n\tpath(...args: Array<any>): SVGPathElement;\n\tpattern(...args: Array<any>): SVGPatternElement;\n\tpolygon(...args: Array<any>): SVGPolygonElement;\n\tpolyline(...args: Array<any>): SVGPolylineElement;\n\tradialGradient(...args: Array<any>): SVGRadialGradientElement;\n\trect(...args: Array<any>): SVGRectElement;\n\tscript(...args: Array<any>): SVGScriptElement;\n\tset(...args: Array<any>): SVGElement;\n\tstop(...args: Array<any>): SVGStopElement;\n\tstyle(...args: Array<any>): SVGStyleElement;\n\tsvg(...args: Array<any>): SVGSVGElement;\n\tswitch(...args: Array<any>): SVGSwitchElement;\n\tsymbol(...args: Array<any>): SVGSymbolElement;\n\ttext(...args: Array<any>): SVGTextElement;\n\ttextPath(...args: Array<any>): SVGTextPathElement;\n\ttitle(...args: Array<any>): SVGTitleElement;\n\ttref(...args: Array<any>): SVGElement;\n\ttspan(...args: Array<any>): SVGTSpanElement;\n\tuse(...args: Array<any>): SVGUseElement;\n\tview(...args: Array<any>): SVGViewElement;\n\tvkern(...args: Array<any>): SVGElement;\n}\n\nexport const HTML: HTMLElementFactory = <HTMLElementFactory> <unknown> parseHTML;\nexport const SVG: SVGElementFactory = <SVGElementFactory> <unknown> parseSVG;\n\nfor (const name of \"a abbr address area article aside audio b base bdi bdo blockquote br button canvas caption cite code col colgroup datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hr i iframe img input ins kbd label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td template textarea tfoot th thead time title tr track u ul var video wbr\".split(\" \")) {\n\t(<any>HTML)[name] = (...args: Array<any>) => applyElementArgs(document.createElement(name), args);\n}\nfor (const name of \"a altGlyph altGlyphDef altGlyphItem animate animateMotion animateTransform circle clipPath color-profile cursor defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font font-face font-face-format font-face-name font-face-src font-face-uri foreignObject g glyph glyphRef hkern image line linearGradient marker mask metadata missing-glyph mpath path pattern polygon polyline radialGradient rect script set stop style svg switch symbol text textPath title tref tspan use view vkern\".split(\" \")) {\n\t(<any>SVG)[name] = (...args: Array<any>) => applyElementArgs(<SVGElement> document.createElementNS(svgNS, name), args);\n\tif (/-/.test(name)) {\n\t\tconst snakeCaseName = name.replace(/-/g, \"_\");\n\t\t(<any>SVG)[snakeCaseName] = (...args: Array<any>) => applyElementArgs(<SVGElement> document.createElementNS(svgNS, name), args);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {BeepBoxOption, DictionaryArray, toNameMap} from \"../synth/SynthConfig\";\nimport {Song} from \"../synth/synth\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\n\nexport interface ChannelColors extends BeepBoxOption {\n\treadonly secondaryChannel: string;\n\treadonly primaryChannel:   string;\n\treadonly secondaryNote: string;\n\treadonly primaryNote: string;\n}\n\nexport class ColorConfig {\n\tpublic static readonly themes: {[name: string]: string} = {\n\t\t\"dark classic\": `\n\t\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #74f;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #444;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #864;\n\t\t\t\t--fifth-note: #468;\n\t\t\t\t--white-piano-key: #bbb;\n\t\t\t\t--black-piano-key: #444;\n\t\t\t\t--pitch1-secondary-channel: #0099A1;\n\t\t\t\t--pitch1-primary-channel:   #25F3FF;\n\t\t\t\t--pitch1-secondary-note:    #00BDC7;\n\t\t\t\t--pitch1-primary-note:      #92F9FF;\n\t\t\t\t--pitch2-secondary-channel: #A1A100;\n\t\t\t\t--pitch2-primary-channel:   #FFFF25;\n\t\t\t\t--pitch2-secondary-note:    #C7C700;\n\t\t\t\t--pitch2-primary-note:      #FFFF92;\n\t\t\t\t--pitch3-secondary-channel: #C75000;\n\t\t\t\t--pitch3-primary-channel:   #FF9752;\n\t\t\t\t--pitch3-secondary-note:    #FF771C;\n\t\t\t\t--pitch3-primary-note:      #FFCDAB;\n\t\t\t\t--pitch4-secondary-channel: #00A100;\n\t\t\t\t--pitch4-primary-channel:   #50FF50;\n\t\t\t\t--pitch4-secondary-note:    #00C700;\n\t\t\t\t--pitch4-primary-note:      #A0FFA0;\n\t\t\t\t--pitch5-secondary-channel: #D020D0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #E040E0;\n\t\t\t\t--pitch5-primary-note:      #FFC0FF;\n\t\t\t\t--pitch6-secondary-channel: #7777B0;\n\t\t\t\t--pitch6-primary-channel:   #A0A0FF;\n\t\t\t\t--pitch6-secondary-note:    #8888D0;\n\t\t\t\t--pitch6-primary-note:      #D0D0FF;\n\t\t\t\t--pitch7-secondary-channel: #8AA100;\n\t\t\t\t--pitch7-primary-channel:   #DEFF25;\n\t\t\t\t--pitch7-secondary-note:    #AAC700;\n\t\t\t\t--pitch7-primary-note:      #E6FF92;\n\t\t\t\t--pitch8-secondary-channel: #DF0019;\n\t\t\t\t--pitch8-primary-channel:   #FF98A4;\n\t\t\t\t--pitch8-secondary-note:    #FF4E63;\n\t\t\t\t--pitch8-primary-note:      #FFB2BB;\n\t\t\t\t--pitch9-secondary-channel: #00A170;\n\t\t\t\t--pitch9-primary-channel:   #50FFC9;\n\t\t\t\t--pitch9-secondary-note:    #00C78A;\n\t\t\t\t--pitch9-primary-note:      #83FFD9;\n\t\t\t\t--pitch10-secondary-channel:#A11FFF;\n\t\t\t\t--pitch10-primary-channel:  #CE8BFF;\n\t\t\t\t--pitch10-secondary-note:   #B757FF;\n\t\t\t\t--pitch10-primary-note:     #DFACFF;\n\t\t\t\t--noise1-secondary-channel: #6F6F6F;\n\t\t\t\t--noise1-primary-channel:   #AAAAAA;\n\t\t\t\t--noise1-secondary-note:    #A7A7A7;\n\t\t\t\t--noise1-primary-note:      #E0E0E0;\n\t\t\t\t--noise2-secondary-channel: #996633;\n\t\t\t\t--noise2-primary-channel:   #DDAA77;\n\t\t\t\t--noise2-secondary-note:    #CC9966;\n\t\t\t\t--noise2-primary-note:      #F0D0BB;\n\t\t\t\t--noise3-secondary-channel: #4A6D8F;\n\t\t\t\t--noise3-primary-channel:   #77AADD;\n\t\t\t\t--noise3-secondary-note:    #6F9FCF;\n\t\t\t\t--noise3-primary-note:      #BBD7FF;\n\t\t\t\t--noise4-secondary-channel: #7A4F9A;\n\t\t\t\t--noise4-primary-channel:   #AF82D2;\n\t\t\t\t--noise4-secondary-note:    #9E71C1;\n\t\t\t\t--noise4-primary-note:      #D4C1EA;\n\t\t\t\t--noise5-secondary-channel: #607837;\n\t\t\t\t--noise5-primary-channel:   #A2BB77;\n\t\t\t\t--noise5-secondary-note:    #91AA66;\n\t\t\t\t--noise5-primary-note:      #C5E2B2;\n\t\t\t}\n\t\t`,\n\t\t\"light classic\": `\n\t\t\t:root {\n\t\t\t\t-webkit-text-stroke-width: 0.5px;\n\t\t\t\t--page-margin: #685d88;\n\t\t\t\t--editor-background: white;\n\t\t\t\t--hover-preview: black;\n\t\t\t\t--playhead: rgba(0,0,0,0.5);\n\t\t\t\t--primary-text: black;\n\t\t\t\t--secondary-text: #777;\n\t\t\t\t--inverted-text: white;\n\t\t\t\t--text-selection: rgba(200,170,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(0,0,0,0.1);\n\t\t\t\t--loop-accent: #98f;\n\t\t\t\t--link-accent: #74f;\n\t\t\t\t--ui-widget-background: #ececec;\n\t\t\t\t--ui-widget-focus: #eee;\n\t\t\t\t--pitch-background: #ececec;\n\t\t\t\t--tonic: #f0d6b6;\n\t\t\t\t--fifth-note: #bbddf0;\n\t\t\t\t--white-piano-key: #eee;\n\t\t\t\t--black-piano-key: #666;\n\t\t\t\t--pitch1-secondary-channel: #6CD9ED;\n\t\t\t\t--pitch1-primary-channel:   #00A0BD;\n\t\t\t\t--pitch1-secondary-note:    #34C2DC;\n\t\t\t\t--pitch1-primary-note:      #00758A;\n\t\t\t\t--pitch2-secondary-channel: #E3C941;\n\t\t\t\t--pitch2-primary-channel:   #B49700;\n\t\t\t\t--pitch2-secondary-note:    #D1B628;\n\t\t\t\t--pitch2-primary-note:      #836E00;\n\t\t\t\t--pitch3-secondary-channel: #FF9D61;\n\t\t\t\t--pitch3-primary-channel:   #E14E00;\n\t\t\t\t--pitch3-secondary-note:    #F67D3C;\n\t\t\t\t--pitch3-primary-note:      #B64000;\n\t\t\t\t--pitch4-secondary-channel: #4BE24B;\n\t\t\t\t--pitch4-primary-channel:   #00A800;\n\t\t\t\t--pitch4-secondary-note:    #2DC82D;\n\t\t\t\t--pitch4-primary-note:      #008000;\n\t\t\t\t--pitch5-secondary-channel: #FF90FF;\n\t\t\t\t--pitch5-primary-channel:   #E12EDF;\n\t\t\t\t--pitch5-secondary-note:    #EC6EEC;\n\t\t\t\t--pitch5-primary-note:      #A600A5;\n\t\t\t\t--pitch6-secondary-channel: #B5B5FE;\n\t\t\t\t--pitch6-primary-channel:   #6969FD;\n\t\t\t\t--pitch6-secondary-note:    #9393FE;\n\t\t\t\t--pitch6-primary-note:      #4A4AD7;\n\t\t\t\t--pitch7-secondary-channel: #C2D848;\n\t\t\t\t--pitch7-primary-channel:   #8EA800;\n\t\t\t\t--pitch7-secondary-note:    #B0C82D;\n\t\t\t\t--pitch7-primary-note:      #6C8000;\n\t\t\t\t--pitch8-secondary-channel: #FF90A4;\n\t\t\t\t--pitch8-primary-channel:   #E12E4D;\n\t\t\t\t--pitch8-secondary-note:    #EC6E85;\n\t\t\t\t--pitch8-primary-note:      #A6001D;\n\t\t\t\t--pitch9-secondary-channel: #41E3B5;\n\t\t\t\t--pitch9-primary-channel:   #00B481;\n\t\t\t\t--pitch9-secondary-note:    #28D1A1;\n\t\t\t\t--pitch9-primary-note:      #00835E;\n\t\t\t\t--pitch10-secondary-channel:#CA77FF;\n\t\t\t\t--pitch10-primary-channel:  #9609FF;\n\t\t\t\t--pitch10-secondary-note:   #B54FFF;\n\t\t\t\t--pitch10-primary-note:     #8400E3;\n\t\t\t\t--noise1-secondary-channel: #C1C1C1;\n\t\t\t\t--noise1-primary-channel:   #898989;\n\t\t\t\t--noise1-secondary-note:    #ADADAD;\n\t\t\t\t--noise1-primary-note:      #6C6C6C;\n\t\t\t\t--noise2-secondary-channel: #E8BB8C;\n\t\t\t\t--noise2-primary-channel:   #BD7D3A;\n\t\t\t\t--noise2-secondary-note:    #D1A374;\n\t\t\t\t--noise2-primary-note:      #836342;\n\t\t\t\t--noise3-secondary-channel: #9BC4EB;\n\t\t\t\t--noise3-primary-channel:   #4481BE;\n\t\t\t\t--noise3-secondary-note:    #7CA7D3;\n\t\t\t\t--noise3-primary-note:      #476685;\n\t\t\t\t--noise4-secondary-channel: #C5A5E0;\n\t\t\t\t--noise4-primary-channel:   #8553AE;\n\t\t\t\t--noise4-secondary-note:    #B290CC;\n\t\t\t\t--noise4-primary-note:      #684F7D;\n\t\t\t\t--noise5-secondary-channel: #B8CE93;\n\t\t\t\t--noise5-primary-channel:   #87A74F;\n\t\t\t\t--noise5-secondary-note:    #ABC183;\n\t\t\t\t--noise5-primary-note:      #68784C;\n\t\t\t}\n\t\t\t\n\t\t\t.beepboxEditor button, .beepboxEditor select {\n\t\t\t\tbox-shadow: inset 0 0 0 1px var(--secondary-text);\n\t\t\t}\n\t\t`,\n\t};\n\t\n\tpublic static readonly pageMargin: string = \"var(--page-margin)\";\n\tpublic static readonly editorBackground: string = \"var(--editor-background)\";\n\tpublic static readonly hoverPreview: string = \"var(--hover-preview)\";\n\tpublic static readonly playhead: string = \"var(--playhead)\";\n\tpublic static readonly primaryText: string = \"var(--primary-text)\";\n\tpublic static readonly secondaryText: string = \"var(--secondary-text)\";\n\tpublic static readonly invertedText: string = \"var(--inverted-text)\";\n\tpublic static readonly textSelection: string = \"var(--text-selection)\";\n\tpublic static readonly boxSelectionFill: string = \"var(--box-selection-fill)\";\n\tpublic static readonly loopAccent: string = \"var(--loop-accent)\";\n\tpublic static readonly linkAccent: string = \"var(--link-accent)\";\n\tpublic static readonly uiWidgetBackground: string = \"var(--ui-widget-background)\";\n\tpublic static readonly uiWidgetFocus: string = \"var(--ui-widget-focus)\";\n\tpublic static readonly pitchBackground: string = \"var(--pitch-background)\";\n\tpublic static readonly tonic: string = \"var(--tonic)\";\n\tpublic static readonly fifthNote: string = \"var(--fifth-note)\";\n\tpublic static readonly whitePianoKey: string = \"var(--white-piano-key)\";\n\tpublic static readonly blackPianoKey: string = \"var(--black-piano-key)\";\n\t\n\tpublic static readonly pitchChannels: DictionaryArray<ChannelColors> = toNameMap([\n\t\t{\n\t\t\tname: \"pitch1\", // cyan\n\t\t\tsecondaryChannel: \"var(--pitch1-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch1-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch1-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch1-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch2\", // yellow\n\t\t\tsecondaryChannel: \"var(--pitch2-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch2-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch2-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch2-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch3\", // orange\n\t\t\tsecondaryChannel: \"var(--pitch3-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch3-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch3-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch3-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch4\", // green\n\t\t\tsecondaryChannel: \"var(--pitch4-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch4-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch4-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch4-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch5\", // magenta\n\t\t\tsecondaryChannel: \"var(--pitch5-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch5-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch5-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch5-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch6\", // blue\n\t\t\tsecondaryChannel: \"var(--pitch6-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch6-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch6-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch6-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch7\", // olive\n\t\t\tsecondaryChannel: \"var(--pitch7-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch7-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch7-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch7-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch8\", // red\n\t\t\tsecondaryChannel: \"var(--pitch8-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch8-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch8-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch8-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch9\", // teal\n\t\t\tsecondaryChannel: \"var(--pitch9-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch9-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch9-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch9-primary-note)\",\n\t\t}, {\n\t\t\tname: \"pitch10\", // purple\n\t\t\tsecondaryChannel: \"var(--pitch10-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--pitch10-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--pitch10-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--pitch10-primary-note)\",\n\t\t},\n\t]);\n\tpublic static readonly noiseChannels: DictionaryArray<ChannelColors> = toNameMap([\n\t\t{\n\t\t\tname: \"noise1\", // gray\n\t\t\tsecondaryChannel: \"var(--noise1-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--noise1-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--noise1-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--noise1-primary-note)\",\n\t\t}, {\n\t\t\tname: \"noise2\", // brown\n\t\t\tsecondaryChannel: \"var(--noise2-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--noise2-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--noise2-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--noise2-primary-note)\",\n\t\t}, {\n\t\t\tname: \"noise3\", // azure\n\t\t\tsecondaryChannel: \"var(--noise3-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--noise3-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--noise3-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--noise3-primary-note)\",\n\t\t}, {\n\t\t\tname: \"noise4\", // purple\n\t\t\tsecondaryChannel: \"var(--noise4-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--noise4-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--noise4-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--noise4-primary-note)\",\n\t\t}, {\n\t\t\tname: \"noise5\", // sage\n\t\t\tsecondaryChannel: \"var(--noise5-secondary-channel)\",\n\t\t\tprimaryChannel:   \"var(--noise5-primary-channel)\",\n\t\t\tsecondaryNote:    \"var(--noise5-secondary-note)\",\n\t\t\tprimaryNote:      \"var(--noise5-primary-note)\",\n\t\t},\n\t]);\n\t\n\tpublic static getChannelColor(song: Song, channel: number): ChannelColors {\n\t\treturn channel < song.pitchChannelCount\n\t\t\t? ColorConfig.pitchChannels[channel % ColorConfig.pitchChannels.length]\n\t\t\t: ColorConfig.noiseChannels[(channel - song.pitchChannelCount) % ColorConfig.noiseChannels.length];\n\t}\n\t\n\tprivate static readonly _styleElement: HTMLStyleElement = document.head.appendChild(HTML.style({type: \"text/css\"}));\n\t\n\tpublic static setTheme(name: string): void {\n\t\tthis._styleElement.textContent = this.themes[name];\n\t\t\n\t\tconst themeColor = <HTMLMetaElement> document.querySelector(\"meta[name='theme-color']\");\n\t\tif (themeColor != null) {\n\t\t\tthemeColor.setAttribute(\"content\", getComputedStyle(document.documentElement).getPropertyValue('--ui-widget-background'));\n\t\t}\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {ColorConfig} from \"./ColorConfig\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\n\n\n// Determine if the user's browser/OS adds scrollbars that occupy space.\n// See: https://www.filamentgroup.com/lab/scrollbars/\nconst scrollBarTest: HTMLDivElement = document.body.appendChild(HTML.div({style: \"width:30px; height:30px; overflow: auto;\"}, \n\tHTML.div({style: \"width:100%;height:40px\"}),\n));\nif ((<any>scrollBarTest).firstChild.clientWidth < 30) {\n\tdocument.documentElement.classList.add(\"obtrusive-scrollbars\");\n}\ndocument.body.removeChild(scrollBarTest);\n\n\ndocument.head.appendChild(HTML.style({type: \"text/css\"}, `\n\n/* Note: \"#\" symbols need to be encoded as \"%23\" in SVG data urls, otherwise they are interpreted as fragment identifiers! */\n:root {\n\t--button-size: 26px;\n\t--settings-area-width: 192px;\n\t--play-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><path d=\"M -4 -8 L -4 8 L 9 0 z\" fill=\"gray\"/></svg>');\n\t--pause-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><rect x=\"-4\" y=\"-8\" width=\"4\" height=\"16\" fill=\"gray\"/><rect x=\"5\" y=\"-8\" width=\"4\" height=\"16\" fill=\"gray\"/></svg>');\n\t--prev-bar-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><rect x=\"-6\" y=\"-6\" width=\"2\" height=\"12\" fill=\"gray\"/><path d=\"M 6 -6 L 6 6 L -3 0 z\" fill=\"gray\"/></svg>');\n\t--next-bar-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><rect x=\"4\" y=\"-6\" width=\"2\" height=\"12\" fill=\"gray\"/><path d=\"M -6 -6 L -6 6 L 3 0 z\" fill=\"gray\"/></svg>');\n\t--volume-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"0 0 26 26\"><path d=\"M 4 16 L 4 10 L 8 10 L 13 5 L 13 21 L 8 16 z M 15 11 L 16 10 A 7.2 7.2 0 0 1 16 16 L 15 15 A 5.8 5.8 0 0 0 15 12 z M 18 8 L 19 7 A 11.5 11.5 0 0 1 19 19 L 18 18 A 10.1 10.1 0 0 0 18 8 z\" fill=\"gray\"/></svg>');\n\t--unmuted-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"3 3 20 20\"><path d=\"M 4 16 L 4 10 L 8 10 L 13 5 L 13 21 L 8 16 z M 15 11 L 16 10 A 7.2 7.2 0 0 1 16 16 L 15 15 A 5.8 5.8 0 0 0 15 12 z M 18 8 L 19 7 A 11.5 11.5 0 0 1 19 19 L 18 18 A 10.1 10.1 0 0 0 18 8 z\" fill=\"gray\"/></svg>');\n\t--muted-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"3 3 20 20\"><path d=\"M 4 16 L 4 10 L 8 10 L 13 5 L 13 21 L 8 16 z\" fill=\"gray\"/></svg>');\n\t--menu-down-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><path d=\"M -4 -2 L 4 -2 L 0 3 z\" fill=\"gray\"/></svg>');\n\t--select-arrows-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><path d=\"M -4 -3 L 4 -3 L 0 -8 z M -4 3 L 4 3 L 0 8 z\" fill=\"gray\"/></svg>');\n\t--file-page-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-5 -21 26 26\"><path d=\"M 2 0 L 2 -16 L 10 -16 L 14 -12 L 14 0 z M 3 -1 L 13 -1 L 13 -11 L 9 -11 L 9 -15 L 3 -15 z\" fill=\"gray\"/></svg>');\n\t--edit-pencil-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-5 -21 26 26\"><path d=\"M 0 0 L 1 -4 L 4 -1 z M 2 -5 L 10 -13 L 13 -10 L 5 -2 zM 11 -14 L 13 -16 L 14 -16 L 16 -14 L 16 -13 L 14 -11 z\" fill=\"gray\"/></svg>');\n\t--preferences-gear-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><path d=\"M 5.78 -1.6 L 7.93 -0.94 L 7.93 0.94 L 5.78 1.6 L 4.85 3.53 L 5.68 5.61 L 4.21 6.78 L 2.36 5.52 L 0.27 5.99 L -0.85 7.94 L -2.68 7.52 L -2.84 5.28 L -4.52 3.95 L -6.73 4.28 L -7.55 2.59 L -5.9 1.07 L -5.9 -1.07 L -7.55 -2.59 L -6.73 -4.28 L -4.52 -3.95 L -2.84 -5.28 L -2.68 -7.52 L -0.85 -7.94 L 0.27 -5.99 L 2.36 -5.52 L 4.21 -6.78 L 5.68 -5.61 L 4.85 -3.53 M 2.92 0.67 L 2.92 -0.67 L 2.35 -1.87 L 1.3 -2.7 L 0 -3 L -1.3 -2.7 L -2.35 -1.87 L -2.92 -0.67 L -2.92 0.67 L -2.35 1.87 L -1.3 2.7 L -0 3 L 1.3 2.7 L 2.35 1.87 z\" fill=\"gray\"/></svg>');\n\t--customize-dial-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"> \\\n\t\t\t<g transform=\"translate(0,1)\" fill=\"gray\"> \\\n\t\t\t\t<circle cx=\"0\" cy=\"0\" r=\"6.5\" stroke=\"gray\" stroke-width=\"1\" fill=\"none\"/> \\\n\t\t\t\t<rect x=\"-1\" y=\"-5\" width=\"2\" height=\"4\" transform=\"rotate(30)\"/> \\\n\t\t\t\t<circle cx=\"-7.79\" cy=\"4.5\" r=\"0.75\"/> \\\n\t\t\t\t<circle cx=\"-9\" cy=\"0\" r=\"0.75\"/> \\\n\t\t\t\t<circle cx=\"-7.79\" cy=\"-4.5\" r=\"0.75\"/> \\\n\t\t\t\t<circle cx=\"-4.5\" cy=\"-7.79\" r=\"0.75\"/> \\\n\t\t\t\t<circle cx=\"0\" cy=\"-9\" r=\"0.75\"/> \\\n\t\t\t\t<circle cx=\"4.5\" cy=\"-7.79\" r=\"0.75\"/> \\\n\t\t\t\t<circle cx=\"7.79\" cy=\"-4.5\" r=\"0.75\"/> \\\n\t\t\t\t<circle cx=\"9\" cy=\"0\" r=\"0.75\"/> \\\n\t\t\t\t<circle cx=\"7.79\" cy=\"4.5\" r=\"0.75\"/> \\\n\t\t\t</g> \\\n\t\t</svg>');\n\t--instrument-copy-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-5 -21 26 26\"><path d=\"M 0 -15 L 1 -15 L 1 0 L 13 0 L 13 1 L 0 1 L 0 -15 z M 2 -1 L 2 -17 L 10 -17 L 14 -13 L 14 -1 z M 3 -2 L 13 -2 L 13 -12 L 9 -12 L 9 -16 L 3 -16 z\" fill=\"currentColor\"></path></svg>');\n\t--instrument-paste-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"0 0 26 26\"><path d=\"M 8 18 L 6 18 L 6 5 L 17 5 L 17 7 M 9 8 L 16 8 L 20 12 L 20 22 L 9 22 z\" stroke=\"currentColor\" fill=\"none\"></path><path d=\"M 9 3 L 14 3 L 14 6 L 9 6 L 9 3 z M 16 8 L 20 12 L 16 12 L 16 8 z\" fill=\"currentColor\"></path></svg>');\n\t--export-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><path fill=\"gray\" d=\"M -8 3 L -8 8 L 8 8 L 8 3 L 6 3 L 6 6 L -6 6 L -6 3 z M 0 2 L -4 -2 L -1 -2 L -1 -8 L 1 -8 L 1 -2 L 4 -2 z\"/></svg>');\n\t--close-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><path fill=\"gray\" d=\"M -7.07 -5.66 L -5.66 -7.07 L 0 -1.4 L 5.66 -7.07 L 7.07 -5.66 L 1.4 0 L 7.07 5.66 L 5.66 7.07 L 0 1.4 L -5.66 7.07 L -7.07 5.66 L -1.4 0 z\"/></svg>');\n\t--add-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><path fill=\"gray\" d=\"M -8 -1 L -1 -1 L -1 -8  L 1 -8 L 1 -1 L 8 -1 L 8 1 L 1 1 L 1 8 L -1 8 L -1 1 L -8 1 z\"/></svg>');\n\t--zoom-in-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"-10 -10 20 20\"><circle cx=\"-1\" cy=\"-1\" r=\"6\" stroke-width=\"2\" stroke=\"gray\" fill=\"none\"></circle><path stroke=\"gray\" stroke-width=\"2\" d=\"M 3 3 L 7 7 M -1 -4 L -1 2 M -4 -1 L 2 -1\" fill=\"none\"></path></svg>');\n\t--zoom-out-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"-10 -10 20 20\"><circle cx=\"-1\" cy=\"-1\" r=\"6\" stroke-width=\"2\" stroke=\"gray\" fill=\"none\"></circle><path stroke=\"gray\" stroke-width=\"2\" d=\"M 3 3 L 7 7 M -4 -1 L 2 -1\" fill=\"none\"></path></svg>');\n\t--checkmark-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"26\" height=\"26\" viewBox=\"-13 -13 26 26\"><path fill=\"gray\" d=\"M -9 -2 L -8 -3 L -3 2 L 9 -8 L 10 -7 L -3 8 z\"/></svg>');\n\t--drum-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"40\" viewBox=\"0 0 32 40\"> \\\n\t\t\t<defs> \\\n\t\t\t\t<linearGradient id=\"gold1\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"> \\\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"%237e3302\"/> \\\n\t\t\t\t\t<stop offset=\"40%\" stop-color=\"%23ffec6b\"/> \\\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%237e3302\"/> \\\n\t\t\t\t</linearGradient> \\\n\t\t\t\t<linearGradient id=\"gold2\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"> \\\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"%23faaf7d\"/> \\\n\t\t\t\t\t<stop offset=\"15%\" stop-color=\"%23fffba9\"/> \\\n\t\t\t\t\t<stop offset=\"40%\" stop-color=\"%23ffffe3\"/> \\\n\t\t\t\t\t<stop offset=\"65%\" stop-color=\"%23fffba9\"/> \\\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%23faaf7d\"/> \\\n\t\t\t\t</linearGradient> \\\n\t\t\t\t<radialGradient id=\"gold3\" cx=\"0%\" cy=\"0%\" r=\"100%\"> \\\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"%23ffffe3\"/> \\\n\t\t\t\t\t<stop offset=\"50%\" stop-color=\"%23ffec6b\"/> \\\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%237e3302\"/> \\\n\t\t\t\t</radialGradient> \\\n\t\t\t\t<linearGradient id=\"red\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"> \\\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"%23641919\"/> \\\n\t\t\t\t\t<stop offset=\"40%\" stop-color=\"%23cd2c2c\"/> \\\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%23641919\"/> \\\n\t\t\t\t</linearGradient> \\\n\t\t\t\t<radialGradient id=\"membrane\"> \\\n\t\t\t\t\t<stop offset=\"10%\" stop-color=\"%23cccccc\" /> \\\n\t\t\t\t\t<stop offset=\"90%\" stop-color=\"%23f6f6f7\" /> \\\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"%23999\" /> \\\n\t\t\t\t</radialGradient> \\\n\t\t\t</defs> \\\n\t\t\t<ellipse cx=\"16\" cy=\"26\" rx=\"16\" ry=\"14\" fill=\"rgba(0,0,0,0.5)\"/> \\\n\t\t\t<ellipse cx=\"16\" cy=\"25\" rx=\"16\" ry=\"14\" fill=\"url(%23gold1)\"/> \\\n\t\t\t<rect x=\"0\" y=\"23\" width=\"32\" height=\"2\" fill=\"url(%23gold1)\"/> \\\n\t\t\t<ellipse cx=\"16\" cy=\"23\" rx=\"16\" ry=\"14\" fill=\"url(%23gold2)\"/> \\\n\t\t\t<ellipse cx=\"16\" cy=\"23\" rx=\"15\" ry=\"13\" fill=\"url(%23red)\"/> \\\n\t\t\t<rect x=\"1\" y=\"17\" width=\"30\" height=\"6\" fill=\"url(%23red)\"/> \\\n\t\t\t<rect x=\"5\" y=\"27\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"rgba(0,0,0,0.5)\"/> \\\n\t\t\t<rect x=\"15\" y=\"31\" width=\"2\" height=\"5\" rx=\"1\" fill=\"rgba(0,0,0,0.5)\"/> \\\n\t\t\t<rect x=\"26\" y=\"27\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"rgba(0,0,0,0.5)\"/> \\\n\t\t\t<rect x=\"5\" y=\"26\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"url(%23gold3)\"/> \\\n\t\t\t<rect x=\"15\" y=\"30\" width=\"2\" height=\"5\" rx=\"1\" fill=\"url(%23gold3)\"/> \\\n\t\t\t<rect x=\"26\" y=\"26\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"url(%23gold3)\"/> \\\n\t\t\t<ellipse cx=\"16\" cy=\"18\" rx=\"15\" ry=\"13\" fill=\"rgba(0,0,0,0.5)\"/> \\\n\t\t\t<ellipse cx=\"16\" cy=\"16\" rx=\"16\" ry=\"14\" fill=\"url(%23gold1)\"/> \\\n\t\t\t<rect x=\"0\" y=\"14\" width=\"32\" height=\"2\" fill=\"url(%23gold1)\"/> \\\n\t\t\t<ellipse cx=\"16\" cy=\"14\" rx=\"16\" ry=\"14\" fill=\"url(%23gold2)\"/> \\\n\t\t\t<ellipse cx=\"16\" cy=\"14\" rx=\"15\" ry=\"13\" fill=\"url(%23membrane)\"/> \\\n\t\t</svg>');\n\t--piano-key-symbol: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"15\" preserveAspectRatio=\"none\" viewBox=\"0 -1 32 15\"> \\\n\t\t\t<defs> \\\n\t\t\t\t<linearGradient id=\"shadow\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"> \\\n\t\t\t\t\t<stop offset=\"0%\" stop-color=\"rgba(0,0,0,0.5)\"/> \\\n\t\t\t\t\t<stop offset=\"100%\" stop-color=\"transparent\"/> \\\n\t\t\t\t</linearGradient> \\\n\t\t\t</defs> \\\n\t\t\t<rect x=\"-1\" y=\"1\" width=\"31\" height=\"1\" rx=\"0.6\" fill=\"rgba(255,255,255,0.4)\"/> \\\n\t\t\t<path d=\"M -1 11 L 30 11 L 30 2 L 33 -1 L 33 14 L -1 14 z\" fill=\"rgba(0,0,0,0.7)\"/> \\\n\t\t\t<rect x=\"-1\" y=\"-1\" width=\"19\" height=\"15\" fill=\"url(%23shadow)\"/> \\\n\t\t</svg>');\n}\n\n\n.obtrusive-scrollbars, .obtrusive-scrollbars * {\n\tscrollbar-width: thin;\n\tscrollbar-color: ${ColorConfig.uiWidgetBackground} ${ColorConfig.editorBackground};\n}\n.obtrusive-scrollbars::-webkit-scrollbar, .obtrusive-scrollbars *::-webkit-scrollbar {\n\twidth: 12px;\n}\n.obtrusive-scrollbars::-webkit-scrollbar-track, .obtrusive-scrollbars *::-webkit-scrollbar-track {\n\tbackground: ${ColorConfig.editorBackground};\n}\n.obtrusive-scrollbars::-webkit-scrollbar-thumb, .obtrusive-scrollbars *::-webkit-scrollbar-thumb {\n\tbackground-color: ${ColorConfig.uiWidgetBackground};\n\tborder: 3px solid ${ColorConfig.editorBackground};\n}\n\n\n.beepboxEditor {\n\tdisplay: grid;\n    grid-template-columns: minmax(0, 1fr) max-content;\n    grid-template-rows: max-content 1fr; /* max-content minmax(0, 1fr); Chrome 80 grid layout regression. https://bugs.chromium.org/p/chromium/issues/detail?id=1050307 */\n    grid-template-areas: \"pattern-area settings-area\" \"track-area settings-area\";\n\tgrid-column-gap: 6px;\n\tgrid-row-gap: 6px;\n\tposition: relative;\n\ttouch-action: manipulation;\n\tcursor: default;\n\tfont-size: 13px;\n\toverflow: hidden;\n\tcolor: ${ColorConfig.primaryText};\n\tbackground: ${ColorConfig.editorBackground};\n}\n\n.beepboxEditor .noSelection {\n\t-webkit-touch-callout: none;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n\n.beepboxEditor div {\n\tmargin: 0;\n\tpadding: 0;\n}\n\n.beepboxEditor .pattern-area {\n\tgrid-area: pattern-area;\n\theight: 481px;\n\tdisplay: flex;\n\tflex-direction: row;\n\tposition: relative;\n}\n\n.beepboxEditor .track-area {\n\tgrid-area: track-area;\n}\n\n.beepboxEditor .loopEditor {\n\theight: 20px;\n\tposition: sticky;\n\tbottom: 0;\n\tpadding: 5px 0;\n\tbackground-color: ${ColorConfig.editorBackground};\n}\n\n.beepboxEditor .settings-area {\n\tgrid-area: settings-area;\n\tdisplay: grid;\n    grid-template-columns: auto;\n    grid-template-rows: min-content min-content min-content min-content min-content;\n    grid-template-areas: \"version-area\" \"play-pause-area\" \"menu-area\" \"song-settings-area\" \"instrument-settings-area\";\n\tgrid-column-gap: 6px;\n}\n\n.beepboxEditor .version-area{ grid-area: version-area; }\n.beepboxEditor .play-pause-area{ grid-area: play-pause-area; }\n.beepboxEditor .menu-area{ grid-area: menu-area; }\n.beepboxEditor .song-settings-area{ grid-area: song-settings-area; }\n.beepboxEditor .instrument-settings-area{ grid-area: instrument-settings-area; }\n\n.beepboxEditor .tip {\n\tcursor: help;\n\tcolor: ${ColorConfig.secondaryText};\n\ttext-decoration: none;\n}\n\n.beepboxEditor .tip:hover {\n\tcolor: ${ColorConfig.linkAccent};\n\ttext-decoration: underline;\n}\n.beepboxEditor .tip:active {\n\tcolor: ${ColorConfig.primaryText};\n}\n\n.beepboxEditor .volume-speaker {\n\tflex-shrink: 0;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: ${ColorConfig.secondaryText};\n\t-webkit-mask-image: var(--volume-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--volume-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .drum-button {\n\tflex: 1;\n\tbackground-color: transparent;\n\tbackground-image: var(--drum-symbol);\n\tbackground-repeat: no-repeat;\n\tbackground-position: center;\n}\n\n.beepboxEditor .piano-button {\n\tflex: 1;\n\tposition: relative;\n\tdisplay: flex;\n\talign-items: center;\n}\n.beepboxEditor .piano-button::before {\n\tcontent: \"\";\n\tposition: absolute;\n\tleft: 0;\n\ttop: 0;\n\twidth: 100%;\n\theight: 100%;\n\tpointer-events: none;\n\tbackground-image: var(--piano-key-symbol);\n\tbackground-repeat: no-repeat;\n\tbackground-position: center;\n\tbackground-size: 100% 115.38%;\n}\n.beepboxEditor .piano-button.disabled::after {\n\tcontent: \"\";\n\tposition: absolute;\n\tright: 0;\n\ttop: 0;\n\twidth: 70%;\n\theight: 100%;\n\tpointer-events: none;\n\tbackground: ${ColorConfig.editorBackground};\n\t-webkit-mask-image: linear-gradient(90deg, transparent 0%, gray 70%, gray 100%);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: linear-gradient(90deg, transparent 0%, gray 70%, gray 100%);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .customize-instrument {\n\tmargin: 2px 0;\n}\n.beepboxEditor .customize-instrument::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--customize-dial-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--customize-dial-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .instrumentCopyPasteRow {\n\tgap: 2px;\n}\n\n.beepboxEditor .copy-instrument {\n\tmargin: 2px 0;\n\tflex-grow: 1;\n}\n.beepboxEditor .copy-instrument::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--instrument-copy-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--instrument-copy-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .paste-instrument {\n\tmargin: 2px 0;\n\tflex-grow: 1;\n}\n.beepboxEditor .paste-instrument::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--instrument-paste-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--instrument-paste-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .envelopeEditor {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .envelope-row {\n\tdisplay: flex;\n\tmargin: 2px 0;\n\tgap: 2px;\n}\n\n.beepboxEditor .add-envelope {\n\twidth: var(--button-size);\n}\n.beepboxEditor .add-envelope::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--add-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--add-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n.beepboxEditor .add-envelope:disabled {\n\tvisibility: hidden;\n}\n\n.beepboxEditor .effects-menu {\n\twidth: var(--button-size);\n\tposition: relative;\n}\n.beepboxEditor .effects-menu::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--menu-down-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--menu-down-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n\n.beepboxEditor .zoomInButton, .beepboxEditor .zoomOutButton {\n\twidth: var(--button-size);\n\tposition: absolute;\n\tright: 10px;\n}\n.beepboxEditor .zoomInButton {\n\ttop: 10px;\n}\n.beepboxEditor .zoomOutButton {\n\ttop: 50px;\n}\n.beepboxEditor .zoomInButton::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--zoom-in-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--zoom-in-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n.beepboxEditor .zoomOutButton::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--zoom-out-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--zoom-out-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n\n.beepboxEditor .delete-envelope {\n\twidth: var(--button-size);\n\tflex-shrink: 0;\n\tflex-grow: 0;\n}\n.beepboxEditor .delete-envelope::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--close-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--close-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n.beepboxEditor .delete-envelope:disabled {\n\tvisibility: hidden;\n}\n\n.beepboxEditor .menu.file::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--file-page-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--file-page-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .menu.edit::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--edit-pencil-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--edit-pencil-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .menu.preferences::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--preferences-gear-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--preferences-gear-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor .mute-button::before {\n\tcontent: \"\";\n\tpointer-events: none;\n\twidth: 100%;\n\theight: 100%;\n\tbackground: ${ColorConfig.primaryText};\n\tdisplay: inline-block;\n\t-webkit-mask-image: var(--unmuted-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\t-webkit-mask-size: contain;\n\tmask-image: var(--unmuted-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\tmask-size: contain;\n}\n\n.beepboxEditor .mute-button.muted::before {\n\tbackground: ${ColorConfig.editorBackground};\n\t-webkit-mask-image: var(--muted-symbol);\n\tmask-image: var(--muted-symbol);\n}\n\n.beepboxEditor .promptContainer {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tz-index: 100;\n}\n\n.beepboxEditor .promptContainer::before {\n\tcontent: \"\";\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground: ${ColorConfig.editorBackground};\n\topacity: 0.5;\n\tdisplay: flex;\n}\n\n.beepboxEditor .prompt {\n\tmargin: auto;\n\ttext-align: center;\n\tbackground: ${ColorConfig.editorBackground};\n\tborder-radius: 15px;\n\tborder: 4px solid ${ColorConfig.uiWidgetBackground};\n\tcolor: ${ColorConfig.primaryText};\n\tpadding: 20px;\n\tdisplay: flex;\n\tflex-direction: column;\n\tposition: relative;\n\tbox-shadow: 5px 5px 20px 10px rgba(0,0,0,0.5);\n}\n\n.beepboxEditor .prompt > *:not(:first-child):not(.cancelButton) {\n\tmargin-top: 1.5em;\n}\n\n.beepboxEditor .prompt h2 {\n\tfont-size: 2em;\n\tmargin: 0 16px;\n\tfont-weight: normal;\n}\n\n.beepboxEditor .prompt p {\n\ttext-align: left;\n\tmargin: 1em 0;\n}\n\n.beepboxEditor .layout-option {\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex: 1;\n\tcursor: pointer;\n\tcolor: ${ColorConfig.secondaryText};\n}\n\n.beepboxEditor .layout-option input {\n\tdisplay: none;\n}\n\n.beepboxEditor .layout-option input:checked ~ * {\n\tcolor: ${ColorConfig.primaryText};\n}\n\n.beepboxEditor .selectContainer {\n\tposition: relative;\n}\n.beepboxEditor .selectContainer:not(.menu)::after {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tright: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: 14px;\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--select-arrows-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--select-arrows-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n.beepboxEditor .selectContainer.menu::after {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tright: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--menu-down-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--menu-down-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n.beepboxEditor select {\n\tmargin: 0;\n\tpadding: 0 4px;\n\tdisplay: block;\n\theight: var(--button-size);\n\tborder: none;\n\tborder-radius: 5px;\n\tbackground: ${ColorConfig.uiWidgetBackground};\n\tcolor: inherit;\n\tfont-size: inherit;\n\tcursor: pointer;\n\tfont-family: inherit;\n\tfont-weight: inherit;\n\n\t-webkit-appearance:none;\n\t-moz-appearance: none;\n\tappearance: none;\n}\n.beepboxEditor .menu select {\n\tpadding: 0 var(--button-size);\n}\n.beepboxEditor select:focus {\n\tbackground: ${ColorConfig.uiWidgetFocus};\n\toutline: none;\n}\n.beepboxEditor .menu select {\n\ttext-align: center;\n\ttext-align-last: center;\n}\n.beepboxEditor .settings-area select {\n       width: 100%;\n}\n\n/* This makes it look better in firefox on my computer... What about others?\n@-moz-document url-prefix() {\n\t.beepboxEditor select { padding: 0 2px; }\n}\n*/\n.beepboxEditor button {\n\tmargin: 0;\n\tposition: relative;\n\theight: var(--button-size);\n\tborder: none;\n\tborder-radius: 5px;\n\tbackground: ${ColorConfig.uiWidgetBackground};\n\tcolor: inherit;\n\tfont-size: inherit;\n\tfont-family: inherit;\n\tfont-weight: inherit;\n\tcursor: pointer;\n}\n.beepboxEditor button:focus {\n\tbackground: ${ColorConfig.uiWidgetFocus};\n\toutline: none;\n}\n\n.beepboxEditor button.cancelButton {\n\tfloat: right;\n\twidth: var(--button-size);\n\tposition: absolute;\n\ttop: 8px;\n\tright: 8px;\n}\n\n.beepboxEditor button.playButton, .beepboxEditor button.pauseButton, .beepboxEditor button.okayButton, .beepboxEditor button.exportButton {\n\tpadding-left: var(--button-size);\n}\n.beepboxEditor button.playButton::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--play-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--play-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n.beepboxEditor button.pauseButton::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 0;\n\ttop: 50%;\n\ttransform: translateY(-50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--pause-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--pause-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor button.prevBarButton::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\ttransform: translate(-50%, -50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--prev-bar-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--prev-bar-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor button.nextBarButton::before {\n\tcontent: \"\";\n\tflex-shrink: 0;\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\ttransform: translate(-50%, -50%);\n\tpointer-events: none;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--next-bar-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--next-bar-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor button.cancelButton::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--close-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--close-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n\n.beepboxEditor button.okayButton::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\t-webkit-mask-image: var(--checkmark-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n\tmask-image: var(--checkmark-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n}\n\n.beepboxEditor button.exportButton::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: var(--button-size);\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--export-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--export-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n\n.beepboxEditor .instrument-bar {\n\tdisplay: flex;\n\tgap: 2px;\n}\n\n.beepboxEditor .instrument-bar button {\n\tflex-grow: 1;\n\tmin-width: 0;\n\tpadding: 0;\n\tflex-basis: 0;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tcolor: var(--text-color-lit);\n}\n\n.beepboxEditor .instrument-bar .remove-instrument, .beepboxEditor .instrument-bar .add-instrument {\n\tmax-width: var(--button-size);\n}\n\n.beepboxEditor .instrument-bar > :not(:first-child) {\n\tborder-top-left-radius: 0;\n\tborder-bottom-left-radius: 0;\n}\n\n.beepboxEditor .instrument-bar > :not(.last-button) {\n\tborder-top-right-radius: 0;\n\tborder-bottom-right-radius: 0;\n}\n\n.beepboxEditor .instrument-bar .selected-instrument {\n\tbackground: var(--background-color-lit);\n\tcolor: ${ColorConfig.invertedText};\n}\n\n.beepboxEditor .instrument-bar .deactivated {\n\tbackground: ${ColorConfig.editorBackground};\n\tcolor: var(--text-color-dim);\n}\n\n.beepboxEditor .instrument-bar .deactivated.selected-instrument {\n\tbackground: var(--background-color-dim);\n\tcolor: ${ColorConfig.invertedText};\n}\n\n.beepboxEditor .instrument-bar .remove-instrument::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: 100%;\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--close-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--close-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n\n.beepboxEditor .instrument-bar .add-instrument::before {\n\tcontent: \"\";\n\tposition: absolute;\n\twidth: 100%;\n\theight: var(--button-size);\n\tleft: 0;\n\ttop: 0;\n\tpointer-events: none;\n\tbackground: currentColor;\n\tmask-image: var(--add-symbol);\n\tmask-repeat: no-repeat;\n\tmask-position: center;\n\t-webkit-mask-image: var(--add-symbol);\n\t-webkit-mask-repeat: no-repeat;\n\t-webkit-mask-position: center;\n}\n\n.beepboxEditor canvas {\n\toverflow: hidden;\n\tposition: absolute;\n\tdisplay: block;\n}\n\n.beepboxEditor .trackContainer {\n\tflex-grow: 1;\n}\n\n.beepboxEditor .trackAndMuteContainer {\n\tdisplay: flex;\n\talign-items: flex-start;\n\twidth: 100%;\n\tmin-height: 0;\n\tflex: 1;\n\toverflow-x: hidden;\n\tposition: relative;\n}\n\n.beepboxEditor .muteEditor {\n\twidth: 32px;\n\tflex-shrink: 0;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: stretch;\n\tposition: sticky;\n\tleft: 0;\n\tz-index: 1;\n\tbackground: ${ColorConfig.editorBackground};\n}\n\n.beepboxEditor .selectRow, .beepboxEditor .instrumentCopyPasteRow {\n\tmargin: 2px 0;\n\theight: var(--button-size);\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n\n.beepboxEditor .selectRow > :last-child {\n\twidth: 62.5%;\n\tflex-shrink: 0;\n}\n\n.beepboxEditor .menu-area {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n.beepboxEditor .menu-area > * {\n\tmargin: 2px 0;\n}\n.beepboxEditor .menu-area > button {\n\tpadding: 0 var(--button-size);\n\twhite-space: nowrap;\n}\n\n.beepboxEditor .song-settings-area {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-controls {\n\tflex-shrink: 0;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .instrument-settings-area {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-side-top > *, .beepboxEditor .editor-right-side-bottom > * {\n\tflex-shrink: 0;\n}\n\n.beepboxEditor .pitchShiftMarkerContainer {\n\tbox-sizing: border-box;\n\tdisplay: flex;\n\theight: 100%;\n\tleft: 3px;\n\tright: 3px;\n\tposition: absolute;\n\talign-items: center;\n\tpointer-events: none;\n}\n\n.beepboxEditor .pitchShiftMarker {\n\twidth: 0;\n\theight: 0;\n\tposition: absolute;\n}\n\n.beepboxEditor .pitchShiftMarker::before {\n\tcontent: \"\";\n\twidth: 2px;\n\theight: 20px;\n\ttransform: translate(-50%, -50%);\n\tposition: absolute;\n\tbackground: currentColor;\n\tborder-radius: 3px;\n}\n\n.beepboxEditor input[type=text], .beepboxEditor input[type=number] {\n\tfont-size: inherit;\n\tfont-weight: inherit;\n\tfont-family: inherit;\n\tbackground: transparent;\n\tborder: 1px solid ${ColorConfig.uiWidgetFocus};\n\tcolor: ${ColorConfig.primaryText};\n}\n\n.beepboxEditor input[type=text]::selection, .beepboxEditor input[type=number]::selection {\n\tbackground-color: ${ColorConfig.textSelection};\n\tcolor: ${ColorConfig.primaryText};\n}\n\n.beepboxEditor input[type=checkbox] {\n  transform: scale(1.5);\n}\n\n.beepboxEditor input[type=range] {\n\t-webkit-appearance: none;\n\tcolor: inherit;\n\twidth: 100%;\n\theight: var(--button-size);\n\tfont-size: inherit;\n\tmargin: 0;\n\tcursor: pointer;\n\tbackground: none;\n\ttouch-action: pan-y;\n}\n.beepboxEditor input[type=range]:focus {\n\toutline: none;\n}\n.beepboxEditor input[type=range]::-webkit-slider-runnable-track {\n\twidth: 100%;\n\theight: 6px;\n\tcursor: pointer;\n\tbackground: ${ColorConfig.uiWidgetBackground};\n}\n.beepboxEditor input[type=range]::-webkit-slider-thumb {\n\theight: var(--button-size);\n\twidth: 6px;\n\tborder-radius: 3px;\n\tbackground: currentColor;\n\tcursor: pointer;\n\t-webkit-appearance: none;\n\tmargin-top: -10px;\n}\n.beepboxEditor input[type=range]:focus::-webkit-slider-runnable-track {\n\tbackground: ${ColorConfig.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-moz-range-track {\n\twidth: 100%;\n\theight: 6px;\n\tcursor: pointer;\n\tbackground: ${ColorConfig.uiWidgetBackground};\n}\n.beepboxEditor input[type=range]:focus::-moz-range-track {\n\tbackground: ${ColorConfig.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-moz-range-thumb {\n\theight: var(--button-size);\n\twidth: 6px;\n\tborder-radius: 3px;\n\tborder: none;\n\tbackground: currentColor;\n\tcursor: pointer;\n}\n.beepboxEditor input[type=range]::-ms-track {\n\twidth: 100%;\n\theight: 6px;\n\tcursor: pointer;\n\tbackground: ${ColorConfig.uiWidgetBackground};\n\tborder-color: transparent;\n}\n.beepboxEditor input[type=range]:focus::-ms-track {\n\tbackground: ${ColorConfig.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-ms-thumb {\n\theight: var(--button-size);\n\twidth: 6px;\n\tborder-radius: 3px;\n\tbackground: currentColor;\n\tcursor: pointer;\n}\n\n/* wide screen */\n@media (min-width: 711px) {\n\t#beepboxEditorContainer {\n\t\tdisplay: table;\n\t}\n\t.beepboxEditor {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor:focus-within {\n\t\toutline: 3px solid ${ColorConfig.uiWidgetBackground};\n\t}\n\t.beepboxEditor .trackAndMuteContainer {\n\t\twidth: 512px;\n\t}\n\t.beepboxEditor .play-pause-area {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t.beepboxEditor .playback-bar-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: 2px 0;\n\t}\n\t.beepboxEditor .playback-volume-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: 2px 0;\n\t\talign-items: center;\n\t}\n\t.beepboxEditor .pauseButton, .beepboxEditor .playButton {\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .nextBarButton, .beepboxEditor .prevBarButton {\n\t\tflex-grow: 1;\n\t\tmargin-left: 10px;\n\t}\n\t.beepboxEditor .settings-area {\n\t\twidth: var(--settings-area-width);\n\t}\n}\n\n/* narrow screen */\n@media (max-width: 710px) {\n\t.beepboxEditor {\n\t\tgrid-template-columns: minmax(0, 1fr);\n\t\tgrid-template-rows: min-content 6px min-content min-content;\n\t\tgrid-template-areas: \"pattern-area\" \".\" \"track-area\" \"settings-area\";\n\t\tgrid-row-gap: 0;\n\t}\n\t.beepboxEditor .settings-area {\n\t\tgrid-template-columns: minmax(0, 1fr) minmax(0, 1fr);\n\t\tgrid-template-rows: min-content min-content 1fr min-content;\n\t\tgrid-template-areas:\n\t\t\t\"play-pause-area play-pause-area\"\n\t\t\t\"menu-area instrument-settings-area\"\n\t\t\t\"song-settings-area instrument-settings-area\"\n\t\t\t\"version-area version-area\";\n\t\tgrid-column-gap: 8px;\n\t\tmargin: 0 4px;\n\t}\n\t.beepboxEditor:focus-within {\n\t\toutline: none;\n\t}\n\t.beepboxEditor .pattern-area {\n\t\tmax-height: 75vh;\n\t}\n\t.beepboxEditor .trackAndMuteContainer {\n\t\toverflow-x: auto;\n\t}\n\t.beepboxEditor .barScrollBar {\n\t\tdisplay: none;\n\t}\n\t.beepboxEditor .play-pause-area {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: 2px 0;\n\t}\n\t.beepboxEditor .playback-bar-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .playback-volume-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tflex-grow: 1;\n\t\tmargin: 0 2px;\n\t}\n\t.beepboxEditor .pauseButton, .beepboxEditor .playButton,\n\t.beepboxEditor .nextBarButton, .beepboxEditor .prevBarButton {\n\t\tflex-grow: 1;\n\t\tmargin: 0 2px;\n\t}\n}\n\n`));\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {ColorConfig} from \"./ColorConfig\";\n\nexport class Layout {\n\tprivate static readonly _layoutMap: {[K: string]: string} = {\n\t\t\"small\": \"\",\n\t\t\"long\": `\\\n\t\t\t/* long layout */\n\t\t\t@media (min-width: 711px) {\n\t\t\t\t#beepboxEditorContainer {\n\t\t\t\t\tmax-width: initial;\n\t\t\t\t\theight: 100vh;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100vh;\n\t\t\t\t\tgrid-template-columns: minmax(0, 1fr) 390px; /* minmax(0, 1fr) min-content; Chrome 80 grid layout regression. https://bugs.chromium.org/p/chromium/issues/detail?id=1050307 */\n\t\t\t\t\tgrid-template-rows: minmax(481px, 1fr) minmax(0, min-content);\n\t\t\t\t\tgrid-template-areas: \"pattern-area settings-area\" \"track-area track-area\";\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .pattern-area {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .track-area {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tmin-height: 0;\n\t\t\t\t\tflex: 1;\n\t\t\t\t\toverflow: auto;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .instrument-settings-area {\n\t\t\t\t\toverflow-y: auto;\n\t\t\t\t\tposition: relative;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .instrument-settings-area > .editor-controls {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .song-settings-area {\n\t\t\t\t\toverflow-y: auto;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.beepboxEditor .settings-area {\n\t\t\t\t\twidth: 390px;\n\t\t\t\t\tgrid-template-columns: minmax(0, 1fr) minmax(0, 1fr);\n\t\t\t\t\tgrid-template-rows: auto auto auto minmax(0, 1fr);\n\t\t\t\t\tgrid-template-areas:\n\t\t\t\t\t\t\"instrument-settings-area version-area\"\n\t\t\t\t\t\t\"instrument-settings-area play-pause-area\"\n\t\t\t\t\t\t\"instrument-settings-area menu-area\"\n\t\t\t\t\t\t\"instrument-settings-area song-settings-area\";\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.beepboxEditor .barScrollBar {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackContainer {\n\t\t\t\t\toverflow: visible;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer {\n\t\t\t\t\tscrollbar-width: auto;\n\t\t\t\t\tscrollbar-color: ${ColorConfig.uiWidgetBackground} ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer::-webkit-scrollbar {\n\t\t\t\t\twidth: 20px;\n\t\t\t\t\theight: 20px;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer::-webkit-scrollbar-track {\n\t\t\t\t\tbackground: ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer::-webkit-scrollbar-thumb {\n\t\t\t\t\tbackground-color: ${ColorConfig.uiWidgetBackground};\n\t\t\t\t\tborder: 3px solid ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer::-webkit-scrollbar-corner {\n\t\t\t\t\tbackground-color: ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t}\n\t\t`,\n\t\t\"tall\": `\\\n\t\t\t/* tall layout */\n\t\t\t@media (min-width: 711px) {\n\t\t\t\t#beepboxEditorContainer {\n\t\t\t\t\tmax-width: initial;\n\t\t\t\t\theight: 100vh;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100vh;\n\t\t\t\t\tgrid-template-columns: minmax(0, 1fr) minmax(0, 1fr) 192px;\n\t\t\t\t\tgrid-template-rows: 1fr;\n\t\t\t\t\tgrid-template-areas: \"track-area pattern-area settings-area\";\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .pattern-area {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .track-area {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tmin-height: 0;\n\t\t\t\t\tflex: 0;\n\t\t\t\t\toverflow: auto;\n\t\t\t\t\tflex-basis: initial;\n\t\t\t\t\tflex-grow: 0;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .instrument-settings-area > .editor-controls {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.beepboxEditor .settings-area {\n\t\t\t\t\twidth: 192px;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\toverflow-y: auto;\n\t\t\t\t\tgrid-template-columns: minmax(0, 1fr);\n\t\t\t\t\tgrid-template-rows: auto auto auto auto minmax(0, 1fr);\n\t\t\t\t\tgrid-template-areas:\n\t\t\t\t\t\t\"version-area\"\n\t\t\t\t\t\t\"play-pause-area\"\n\t\t\t\t\t\t\"menu-area\"\n\t\t\t\t\t\t\"song-settings-area\"\n\t\t\t\t\t\t\"instrument-settings-area\";\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .version-area {\n\t\t\t\t\tposition: sticky;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\tz-index: 1;\n\t\t\t\t\tbackground: ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .play-pause-area {\n\t\t\t\t\tposition: sticky;\n\t\t\t\t\ttop: 22px;\n\t\t\t\t\tz-index: 1;\n\t\t\t\t\tbackground: ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .menu-area {\n\t\t\t\t\tposition: sticky;\n\t\t\t\t\ttop: 82px;\n\t\t\t\t\tz-index: 1;\n\t\t\t\t\tbackground: ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t.beepboxEditor .barScrollBar {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackContainer {\n\t\t\t\t\toverflow: visible;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer {\n\t\t\t\t\tscrollbar-width: auto;\n\t\t\t\t\tscrollbar-color: ${ColorConfig.uiWidgetBackground} ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer::-webkit-scrollbar {\n\t\t\t\t\twidth: 20px;\n\t\t\t\t\theight: 20px;\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer::-webkit-scrollbar-track {\n\t\t\t\t\tbackground: ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer::-webkit-scrollbar-thumb {\n\t\t\t\t\tbackground-color: ${ColorConfig.uiWidgetBackground};\n\t\t\t\t\tborder: 3px solid ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t\t.beepboxEditor .trackAndMuteContainer::-webkit-scrollbar-corner {\n\t\t\t\t\tbackground-color: ${ColorConfig.editorBackground};\n\t\t\t\t}\n\t\t\t}\n\t\t`,\n\t}\n\t\n\tprivate static readonly _styleElement: HTMLStyleElement = document.head.appendChild(HTML.style({type: \"text/css\"}));\n\t\n\tpublic static setLayout(layout: string): void {\n\t\tthis._styleElement.textContent = this._layoutMap[layout];\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\n// interface shared by number[], Float32Array, and other typed arrays in JavaScript.\ninterface NumberArray {\n\tlength: number;\n\t[index: number]: number;\n}\n\n// A basic FFT operation scales the overall magnitude of elements by the\n// square root of the length of the array, √N. Performing a forward FFT and\n// then an inverse FFT results in the original array, but multiplied by N.\n// This helper function can be used to compensate for that. \nexport function scaleElementsByFactor(array: NumberArray, factor: number): void {\n\tfor (let i: number = 0; i < array.length; i++) {\n\t\tarray[i] *= factor;\n\t}\n}\n\nfunction isPowerOf2(n: number): boolean {\n\treturn !!n && !(n & (n - 1));\n}\n\nfunction countBits(n: number): number {\n\tif (!isPowerOf2(n)) throw new Error(\"FFT array length must be a power of 2.\");\n\treturn Math.round(Math.log(n) / Math.log(2));\n}\n\n// Rearranges the elements of the array, swapping the element at an index\n// with an element at an index that is the bitwise reverse of the first\n// index in base 2. Useful for computing the FFT.\nfunction reverseIndexBits(array: NumberArray, fullArrayLength: number): void {\n\tconst bitCount: number = countBits(fullArrayLength);\n\tif (bitCount > 16) throw new Error(\"FFT array length must not be greater than 2^16.\");\n\tconst finalShift: number = 16 - bitCount;\n\tfor (let i: number = 0; i < fullArrayLength; i++) {\n\t\t// Dear Javascript: Please support bit order reversal intrinsics. Thanks! :D\n\t\tlet j: number;\n\t\tj = ((i & 0xaaaa) >> 1) | ((i & 0x5555) << 1);\n\t\tj = ((j & 0xcccc) >> 2) | ((j & 0x3333) << 2);\n\t\tj = ((j & 0xf0f0) >> 4) | ((j & 0x0f0f) << 4);\n\t\tj = ((j           >> 8) | ((j &   0xff) << 8)) >> finalShift;\n\t\tif (j > i) {\n\t\t\tlet temp: number = array[i];\n\t\t\tarray[i] = array[j];\n\t\t\tarray[j] = temp;\n\t\t}\n\t}\n}\n\n// Provided for educational purposes. Easier to read than\n// fastFourierTransform(), but computes the same result.\n// Takes two parallel arrays representing the real and imaginary elements,\n// respectively, and returns an array containing two new arrays, which\n// contain the complex result of the transform.\nexport function discreteFourierTransform(realArray: NumberArray, imagArray: NumberArray): number[][] {\n\tconst fullArrayLength: number = realArray.length;\n\tif (fullArrayLength != imagArray.length) throw new Error(\"FFT arrays must be the same length.\");\n\tconst realOut: number[] = [];\n\tconst imagOut: number[] = [];\n\tfor (let i: number = 0; i < fullArrayLength; i++) {\n\t\trealOut[i] = 0.0;\n\t\timagOut[i] = 0.0;\n\t\tfor (let j: number = 0; j < fullArrayLength; j++) {\n\t\t\tconst radians: number = -6.2831853 * j * i / fullArrayLength;\n\t\t\tconst c: number = Math.cos(radians);\n\t\t\tconst s: number = Math.sin(radians);\n\t\t\trealOut[i] += realArray[j] * c - imagArray[j] * s;\n\t\t\timagOut[i] += realArray[j] * s + imagArray[j] * c;\n\t\t}\n\t}\n\treturn [realOut, imagOut];\n}\n\n// Performs a Fourier transform in O(N log(N)) operations. Overwrites the\n// input real and imaginary arrays. Can be used for both forward and inverse\n// transforms: swap the order of the arguments for the inverse.\nexport function fastFourierTransform(realArray: NumberArray, imagArray: NumberArray): void {\n\tconst fullArrayLength: number = realArray.length;\n\tif (!isPowerOf2(fullArrayLength)) throw new Error(\"FFT array length must be a power of 2.\");\n\tif (fullArrayLength < 4) throw new Error(\"FFT array length must be at least 4.\");\n\tif (fullArrayLength != imagArray.length) throw new Error(\"FFT arrays must be the same length.\");\n\t\n\treverseIndexBits(realArray, fullArrayLength);\n\treverseIndexBits(imagArray, fullArrayLength);\n\t\n\t// First two passes, with strides of 2 and 4, can be combined and optimized.\n\tfor (let startIndex: number = 0; startIndex < fullArrayLength; startIndex += 4) {\n\t\tconst startIndex1: number = startIndex + 1;\n\t\tconst startIndex2: number = startIndex + 2;\n\t\tconst startIndex3: number = startIndex + 3;\n\t\tconst real0: number = realArray[startIndex ];\n\t\tconst real1: number = realArray[startIndex1];\n\t\tconst real2: number = realArray[startIndex2];\n\t\tconst real3: number = realArray[startIndex3];\n\t\tconst imag0: number = imagArray[startIndex ];\n\t\tconst imag1: number = imagArray[startIndex1];\n\t\tconst imag2: number = imagArray[startIndex2];\n\t\tconst imag3: number = imagArray[startIndex3];\n\t\tconst realTemp0: number = real0 + real1;\n\t\tconst realTemp1: number = real0 - real1;\n\t\tconst realTemp2: number = real2 + real3;\n\t\tconst realTemp3: number = real2 - real3;\n\t\tconst imagTemp0: number = imag0 + imag1;\n\t\tconst imagTemp1: number = imag0 - imag1;\n\t\tconst imagTemp2: number = imag2 + imag3;\n\t\tconst imagTemp3: number = imag2 - imag3;\n\t\trealArray[startIndex ] = realTemp0 + realTemp2;\n\t\trealArray[startIndex1] = realTemp1 + imagTemp3;\n\t\trealArray[startIndex2] = realTemp0 - realTemp2;\n\t\trealArray[startIndex3] = realTemp1 - imagTemp3;\n\t\timagArray[startIndex ] = imagTemp0 + imagTemp2;\n\t\timagArray[startIndex1] = imagTemp1 - realTemp3;\n\t\timagArray[startIndex2] = imagTemp0 - imagTemp2;\n\t\timagArray[startIndex3] = imagTemp1 + realTemp3;\n\t}\n\t\n\tfor (let stride: number = 8; stride <= fullArrayLength; stride += stride) {\n\t\tconst halfLength: number = stride >>> 1;\n\t\tconst radiansIncrement: number = Math.PI * 2.0 / stride;\n\t\tconst cosIncrement: number = Math.cos(radiansIncrement);\n\t\tconst sinIncrement: number = Math.sin(radiansIncrement);\n\t\tconst oscillatorMultiplier: number = 2.0 * cosIncrement;\n\t\tfor (let startIndex: number = 0; startIndex < fullArrayLength; startIndex += stride) {\n\t\t\tlet c: number = 1.0;\n\t\t\tlet s: number = 0.0;\n\t\t\tlet cPrev: number = cosIncrement;\n\t\t\tlet sPrev: number = sinIncrement;\n\t\t\tconst secondHalf: number = startIndex + halfLength;\n\t\t\tfor (let i: number = startIndex; i < secondHalf; i++) {\n\t\t\t\tconst j: number = i + halfLength;\n\t\t\t\tconst real0: number = realArray[i];\n\t\t\t\tconst imag0: number = imagArray[i];\n\t\t\t\tconst real1: number = realArray[j] * c - imagArray[j] * s;\n\t\t\t\tconst imag1: number = realArray[j] * s + imagArray[j] * c;\n\t\t\t\trealArray[i] = real0 + real1;\n\t\t\t\timagArray[i] = imag0 + imag1;\n\t\t\t\trealArray[j] = real0 - real1;\n\t\t\t\timagArray[j] = imag0 - imag1;\n\t\t\t\tconst cTemp: number = oscillatorMultiplier * c - cPrev;\n\t\t\t\tconst sTemp: number = oscillatorMultiplier * s - sPrev;\n\t\t\t\tcPrev = c;\n\t\t\t\tsPrev = s;\n\t\t\t\tc = cTemp;\n\t\t\t\ts = sTemp;\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Computes the Fourier transform from an array of real-valued time-domain\n// samples. The output is specially formatted for space efficieny: elements\n// 0 through N/2 represent cosine wave amplitudes in ascending frequency,\n// and elements N/2+1 through N-1 represent sine wave amplitudes in\n// descending frequency. Overwrites the input array.\nexport function forwardRealFourierTransform(array: NumberArray): void {\n\tconst fullArrayLength: number = array.length;\n\tconst totalPasses: number = countBits(fullArrayLength);\n\tif (fullArrayLength < 4) throw new Error(\"FFT array length must be at least 4.\");\n\t\n\treverseIndexBits(array, fullArrayLength);\n\t\n\t// First and second pass.\n\tfor (let index: number = 0; index < fullArrayLength; index += 4) {\n\t\tconst index1: number = index + 1;\n\t\tconst index2: number = index + 2;\n\t\tconst index3: number = index + 3;\n\t\tconst real0: number = array[index ];\n\t\tconst real1: number = array[index1];\n\t\tconst real2: number = array[index2];\n\t\tconst real3: number = array[index3];\n\t\t// no imaginary elements yet since the input is fully real.\n\t\tconst tempA: number = real0 + real1;\n\t\tconst tempB: number = real2 + real3;\n\t\tarray[index ] = tempA + tempB;\n\t\tarray[index1] = real0 - real1;\n\t\tarray[index2] = tempA - tempB;\n\t\tarray[index3] = real2 - real3;\n\t}\n\t\n\t// Third pass.\n\tconst sqrt2over2: number = Math.sqrt(2.0) / 2.0;\n\tfor (let index: number = 0; index < fullArrayLength; index += 8) {\n\t\tconst index1: number = index + 1;\n\t\tconst index3: number = index + 3;\n\t\tconst index4: number = index + 4;\n\t\tconst index5: number = index + 5;\n\t\tconst index7: number = index + 7;\n\t\tconst real0: number = array[index ];\n\t\tconst real1: number = array[index1];\n\t\tconst imag3: number = array[index3];\n\t\tconst real4: number = array[index4];\n\t\tconst real5: number = array[index5];\n\t\tconst imag7: number = array[index7];\n\t\tconst tempA: number = (real5 - imag7) * sqrt2over2;\n\t\tconst tempB: number = (real5 + imag7) * sqrt2over2;\n\t\tarray[index ] = real0 + real4;\n\t\tarray[index1] = real1 + tempA;\n\t\tarray[index3] = real1 - tempA;\n\t\tarray[index4] = real0 - real4;\n\t\tarray[index5] = tempB - imag3;\n\t\tarray[index7] = tempB + imag3;\n\t}\n\t\n\t// Handle remaining passes.\n\tfor (let pass: number = 3; pass < totalPasses; pass++) {\n\t\tconst subStride: number = 1 << pass;\n\t\tconst midSubStride: number = subStride >> 1;\n\t\tconst stride: number = subStride << 1;\n\t\tconst radiansIncrement: number = Math.PI * 2.0 / stride;\n\t\tconst cosIncrement: number = Math.cos(radiansIncrement);\n\t\tconst sinIncrement: number = Math.sin(radiansIncrement);\n\t\tconst oscillatorMultiplier: number = 2.0 * cosIncrement;\n\t\tfor (let startIndex: number = 0; startIndex < fullArrayLength; startIndex += stride) {\n\t\t\tconst startIndexA: number = startIndex;\n\t\t\tconst startIndexB: number = startIndexA + subStride;\n\t\t\tconst stopIndex: number = startIndexB + subStride;\n\t\t\tconst realStartA: number = array[startIndexA];\n\t\t\tconst realStartB: number = array[startIndexB];\n\t\t\tarray[startIndexA] = realStartA + realStartB;\n\t\t\tarray[startIndexB] = realStartA - realStartB;\n\t\t\tlet c: number = cosIncrement;\n\t\t\tlet s: number = -sinIncrement;\n\t\t\tlet cPrev: number = 1.0;\n\t\t\tlet sPrev: number = 0.0;\n\t\t\tfor (let index: number = 1; index < midSubStride; index++) {\n\t\t\t\tconst indexA0: number = startIndexA + index;\n\t\t\t\tconst indexA1: number = startIndexB - index;\n\t\t\t\tconst indexB0: number = startIndexB + index;\n\t\t\t\tconst indexB1: number = stopIndex   - index;\n\t\t\t\tconst real0: number = array[indexA0];\n\t\t\t\tconst imag0: number = array[indexA1];\n\t\t\t\tconst real1: number = array[indexB0];\n\t\t\t\tconst imag1: number = array[indexB1];\n\t\t\t\tconst tempA: number = real1 * c + imag1 * s;\n\t\t\t\tconst tempB: number = real1 * s - imag1 * c;\n\t\t\t\tarray[indexA0] = real0 + tempA;\n\t\t\t\tarray[indexA1] = real0 - tempA;\n\t\t\t\tarray[indexB0] =-imag0 - tempB;\n\t\t\t\tarray[indexB1] = imag0 - tempB;\n\t\t\t\tconst cTemp: number = oscillatorMultiplier * c - cPrev;\n\t\t\t\tconst sTemp: number = oscillatorMultiplier * s - sPrev;\n\t\t\t\tcPrev = c;\n\t\t\t\tsPrev = s;\n\t\t\t\tc = cTemp;\n\t\t\t\ts = sTemp;\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Computes the inverse Fourier transform from a specially formatted array of\n// scalar values. Elements 0 through N/2 are expected to be the real values of\n// the corresponding complex elements, representing cosine wave amplitudes in\n// ascending frequency, and elements N/2+1 through N-1 correspond to the\n// imaginary values, representing sine wave amplitudes in descending frequency.\n// Generates real-valued time-domain samples. Overwrites the input array.\nexport function inverseRealFourierTransform(array: NumberArray, fullArrayLength: number): void {\n\tconst totalPasses: number = countBits(fullArrayLength);\n\tif (fullArrayLength < 4) throw new Error(\"FFT array length must be at least 4.\");\n\n\t// Perform all but the last few passes in reverse.\n\tfor (let pass: number = totalPasses - 1; pass >= 2; pass--) {\n\t\tconst subStride: number = 1 << pass;\n\t\tconst midSubStride: number = subStride >> 1;\n\t\tconst stride: number = subStride << 1;\n\t\tconst radiansIncrement: number = Math.PI * 2.0 / stride;\n\t\tconst cosIncrement: number = Math.cos(radiansIncrement);\n\t\tconst sinIncrement: number = Math.sin(radiansIncrement);\n\t\tconst oscillatorMultiplier: number = 2.0 * cosIncrement;\n\t\t\n\t\tfor (let startIndex: number = 0; startIndex < fullArrayLength; startIndex += stride) {\n\t\t\tconst startIndexA: number = startIndex;\n\t\t\tconst midIndexA: number = startIndexA + midSubStride;\n\t\t\tconst startIndexB: number = startIndexA + subStride;\n\t\t\tconst midIndexB: number = startIndexB + midSubStride;\n\t\t\tconst stopIndex: number = startIndexB + subStride;\n\t\t\tconst realStartA: number = array[startIndexA];\n\t\t\tconst imagStartB: number = array[startIndexB];\n\t\t\tarray[startIndexA] = realStartA + imagStartB;\n\t\t\tarray[midIndexA] *= 2;\n\t\t\tarray[startIndexB] = realStartA - imagStartB;\n\t\t\tarray[midIndexB] *= 2;\n\t\t\tlet c: number = cosIncrement;\n\t\t\tlet s: number = -sinIncrement;\n\t\t\tlet cPrev: number = 1.0;\n\t\t\tlet sPrev: number = 0.0;\n\t\t\tfor (let index: number = 1; index < midSubStride; index++) {\n\t\t\t\tconst indexA0: number = startIndexA + index;\n\t\t\t\tconst indexA1: number = startIndexB - index;\n\t\t\t\tconst indexB0: number = startIndexB + index;\n\t\t\t\tconst indexB1: number = stopIndex   - index;\n\t\t\t\tconst real0: number = array[indexA0];\n\t\t\t\tconst real1: number = array[indexA1];\n\t\t\t\tconst imag0: number = array[indexB0];\n\t\t\t\tconst imag1: number = array[indexB1];\n\t\t\t\tconst tempA: number = real0 - real1;\n\t\t\t\tconst tempB: number = imag0 + imag1;\n\t\t\t\tarray[indexA0] = real0 + real1;\n\t\t\t\tarray[indexA1] = imag1 - imag0;\n\t\t\t\tarray[indexB0] = tempA * c - tempB * s;\n\t\t\t\tarray[indexB1] = tempB * c + tempA * s;\n\t\t\t\tconst cTemp: number = oscillatorMultiplier * c - cPrev;\n\t\t\t\tconst sTemp: number = oscillatorMultiplier * s - sPrev;\n\t\t\t\tcPrev = c;\n\t\t\t\tsPrev = s;\n\t\t\t\tc = cTemp;\n\t\t\t\ts = sTemp;\n\t\t\t}\n\t\t}\n\t}\n\t/*\n\t// Commented out this block (and compensated with an extra pass above)\n\t// because it's slower in my testing so far.\n\t// Pass with stride 8.\n\tconst sqrt2over2: number = Math.sqrt(2.0) / 2.0;\n\tfor (let index: number = 0; index < fullArrayLength; index += 8) {\n\t\tconst index1: number = index + 1;\n\t\tconst index2: number = index + 2;\n\t\tconst index3: number = index + 3;\n\t\tconst index4: number = index + 4;\n\t\tconst index5: number = index + 5;\n\t\tconst index6: number = index + 6;\n\t\tconst index7: number = index + 7;\n\t\tconst real0: number = array[index ];\n\t\tconst real1: number = array[index1];\n\t\tconst real2: number = array[index2];\n\t\tconst real3: number = array[index3];\n\t\tconst imag4: number = array[index4];\n\t\tconst imag5: number = array[index5];\n\t\tconst imag6: number = array[index6];\n\t\tconst imag7: number = array[index7];\n\t\tconst tempA: number = real1 - real3;\n\t\tconst tempB: number = imag5 + imag7;\n\t\tarray[index ] = real0 + imag4;\n\t\tarray[index1] = real1 + real3;\n\t\tarray[index2] = real2 * 2;\n\t\tarray[index3] = imag7 - imag5;\n\t\tarray[index4] = real0 - imag4;\n\t\tarray[index5] = (tempA + tempB) * sqrt2over2;\n\t\tarray[index6] = imag6 * 2;\n\t\tarray[index7] = (tempB - tempA) * sqrt2over2;\n\t}\n\t*/\n\t// The final passes with strides 4 and 2, combined into one loop.\n\tfor (let index: number = 0; index < fullArrayLength; index += 4) {\n\t\tconst index1: number = index + 1;\n\t\tconst index2: number = index + 2;\n\t\tconst index3: number = index + 3;\n\t\tconst real0: number = array[index ];\n\t\tconst real1: number = array[index1] * 2;\n\t\tconst imag2: number = array[index2];\n\t\tconst imag3: number = array[index3] * 2;\n\t\tconst tempA: number = real0 + imag2;\n\t\tconst tempB: number = real0 - imag2;\n\t\tarray[index ] = tempA + real1;\n\t\tarray[index1] = tempA - real1;\n\t\tarray[index2] = tempB + imag3;\n\t\tarray[index3] = tempB - imag3;\n\t}\n\t\n\treverseIndexBits(array, fullArrayLength);\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\r\n\r\nexport class Deque<T> {\r\n\tprivate _capacity: number = 1;\r\n\tprivate _buffer: Array<T | undefined> = [undefined];\r\n\tprivate _mask: number = 0;\r\n\tprivate _offset: number = 0;\r\n\tprivate _count: number = 0;\r\n\r\n\tpublic pushFront(element: T): void {\r\n\t\tif (this._count >= this._capacity) this._expandCapacity();\r\n\t\tthis._offset = (this._offset - 1) & this._mask;\r\n\t\tthis._buffer[this._offset] = element;\r\n\t\tthis._count++;\r\n\t}\r\n\tpublic pushBack(element: T): void {\r\n\t\tif (this._count >= this._capacity) this._expandCapacity();\r\n\t\tthis._buffer[(this._offset + this._count) & this._mask] = element;\r\n\t\tthis._count++;\r\n\t}\r\n\tpublic popFront(): T {\r\n\t\tif (this._count <= 0) throw new Error(\"No elements left to pop.\");\r\n\t\tconst element: T = <T>this._buffer[this._offset];\r\n\t\tthis._buffer[this._offset] = undefined;\r\n\t\tthis._offset = (this._offset + 1) & this._mask;\r\n\t\tthis._count--;\r\n\t\treturn element;\r\n\t}\r\n\tpublic popBack(): T {\r\n\t\tif (this._count <= 0) throw new Error(\"No elements left to pop.\");\r\n\t\tthis._count--;\r\n\t\tconst index: number = (this._offset + this._count) & this._mask;\r\n\t\tconst element: T = <T>this._buffer[index];\r\n\t\tthis._buffer[index] = undefined;\r\n\t\treturn element;\r\n\t}\r\n\tpublic peakFront(): T {\r\n\t\tif (this._count <= 0) throw new Error(\"No elements left to pop.\");\r\n\t\treturn <T>this._buffer[this._offset];\r\n\t}\r\n\tpublic peakBack(): T {\r\n\t\tif (this._count <= 0) throw new Error(\"No elements left to pop.\");\r\n\t\treturn <T>this._buffer[(this._offset + this._count - 1) & this._mask];\r\n\t}\r\n\tpublic count(): number {\r\n\t\treturn this._count;\r\n\t}\r\n\tpublic set(index: number, element: T): void {\r\n\t\tif (index < 0 || index >= this._count) throw new Error(\"Invalid index\");\r\n\t\tthis._buffer[(this._offset + index) & this._mask] = element;\r\n\t}\r\n\tpublic get(index: number): T {\r\n\t\tif (index < 0 || index >= this._count) throw new Error(\"Invalid index\");\r\n\t\treturn <T>this._buffer[(this._offset + index) & this._mask];\r\n\t}\r\n\tpublic remove(index: number): void {\r\n\t\tif (index < 0 || index >= this._count) throw new Error(\"Invalid index\");\r\n\t\tif (index <= (this._count >> 1)) {\r\n\t\t\twhile (index > 0) {\r\n\t\t\t\tthis.set(index, this.get(index - 1));\r\n\t\t\t\tindex--;\r\n\t\t\t}\r\n\t\t\tthis.popFront();\r\n\t\t} else {\r\n\t\t\tindex++;\r\n\t\t\twhile (index < this._count) {\r\n\t\t\t\tthis.set(index - 1, this.get(index));\r\n\t\t\t\tindex++;\r\n\t\t\t}\r\n\t\t\tthis.popBack();\r\n\t\t}\r\n\t}\r\n\tprivate _expandCapacity(): void {\r\n\t\tif (this._capacity >= 0x40000000) throw new Error(\"Capacity too big.\");\r\n\t\tthis._capacity = this._capacity << 1;\r\n\t\tconst oldBuffer: Array<T | undefined> = this._buffer;\r\n\t\tconst newBuffer: Array<T | undefined> = new Array(this._capacity);\r\n\t\tconst size: number = this._count | 0;\r\n\t\tconst offset: number = this._offset | 0;\r\n\t\tfor (let i = 0; i < size; i++) {\r\n\t\t\tnewBuffer[i] = oldBuffer[(offset + i) & this._mask];\r\n\t\t}\r\n\t\tfor (let i = size; i < this._capacity; i++) {\r\n\t\t\tnewBuffer[i] = undefined;\r\n\t\t}\r\n\t\tthis._offset = 0;\r\n\t\tthis._buffer = newBuffer;\r\n\t\tthis._mask = this._capacity - 1;\r\n\t}\r\n}\r\n","/*\nThis file contains code to compute digital audio filter coefficients based on\nthe desired type, cutoff frequency, and other parameters. You can use these\ncoefficients to apply the filter to audio samples. It also contains code to\nanalyze these filters, which is useful for graphically displaying their effects.\n\nAll of the filters in this file are known as \"Infinite Impulse Response\" or IIR\nfilters, because older output samples contribute feedback to newer output\nsamples and thus contribute to all future samples, although typically filters\nare design to reduce the contribution of older samples over time.\n\nLow-pass filters aka high-cut filters preserve audio signals below the cutoff\nfrequency, and attenuate audio signals above the cutoff frequency. High-pass\nfilters aka low-cut filters are the reverse. All-pass filters do not affect the\nvolume of the signal at all but induce phase changes above the cutoff frequency.\nPeak/Notch filters maintain the volume on either side of the cutoff frequency,\nbut raise or lower the volume at that frequency. \n\nThe number of old samples used in the filter determines the \"order\" of the\nfilter. First-order filters generally have shallower slopes, and second-order\nfilters generally have steeper slopes and can be configured to \"resonate\",\nmeaning they have a louder peak at the cutoff frequency. This file contains\nfirst-order filters and second-order filters, meaning one or two older samples\nare involved, as well as the current input sample.\n\nThe class FilterCoefficients is defined lower in this file. You can use it to\nset up a first order filter like this:\n\n\tconst cutoffRadiansPerSample: number = 2 * Math.PI * cutoffHz / sampleRate;\n\tconst filter: FilterCoefficients = new FilterCoefficients();\n\tfilter.lowPass1stOrderButterworth(cutoffRadiansPerSample);\n\t// output sample coefficients are conventionally called a0, a1, etc. Note\n\t// that a[0] is typically normalized to 1.0 and need not be used directly.\n\tconst a: number[] = filter.a;\n\t// input sample coefficients are conventionally called b0, b1, etc\n\tconst b: number[] = filter.b;\n\t// filter input samples, x[0] is the most recent, x[1] is the previous one, etc.\n\tconst x: number[] = [0, 0, 0];\n\t// filter output samples, y[0] will be computed by the filter based on input\n\t// samples and older output samples.\n\tconst y: number[] = [0, 0, 0];\n\nThen to apply the first-order filter to samples inside a loop, using the current\ninput sample (x[0]) as well as previous input and output samples, do this:\n\n\t// Compute the next output sample y[0]:\n\ty[0] = b[0] * x[0] + b[1] * x[1] - a[1] * y[1];\n\t// Remember the input and output samples for next time:\n\tx[1] = x[0];\n\ty[1] = y[0];\n\n2nd order filters are similar, but have more parameters and require more old\nsamples:\n\n\t// Compute the next output sample y[0]:\n\ty[0] = b[0] * x[0] + b[1] * x[1] + b[2] * x[2] - a[1] * y[1] - a[2] * y[2];\n\t// Remember the input and output samples for next time:\n\tx[2] = x[1];\n\tx[1] = x[0];\n\ty[2] = y[1];\n\ty[1] = y[0];\n\nYou can compose multiple filters into a higher order filter, although doing so\nreduces the numerical stability of the filter:\n\n\tfilter3.combination(filter1, filter2);\n\t// filter3.order will equal: filter1.order + filter2.order\n\t// The number of coefficients in filter3.a and filter3.b will be: order + 1\n\nThis file also contains a class called FrequencyResponse. You can use it to\ndetermine how much gain or attenuation a filter would apply to sounds at a\nspecific input frequency, as well as the phase offset:\n\n\tconst inputRadians: number = 2 * Math.PI * cutoffHz / sampleRate;\n\tconst response: FrequencyResponse = new FrequencyResponse();\n\tresponse.analyze(filter, inputRadians);\n\tconst gainResponse = response.magnitude();\n\tconst phaseResponse = response.angle();\n\nThat's basically all you need to know to use this code, but I'll also explain\nhow the analysis works.\n\nA first-order digital IIR filter is ordinarily implemented in a form like this:\n\n\toutput = inputCoeff * input + prevInputCoeff * prevInput - prevOutputCoeff * prevOutput;\n\nIf we adopt standard naming conventions for audio filters, this same code would\ninstead look like:\n\n\t// x0 = current input, x1 = prevInput, y0 = current output, y1 = prevOutput\n\ty0 = b0*x0 + b1*x1 - a1*y1;\n\nLeaving behind the world of code for a moment and entering the world of algebra,\nwe can rewrite this equation by moving all the output terms to the left side,\nand we can add a coefficient to the y0 term called a0 (which is typically\nnormalized to 1.0, which is why I didn't bother including it until now):\n\n\ta0*y0 + a1*y1 = b0*x0 + b1*x1\n\nThis is known as the symmetrical form of the filter, and it will help us analyze\nthe impact of the filter on an input audio signal. Here's a lesson that helped\nme understand the symmetrical form:\nhttps://web.archive.org/web/20200626183458/http://123.physics.ucdavis.edu/week_5_files/filters/digital_filter.pdf\n\nThe end of that lesson introduces a concept called the \"delay operator\" which\nlooks like \"z^-1\", which (magically) turns a sample into the previous sample\nwhen you multiply them. For example:\n\n\tx0 * z^-1 = x1\n\nThe lesson doesn't explain how it actually works. Audio signals aren't always\npredictable, which means that you generally can't do math on a single sample to\ncompute what the previous sample was. However, some audio signals ARE\npredictable, such as pure sine waves. Fortunately, all audio signals can be\nbroken down into a sum of independent sine waves. We can pick one sine wave at a\ntime, and use it to analyze the filter's impact on waves at that frequency. In\npractice, this tells us what the filter will do to unpredictable input samples\nthat contain a partial sine wave at that frequency.\n\nTechnically, you can't just use a single sine wave sample to determine the\nprevious sine wave sample, because each possible value is passed going upwards\nand downwards once per period and the direction is ambigous. This is where we\nneed to move into the complex number domain, where the real and imaginary\ncomponents can provide enough information to compute the previous position on\nthe input signal. So now instead of talking about sine waves, we're talking\nabout waves where the imaginary component is a sine wave and the real component\nis a cosine wave at the same frequency. Together, they trace around a unit\ncircle in the complex domain, and each sample is just a consistent rotation\napplied to the previous sample. The \"delay operator\" described above, z^-1, is\nthis same rotation applied in reverse, and it can be computed as:\n\n\tz^-1 = cos(radiansPerSample) - i * sin(radiansPerSample)\n\nMath nerds may be interested to know that \"Euler's formula\" was used here, but\nexplaining what that means is probably beyond the scope of this documentation\naside from noting that a complex number on the unit circle represents a 2D\nrotation that you can apply via multiplication.\n\nNow we can rewrite the symmetrical form using the delay operator and algebra:\n\n\ta0*y0 + a1*y0*z^-1 = b0*x0 + b1*x0*z^-1\n\ty0 * (a0 + a1*z^-1) = x0 * (b0 + b1*z^-1)\n\ty0 = x0 * (b0 + b1*z^-1) / (a0 + a1*z^-1)\n\ty0 / x0 = (b0 + b1*z^-1) / (a0 + a1*z^-1)\n\nThat last equation expresses the relationship between the input and output\nsignals (y0/x0) in terms of the filter coefficients and delay operator. At this\npoint, the specific values of the input and output samples don't even matter!\nThis is called the \"transfer function\", and it's conventionally named \"H(z)\":\n\n\tH(z) = (b0 + b1*z^-1) / (a0 + a1*z^-1)\n\nIf you plug in actual filter coefficients and express the delay operators as\ncomplex numbers with the appropriate trigonometry functions, the transfer\nfunction can be computed and produces a complex number that represents the\nrelationship between the input and output signals, whose magnitude represents\nthe volume gain (or attenuation) of signals at that frequency, and whose angle\nrepresents how much phase shift is applied by the filter to signals at that\nfrequency.\n\n(Note that in order to compute the transfer function, you'll need to do\nsomething about the complex number in the denominator. It turns out you can turn\nthe denominator into a real number by multiplying both the numerator and\ndenominator by the complex conjugate of the denominator, which is just the\ndenominator with the imaginary component negated.)\n\nFinally, I'll list some of the links that helped me understand filters and\nprovided some of the algorithms I that use here.\n\nHere's where I found accurate 2nd order low-pass and high-pass digital filters:\nhttps://web.archive.org/web/20120531011328/http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt\n\nThis page is how I found a link to the cookbook article above. It claims these\nfilters are Butterworth filters:\nhttp://web.archive.org/web/20191213120120/https://crypto.stanford.edu/~blynn/sound/analog.html\n\nI found the first-order digital Butterworth filter coefficients at:\nhttps://www.researchgate.net/publication/338022014_Digital_Implementation_of_Butterworth_First-Order_Filter_Type_IIR\n\nThis meta-paper helped me understand how to make 2nd order peak/notch filters:\nhttps://web.archive.org/web/20170706085655/https://www.thesounddesign.com/MIO/EQ-Coefficients.pdf\n\nBeepBox originally used simpler low-pass filters that I adapted from SFXR:\nhttps://www.drpetter.se/project_sfxr.html\nFor low cutoff frequencies, the simpler filters and the Butterworth filters are\nnearly identical, but when closer to the nyquist frequency the simpler filters\ncreate extra resonance.\n*/\n\nexport class FilterCoefficients {\n\tpublic readonly a: number[] = [1.0]; // output coefficients (negated, keep a[0]=1)\n\tpublic readonly b: number[] = [1.0]; // input coefficients\n\tpublic order: number = 0;\n\t\n\tpublic linearGain0thOrder(linearGain: number): void {\n\t\t//a[0] = 1.0; // a0 should always be normalized to 1.0, no need to assign it directly.\n\t\tthis.b[0] = linearGain;\n\t\tthis.order = 0;\n\t}\n\t\n\tpublic lowPass1stOrderButterworth(cornerRadiansPerSample: number): void {\n\t\t// First-order Butterworth low-pass filter according to:\n\t\t// https://www.researchgate.net/publication/338022014_Digital_Implementation_of_Butterworth_First-Order_Filter_Type_IIR\n\t\t// A butterworth filter is one where the amplitude response is equal to:\n\t\t// 1 / √(1 + (freq / cutoffFreq)^(2 * order))\n\t\tconst g: number = 1.0 / Math.tan(cornerRadiansPerSample * 0.5);\n\t\tconst a0: number = 1.0 + g;\n\t\tthis.a[1] = (1.0 - g) / a0;\n\t\tthis.b[1] = this.b[0] = 1 / a0;\n\t\tthis.order = 1;\n\t}\n\t\n\tpublic lowPass1stOrderSimplified(cornerRadiansPerSample: number): void {\n\t\t// The output of this filter is nearly identical to the 1st order\n\t\t// Butterworth low-pass above, except if the cutoff is set to nyquist/3,\n\t\t// then the output is the same as the input, and if the cutoff is higher\n\t\t// than that, then the output actually resonates at high frequencies\n\t\t// instead of attenuating.\n\t\t// I'm guessing this filter was converted from analog to digital using\n\t\t// the \"matched z-transform\" method instead of the \"bilinear transform\"\n\t\t// method. The difference is that the bilinear transform warps\n\t\t// frequencies so that the lowpass response of zero at analogue ∞hz maps\n\t\t// to the digital nyquist frequency, whereas the matched z-transform\n\t\t// preserves the frequency of the filter response but also adds the\n\t\t// reflected response from above the nyquist frequency.\n\t\tconst g: number = 2.0 * Math.sin(cornerRadiansPerSample * 0.5);\n\t\tthis.a[1] = g - 1.0;\n\t\tthis.b[0] = g;\n\t\tthis.b[1] = 0.0;\n\t\t/*\n\t\t// Alternatively:\n\t\tconst g: number = 1.0 / (2.0 * Math.sin(cornerRadiansPerSample / 2));\n\t\tconst a0: number = g;\n\t\tthis.a[1] = (1.0 - g) / a0;\n\t\tthis.b[0] = 1.0 / a0;\n\t\tthis.b[1] = 0.0 / a0;\n\t\t*/\n\t\tthis.order = 1;\n\t}\n\t\n\tpublic highPass1stOrderButterworth(cornerRadiansPerSample: number): void {\n\t\t// First-order Butterworth high-pass filter according to:\n\t\t// https://www.researchgate.net/publication/338022014_Digital_Implementation_of_Butterworth_First-Order_Filter_Type_IIR\n\t\tconst g: number = 1.0 / Math.tan(cornerRadiansPerSample * 0.5);\n\t\tconst a0: number = 1.0 + g;\n\t\tthis.a[1] = (1.0 - g) / a0;\n\t\tthis.b[0] = g / a0;\n\t\tthis.b[1] = -g / a0;\n\t\tthis.order = 1;\n\t}\n\t/*\n\tpublic highPass1stOrderSimplified(cornerRadiansPerSample: number): void {\n\t\t// The output of this filter is nearly identical to the 1st order\n\t\t// Butterworth high-pass above, except it resonates when the cutoff\n\t\t// appoaches the nyquist.\n\t\tconst g: number = 2.0 * Math.sin(cornerRadiansPerSample * 0.5);\n\t\tthis.a[1] = g - 1.0;\n\t\tthis.b[0] = 1.0;\n\t\tthis.b[1] = -1.0;\n\t\tthis.order = 1;\n\t}\n\t*/\n\tpublic highShelf1stOrder(cornerRadiansPerSample: number, shelfLinearGain: number): void {\n\t\t// I had trouble figuring this one out because I couldn't find any\n\t\t// online algorithms that I understood. There are 3 degrees of freedom\n\t\t// and I could narrow down a couple of them based on the desired gain at\n\t\t// DC and nyquist, but getting the cutoff frequency correct took a\n\t\t// little bit of trial and error in my attempts to interpret page 53 of\n\t\t// this chapter: http://www.music.mcgill.ca/~ich/classes/FiltersChap2.pdf\n\t\t// Obviously I don't fully understand the bilinear transform yet!\n\t\tconst tan: number = Math.tan(cornerRadiansPerSample * 0.5);\n\t\tconst sqrtGain: number = Math.sqrt(shelfLinearGain);\n\t\tconst g: number = (tan * sqrtGain - 1) / (tan * sqrtGain + 1.0);\n\t\tconst a0: number = 1.0;\n\t\tthis.a[1] = g / a0;\n\t\tthis.b[0] = (1.0 + g + shelfLinearGain * (1.0 - g)) / (2.0 * a0);\n\t\tthis.b[1] = (1.0 + g - shelfLinearGain * (1.0 - g)) / (2.0 * a0);\n\t\tthis.order = 1;\n\t}\n\t\n\tpublic allPass1stOrderInvertPhaseAbove(cornerRadiansPerSample: number): void {\n\t\tconst g: number = (Math.sin(cornerRadiansPerSample) - 1.0) / Math.cos(cornerRadiansPerSample);\n\t\tthis.a[1] = g;\n\t\tthis.b[0] = g;\n\t\tthis.b[1] = 1.0;\n\t\tthis.order = 1;\n\t}\n\t\n\t/*\n\t// I haven't found a practical use for this version of the all pass filter.\n\t// It seems to create a weird subharmonic when used in a delay feedback loop.\n\tpublic allPass1stOrderInvertPhaseBelow(cornerRadiansPerSample: number): void {\n\t\tconst g: number = (Math.sin(cornerRadiansPerSample) - 1.0) / Math.cos(cornerRadiansPerSample);\n\t\tthis.a[1] = g;\n\t\tthis.b[0] = -g;\n\t\tthis.b[1] = -1.0;\n\t\tthis.order = 1;\n\t}\n\t*/\n\t\n\tpublic allPass1stOrderFractionalDelay(delay: number) {\n\t\t// Very similar to allPass1stOrderInvertPhaseAbove, but configured\n\t\t// differently and for a different purpose! Useful for interpolating\n\t\t// between samples in a delay line.\n\t\tconst g: number = (1.0 - delay) / (1.0 + delay);\n\t\tthis.a[1] = g;\n\t\tthis.b[0] = g;\n\t\tthis.b[1] = 1.0;\n\t\tthis.order = 1;\n\t}\n\t\n\tpublic lowPass2ndOrderButterworth(cornerRadiansPerSample: number, peakLinearGain: number): void {\n\t\t// This is Butterworth if peakLinearGain=1/√2 according to:\n\t\t// http://web.archive.org/web/20191213120120/https://crypto.stanford.edu/~blynn/sound/analog.html\n\t\t// An interesting property is that if peakLinearGain=1/16 then the\n\t\t// output resembles a first-order lowpass at a cutoff 4 octaves lower,\n\t\t// although it gets distorted near the nyquist.\n\t\tconst alpha: number = Math.sin(cornerRadiansPerSample) / (2.0 * peakLinearGain);\n\t\tconst cos: number = Math.cos(cornerRadiansPerSample);\n\t\tconst a0: number = 1.0 + alpha;\n\t\tthis.a[1] = -2.0*cos / a0;\n\t\tthis.a[2] = (1 - alpha) / a0;\n\t\tthis.b[2] = this.b[0] = (1 - cos) / (2.0*a0);\n\t\tthis.b[1] = (1 - cos) / a0;\n\t\tthis.order = 2;\n\t}\n\t\n\tpublic lowPass2ndOrderSimplified(cornerRadiansPerSample: number, peakLinearGain: number): void {\n\t\t// This filter is adapted from the one in the SFXR source code:\n\t\t// https://www.drpetter.se/project_sfxr.html\n\t\t// The output is nearly identical to the resonant Butterworth low-pass\n\t\t// above, except it resonates too much when the cutoff appoaches the\n\t\t// nyquist. If the resonance is set to zero and the cutoff is set to\n\t\t// nyquist/3, then the output is the same as the input.\n\t\tconst g: number = 2.0 * Math.sin(cornerRadiansPerSample / 2.0);\n\t\tconst filterResonance: number = 1.0 - 1.0 / (2.0 * peakLinearGain);\n\t\tconst feedback: number = filterResonance + filterResonance / (1.0 - g);\n\t\tthis.a[1] = 2.0*g + (g - 1.0) * g*feedback - 2.0;\n\t\tthis.a[2] = (g - 1.0) * (g - g*feedback - 1.0);\n\t\tthis.b[0] = g*g;\n\t\tthis.b[1] = 0;\n\t\tthis.b[2] = 0;\n\t\tthis.order = 2;\n\t}\n\t\n\tpublic highPass2ndOrderButterworth(cornerRadiansPerSample: number, peakLinearGain: number): void {\n\t\tconst alpha: number = Math.sin(cornerRadiansPerSample) / (2 * peakLinearGain);\n\t\tconst cos: number = Math.cos(cornerRadiansPerSample);\n\t\tconst a0: number = 1.0 + alpha;\n\t\tthis.a[1] = -2.0*cos / a0;\n\t\tthis.a[2] = (1.0 - alpha) / a0;\n\t\tthis.b[2] = this.b[0] = (1.0 + cos) / (2.0*a0);\n\t\tthis.b[1] = -(1.0 + cos) / a0;\n\t\tthis.order = 2;\n\t}\n\t/*\n\tpublic highPass2ndOrderSimplified(cornerRadiansPerSample: number, peakLinearGain: number): void {\n\t\tconst g: number = 2.0 * Math.sin(cornerRadiansPerSample * 0.5);\n\t\tconst filterResonance: number = 1.0 - 1.0 / (2.0 * peakLinearGain);\n\t\tconst feedback: number = filterResonance + filterResonance / (1.0 - g);\n\t\tthis.a[1] = 2.0*g + (g - 1.0) * g*feedback - 2.0;\n\t\tthis.a[2] = (g - 1.0) * (g - g*feedback - 1.0);\n\t\tthis.b[0] = 1.0;\n\t\tthis.b[1] = -2.0;\n\t\tthis.b[2] = 1.0;\n\t\tthis.order = 2;\n\t}\n\t*/\n\tpublic peak2ndOrder(cornerRadiansPerSample: number, peakLinearGain: number, bandWidthScale: number): void {\n\t\tconst sqrtGain: number = Math.sqrt(peakLinearGain);\n\t\tconst bandWidth: number = bandWidthScale * cornerRadiansPerSample / (sqrtGain >= 1 ? sqrtGain : 1/sqrtGain);\n\t\t//const bandWidth: number = bandWidthScale * cornerRadiansPerSample / Math.max(sqrtGain, 1.0);\n\t\tconst alpha: number = Math.tan(bandWidth * 0.5);\n\t\tconst a0: number = 1.0 + alpha / sqrtGain;\n\t\tthis.b[0] = (1.0 + alpha * sqrtGain) / a0;\n\t\tthis.b[1] = this.a[1] = -2.0 * Math.cos(cornerRadiansPerSample) / a0;\n\t\tthis.b[2] = (1.0 - alpha * sqrtGain) / a0;\n\t\tthis.a[2] = (1.0 - alpha / sqrtGain) / a0;\n\t\tthis.order = 2;\n\t}\n\t/*\n\t// Create a higher order filter by combining two lower order filters.\n\t// However, making high order filters in this manner results in instability.\n\t// It is recommended to apply the 2nd order filters (biquads) in sequence instead.\n\tpublic combination(filter1: FilterCoefficients, filter2: FilterCoefficients): void {\n\t\tthis.order = filter1.order + filter2.order;\n\t\tfor (let i: number = 0; i <= this.order; i++) {\n\t\t\tthis.a[i] = 0.0;\n\t\t\tthis.b[i] = 0.0;\n\t\t}\n\t\tfor (let i: number = 0; i <= filter1.order; i++) {\n\t\t\tfor (let j: number = 0; j <= filter2.order; j++) {\n\t\t\t\tthis.a[i + j] += filter1.a[i] * filter2.a[j];\n\t\t\t\tthis.b[i + j] += filter1.b[i] * filter2.b[j];\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic scaledDifference(other: FilterCoefficients, scale: number): void {\n\t\tif (other.order != this.order) throw new Error();\n\t\tfor (let i: number = 0; i <= this.order; i++) {\n\t\t\tthis.a[i] = (this.a[i] - other.a[i]) * scale;\n\t\t\tthis.b[i] = (this.b[i] - other.b[i]) * scale;\n\t\t}\n\t}\n\t\n\tpublic copy(other: FilterCoefficients): void {\n\t\tthis.order = other.order;\n\t\tfor (let i: number = 0; i <= this.order; i++) {\n\t\t\tthis.a[i] = other.a[i];\n\t\t\tthis.b[i] = other.b[i];\n\t\t}\n\t}\n\t*/\n}\n\nexport class FrequencyResponse {\n\tpublic real: number = 0.0;\n\tpublic imag: number = 0.0;\n\tpublic denom: number = 1.0;\n\t\n\tpublic analyze(filter: FilterCoefficients, radiansPerSample: number): void {\n\t\tthis.analyzeComplex(filter, Math.cos(radiansPerSample), Math.sin(radiansPerSample));\n\t}\n\t\n\tpublic analyzeComplex(filter: FilterCoefficients, real: number, imag: number): void {\n\t\tconst a: number[] = filter.a;\n\t\tconst b: number[] = filter.b;\n\t\tconst realZ1: number = real;\n\t\tconst imagZ1: number = -imag;\n\t\tlet realNum: number = b[0] + b[1] * realZ1;\n\t\tlet imagNum: number = b[1] * imagZ1;\n\t\tlet realDenom: number = 1.0 + a[1] * realZ1;\n\t\tlet imagDenom: number = a[1] * imagZ1;\n\t\tlet realZ: number = realZ1;\n\t\tlet imagZ: number = imagZ1;\n\t\tfor (let i: number = 2; i <= filter.order; i++) {\n\t\t\tconst realTemp: number = realZ * realZ1 - imagZ * imagZ1;\n\t\t\tconst imagTemp: number = realZ * imagZ1 + imagZ * realZ1;\n\t\t\trealZ = realTemp;\n\t\t\timagZ = imagTemp;\n\t\t\trealNum += b[i] * realZ;\n\t\t\timagNum += b[i] * imagZ;\n\t\t\trealDenom += a[i] * realZ;\n\t\t\timagDenom += a[i] * imagZ;\n\t\t}\n\t\tthis.denom = realDenom * realDenom + imagDenom * imagDenom;\n\t\tthis.real = realNum * realDenom + imagNum * imagDenom;\n\t\tthis.imag = imagNum * realDenom - realNum * imagDenom;\n\t}\n\t\n\tpublic magnitude(): number {\n\t\treturn Math.sqrt(this.real * this.real + this.imag * this.imag) / this.denom;\n\t}\n\t\n\tpublic angle(): number {\n\t\treturn Math.atan2(this.imag, this.real);\n\t}\n}\n\nexport class DynamicBiquadFilter {\n\tpublic a1: number = 0.0;\n\tpublic a2: number = 0.0;\n\tpublic b0: number = 1.0;\n\tpublic b1: number = 0.0;\n\tpublic b2: number = 0.0;\n\tpublic a1Delta: number = 0.0;\n\tpublic a2Delta: number = 0.0;\n\tpublic b0Delta: number = 0.0;\n\tpublic b1Delta: number = 0.0;\n\tpublic b2Delta: number = 0.0;\n\tpublic output1: number = 0.0;\n\tpublic output2: number = 0.0;\n\t\n\t// Some filter types are more stable when interpolating between coefficients\n\t// if the \"b\" coefficient interpolation is multiplicative. Don't enable this\n\t// for filter types where the \"b\" coefficients might change sign!\n\tpublic useMultiplicativeInputCoefficients: boolean = false;\n\t\n\tpublic resetOutput(): void {\n\t\tthis.output1 = 0.0;\n\t\tthis.output2 = 0.0;\n\t}\n\t\n\tpublic loadCoefficientsWithGradient(start: FilterCoefficients, end: FilterCoefficients, deltaRate: number, useMultiplicativeInputCoefficients: boolean): void {\n\t\tif (start.order != 2 || end.order != 2) throw new Error();\n\t\tthis.a1 = start.a[1];\n\t\tthis.a2 = start.a[2];\n\t\tthis.b0 = start.b[0];\n\t\tthis.b1 = start.b[1];\n\t\tthis.b2 = start.b[2];\n\t\tthis.a1Delta = (end.a[1] - start.a[1]) * deltaRate;\n\t\tthis.a2Delta = (end.a[2] - start.a[2]) * deltaRate;\n\t\tif (useMultiplicativeInputCoefficients) {\n\t\t\tthis.b0Delta = Math.pow(end.b[0] / start.b[0], deltaRate);\n\t\t\tthis.b1Delta = Math.pow(end.b[1] / start.b[1], deltaRate);\n\t\t\tthis.b2Delta = Math.pow(end.b[2] / start.b[2], deltaRate);\n\t\t} else {\n\t\t\tthis.b0Delta = (end.b[0] - start.b[0]) * deltaRate;\n\t\t\tthis.b1Delta = (end.b[1] - start.b[1]) * deltaRate;\n\t\t\tthis.b2Delta = (end.b[2] - start.b[2]) * deltaRate;\n\t\t}\n\t\tthis.useMultiplicativeInputCoefficients = useMultiplicativeInputCoefficients;\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Dictionary, DictionaryArray, FilterType, EnvelopeType, InstrumentType, EffectType, NoteAutomationIndex, Transition, Unison, Chord, Vibrato, Envelope, AutomationTarget, Config, getDrumWave, drawNoiseSpectrum, getArpeggioPitchIndex, performIntegral, getPulseWidthRatio, effectsIncludeTransition, effectsIncludeChord, effectsIncludePitchShift, effectsIncludeDetune, effectsIncludeVibrato, effectsIncludeNoteFilter, effectsIncludeDistortion, effectsIncludeBitcrusher, effectsIncludePanning, effectsIncludeChorus, effectsIncludeEcho, effectsIncludeReverb} from \"./SynthConfig\";\nimport {scaleElementsByFactor, inverseRealFourierTransform} from \"./FFT\";\nimport {Deque} from \"./Deque\";\nimport {FilterCoefficients, FrequencyResponse, DynamicBiquadFilter} from \"./filtering\";\n\ndeclare global {\n\tinterface Window {\n\t\tAudioContext: any;\n\t\twebkitAudioContext: any;\n\t}\n}\n\nconst epsilon: number = (1.0e-24); // For detecting and avoiding float denormals, which have poor performance.\n\n// For performance debugging:\n//let samplesAccumulated: number = 0;\n//let samplePerformance: number = 0;\n\nconst enum CharCode {\n\tSPACE = 32,\n\tHASH = 35,\n\tPERCENT = 37,\n\tAMPERSAND = 38,\n\tPLUS = 43,\n\tDASH = 45,\n\tDOT = 46,\n\tNUM_0 = 48,\n\tNUM_1 = 49,\n\tNUM_2 = 50,\n\tNUM_3 = 51,\n\tNUM_4 = 52,\n\tNUM_5 = 53,\n\tNUM_6 = 54,\n\tNUM_7 = 55,\n\tNUM_8 = 56,\n\tNUM_9 = 57,\n\tEQUALS = 61,\n\tA =  65,\n\tB =  66,\n\tC =  67,\n\tD =  68,\n\tE =  69,\n\tF =  70,\n\tG =  71,\n\tH =  72,\n\tI =  73,\n\tJ =  74,\n\tK =  75,\n\tL =  76,\n\tM =  77,\n\tN =  78,\n\tO =  79,\n\tP =  80,\n\tQ =  81,\n\tR =  82,\n\tS =  83,\n\tT =  84,\n\tU =  85,\n\tV =  86,\n\tW =  87,\n\tX =  88,\n\tY =  89,\n\tZ =  90,\n\tUNDERSCORE = 95,\n\ta =  97,\n\tb =  98,\n\tc =  99,\n\td = 100,\n\te = 101,\n\tf = 102,\n\tg = 103,\n\th = 104,\n\ti = 105,\n\tj = 106,\n\tk = 107,\n\tl = 108,\n\tm = 109,\n\tn = 110,\n\to = 111,\n\tp = 112,\n\tq = 113,\n\tr = 114,\n\ts = 115,\n\tt = 116,\n\tu = 117,\n\tv = 118,\n\tw = 119,\n\tx = 120,\n\ty = 121,\n\tz = 122,\n\tLEFT_CURLY_BRACE = 123,\n\tRIGHT_CURLY_BRACE = 125,\n}\n\nconst enum SongTagCode {\n\tbeatCount           = CharCode.a, // added in song url version 2\n\tbars                = CharCode.b, // added in 2\n\tvibrato             = CharCode.c, // added in 2, DEPRECATED\n\tfadeInOut           = CharCode.d, // added in 3 for transition, switched to fadeInOut in 9\n\tloopEnd             = CharCode.e, // added in 2\n\teqFilter            = CharCode.f, // added in 3\n\tbarCount            = CharCode.g, // added in 3\n\tunison              = CharCode.h, // added in 2\n\tinstrumentCount     = CharCode.i, // added in 3\n\tpatternCount        = CharCode.j, // added in 3\n\tkey                 = CharCode.k, // added in 2\n\tloopStart           = CharCode.l, // added in 2\n\treverb              = CharCode.m, // added in 5, DEPRECATED\n\tchannelCount        = CharCode.n, // added in 6\n\tchannelOctave       = CharCode.o, // added in 3\n\tpatterns            = CharCode.p, // added in 2\n\teffects             = CharCode.q, // added in 7\n\trhythm              = CharCode.r, // added in 2\n\tscale               = CharCode.s, // added in 2\n\ttempo               = CharCode.t, // added in 2\n\tpreset              = CharCode.u, // added in 7\n\tvolume              = CharCode.v, // added in 2\n\twave                = CharCode.w, // added in 2\n\t\n\tfilterResonance     = CharCode.y, // added in 7, DEPRECATED\n\tdrumsetEnvelopes    = CharCode.z, // added in 7 for filter envelopes, still used for drumset envelopes\n\talgorithm           = CharCode.A, // added in 6\n\tfeedbackAmplitude   = CharCode.B, // added in 6\n\tchord               = CharCode.C, // added in 7, DEPRECATED\n\t\n\tenvelopes           = CharCode.E, // added in 6 for FM operator envelopes, repurposed in 9 for general envelopes.\n\tfeedbackType        = CharCode.F, // added in 6\n\t\n\tharmonics           = CharCode.H, // added in 7\n\tstringSustain       = CharCode.I, // added in 9\n\t\n\tpan                 = CharCode.L, // added between 8 and 9, DEPRECATED\n\t\n\toperatorAmplitudes  = CharCode.P, // added in 6\n\toperatorFrequencies = CharCode.Q, // added in 6\n\t\n\tspectrum            = CharCode.S, // added in 7\n\tstartInstrument     = CharCode.T, // added in 6\n\t\n\tfeedbackEnvelope    = CharCode.V, // added in 6, DEPRECATED\n\tpulseWidth          = CharCode.W, // added in 7\n}\n\nconst base64IntToCharCode: ReadonlyArray<number> = [48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,45,95];\nconst base64CharCodeToInt: ReadonlyArray<number> = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,62,0,0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0,0,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,0,0,0,0,63,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,0,0,0,0,0]; // 62 could be represented by either \"-\" or \".\" for historical reasons. New songs should use \"-\".\n\nclass BitFieldReader {\n\tprivate _bits: number[] = [];\n\tprivate _readIndex: number = 0;\n\t\n\tconstructor(source: string, startIndex: number, stopIndex: number) {\n\t\tfor (let i: number = startIndex; i < stopIndex; i++) {\n\t\t\tconst value: number = base64CharCodeToInt[source.charCodeAt(i)];\n\t\t\tthis._bits.push((value >> 5) & 0x1);\n\t\t\tthis._bits.push((value >> 4) & 0x1);\n\t\t\tthis._bits.push((value >> 3) & 0x1);\n\t\t\tthis._bits.push((value >> 2) & 0x1);\n\t\t\tthis._bits.push((value >> 1) & 0x1);\n\t\t\tthis._bits.push( value       & 0x1);\n\t\t}\n\t}\n\t\n\tpublic read(bitCount: number): number {\n\t\tlet result: number = 0;\n\t\twhile (bitCount > 0) {\n\t\t\tresult = result << 1;\n\t\t\tresult += this._bits[this._readIndex++];\n\t\t\tbitCount--;\n\t\t}\n\t\treturn result;\n\t}\n\t\n\tpublic readLongTail(minValue: number, minBits: number): number {\n\t\tlet result: number = minValue;\n\t\tlet numBits: number = minBits;\n\t\twhile (this._bits[this._readIndex++]) {\n\t\t\tresult += 1 << numBits;\n\t\t\tnumBits++;\n\t\t}\n\t\twhile (numBits > 0) {\n\t\t\tnumBits--;\n\t\t\tif (this._bits[this._readIndex++]) {\n\t\t\t\tresult += 1 << numBits;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\t\n\tpublic readPartDuration(): number {\n\t\treturn this.readLongTail(1, 3);\n\t}\n\t\n\tpublic readLegacyPartDuration(): number {\n\t\treturn this.readLongTail(1, 2);\n\t}\n\t\n\tpublic readPinCount(): number {\n\t\treturn this.readLongTail(1, 0);\n\t}\n\t\n\tpublic readPitchInterval(): number {\n\t\tif (this.read(1)) {\n\t\t\treturn -this.readLongTail(1, 3);\n\t\t} else {\n\t\t\treturn this.readLongTail(1, 3);\n\t\t}\n\t}\n}\n\nclass BitFieldWriter {\n\tprivate _index: number = 0;\n\tprivate _bits: number[] = [];\n\t\n\tpublic clear() {\n\t\tthis._index = 0;\n\t}\n\t\n\tpublic write(bitCount: number, value: number): void {\n\t\tbitCount--;\n\t\twhile (bitCount >= 0) {\n\t\t\tthis._bits[this._index++] = (value >>> bitCount) & 1;\n\t\t\tbitCount--;\n\t\t}\n\t}\n\t\n\tpublic writeLongTail(minValue: number, minBits: number, value: number): void {\n\t\tif (value < minValue) throw new Error(\"value out of bounds\");\n\t\tvalue -= minValue;\n\t\tlet numBits: number = minBits;\n\t\twhile (value >= (1 << numBits)) {\n\t\t\tthis._bits[this._index++] = 1;\n\t\t\tvalue -= 1 << numBits;\n\t\t\tnumBits++;\n\t\t}\n\t\tthis._bits[this._index++] = 0;\n\t\twhile (numBits > 0) {\n\t\t\tnumBits--;\n\t\t\tthis._bits[this._index++] = (value >>> numBits) & 1;\n\t\t}\n\t}\n\t\n\tpublic writePartDuration(value: number): void {\n\t\tthis.writeLongTail(1, 3, value);\n\t}\n\t\n\tpublic writePinCount(value: number): void {\n\t\tthis.writeLongTail(1, 0, value);\n\t}\n\t\n\tpublic writePitchInterval(value: number): void {\n\t\tif (value < 0) {\n\t\t\tthis.write(1, 1); // sign\n\t\t\tthis.writeLongTail(1, 3, -value);\n\t\t} else {\n\t\t\tthis.write(1, 0); // sign\n\t\t\tthis.writeLongTail(1, 3, value);\n\t\t}\n\t}\n\t\n\tpublic concat(other: BitFieldWriter): void {\n\t\tfor (let i: number = 0; i < other._index; i++) {\n\t\t\tthis._bits[this._index++] = other._bits[i];\n\t\t}\n\t}\n\t\n\tpublic encodeBase64(buffer: number[]): number[] {\n\t\tfor (let i: number = 0; i < this._index; i += 6) {\n\t\t\tconst value: number = (this._bits[i] << 5) | (this._bits[i+1] << 4) | (this._bits[i+2] << 3) | (this._bits[i+3] << 2) | (this._bits[i+4] << 1) | this._bits[i+5];\n\t\t\tbuffer.push(base64IntToCharCode[value]);\n\t\t}\n\t\treturn buffer;\n\t}\n\t\n\tpublic lengthBase64(): number {\n\t\treturn Math.ceil(this._index / 6);\n\t}\n}\n\nexport interface NotePin {\n\tinterval: number;\n\ttime: number;\n\tsize: number;\n}\n\nexport function makeNotePin(interval: number, time: number, size: number): NotePin {\n\treturn {interval: interval, time: time, size: size};\n}\n\nexport function clamp(min: number, max: number, val: number): number {\n\tmax = max - 1;\n\tif (val <= max) {\n\t\tif (val >= min) return val;\n\t\telse return min;\n\t} else {\n\t\treturn max;\n\t}\n}\n\nfunction validateRange(min: number, max: number, val: number): number {\n\tif (min <= val && val <= max) return val;\n\tthrow new Error(`Value ${val} not in range [${min}, ${max}]`);\n}\n\nexport class Note {\n\tpublic pitches: number[];\n\tpublic pins: NotePin[];\n\tpublic start: number;\n\tpublic end: number;\n\tpublic continuesLastPattern: boolean;\n\t\n\tpublic constructor(pitch: number, start: number, end: number, size: number, fadeout: boolean = false) {\n\t\tthis.pitches = [pitch];\n\t\tthis.pins = [makeNotePin(0, 0, size), makeNotePin(0, end - start, fadeout ? 0 : size)];\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t\tthis.continuesLastPattern = false;\n\t}\n\t\n\tpublic pickMainInterval(): number {\n\t\tlet longestFlatIntervalDuration: number = 0;\n\t\tlet mainInterval: number = 0;\n\t\tfor (let pinIndex: number = 1; pinIndex < this.pins.length; pinIndex++) {\n\t\t\tconst pinA: NotePin = this.pins[pinIndex - 1];\n\t\t\tconst pinB: NotePin = this.pins[pinIndex];\n\t\t\tif (pinA.interval == pinB.interval) {\n\t\t\t\tconst duration: number = pinB.time - pinA.time;\n\t\t\t\tif (longestFlatIntervalDuration < duration) {\n\t\t\t\t\tlongestFlatIntervalDuration = duration;\n\t\t\t\t\tmainInterval = pinA.interval;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (longestFlatIntervalDuration == 0) {\n\t\t\tlet loudestSize: number = 0;\n\t\t\tfor (let pinIndex: number = 0; pinIndex < this.pins.length; pinIndex++) {\n\t\t\t\tconst pin: NotePin = this.pins[pinIndex];\n\t\t\t\tif (loudestSize < pin.size) {\n\t\t\t\t\tloudestSize = pin.size;\n\t\t\t\t\tmainInterval = pin.interval;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn mainInterval;\n\t}\n\t\n\tpublic clone(): Note {\n\t\tconst newNote: Note = new Note(-1, this.start, this.end, Config.noteSizeMax);\n\t\tnewNote.pitches = this.pitches.concat();\n\t\tnewNote.pins = [];\n\t\tfor (const pin of this.pins) {\n\t\t\tnewNote.pins.push(makeNotePin(pin.interval, pin.time, pin.size));\n\t\t}\n\t\tnewNote.continuesLastPattern = this.continuesLastPattern;\n\t\treturn newNote;\n\t}\n\t\n\tpublic getEndPinIndex(part: number): number {\n\t\tlet endPinIndex: number;\n\t\tfor (endPinIndex = 1; endPinIndex < this.pins.length - 1; endPinIndex++) {\n\t\t\tif (this.pins[endPinIndex].time + this.start > part) break;\n\t\t}\n\t\treturn endPinIndex;\n\t}\n}\n\nexport class Pattern {\n\tpublic notes: Note[] = [];\n\tpublic readonly instruments: number[] = [0];\n\t\n\tpublic cloneNotes(): Note[] {\n\t\tconst result: Note[] = [];\n\t\tfor (const note of this.notes) {\n\t\t\tresult.push(note.clone());\n\t\t}\n\t\treturn result;\n\t}\n\t\n\tpublic reset(): void {\n\t\tthis.notes.length = 0;\n\t\tthis.instruments[0] = 0;\n\t\tthis.instruments.length = 1;\n\t}\n}\n\nexport class Operator {\n\tpublic frequency: number = 0;\n\tpublic amplitude: number = 0;\n\t\n\tconstructor(index: number) {\n\t\tthis.reset(index);\n\t}\n\t\n\tpublic reset(index: number): void {\n\t\tthis.frequency = 0;\n\t\tthis.amplitude = (index <= 1) ? Config.operatorAmplitudeMax : 0;\n\t}\n}\n\nexport class SpectrumWave {\n\tpublic spectrum: number[] = [];\n\tprivate _wave: Float32Array | null = null;\n\tprivate _waveIsReady: boolean = false;\n\t\n\tconstructor(isNoiseChannel: boolean) {\n\t\tthis.reset(isNoiseChannel);\n\t}\n\t\n\tpublic reset(isNoiseChannel: boolean): void {\n\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\tif (isNoiseChannel) {\n\t\t\t\tthis.spectrum[i] = Math.round(Config.spectrumMax * (1 / Math.sqrt(1 + i / 3)));\n\t\t\t} else {\n\t\t\t\tconst isHarmonic: boolean = i==0 || i==7 || i==11 || i==14 || i==16 || i==18 || i==21 || i==23 || i>=25;\n\t\t\t\tthis.spectrum[i] = isHarmonic ? Math.max(0, Math.round(Config.spectrumMax * (1 - i / 30))) : 0;\n\t\t\t}\n\t\t}\n\t\tthis._waveIsReady = false;\n\t}\n\t\n\tpublic markCustomWaveDirty(): void {\n\t\tthis._waveIsReady = false;\n\t}\n\t\n\tpublic getCustomWave(lowestOctave: number): Float32Array {\n\t\tif (this._waveIsReady) return this._wave!;\n\t\t\n\t\tconst waveLength: number = Config.spectrumNoiseLength;\n\t\tif (this._wave == null || this._wave.length != waveLength + 1) {\n\t\t\tthis._wave = new Float32Array(waveLength + 1);\n\t\t}\n\t\tconst wave: Float32Array = this._wave;\n\t\t\n\t\tfor (let i: number = 0; i < waveLength; i++) {\n\t\t\twave[i] = 0;\n\t\t}\n\t\t\n\t\tconst highestOctave: number = 14;\n\t\tconst falloffRatio: number = 0.25;\n\t\t// Nudge the 2/7 and 4/7 control points so that they form harmonic intervals.\n\t\tconst pitchTweak: number[] = [0, 1/7, Math.log2(5/4), 3/7, Math.log2(3/2), 5/7, 6/7];\n\t\tfunction controlPointToOctave(point: number): number {\n\t\t\treturn lowestOctave + Math.floor(point / Config.spectrumControlPointsPerOctave) + pitchTweak[(point + Config.spectrumControlPointsPerOctave) % Config.spectrumControlPointsPerOctave];\n\t\t}\n\t\t\n\t\tlet combinedAmplitude: number = 1;\n\t\tfor (let i: number = 0; i < Config.spectrumControlPoints + 1; i++) {\n\t\t\tconst value1: number = (i <= 0) ? 0 : this.spectrum[i - 1];\n\t\t\tconst value2: number = (i >= Config.spectrumControlPoints) ? this.spectrum[Config.spectrumControlPoints - 1] : this.spectrum[i];\n\t\t\tconst octave1: number = controlPointToOctave(i - 1);\n\t\t\tlet octave2: number = controlPointToOctave(i);\n\t\t\tif (i >= Config.spectrumControlPoints) octave2 = highestOctave + (octave2 - highestOctave) * falloffRatio;\n\t\t\tif (value1 == 0 && value2 == 0) continue;\n\t\t\t\n\t\t\tcombinedAmplitude += 0.02 * drawNoiseSpectrum(wave, waveLength, octave1, octave2, value1 / Config.spectrumMax, value2 / Config.spectrumMax, -0.5);\n\t\t}\n\t\tif (this.spectrum[Config.spectrumControlPoints - 1] > 0) {\n\t\t\tcombinedAmplitude += 0.02 * drawNoiseSpectrum(wave, waveLength, highestOctave + (controlPointToOctave(Config.spectrumControlPoints) - highestOctave) * falloffRatio, highestOctave, this.spectrum[Config.spectrumControlPoints - 1] / Config.spectrumMax, 0, -0.5);\n\t\t}\n\t\t\n\t\tinverseRealFourierTransform(wave, waveLength);\n\t\tscaleElementsByFactor(wave, 5.0 / (Math.sqrt(waveLength) * Math.pow(combinedAmplitude, 0.75)));\n\t\t\n\t\t// Duplicate the first sample at the end for easier wrap-around interpolation.\n\t\twave[waveLength] = wave[0];\n\t\t\n\t\tthis._waveIsReady = true;\n\t\treturn wave;\n\t}\n}\n\nexport class HarmonicsWave {\n\tpublic harmonics: number[] = [];\n\tprivate _wave: Float32Array | null = null;\n\tprivate _waveIsReady: boolean = false;\n\tprivate _generatedForType: InstrumentType;\n\t\n\tconstructor() {\n\t\tthis.reset();\n\t}\n\t\n\tpublic reset(): void {\n\t\tfor (let i: number = 0; i < Config.harmonicsControlPoints; i++) {\n\t\t\tthis.harmonics[i] = 0;\n\t\t}\n\t\tthis.harmonics[0] = Config.harmonicsMax;\n\t\tthis.harmonics[3] = Config.harmonicsMax;\n\t\tthis.harmonics[6] = Config.harmonicsMax;\n\t\tthis._waveIsReady = false;\n\t}\n\t\n\tpublic markCustomWaveDirty(): void {\n\t\tthis._waveIsReady = false;\n\t}\n\t\n\tpublic getCustomWave(instrumentType: InstrumentType): Float32Array {\n\t\tif (this._generatedForType != instrumentType) {\n\t\t\tthis._generatedForType = instrumentType;\n\t\t\tthis._waveIsReady = false;\n\t\t}\n\t\tconst harmonicsRendered: number = (instrumentType == InstrumentType.pickedString) ? Config.harmonicsRenderedForPickedString : Config.harmonicsRendered;\n\t\t\n\t\tif (this._waveIsReady) return this._wave!;\n\t\t\n\t\tconst waveLength: number = Config.harmonicsWavelength;\n\t\tconst retroWave: Float32Array = getDrumWave(0, null, null);\n\t\t\n\t\tif (this._wave == null || this._wave.length != waveLength + 1) {\n\t\t\tthis._wave = new Float32Array(waveLength + 1);\n\t\t}\n\t\tconst wave: Float32Array = this._wave;\n\t\t\n\t\tfor (let i: number = 0; i < waveLength; i++) {\n\t\t\twave[i] = 0;\n\t\t}\n\t\t\n\t\tconst overallSlope: number = -0.25;\n\t\tlet combinedControlPointAmplitude: number = 1;\n\t\t\n\t\tfor (let harmonicIndex: number = 0; harmonicIndex < harmonicsRendered; harmonicIndex++) {\n\t\t\tconst harmonicFreq: number = harmonicIndex + 1;\n\t\t\tlet controlValue: number = harmonicIndex < Config.harmonicsControlPoints ? this.harmonics[harmonicIndex] : this.harmonics[Config.harmonicsControlPoints - 1];\n\t\t\tif (harmonicIndex >= Config.harmonicsControlPoints) {\n\t\t\t\tcontrolValue *= 1 - (harmonicIndex - Config.harmonicsControlPoints) / (harmonicsRendered - Config.harmonicsControlPoints);\n\t\t\t}\n\t\t\tconst normalizedValue: number = controlValue / Config.harmonicsMax;\n\t\t\tlet amplitude: number = Math.pow(2, controlValue - Config.harmonicsMax + 1) * Math.sqrt(normalizedValue);\n\t\t\tif (harmonicIndex < Config.harmonicsControlPoints) {\n\t\t\t\tcombinedControlPointAmplitude += amplitude;\n\t\t\t}\n\t\t\tamplitude *= Math.pow(harmonicFreq, overallSlope);\n\t\t\t\n\t\t\t// Multiply all the sine wave amplitudes by 1 or -1 based on the LFSR\n\t\t\t// retro wave (effectively random) to avoid egregiously tall spikes.\n\t\t\tamplitude *= retroWave[harmonicIndex + 589];\n\t\t\t\n\t\t\twave[waveLength - harmonicFreq] = amplitude;\n\t\t}\n\t\t\n\t\tinverseRealFourierTransform(wave, waveLength);\n\t\t\n\t\t// Limit the maximum wave amplitude.\n\t\tconst mult: number = 1 / Math.pow(combinedControlPointAmplitude, 0.7);\n\t\tfor (let i: number = 0; i < wave.length; i++) wave[i] *= mult;\n\t\t\n\t\tperformIntegral(wave);\n\t\t\n\t\t// The first sample should be zero, and we'll duplicate it at the end for easier interpolation.\n\t\twave[waveLength] = wave[0];\n\t\t\n\t\tthis._waveIsReady = true;\n\t\treturn wave;\n\t}\n}\n\nexport class FilterControlPoint {\n\tpublic freq: number = 0;\n\tpublic gain: number = Config.filterGainCenter;\n\tpublic type: FilterType = FilterType.peak;\n\t\n\tpublic set(freqSetting: number, gainSetting: number): void {\n\t\tthis.freq = freqSetting;\n\t\tthis.gain = gainSetting;\n\t}\n\t\n\tpublic getHz(): number {\n\t\treturn FilterControlPoint.getHzFromSettingValue(this.freq);\n\t}\n\t\n\tpublic static getHzFromSettingValue(value: number): number {\n\t\treturn Config.filterFreqReferenceHz * Math.pow(2.0, (value - Config.filterFreqReferenceSetting) * Config.filterFreqStep);\n\t}\n\tpublic static getSettingValueFromHz(hz: number): number {\n\t\treturn Math.log2(hz / Config.filterFreqReferenceHz) / Config.filterFreqStep + Config.filterFreqReferenceSetting;\n\t}\n\tpublic static getRoundedSettingValueFromHz(hz: number): number {\n\t\treturn Math.max(0, Math.min(Config.filterFreqRange - 1, Math.round(FilterControlPoint.getSettingValueFromHz(hz))));\n\t}\n\t\n\tpublic getLinearGain(peakMult: number = 1.0): number {\n\t\tconst power: number = (this.gain - Config.filterGainCenter) * Config.filterGainStep;\n\t\tconst neutral: number = (this.type == FilterType.peak) ? 0.0 : -0.5;\n\t\tconst interpolatedPower: number = neutral + (power - neutral) * peakMult;\n\t\treturn Math.pow(2.0, interpolatedPower);\n\t}\n\tpublic static getRoundedSettingValueFromLinearGain(linearGain: number): number {\n\t\treturn Math.max(0, Math.min(Config.filterGainRange - 1, Math.round(Math.log2(linearGain) / Config.filterGainStep + Config.filterGainCenter)));\n\t}\n\t\n\tpublic toCoefficients(filter: FilterCoefficients, sampleRate: number, freqMult: number = 1.0, peakMult: number = 1.0): void {\n\t\tconst cornerRadiansPerSample: number = 2.0 * Math.PI * Math.max(Config.filterFreqMinHz, Math.min(Config.filterFreqMaxHz, freqMult * this.getHz())) / sampleRate;\n\t\tconst linearGain: number = this.getLinearGain(peakMult);\n\t\tswitch (this.type) {\n\t\t\tcase FilterType.lowPass:\n\t\t\t\tfilter.lowPass2ndOrderButterworth(cornerRadiansPerSample, linearGain);\n\t\t\t\tbreak;\n\t\t\tcase FilterType.highPass:\n\t\t\t\tfilter.highPass2ndOrderButterworth(cornerRadiansPerSample, linearGain);\n\t\t\t\tbreak;\n\t\t\tcase FilterType.peak:\n\t\t\t\tfilter.peak2ndOrder(cornerRadiansPerSample, linearGain, 1.0);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error();\n\t\t}\n\t}\n\t\n\tpublic getVolumeCompensationMult(): number {\n\t\tconst octave: number = (this.freq - Config.filterFreqReferenceSetting) * Config.filterFreqStep;\n\t\tconst gainPow: number = (this.gain - Config.filterGainCenter) * Config.filterGainStep;\n\t\tswitch (this.type) {\n\t\t\tcase FilterType.lowPass:\n\t\t\t\tconst freqRelativeTo8khz: number = Math.pow(2.0, octave) * Config.filterFreqReferenceHz / 8000.0;\n\t\t\t\t// Reverse the frequency warping from importing legacy simplified filters to imitate how the legacy filter cutoff setting affected volume.\n\t\t\t\tconst warpedFreq: number = (Math.sqrt(1.0 + 4.0 * freqRelativeTo8khz) - 1.0) / 2.0;\n\t\t\t\tconst warpedOctave: number = Math.log2(warpedFreq);\n\t\t\t\treturn Math.pow(0.5, 0.2 * Math.max(0.0, gainPow + 1.0) + Math.min(0.0, Math.max(-3.0, 0.595 * warpedOctave + 0.35 * Math.min(0.0, gainPow + 1.0))));\n\t\t\tcase FilterType.highPass:\n\t\t\t\treturn Math.pow(0.5, 0.125 * Math.max(0.0, gainPow + 1.0) + Math.min(0.0, 0.3 * (-octave - Math.log2(Config.filterFreqReferenceHz / 125.0)) + 0.2 * Math.min(0.0, gainPow + 1.0)));\n\t\t\tcase FilterType.peak:\n\t\t\t\tconst distanceFromCenter: number = octave + Math.log2(Config.filterFreqReferenceHz / 2000.0);\n\t\t\t\tconst freqLoudness: number = Math.pow(1.0 / (1.0 + Math.pow(distanceFromCenter / 3.0, 2.0)), 2.0);\n\t\t\t\treturn Math.pow(0.5, 0.125 * Math.max(0.0, gainPow) + 0.1 * freqLoudness * Math.min(0.0, gainPow));\n\t\t\tdefault:\n\t\t\t\tthrow new Error();\n\t\t}\n\t}\n}\n\nexport class FilterSettings {\n\tpublic readonly controlPoints: FilterControlPoint[] = [];\n\tpublic controlPointCount: number = 0;\n\t\n\tconstructor() {\n\t\tthis.reset();\n\t}\n\t\n\treset(): void {\n\t\tthis.controlPointCount = 0;\n\t}\n\t\n\taddPoint(type: FilterType, freqSetting: number, gainSetting: number): void {\n\t\tlet controlPoint: FilterControlPoint;\n\t\tif (this.controlPoints.length <= this.controlPointCount) {\n\t\t\tcontrolPoint = new FilterControlPoint();\n\t\t\tthis.controlPoints[this.controlPointCount] = controlPoint;\n\t\t} else {\n\t\t\tcontrolPoint = this.controlPoints[this.controlPointCount];\n\t\t}\n\t\tthis.controlPointCount++;\n\t\tcontrolPoint.type = type;\n\t\tcontrolPoint.set(freqSetting, gainSetting);\n\t}\n\t\n\tpublic toJsonObject(): Object {\n\t\tconst filterArray: any[] = [];\n\t\tfor (let i: number = 0; i < this.controlPointCount; i++) {\n\t\t\tconst point: FilterControlPoint = this.controlPoints[i];\n\t\t\tfilterArray.push({\n\t\t\t\t\"type\": Config.filterTypeNames[point.type],\n\t\t\t\t\"cutoffHz\": Math.round(point.getHz() * 100) / 100,\n\t\t\t\t\"linearGain\": Math.round(point.getLinearGain() * 10000) / 10000,\n\t\t\t});\n\t\t}\n\t\treturn filterArray;\n\t}\n\t\n\tpublic fromJsonObject(filterObject: any): void {\n\t\tthis.controlPoints.length = 0;\n\t\tif (filterObject) {\n\t\t\tfor (const pointObject of filterObject) {\n\t\t\t\tconst point: FilterControlPoint = new FilterControlPoint();\n\t\t\t\tpoint.type = Config.filterTypeNames.indexOf(pointObject[\"type\"]);\n\t\t\t\tif (<any>point.type == -1) point.type = FilterType.peak;\n\t\t\t\tif (pointObject[\"cutoffHz\"] != undefined) {\n\t\t\t\t\tpoint.freq = FilterControlPoint.getRoundedSettingValueFromHz(pointObject[\"cutoffHz\"]);\n\t\t\t\t} else {\n\t\t\t\t\tpoint.freq = 0;\n\t\t\t\t}\n\t\t\t\tif (pointObject[\"linearGain\"] != undefined) {\n\t\t\t\t\tpoint.gain = FilterControlPoint.getRoundedSettingValueFromLinearGain(pointObject[\"linearGain\"]);\n\t\t\t\t} else {\n\t\t\t\t\tpoint.gain = Config.filterGainCenter;\n\t\t\t\t}\n\t\t\t\tthis.controlPoints.push(point);\n\t\t\t}\n\t\t}\n\t\tthis.controlPointCount = this.controlPoints.length;\n\t}\n\t\n\tpublic convertLegacySettings(legacyCutoffSetting: number, legacyResonanceSetting: number, legacyEnv: Envelope): void {\n\t\tthis.reset();\n\t\t\n\t\tconst legacyFilterCutoffMaxHz: number = 8000; // This was carefully calculated to correspond to no change in response when filtering at 48000 samples per second... when using the legacy simplified low-pass filter.\n\t\tconst legacyFilterMax: number = 0.95;\n\t\tconst legacyFilterMaxRadians: number = Math.asin(legacyFilterMax / 2.0) * 2.0;\n\t\tconst legacyFilterMaxResonance: number = 0.95;\n\t\tconst legacyFilterCutoffRange: number = 11;\n\t\tconst legacyFilterResonanceRange: number = 8;\n\t\t\n\t\tconst resonant: boolean = (legacyResonanceSetting > 1);\n\t\tconst firstOrder: boolean = (legacyResonanceSetting == 0);\n\t\tconst cutoffAtMax: boolean = (legacyCutoffSetting == legacyFilterCutoffRange - 1);\n\t\tconst envDecays: boolean = (legacyEnv.type == EnvelopeType.flare || legacyEnv.type == EnvelopeType.twang || legacyEnv.type == EnvelopeType.decay || legacyEnv.type == EnvelopeType.noteSize);\n\t\t\n\t\tconst standardSampleRate: number = 48000;\n\t\tconst legacyHz: number = legacyFilterCutoffMaxHz * Math.pow(2.0, (legacyCutoffSetting - (legacyFilterCutoffRange - 1)) * 0.5);\n\t\tconst legacyRadians: number = Math.min(legacyFilterMaxRadians, 2 * Math.PI * legacyHz / standardSampleRate);\n\t\t\n\t\tif (legacyEnv.type == EnvelopeType.none && !resonant && cutoffAtMax) {\n\t\t\t// The response is flat and there's no envelopes, so don't even bother adding any control points.\n\t\t} else if (firstOrder) {\n\t\t\t// In general, a 1st order lowpass can be approximated by a 2nd order lowpass\n\t\t\t// with a cutoff ~4 octaves higher (*16) and a gain of 1/16.\n\t\t\t// However, BeepBox's original lowpass filters behaved oddly as they\n\t\t\t// approach the nyquist frequency, so I've devised this curved conversion\n\t\t\t// to guess at a perceptually appropriate new cutoff frequency and gain.\n\t\t\tconst extraOctaves: number = 3.5;\n\t\t\tconst targetRadians: number = legacyRadians * Math.pow(2.0, extraOctaves);\n\t\t\tconst curvedRadians: number = targetRadians / (1.0 + targetRadians / Math.PI);\n\t\t\tconst curvedHz: number = standardSampleRate * curvedRadians / (2.0 * Math.PI)\n\t\t\tconst freqSetting: number = FilterControlPoint.getRoundedSettingValueFromHz(curvedHz);\n\t\t\tconst finalHz: number = FilterControlPoint.getHzFromSettingValue(freqSetting);\n\t\t\tconst finalRadians: number = 2.0 * Math.PI * finalHz / standardSampleRate;\n\t\t\t\n\t\t\tconst legacyFilter: FilterCoefficients = new FilterCoefficients();\n\t\t\tlegacyFilter.lowPass1stOrderSimplified(legacyRadians);\n\t\t\tconst response: FrequencyResponse = new FrequencyResponse();\n\t\t\tresponse.analyze(legacyFilter, finalRadians);\n\t\t\tconst legacyFilterGainAtNewRadians: number = response.magnitude();\n\t\t\t\n\t\t\tlet logGain: number = Math.log2(legacyFilterGainAtNewRadians);\n\t\t\t// Bias slightly toward 2^(-extraOctaves):\n\t\t\tlogGain = -extraOctaves + (logGain + extraOctaves) * 0.82;\n\t\t\t// Decaying envelopes move the cutoff frequency back into an area where the best approximation of the first order slope requires a lower gain setting.\n\t\t\tif (envDecays) logGain = Math.min(logGain, -1.0);\n\t\t\tconst convertedGain: number = Math.pow(2.0, logGain);\n\t\t\tconst gainSetting: number = FilterControlPoint.getRoundedSettingValueFromLinearGain(convertedGain);\n\t\t\t\n\t\t\tthis.addPoint(FilterType.lowPass, freqSetting, gainSetting);\n\t\t} else {\n\t\t\tconst intendedGain: number = 0.5 / (1.0 - legacyFilterMaxResonance * Math.sqrt(Math.max(0.0, legacyResonanceSetting - 1.0) / (legacyFilterResonanceRange - 2.0)));\n\t\t\tconst invertedGain: number = 0.5 / intendedGain;\n\t\t\tconst maxRadians: number = 2.0 * Math.PI * legacyFilterCutoffMaxHz / standardSampleRate;\n\t\t\tconst freqRatio: number = legacyRadians / maxRadians;\n\t\t\tconst targetRadians: number = legacyRadians * (freqRatio * Math.pow(invertedGain, 0.9) + 1.0);\n\t\t\tconst curvedRadians: number = legacyRadians + (targetRadians - legacyRadians) * invertedGain;\n\t\t\tlet curvedHz: number;\n\t\t\tif (envDecays) {\n\t\t\t\tcurvedHz = standardSampleRate * Math.min(curvedRadians, legacyRadians * Math.pow(2, 0.25)) / (2.0 * Math.PI)\n\t\t\t} else {\n\t\t\t\tcurvedHz = standardSampleRate * curvedRadians / (2.0 * Math.PI)\n\t\t\t}\n\t\t\tconst freqSetting: number = FilterControlPoint.getRoundedSettingValueFromHz(curvedHz);\n\t\t\t\n\t\t\tlet legacyFilterGain: number;\n\t\t\tif (envDecays) {\n\t\t\t\tlegacyFilterGain = intendedGain;\n\t\t\t} else {\n\t\t\t\tconst legacyFilter: FilterCoefficients = new FilterCoefficients();\n\t\t\t\tlegacyFilter.lowPass2ndOrderSimplified(legacyRadians, intendedGain);\n\t\t\t\tconst response: FrequencyResponse = new FrequencyResponse();\n\t\t\t\tresponse.analyze(legacyFilter, curvedRadians);\n\t\t\t\tlegacyFilterGain = response.magnitude();\n\t\t\t}\n\t\t\tif (!resonant) legacyFilterGain = Math.min(legacyFilterGain, Math.sqrt(0.5));\n\t\t\tconst gainSetting: number = FilterControlPoint.getRoundedSettingValueFromLinearGain(legacyFilterGain);\n\t\t\t\n\t\t\tthis.addPoint(FilterType.lowPass, freqSetting, gainSetting);\n\t\t}\n\t}\n}\n\nexport class EnvelopeSettings {\n\tpublic target: number = 0;\n\tpublic index: number = 0;\n\tpublic envelope: number = 0;\n\t\n\tconstructor() {\n\t\tthis.reset();\n\t}\n\t\n\treset(): void {\n\t\tthis.target = 0;\n\t\tthis.index = 0;\n\t\tthis.envelope = 0;\n\t}\n\t\n\tpublic toJsonObject(): Object {\n\t\tconst envelopeObject: any = {\n\t\t\t\"target\": Config.instrumentAutomationTargets[this.target].name,\n\t\t\t\"envelope\": Config.envelopes[this.envelope].name,\n\t\t};\n\t\tif (Config.instrumentAutomationTargets[this.target].maxCount > 1) {\n\t\t\tenvelopeObject[\"index\"] = this.index;\n\t\t}\n\t\treturn envelopeObject;\n\t}\n\t\n\tpublic fromJsonObject(envelopeObject: any): void {\n\t\tthis.reset();\n\t\t\n\t\tlet target: AutomationTarget = Config.instrumentAutomationTargets.dictionary[envelopeObject[\"target\"]];\n\t\tif (target == null) target = Config.instrumentAutomationTargets.dictionary[\"noteVolume\"];\n\t\tthis.target = target.index;\n\t\t\n\t\tlet envelope: Envelope = Config.envelopes.dictionary[envelopeObject[\"envelope\"]];\n\t\tif (envelope == null) envelope = Config.envelopes.dictionary[\"none\"];\n\t\tthis.envelope = envelope.index;\n\t\t\n\t\tif (envelopeObject[\"index\"] != undefined) {\n\t\t\tthis.index = clamp(0, Config.instrumentAutomationTargets[this.target].maxCount, envelopeObject[\"index\"] | 0);\n\t\t} else {\n\t\t\tthis.index = 0;\n\t\t}\n\t}\n}\n\n// Settings that were available to old versions of BeepBox but are no longer available in the\n// current version that need to be reinterpreted as a group to determine the best way to\n// represent them in the current version.\ninterface LegacySettings {\n\tfilterCutoff?: number;\n\tfilterResonance?: number;\n\tfilterEnvelope?: Envelope;\n\tpulseEnvelope?: Envelope;\n\toperatorEnvelopes?: Envelope[];\n\tfeedbackEnvelope?: Envelope;\n}\n\nexport class Instrument {\n\tpublic type: InstrumentType = InstrumentType.chip;\n\tpublic preset: number = 0;\n\tpublic chipWave: number = 2;\n\tpublic chipNoise: number = 1;\n\tpublic eqFilter: FilterSettings = new FilterSettings();\n\tpublic noteFilter: FilterSettings = new FilterSettings();\n\tpublic envelopes: EnvelopeSettings[] = [];\n\tpublic envelopeCount: number = 0;\n\tpublic fadeIn: number = 0;\n\tpublic fadeOut: number = Config.fadeOutNeutral;\n\tpublic transition: number = Config.transitions.dictionary[\"normal\"].index;\n\tpublic pitchShift: number = 0;\n\tpublic detune: number = 0;\n\tpublic vibrato: number = 0;\n\tpublic unison: number = 0;\n\tpublic effects: number = 0;\n\tpublic chord: number = 1;\n\tpublic volume: number = 0;\n\tpublic pan: number = Config.panCenter;\n\tpublic pulseWidth: number = Config.pulseWidthRange - 1;\n\tpublic stringSustain: number = 10;\n\tpublic distortion: number = 0;\n\tpublic bitcrusherFreq: number = 0;\n\tpublic bitcrusherQuantization: number = 0;\n\tpublic chorus: number = 0;\n\tpublic reverb: number = 0;\n\tpublic echoSustain: number = 0;\n\tpublic echoDelay: number = 0;\n\tpublic algorithm: number = 0;\n\tpublic feedbackType: number = 0;\n\tpublic feedbackAmplitude: number = 0;\n\tpublic readonly operators: Operator[] = [];\n\tpublic readonly spectrumWave: SpectrumWave;\n\tpublic readonly harmonicsWave: HarmonicsWave = new HarmonicsWave();\n\tpublic readonly drumsetEnvelopes: number[] = [];\n\tpublic readonly drumsetSpectrumWaves: SpectrumWave[] = [];\n\t\n\tconstructor(isNoiseChannel: boolean) {\n\t\tthis.spectrumWave = new SpectrumWave(isNoiseChannel);\n\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\n\t\t\tthis.operators[i] = new Operator(i);\n\t\t}\n\t\tfor (let i: number = 0; i < Config.drumCount; i++) {\n\t\t\tthis.drumsetEnvelopes[i] = Config.envelopes.dictionary[\"twang 2\"].index;\n\t\t\tthis.drumsetSpectrumWaves[i] = new SpectrumWave(true);\n\t\t}\n\t}\n\t\n\tpublic setTypeAndReset(type: InstrumentType, isNoiseChannel: boolean): void {\n\t\tthis.type = type;\n\t\tthis.preset = type;\n\t\tthis.volume = 0;\n\t\tthis.effects = 0;\n\t\tthis.chorus = Config.chorusRange - 1;\n\t\tthis.reverb = 2;\n\t\tthis.echoSustain = Math.floor((Config.echoSustainRange - 1) * 0.5);\n\t\tthis.echoDelay = Math.floor((Config.echoDelayRange - 1) * 0.5);\n\t\tthis.eqFilter.reset();\n\t\tthis.noteFilter.reset();\n\t\tthis.distortion = Math.floor((Config.distortionRange - 1) * 0.75);\n\t\tthis.bitcrusherFreq = Math.floor((Config.bitcrusherFreqRange - 1) * 0.5)\n\t\tthis.bitcrusherQuantization = Math.floor((Config.bitcrusherQuantizationRange - 1) * 0.5);\n\t\tthis.pan = Config.panCenter;\n\t\tthis.pitchShift = Config.pitchShiftCenter;\n\t\tthis.detune = Config.detuneCenter;\n\t\tthis.vibrato = 0;\n\t\tthis.unison = 0;\n\t\tthis.stringSustain = 10;\n\t\tthis.fadeIn = 0;\n\t\tthis.fadeOut = Config.fadeOutNeutral;\n\t\tthis.transition = Config.transitions.dictionary[\"normal\"].index;\n\t\tthis.envelopeCount = 0;\n\t\tswitch (type) {\n\t\t\tcase InstrumentType.chip:\n\t\t\t\tthis.chipWave = 2;\n\t\t\t\t// TODO: enable the chord effect?\n\t\t\t\tthis.chord = Config.chords.dictionary[\"arpeggio\"].index;\n\t\t\t\tbreak;\n\t\t\tcase InstrumentType.fm:\n\t\t\t\tthis.chord = Config.chords.dictionary[\"custom interval\"].index;\n\t\t\t\tthis.algorithm = 0;\n\t\t\t\tthis.feedbackType = 0;\n\t\t\t\tthis.feedbackAmplitude = 0;\n\t\t\t\tfor (let i: number = 0; i < this.operators.length; i++) {\n\t\t\t\t\tthis.operators[i].reset(i);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase InstrumentType.noise:\n\t\t\t\tthis.chipNoise = 1;\n\t\t\t\tthis.chord = Config.chords.dictionary[\"arpeggio\"].index;\n\t\t\t\tbreak;\n\t\t\tcase InstrumentType.spectrum:\n\t\t\t\tthis.chord = Config.chords.dictionary[\"simultaneous\"].index;\n\t\t\t\tthis.spectrumWave.reset(isNoiseChannel);\n\t\t\t\tbreak;\n\t\t\tcase InstrumentType.drumset:\n\t\t\t\tthis.chord = Config.chords.dictionary[\"simultaneous\"].index;\n\t\t\t\tfor (let i: number = 0; i < Config.drumCount; i++) {\n\t\t\t\t\tthis.drumsetEnvelopes[i] = Config.envelopes.dictionary[\"twang 2\"].index;\n\t\t\t\t\tthis.drumsetSpectrumWaves[i].reset(isNoiseChannel);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase InstrumentType.harmonics:\n\t\t\t\tthis.chord = Config.chords.dictionary[\"simultaneous\"].index;\n\t\t\t\tthis.harmonicsWave.reset();\n\t\t\t\tbreak;\n\t\t\tcase InstrumentType.pwm:\n\t\t\t\tthis.chord = Config.chords.dictionary[\"arpeggio\"].index;\n\t\t\t\tthis.pulseWidth = Config.pulseWidthRange - 1;\n\t\t\t\tbreak;\n\t\t\tcase InstrumentType.pickedString:\n\t\t\t\tthis.chord = Config.chords.dictionary[\"strum\"].index;\n\t\t\t\tthis.harmonicsWave.reset();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"Unrecognized instrument type: \" + type);\n\t\t}\n\t\t// Chip/noise instruments had arpeggio and FM had custom interval but neither\n\t\t// explicitly saved the chorus setting beforeSeven so enable it here. The effects\n\t\t// will otherwise get overridden when reading SongTagCode.startInstrument.\n\t\tif (this.chord != Config.chords.dictionary[\"simultaneous\"].index) {\n\t\t\t// Enable chord if it was used.\n\t\t\tthis.effects = (this.effects | (1 << EffectType.chord));\n\t\t}\n\t}\n\t\n\tpublic convertLegacySettings(legacySettings: LegacySettings): void {\n\t\tlet legacyCutoffSetting: number | undefined = legacySettings.filterCutoff;\n\t\tlet legacyResonanceSetting: number | undefined = legacySettings.filterResonance;\n\t\tlet legacyFilterEnv: Envelope | undefined = legacySettings.filterEnvelope;\n\t\tlet legacyPulseEnv: Envelope | undefined = legacySettings.pulseEnvelope;\n\t\tlet legacyOperatorEnvelopes: Envelope[] | undefined = legacySettings.operatorEnvelopes;\n\t\tlet legacyFeedbackEnv: Envelope | undefined = legacySettings.feedbackEnvelope;\n\t\t\n\t\t// legacy defaults:\n\t\tif (legacyCutoffSetting == undefined) legacyCutoffSetting = (this.type == InstrumentType.chip) ? 6 : 10;\n\t\tif (legacyResonanceSetting == undefined) legacyResonanceSetting = 0;\n\t\tif (legacyFilterEnv == undefined) legacyFilterEnv = Config.envelopes.dictionary[\"none\"];\n\t\tif (legacyPulseEnv == undefined) legacyPulseEnv = Config.envelopes.dictionary[(this.type == InstrumentType.pwm) ? \"twang 2\" : \"none\"];\n\t\tif (legacyOperatorEnvelopes == undefined) legacyOperatorEnvelopes = [Config.envelopes.dictionary[(this.type == InstrumentType.fm) ? \"note size\" : \"none\"], Config.envelopes.dictionary[\"none\"], Config.envelopes.dictionary[\"none\"], Config.envelopes.dictionary[\"none\"]];\n\t\tif (legacyFeedbackEnv == undefined) legacyFeedbackEnv = Config.envelopes.dictionary[\"none\"];\n\t\t\n\t\tconst carrierCount: number = Config.algorithms[this.algorithm].carrierCount;\n\t\tlet noCarriersControlledByNoteSize: boolean = true;\n\t\tlet allCarriersControlledByNoteSize: boolean = true;\n\t\tlet noteSizeControlsSomethingElse: boolean = (legacyFilterEnv.type == EnvelopeType.noteSize) || (legacyPulseEnv.type == EnvelopeType.noteSize);\n\t\tif (this.type == InstrumentType.fm) {\n\t\t\tnoteSizeControlsSomethingElse = noteSizeControlsSomethingElse || (legacyFeedbackEnv.type == EnvelopeType.noteSize);\n\t\t\tfor (let i: number = 0; i < legacyOperatorEnvelopes.length; i++) {\n\t\t\t\tif (i < carrierCount) {\n\t\t\t\t\tif (legacyOperatorEnvelopes[i].type != EnvelopeType.noteSize) {\n\t\t\t\t\t\tallCarriersControlledByNoteSize = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnoCarriersControlledByNoteSize = false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnoteSizeControlsSomethingElse = noteSizeControlsSomethingElse || (legacyOperatorEnvelopes[i].type == EnvelopeType.noteSize);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.envelopeCount = 0;\n\t\t\n\t\tif (this.type == InstrumentType.fm) {\n\t\t\tif (allCarriersControlledByNoteSize && noteSizeControlsSomethingElse) {\n\t\t\t\tthis.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"noteVolume\"].index, 0, Config.envelopes.dictionary[\"note size\"].index);\n\t\t\t} else if (noCarriersControlledByNoteSize && !noteSizeControlsSomethingElse) {\n\t\t\t\tthis.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"none\"].index, 0, Config.envelopes.dictionary[\"note size\"].index);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (legacyFilterEnv.type == EnvelopeType.none) {\n\t\t\tthis.noteFilter.reset();\n\t\t\tthis.eqFilter.convertLegacySettings(legacyCutoffSetting, legacyResonanceSetting, legacyFilterEnv);\n\t\t\tthis.effects &= ~(1 << EffectType.noteFilter);\n\t\t} else {\n\t\t\tthis.eqFilter.reset();\n\t\t\tthis.noteFilter.convertLegacySettings(legacyCutoffSetting, legacyResonanceSetting, legacyFilterEnv);\n\t\t\tthis.effects |= 1 << EffectType.noteFilter;\n\t\t\tthis.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"noteFilterAllFreqs\"].index, 0, legacyFilterEnv.index);\n\t\t}\n\t\t\n\t\tif (legacyPulseEnv.type != EnvelopeType.none) {\n\t\t\tthis.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"pulseWidth\"].index, 0, legacyPulseEnv.index);\n\t\t}\n\t\t\n\t\tfor (let i: number = 0; i < legacyOperatorEnvelopes.length; i++) {\n\t\t\tif (i < carrierCount && allCarriersControlledByNoteSize) continue;\n\t\t\tif (legacyOperatorEnvelopes[i].type != EnvelopeType.none) {\n\t\t\t\tthis.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"operatorAmplitude\"].index, i, legacyOperatorEnvelopes[i].index);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (legacyFeedbackEnv.type != EnvelopeType.none) {\n\t\t\tthis.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"feedbackAmplitude\"].index, 0, legacyFeedbackEnv.index);\n\t\t}\n\t}\n\t\n\tpublic toJsonObject(): Object {\n\t\tconst instrumentObject: any = {\n\t\t\t\"type\": Config.instrumentTypeNames[this.type],\n\t\t\t\"volume\": (5 - this.volume) * 20,\n\t\t\t\"eqFilter\": this.eqFilter.toJsonObject(),\n\t\t};\n\t\t\n\t\tif (this.preset != this.type) {\n\t\t\tinstrumentObject[\"preset\"] = this.preset;\n\t\t}\n\t\t\n\t\tconst effects: string[] = [];\n\t\tfor (const effect of Config.effectOrder) {\n\t\t\tif (this.effects & (1 << effect)) {\n\t\t\t\teffects.push(Config.effectNames[effect]);\n\t\t\t}\n\t\t}\n\t\tinstrumentObject[\"effects\"] = effects;\n\t\t\n\t\t\n\t\tif (effectsIncludeTransition(this.effects)) {\n\t\t\tinstrumentObject[\"transition\"] = Config.transitions[this.transition].name;\n\t\t}\n\t\tif (effectsIncludeChord(this.effects)) {\n\t\t\tinstrumentObject[\"chord\"] = this.getChord().name;\n\t\t}\n\t\tif (effectsIncludePitchShift(this.effects)) {\n\t\t\tinstrumentObject[\"pitchShiftSemitones\"] = this.pitchShift;\n\t\t}\n\t\tif (effectsIncludeDetune(this.effects)) {\n\t\t\tinstrumentObject[\"detuneCents\"] = Synth.detuneToCents(this.detune - Config.detuneCenter);\n\t\t}\n\t\tif (effectsIncludeVibrato(this.effects)) {\n\t\t\tinstrumentObject[\"vibrato\"] = Config.vibratos[this.vibrato].name;\n\t\t}\n\t\tif (effectsIncludeNoteFilter(this.effects)) {\n\t\t\tinstrumentObject[\"noteFilter\"] = this.noteFilter.toJsonObject();\n\t\t}\n\t\tif (effectsIncludeDistortion(this.effects)) {\n\t\t\tinstrumentObject[\"distortion\"] = Math.round(100 * this.distortion / (Config.distortionRange - 1));\n\t\t}\n\t\tif (effectsIncludeBitcrusher(this.effects)) {\n\t\t\tinstrumentObject[\"bitcrusherOctave\"] = (Config.bitcrusherFreqRange - 1 - this.bitcrusherFreq) * Config.bitcrusherOctaveStep;\n\t\t\tinstrumentObject[\"bitcrusherQuantization\"] = Math.round(100 * this.bitcrusherQuantization / (Config.bitcrusherQuantizationRange - 1));\n\t\t}\n\t\tif (effectsIncludePanning(this.effects)) {\n\t\t\tinstrumentObject[\"pan\"] = Math.round(100 * (this.pan - Config.panCenter) / Config.panCenter);\n\t\t}\n\t\tif (effectsIncludeChorus(this.effects)) {\n\t\t\tinstrumentObject[\"chorus\"] = Math.round(100 * this.chorus / (Config.chorusRange - 1));\n\t\t}\n\t\tif (effectsIncludeEcho(this.effects)) {\n\t\t\tinstrumentObject[\"echoSustain\"] = Math.round(100 * this.echoSustain / (Config.echoSustainRange - 1));\n\t\t\tinstrumentObject[\"echoDelayBeats\"] = Math.round(1000 * (this.echoDelay + 1) * Config.echoDelayStepTicks / (Config.ticksPerPart * Config.partsPerBeat)) / 1000;\n\t\t}\n\t\tif (effectsIncludeReverb(this.effects)) {\n\t\t\tinstrumentObject[\"reverb\"] = Math.round(100 * this.reverb / (Config.reverbRange - 1));\n\t\t}\n\t\t\n\t\tif (this.type != InstrumentType.drumset) {\n\t\t\tinstrumentObject[\"fadeInSeconds\"] = Math.round(10000 * Synth.fadeInSettingToSeconds(this.fadeIn)) / 10000;\n\t\t\tinstrumentObject[\"fadeOutTicks\"] = Synth.fadeOutSettingToTicks(this.fadeOut);\n\t\t}\n\t\t\n\t\tif (this.type == InstrumentType.harmonics || this.type == InstrumentType.pickedString) {\n\t\t\tinstrumentObject[\"harmonics\"] = [];\n\t\t\tfor (let i: number = 0; i < Config.harmonicsControlPoints; i++) {\n\t\t\t\tinstrumentObject[\"harmonics\"][i] = Math.round(100 * this.harmonicsWave.harmonics[i] / Config.harmonicsMax);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this.type == InstrumentType.noise) {\n\t\t\tinstrumentObject[\"wave\"] = Config.chipNoises[this.chipNoise].name;\n\t\t} else if (this.type == InstrumentType.spectrum) {\n\t\t\tinstrumentObject[\"spectrum\"] = [];\n\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\tinstrumentObject[\"spectrum\"][i] = Math.round(100 * this.spectrumWave.spectrum[i] / Config.spectrumMax);\n\t\t\t}\n\t\t} else if (this.type == InstrumentType.drumset) {\n\t\t\tinstrumentObject[\"drums\"] = [];\n\t\t\tfor (let j: number = 0; j < Config.drumCount; j++) {\n\t\t\t\tconst spectrum: number[] = [];\n\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\tspectrum[i] = Math.round(100 * this.drumsetSpectrumWaves[j].spectrum[i] / Config.spectrumMax);\n\t\t\t\t}\n\t\t\t\tinstrumentObject[\"drums\"][j] = {\n\t\t\t\t\t\"filterEnvelope\": this.getDrumsetEnvelope(j).name,\n\t\t\t\t\t\"spectrum\": spectrum,\n\t\t\t\t};\n\t\t\t}\n\t\t} else if (this.type == InstrumentType.chip) {\n\t\t\tinstrumentObject[\"wave\"] = Config.chipWaves[this.chipWave].name;\n\t\t\tinstrumentObject[\"unison\"] = Config.unisons[this.unison].name;\n\t\t} else if (this.type == InstrumentType.pwm) {\n\t\t\tinstrumentObject[\"pulseWidth\"] = Math.round(getPulseWidthRatio(this.pulseWidth) * 100 * 100000) / 100000;\n\t\t} else if (this.type == InstrumentType.pickedString) {\n\t\t\tinstrumentObject[\"unison\"] = Config.unisons[this.unison].name;\n\t\t\tinstrumentObject[\"stringSustain\"] = Math.round(100 * this.stringSustain / (Config.stringSustainRange - 1));\n\t\t} else if (this.type == InstrumentType.harmonics) {\n\t\t\tinstrumentObject[\"unison\"] = Config.unisons[this.unison].name;\n\t\t} else if (this.type == InstrumentType.fm) {\n\t\t\tconst operatorArray: Object[] = [];\n\t\t\tfor (const operator of this.operators) {\n\t\t\t\toperatorArray.push({\n\t\t\t\t\t\"frequency\": Config.operatorFrequencies[operator.frequency].name,\n\t\t\t\t\t\"amplitude\": operator.amplitude,\n\t\t\t\t});\n\t\t\t}\n\t\t\tinstrumentObject[\"algorithm\"] = Config.algorithms[this.algorithm].name;\n\t\t\tinstrumentObject[\"feedbackType\"] = Config.feedbacks[this.feedbackType].name;\n\t\t\tinstrumentObject[\"feedbackAmplitude\"] = this.feedbackAmplitude;\n\t\t\tinstrumentObject[\"operators\"] = operatorArray;\n\t\t} else {\n\t\t\tthrow new Error(\"Unrecognized instrument type\");\n\t\t}\n\t\t\n\t\tconst envelopes: any[] = [];\n\t\tfor (let i = 0; i < this.envelopeCount; i++) {\n\t\t\tenvelopes.push(this.envelopes[i].toJsonObject());\n\t\t}\n\t\tinstrumentObject[\"envelopes\"] = envelopes;\n\t\t\n\t\treturn instrumentObject;\n\t}\n\t\n\tpublic fromJsonObject(instrumentObject: any, isNoiseChannel: boolean, legacyGlobalReverb: number = 0): void {\n\t\tif (instrumentObject == undefined) instrumentObject = {};\n\t\t\n\t\tlet type: InstrumentType = Config.instrumentTypeNames.indexOf(instrumentObject[\"type\"]);\n\t\tif (<any>type == -1) type = isNoiseChannel ? InstrumentType.noise : InstrumentType.chip;\n\t\tthis.setTypeAndReset(type, isNoiseChannel);\n\t\t\n\t\tif (instrumentObject[\"preset\"] != undefined) {\n\t\t\tthis.preset = instrumentObject[\"preset\"] >>> 0;\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"volume\"] != undefined) {\n\t\t\tthis.volume = clamp(0, Config.volumeRange, Math.round(5 - (instrumentObject[\"volume\"] | 0) / 20));\n\t\t} else {\n\t\t\tthis.volume = 0;\n\t\t}\n\t\t\n\t\tif (Array.isArray(instrumentObject[\"effects\"])) {\n\t\t\tlet effects: number = 0;\n\t\t\tfor (let i: number = 0; i < instrumentObject[\"effects\"].length; i++) {\n\t\t\t\teffects = effects | (1 << Config.effectNames.indexOf(instrumentObject[\"effects\"][i]));\n\t\t\t}\n\t\t\tthis.effects = (effects & ((1 << EffectType.length) - 1));\n\t\t} else {\n\t\t\t// The index of these names is reinterpreted as a bitfield, which relies on reverb and chorus being the first effects!\n\t\t\tconst legacyEffectsNames: string[] = [\"none\", \"reverb\", \"chorus\", \"chorus & reverb\"];\n\t\t\tthis.effects = legacyEffectsNames.indexOf(instrumentObject[\"effects\"]);\n\t\t\tif (this.effects == -1) this.effects = (this.type == InstrumentType.noise) ? 0 : 1;\n\t\t}\n\t\t\n\t\tthis.transition = Config.transitions.dictionary[\"normal\"].index; // default value.\n\t\tconst transitionProperty: any = instrumentObject[\"transition\"] || instrumentObject[\"envelope\"]; // the transition property used to be called envelope, so check that too.\n\t\tif (transitionProperty != undefined) {\n\t\t\tlet transition: Transition | undefined = Config.transitions.dictionary[transitionProperty];\n\t\t\tif (instrumentObject[\"fadeInSeconds\"] == undefined || instrumentObject[\"fadeOutTicks\"] == undefined) {\n\t\t\t\tconst legacySettings = (<any>{\n\t\t\t\t\t\"binary\":      {transition: \"interrupt\", fadeInSeconds: 0.0,    fadeOutTicks: -1},\n\t\t\t\t\t\"seamless\":    {transition: \"interrupt\", fadeInSeconds: 0.0,    fadeOutTicks: -1},\n\t\t\t\t\t\"sudden\":      {transition: \"normal\",    fadeInSeconds: 0.0,    fadeOutTicks: -3},\n\t\t\t\t\t\"hard\":        {transition: \"normal\",    fadeInSeconds: 0.0,    fadeOutTicks: -3},\n\t\t\t\t\t\"smooth\":      {transition: \"normal\",    fadeInSeconds: 0.025,  fadeOutTicks: -3},\n\t\t\t\t\t\"soft\":        {transition: \"normal\",    fadeInSeconds: 0.025,  fadeOutTicks: -3},\n\t\t\t\t\t// Note that the old slide transition has the same name as a new slide transition that is different.\n\t\t\t\t\t// Only apply legacy settings if the instrument JSON was created before, based on the presence\n\t\t\t\t\t// of the fade in/out fields.\n\t\t\t\t\t\"slide\":       {transition: \"slide in pattern\", fadeInSeconds: 0.025,  fadeOutTicks: -3},\n\t\t\t\t\t\"cross fade\":  {transition: \"normal\",    fadeInSeconds: 0.04,   fadeOutTicks:  6},\n\t\t\t\t\t\"hard fade\":   {transition: \"normal\",    fadeInSeconds: 0.0,    fadeOutTicks: 48},\n\t\t\t\t\t\"medium fade\": {transition: \"normal\",    fadeInSeconds: 0.0125, fadeOutTicks: 72},\n\t\t\t\t\t\"soft fade\":   {transition: \"normal\",    fadeInSeconds: 0.06,   fadeOutTicks: 96},\n\t\t\t\t})[transitionProperty];\n\t\t\t\tif (legacySettings != undefined) {\n\t\t\t\t\ttransition = Config.transitions.dictionary[legacySettings.transition];\n\t\t\t\t\t// These may be overridden below.\n\t\t\t\t\tthis.fadeIn = Synth.secondsToFadeInSetting(legacySettings.fadeInSeconds);\n\t\t\t\t\tthis.fadeOut = Synth.ticksToFadeOutSetting(legacySettings.fadeOutTicks);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (transition != undefined) this.transition = transition.index;\n\t\t\t\n\t\t\tif (this.transition != Config.transitions.dictionary[\"normal\"].index) {\n\t\t\t\t// Enable transition if it was used.\n\t\t\t\tthis.effects = (this.effects | (1 << EffectType.transition));\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Overrides legacy settings in transition above.\n\t\tif (instrumentObject[\"fadeInSeconds\"] != undefined) {\n\t\t\tthis.fadeIn = Synth.secondsToFadeInSetting(+instrumentObject[\"fadeInSeconds\"]);\n\t\t}\n\t\tif (instrumentObject[\"fadeOutTicks\"] != undefined) {\n\t\t\tthis.fadeOut = Synth.ticksToFadeOutSetting(+instrumentObject[\"fadeOutTicks\"]);\n\t\t}\n\t\t\n\t\t{\n\t\t\t// Note that the chord setting may be overridden by instrumentObject[\"chorus\"] below.\n\t\t\tconst chordProperty: any = instrumentObject[\"chord\"];\n\t\t\tconst legacyChordNames: Dictionary<string> = {\"harmony\": \"simultaneous\"};\n\t\t\tconst chord: Chord | undefined = Config.chords.dictionary[legacyChordNames[chordProperty]] || Config.chords.dictionary[chordProperty];\n\t\t\tif (chord != undefined) {\n\t\t\t\tthis.chord = chord.index;\n\t\t\t} else {\n\t\t\t\t// Different instruments have different default chord types based on historical behaviour.\n\t\t\t\tif (this.type == InstrumentType.noise) {\n\t\t\t\t\tthis.chord = Config.chords.dictionary[\"arpeggio\"].index;\n\t\t\t\t} else if (this.type == InstrumentType.pickedString) {\n\t\t\t\t\tthis.chord = Config.chords.dictionary[\"strum\"].index;\n\t\t\t\t} else if (this.type == InstrumentType.chip) {\n\t\t\t\t\tthis.chord = Config.chords.dictionary[\"arpeggio\"].index;\n\t\t\t\t} else if (this.type == InstrumentType.fm) {\n\t\t\t\t\tthis.chord = Config.chords.dictionary[\"custom interval\"].index;\n\t\t\t\t} else {\n\t\t\t\t\tthis.chord = Config.chords.dictionary[\"simultaneous\"].index;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.unison = Config.unisons.dictionary[\"none\"].index; // default value.\n\t\tconst unisonProperty: any = instrumentObject[\"unison\"] || instrumentObject[\"interval\"] || instrumentObject[\"chorus\"]; // The unison property has gone by various names in the past.\n\t\tif (unisonProperty != undefined) {\n\t\t\tconst legacyChorusNames: Dictionary<string> = {\"union\": \"none\", \"fifths\": \"fifth\", \"octaves\": \"octave\"};\n\t\t\tconst unison: Unison | undefined = Config.unisons.dictionary[legacyChorusNames[unisonProperty]] || Config.unisons.dictionary[unisonProperty];\n\t\t\tif (unison != undefined) this.unison = unison.index;\n\t\t}\n\t\tif (instrumentObject[\"chorus\"] == \"custom harmony\") {\n\t\t\t// The original chorus setting had an option that now maps to two different settings. Override those if necessary.\n\t\t\tthis.unison = Config.unisons.dictionary[\"hum\"].index;\n\t\t\tthis.chord = Config.chords.dictionary[\"custom interval\"].index;\n\t\t}\n\t\tif (this.chord != Config.chords.dictionary[\"simultaneous\"].index && !Array.isArray(instrumentObject[\"effects\"])) {\n\t\t\t// Enable chord if it was used.\n\t\t\tthis.effects = (this.effects | (1 << EffectType.chord));\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"pitchShiftSemitones\"] != undefined) {\n\t\t\tthis.pitchShift = clamp(0, Config.pitchShiftRange, Math.round(+instrumentObject[\"pitchShiftSemitones\"]));\n\t\t}\n\t\tif (instrumentObject[\"detuneCents\"] != undefined) {\n\t\t\tthis.detune = clamp(0, Config.detuneMax + 1, Math.round(Config.detuneCenter + Synth.centsToDetune(+instrumentObject[\"detuneCents\"])));\n\t\t}\n\t\t\n\t\tthis.vibrato = Config.vibratos.dictionary[\"none\"].index; // default value.\n\t\tconst vibratoProperty: any = instrumentObject[\"vibrato\"] || instrumentObject[\"effect\"]; // The vibrato property was previously called \"effect\", not to be confused with the current \"effects\".\n\t\tif (vibratoProperty != undefined) {\n\t\t\tconst legacyVibratoNames: Dictionary<string> = {\"vibrato light\": \"light\", \"vibrato delayed\": \"delayed\", \"vibrato heavy\": \"heavy\"};\n\t\t\tconst vibrato: Vibrato | undefined = Config.vibratos.dictionary[legacyVibratoNames[unisonProperty]] || Config.vibratos.dictionary[vibratoProperty];\n\t\t\tif (vibrato != undefined) this.vibrato = vibrato.index;\n\t\t\t\n\t\t\t// Old songs may have a vibrato effect without explicitly enabling it.\n\t\t\tif (vibrato != Config.vibratos.dictionary[\"none\"]) {\n\t\t\t\tthis.effects = (this.effects | (1 << EffectType.vibrato));\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"pan\"] != undefined) {\n\t\t\tthis.pan = clamp(0, Config.panMax + 1, Math.round(Config.panCenter + (instrumentObject[\"pan\"] | 0) * Config.panCenter / 100));\n\t\t\t\n\t\t\t// Old songs may have a panning effect without explicitly enabling it.\n\t\t\tif (this.pan != Config.panCenter) {\n\t\t\t\tthis.effects = (this.effects | (1 << EffectType.panning));\n\t\t\t}\n\t\t} else {\n\t\t\tthis.pan = Config.panCenter;\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"distortion\"] != undefined) {\n\t\t\tthis.distortion = clamp(0, Config.distortionRange, Math.round((Config.distortionRange - 1) * (instrumentObject[\"distortion\"] | 0) / 100));\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"bitcrusherOctave\"] != undefined) {\n\t\t\tthis.bitcrusherFreq = Config.bitcrusherFreqRange - 1 - (+instrumentObject[\"bitcrusherOctave\"]) / Config.bitcrusherOctaveStep;\n\t\t}\n\t\tif (instrumentObject[\"bitcrusherQuantization\"] != undefined) {\n\t\t\tthis.bitcrusherQuantization = clamp(0, Config.bitcrusherQuantizationRange, Math.round((Config.bitcrusherQuantizationRange - 1) * (instrumentObject[\"bitcrusherQuantization\"] | 0) / 100));\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"echoSustain\"] != undefined) {\n\t\t\tthis.echoSustain = clamp(0, Config.echoSustainRange, Math.round((Config.echoSustainRange - 1) * (instrumentObject[\"echoSustain\"] | 0) / 100));\n\t\t}\n\t\tif (instrumentObject[\"echoDelayBeats\"] != undefined) {\n\t\t\tthis.echoDelay = clamp(0, Config.echoDelayRange, Math.round((+instrumentObject[\"echoDelayBeats\"]) * (Config.ticksPerPart * Config.partsPerBeat) / Config.echoDelayStepTicks - 1.0));\n\t\t}\n\t\t\n\t\tif (!isNaN(instrumentObject[\"chorus\"])) {\n\t\t\tthis.chorus = clamp(0, Config.chorusRange, Math.round((Config.chorusRange - 1) * (instrumentObject[\"chorus\"] | 0) / 100));\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"reverb\"] != undefined) {\n\t\t\tthis.reverb = clamp(0, Config.reverbRange, Math.round((Config.reverbRange - 1) * (instrumentObject[\"reverb\"] | 0) / 100));\n\t\t} else {\n\t\t\tif (legacyGlobalReverb == 0) {\n\t\t\t\t// If the original song reverb was zero, just disable the instrument reverb effect entirely.\n\t\t\t\tthis.effects = (this.effects & (~(1 << EffectType.reverb)));\n\t\t\t} else {\n\t\t\t\tthis.reverb = legacyGlobalReverb;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"pulseWidth\"] != undefined) {\n\t\t\tthis.pulseWidth = clamp(0, Config.pulseWidthRange, Math.round(Math.log2((+instrumentObject[\"pulseWidth\"]) / 50) / 0.5 - 1 + 8));\n\t\t} else {\n\t\t\tthis.pulseWidth = Config.pulseWidthRange - 1;\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"harmonics\"] != undefined) {\n\t\t\tfor (let i: number = 0; i < Config.harmonicsControlPoints; i++) {\n\t\t\t\tthis.harmonicsWave.harmonics[i] = Math.max(0, Math.min(Config.harmonicsMax, Math.round(Config.harmonicsMax * (+instrumentObject[\"harmonics\"][i]) / 100)));\n\t\t\t}\n\t\t} else {\n\t\t\tthis.harmonicsWave.reset();\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"spectrum\"] != undefined) {\n\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\tthis.spectrumWave.spectrum[i] = Math.max(0, Math.min(Config.spectrumMax, Math.round(Config.spectrumMax * (+instrumentObject[\"spectrum\"][i]) / 100)));\n\t\t\t}\n\t\t} else {\n\t\t\tthis.spectrumWave.reset(isNoiseChannel);\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"stringSustain\"] != undefined) {\n\t\t\tthis.stringSustain = clamp(0, Config.stringSustainRange, Math.round((Config.stringSustainRange - 1) * (instrumentObject[\"stringSustain\"] | 0) / 100));\n\t\t} else {\n\t\t\tthis.stringSustain = 10;\n\t\t}\n\t\t\n\t\tif (this.type == InstrumentType.noise) {\n\t\t\tthis.chipNoise = Config.chipNoises.findIndex(wave=>wave.name==instrumentObject[\"wave\"]);\n\t\t\tif (this.chipNoise == -1) this.chipNoise = 1;\n\t\t}\n\t\t\n\t\tconst legacyEnvelopeNames: Dictionary<string> = {\"custom\": \"note size\", \"steady\": \"none\", \"pluck 1\": \"twang 1\", \"pluck 2\": \"twang 2\", \"pluck 3\": \"twang 3\"};\n\t\tconst getEnvelope = (name: any): Envelope | undefined => (legacyEnvelopeNames[name] != undefined) ? Config.envelopes.dictionary[legacyEnvelopeNames[name]] : Config.envelopes.dictionary[name];\n\t\t\n\t\tif (this.type == InstrumentType.drumset) {\n\t\t\tif (instrumentObject[\"drums\"] != undefined) {\n\t\t\t\tfor (let j: number = 0; j < Config.drumCount; j++) {\n\t\t\t\t\tconst drum: any = instrumentObject[\"drums\"][j];\n\t\t\t\t\tif (drum == undefined) continue;\n\t\t\t\t\t\n\t\t\t\t\tthis.drumsetEnvelopes[j] = Config.envelopes.dictionary[\"twang 2\"].index; // default value.\n\t\t\t\t\tif (drum[\"filterEnvelope\"] != undefined) {\n\t\t\t\t\t\tconst envelope: Envelope | undefined = getEnvelope(drum[\"filterEnvelope\"]);\n\t\t\t\t\t\tif (envelope != undefined) this.drumsetEnvelopes[j] = envelope.index;\n\t\t\t\t\t}\n\t\t\t\t\tif (drum[\"spectrum\"] != undefined) {\n\t\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\t\tthis.drumsetSpectrumWaves[j].spectrum[i] = Math.max(0, Math.min(Config.spectrumMax, Math.round(Config.spectrumMax * (+drum[\"spectrum\"][i]) / 100)));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this.type == InstrumentType.chip) {\n\t\t\tconst legacyWaveNames: Dictionary<number> = {\"triangle\": 1, \"square\": 2, \"pulse wide\": 3, \"pulse narrow\": 4, \"sawtooth\": 5, \"double saw\": 6, \"double pulse\": 7, \"spiky\": 8, \"plateau\": 0};\n\t\t\tthis.chipWave = legacyWaveNames[instrumentObject[\"wave\"]] != undefined ? legacyWaveNames[instrumentObject[\"wave\"]] : Config.chipWaves.findIndex(wave=>wave.name==instrumentObject[\"wave\"]);\n\t\t\tif (this.chipWave == -1) this.chipWave = 1;\n\t\t}\n\t\t\n\t\tif (this.type == InstrumentType.fm) {\n\t\t\tthis.algorithm = Config.algorithms.findIndex(algorithm=>algorithm.name==instrumentObject[\"algorithm\"]);\n\t\t\tif (this.algorithm == -1) this.algorithm = 0;\n\t\t\tthis.feedbackType = Config.feedbacks.findIndex(feedback=>feedback.name==instrumentObject[\"feedbackType\"]);\n\t\t\tif (this.feedbackType == -1) this.feedbackType = 0;\n\t\t\tif (instrumentObject[\"feedbackAmplitude\"] != undefined) {\n\t\t\t\tthis.feedbackAmplitude = clamp(0, Config.operatorAmplitudeMax + 1, instrumentObject[\"feedbackAmplitude\"] | 0);\n\t\t\t} else {\n\t\t\t\tthis.feedbackAmplitude = 0;\n\t\t\t}\n\t\t\t\n\t\t\tfor (let j: number = 0; j < Config.operatorCount; j++) {\n\t\t\t\tconst operator: Operator = this.operators[j];\n\t\t\t\tlet operatorObject: any = undefined;\n\t\t\t\tif (instrumentObject[\"operators\"] != undefined) operatorObject = instrumentObject[\"operators\"][j];\n\t\t\t\tif (operatorObject == undefined) operatorObject = {};\n\t\t\t\t\n\t\t\t\toperator.frequency = Config.operatorFrequencies.findIndex(freq=>freq.name==operatorObject[\"frequency\"]);\n\t\t\t\tif (operator.frequency == -1) operator.frequency = 0;\n\t\t\t\tif (operatorObject[\"amplitude\"] != undefined) {\n\t\t\t\t\toperator.amplitude = clamp(0, Config.operatorAmplitudeMax + 1, operatorObject[\"amplitude\"] | 0);\n\t\t\t\t} else {\n\t\t\t\t\toperator.amplitude = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (instrumentObject[\"noteFilter\"] != undefined) {\n\t\t\tthis.noteFilter.fromJsonObject(instrumentObject[\"noteFilter\"]);\n\t\t} else {\n\t\t\tthis.noteFilter.reset();\n\t\t}\n\t\tif (Array.isArray(instrumentObject[\"eqFilter\"])) {\n\t\t\tthis.eqFilter.fromJsonObject(instrumentObject[\"eqFilter\"]);\n\t\t} else {\n\t\t\tthis.eqFilter.reset();\n\t\t\t\n\t\t\tconst legacySettings: LegacySettings = {};\n\t\t\t\n\t\t\t// Try converting from legacy filter settings.\n\t\t\tconst filterCutoffMaxHz: number = 8000;\n\t\t\tconst filterCutoffRange: number = 11;\n\t\t\tconst filterResonanceRange: number = 8;\n\t\t\tif (instrumentObject[\"filterCutoffHz\"] != undefined) {\n\t\t\t\tlegacySettings.filterCutoff = clamp(0, filterCutoffRange, Math.round((filterCutoffRange - 1) + 2.0 * Math.log((instrumentObject[\"filterCutoffHz\"] | 0) / filterCutoffMaxHz) / Math.LN2));\n\t\t\t} else {\n\t\t\t\tlegacySettings.filterCutoff = (this.type == InstrumentType.chip) ? 6 : 10;\n\t\t\t}\n\t\t\tif (instrumentObject[\"filterResonance\"] != undefined) {\n\t\t\t\tlegacySettings.filterResonance = clamp(0, filterResonanceRange, Math.round((filterResonanceRange - 1) * (instrumentObject[\"filterResonance\"] | 0) / 100));\n\t\t\t} else {\n\t\t\t\tlegacySettings.filterResonance = 0;\n\t\t\t}\n\t\t\t\n\t\t\tlegacySettings.filterEnvelope = getEnvelope(instrumentObject[\"filterEnvelope\"]);\n\t\t\tlegacySettings.pulseEnvelope = getEnvelope(instrumentObject[\"pulseEnvelope\"]);\n\t\t\tlegacySettings.feedbackEnvelope = getEnvelope(instrumentObject[\"feedbackEnvelope\"]);\n\t\t\tif (Array.isArray(instrumentObject[\"operators\"])) {\n\t\t\t\tlegacySettings.operatorEnvelopes = [];\n\t\t\t\tfor (let j: number = 0; j < Config.operatorCount; j++) {\n\t\t\t\t\tlet envelope: Envelope | undefined;\n\t\t\t\t\tif (instrumentObject[\"operators\"][j] != undefined) {\n\t\t\t\t\t\tenvelope = getEnvelope(instrumentObject[\"operators\"][j][\"envelope\"]);\n\t\t\t\t\t}\n\t\t\t\t\tlegacySettings.operatorEnvelopes[j] = (envelope != undefined) ? envelope : Config.envelopes.dictionary[\"none\"];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Try converting from even older legacy filter settings.\n\t\t\tif (instrumentObject[\"filter\"] != undefined) {\n\t\t\t\tconst legacyToCutoff: number[] = [10, 6, 3, 0, 8, 5, 2];\n\t\t\t\tconst legacyToEnvelope: string[] = [\"none\", \"none\", \"none\", \"none\", \"decay 1\", \"decay 2\", \"decay 3\"];\n\t\t\t\tconst filterNames: string[] = [\"none\", \"bright\", \"medium\", \"soft\", \"decay bright\", \"decay medium\", \"decay soft\"];\n\t\t\t\tconst oldFilterNames: Dictionary<number> = {\"sustain sharp\": 1, \"sustain medium\": 2, \"sustain soft\": 3, \"decay sharp\": 4};\n\t\t\t\tlet legacyFilter: number = oldFilterNames[instrumentObject[\"filter\"]] != undefined ? oldFilterNames[instrumentObject[\"filter\"]] : filterNames.indexOf(instrumentObject[\"filter\"]);\n\t\t\t\tif (legacyFilter == -1) legacyFilter = 0;\n\t\t\t\tlegacySettings.filterCutoff = legacyToCutoff[legacyFilter];\n\t\t\t\tlegacySettings.filterEnvelope = getEnvelope(legacyToEnvelope[legacyFilter]);\n\t\t\t\tlegacySettings.filterResonance = 0;\n\t\t\t}\n\t\t\t\n\t\t\tthis.convertLegacySettings(legacySettings);\n\t\t}\n\t\t\n\t\tif (Array.isArray(instrumentObject[\"envelopes\"])) {\n\t\t\tconst envelopeArray: any[] = instrumentObject[\"envelopes\"];\n\t\t\tfor (let i = 0; i < envelopeArray.length; i++) {\n\t\t\t\tif (this.envelopeCount >= Config.maxEnvelopeCount) break;\n\t\t\t\tconst tempEnvelope: EnvelopeSettings = new EnvelopeSettings();\n\t\t\t\ttempEnvelope.fromJsonObject(envelopeArray[i]);\n\t\t\t\tthis.addEnvelope(tempEnvelope.target, tempEnvelope.index, tempEnvelope.envelope);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic static frequencyFromPitch(pitch: number): number {\n\t\treturn 440.0 * Math.pow(2.0, (pitch - 69.0) / 12.0);\n\t}\n\t\n\tpublic static drumsetIndexReferenceDelta(index: number): number {\n\t\treturn Instrument.frequencyFromPitch(Config.spectrumBasePitch + index * 6) / 44100;\n\t}\n\t\n\tprivate static _drumsetIndexToSpectrumOctave(index: number) {\n\t\treturn 15 + Math.log2(Instrument.drumsetIndexReferenceDelta(index));\n\t}\n\t\n\tpublic addEnvelope(target: number, index: number, envelope: number): void {\n\t\tif (!this.supportsEnvelopeTarget(target, index)) throw new Error();\n\t\tif (this.envelopeCount >= Config.maxEnvelopeCount) throw new Error();\n\t\twhile (this.envelopes.length <= this.envelopeCount) this.envelopes[this.envelopes.length] = new EnvelopeSettings();\n\t\tconst envelopeSettings: EnvelopeSettings = this.envelopes[this.envelopeCount];\n\t\tenvelopeSettings.target = target;\n\t\tenvelopeSettings.index = index;\n\t\tenvelopeSettings.envelope = envelope;\n\t\tthis.envelopeCount++;\n\t}\n\t\n\tpublic supportsEnvelopeTarget(target: number, index: number): boolean {\n\t\tconst automationTarget: AutomationTarget = Config.instrumentAutomationTargets[target];\n\t\tif (index >= automationTarget.maxCount) {\n\t\t\treturn false;\n\t\t}\n\t\tif (automationTarget.compatibleInstruments != null && automationTarget.compatibleInstruments.indexOf(this.type) == -1) {\n\t\t\treturn false;\n\t\t}\n\t\tif (automationTarget.effect != null && (this.effects & (1 << automationTarget.effect)) == 0) {\n\t\t\treturn false;\n\t\t}\n\t\tif (automationTarget.isFilter) {\n\t\t\t//if (automationTarget.perNote) {\n\t\t\t\tif (index >= this.noteFilter.controlPointCount) return false;\n\t\t\t//} else {\n\t\t\t//\tif (index >= this.eqFilter.controlPointCount)   return false;\n\t\t\t//}\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tpublic clearInvalidEnvelopeTargets(): void {\n\t\tfor (let envelopeIndex: number = 0; envelopeIndex < this.envelopeCount; envelopeIndex++) {\n\t\t\tconst target: number = this.envelopes[envelopeIndex].target;\n\t\t\tconst index: number = this.envelopes[envelopeIndex].index;\n\t\t\tif (!this.supportsEnvelopeTarget(target, index)) {\n\t\t\t\tthis.envelopes[envelopeIndex].target = Config.instrumentAutomationTargets.dictionary[\"none\"].index;\n\t\t\t\tthis.envelopes[envelopeIndex].index = 0;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic warmUp(samplesPerSecond: number): void {\n\t\tif (this.type == InstrumentType.noise) {\n\t\t\tgetDrumWave(this.chipNoise, inverseRealFourierTransform, scaleElementsByFactor);\n\t\t} else if (this.type == InstrumentType.harmonics) {\n\t\t\tthis.harmonicsWave.getCustomWave(this.type);\n\t\t} else if (this.type == InstrumentType.pickedString) {\n\t\t\tthis.harmonicsWave.getCustomWave(this.type);\n\t\t} else if (this.type == InstrumentType.spectrum) {\n\t\t\tthis.spectrumWave.getCustomWave(8);\n\t\t} else if (this.type == InstrumentType.drumset) {\n\t\t\tfor (let i: number = 0; i < Config.drumCount; i++) {\n\t\t\t\tthis.drumsetSpectrumWaves[i].getCustomWave(Instrument._drumsetIndexToSpectrumOctave(i));\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic getDrumWave(): Float32Array {\n\t\tif (this.type == InstrumentType.noise) {\n\t\t\treturn getDrumWave(this.chipNoise, inverseRealFourierTransform, scaleElementsByFactor);\n\t\t} else if (this.type == InstrumentType.spectrum) {\n\t\t\treturn this.spectrumWave.getCustomWave(8);\n\t\t} else {\n\t\t\tthrow new Error(\"Unhandled instrument type in getDrumWave\");\n\t\t}\n\t}\n\t\n\tpublic getDrumsetWave(pitch: number): Float32Array {\n\t\tif (this.type == InstrumentType.drumset) {\n\t\t\treturn this.drumsetSpectrumWaves[pitch].getCustomWave(Instrument._drumsetIndexToSpectrumOctave(pitch));\n\t\t} else {\n\t\t\tthrow new Error(\"Unhandled instrument type in getDrumsetWave\");\n\t\t}\n\t}\n\t\n\tpublic getTransition(): Transition {\n\t\treturn effectsIncludeTransition(this.effects) ? Config.transitions[this.transition] : Config.transitions.dictionary[\"normal\"];\n\t}\n\t\n\tpublic getFadeInSeconds(): number {\n\t\treturn (this.type == InstrumentType.drumset) ? 0.0 : Synth.fadeInSettingToSeconds(this.fadeIn);\n\t}\n\t\n\tpublic getFadeOutTicks(): number {\n\t\treturn (this.type == InstrumentType.drumset) ? Config.drumsetFadeOutTicks : Synth.fadeOutSettingToTicks(this.fadeOut)\n\t}\n\t\n\tpublic getChord(): Chord {\n\t\treturn effectsIncludeChord(this.effects) ? Config.chords[this.chord] : Config.chords.dictionary[\"simultaneous\"];\n\t}\n\t\n\tpublic getDrumsetEnvelope(pitch: number): Envelope {\n\t\tif (this.type != InstrumentType.drumset) throw new Error(\"Can't getDrumsetEnvelope() for non-drumset.\");\n\t\treturn Config.envelopes[this.drumsetEnvelopes[pitch]];\n\t}\n}\n\nexport class Channel {\n\tpublic octave: number = 0;\n\tpublic readonly instruments: Instrument[] = [];\n\tpublic readonly patterns: Pattern[] = [];\n\tpublic readonly bars: number[] = [];\n\tpublic muted: boolean = false;\n}\n\nexport class Song {\n\tprivate static readonly _format: string = \"BeepBox\";\n\tprivate static readonly _oldestVersion: number = 2;\n\tprivate static readonly _latestVersion: number = 9;\n\t\n\tpublic scale: number;\n\tpublic key: number;\n\tpublic tempo: number;\n\tpublic beatsPerBar: number;\n\tpublic barCount: number;\n\tpublic patternsPerChannel: number;\n\tpublic rhythm: number;\n\tpublic layeredInstruments: boolean;\n\tpublic patternInstruments: boolean;\n\tpublic loopStart: number;\n\tpublic loopLength: number;\n\tpublic pitchChannelCount: number;\n\tpublic noiseChannelCount: number;\n\tpublic readonly channels: Channel[] = [];\n\t\n\tconstructor(string?: string) {\n\t\tif (string != undefined) {\n\t\t\tthis.fromBase64String(string);\n\t\t} else {\n\t\t\tthis.initToDefault(true);\n\t\t}\n\t}\n\t\n\tpublic getChannelCount(): number {\n\t\treturn this.pitchChannelCount + this.noiseChannelCount;\n\t}\n\t\n\tpublic getMaxInstrumentsPerChannel(): number {\n\t\treturn Math.max(\n\t\t\tthis.layeredInstruments ? Config.layeredInstrumentCountMax : Config.instrumentCountMin,\n\t\t\tthis.patternInstruments ? Config.patternInstrumentCountMax : Config.instrumentCountMin);\n\t}\n\t\n\tpublic getMaxInstrumentsPerPattern(channelIndex: number): number {\n\t\treturn this.getMaxInstrumentsPerPatternForChannel(this.channels[channelIndex]);\n\t}\n\t\n\tpublic getMaxInstrumentsPerPatternForChannel(channel: Channel): number {\n\t\treturn this.layeredInstruments\n\t\t\t? Math.min(Config.layeredInstrumentCountMax, channel.instruments.length)\n\t\t\t: 1;\n\t}\n\t\n\tpublic getChannelIsNoise(channelIndex: number): boolean {\n\t\treturn (channelIndex >= this.pitchChannelCount);\n\t}\n\t\n\tpublic initToDefault(andResetChannels: boolean = true): void {\n\t\tthis.scale = 0;\n\t\tthis.key = 0;\n\t\tthis.loopStart = 0;\n\t\tthis.loopLength = 4;\n\t\tthis.tempo = 150;\n\t\tthis.beatsPerBar = 8;\n\t\tthis.barCount = 16;\n\t\tthis.patternsPerChannel = 8;\n\t\tthis.rhythm = 1;\n\t\tthis.layeredInstruments = false;\n\t\tthis.patternInstruments = false;\n\t\t\n\t\tif (andResetChannels) {\n\t\t\tthis.pitchChannelCount = 3;\n\t\t\tthis.noiseChannelCount = 1;\n\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\tconst isNoiseChannel: boolean = channelIndex >= this.pitchChannelCount;\n\t\t\t\tif (this.channels.length <= channelIndex) {\n\t\t\t\t\tthis.channels[channelIndex] = new Channel();\n\t\t\t\t}\n\t\t\t\tconst channel: Channel = this.channels[channelIndex];\n\t\t\t\tchannel.octave = isNoiseChannel ? 0 : 4 - channelIndex; // [4, 3, 2, 0]: Descending octaves with drums at zero in last channel.\n\t\t\t\n\t\t\t\tfor (let pattern: number = 0; pattern < this.patternsPerChannel; pattern++) {\n\t\t\t\t\tif (channel.patterns.length <= pattern) {\n\t\t\t\t\t\tchannel.patterns[pattern] = new Pattern();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tchannel.patterns[pattern].reset();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tchannel.patterns.length = this.patternsPerChannel;\n\t\t\t\n\t\t\t\tfor (let instrument: number = 0; instrument < Config.instrumentCountMin; instrument++) {\n\t\t\t\t\tif (channel.instruments.length <= instrument) {\n\t\t\t\t\t\tchannel.instruments[instrument] = new Instrument(isNoiseChannel);\n\t\t\t\t\t}\n\t\t\t\t\tchannel.instruments[instrument].setTypeAndReset(isNoiseChannel ? InstrumentType.noise : InstrumentType.chip, isNoiseChannel);\n\t\t\t\t}\n\t\t\t\tchannel.instruments.length = Config.instrumentCountMin;\n\t\t\t\n\t\t\t\tfor (let bar: number = 0; bar < this.barCount; bar++) {\n\t\t\t\t\tchannel.bars[bar] = bar < 4 ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tchannel.bars.length = this.barCount;\n\t\t\t}\n\t\t\tthis.channels.length = this.getChannelCount();\n\t\t}\n\t}\n\t\n\tpublic toBase64String(): string {\n\t\tlet bits: BitFieldWriter;\n\t\tlet buffer: number[] = [];\n\t\t\n\t\tbuffer.push(base64IntToCharCode[Song._latestVersion]);\n\t\tbuffer.push(SongTagCode.channelCount, base64IntToCharCode[this.pitchChannelCount], base64IntToCharCode[this.noiseChannelCount]);\n\t\tbuffer.push(SongTagCode.scale, base64IntToCharCode[this.scale]);\n\t\tbuffer.push(SongTagCode.key, base64IntToCharCode[this.key]);\n\t\tbuffer.push(SongTagCode.loopStart, base64IntToCharCode[this.loopStart >> 6], base64IntToCharCode[this.loopStart & 0x3f]);\n\t\tbuffer.push(SongTagCode.loopEnd, base64IntToCharCode[(this.loopLength - 1) >> 6], base64IntToCharCode[(this.loopLength - 1) & 0x3f]);\n\t\tbuffer.push(SongTagCode.tempo, base64IntToCharCode[this.tempo >> 6], base64IntToCharCode[this.tempo & 63]);\n\t\tbuffer.push(SongTagCode.beatCount, base64IntToCharCode[this.beatsPerBar - 1]);\n\t\tbuffer.push(SongTagCode.barCount, base64IntToCharCode[(this.barCount - 1) >> 6], base64IntToCharCode[(this.barCount - 1) & 0x3f]);\n\t\tbuffer.push(SongTagCode.patternCount, base64IntToCharCode[(this.patternsPerChannel - 1) >> 6], base64IntToCharCode[(this.patternsPerChannel - 1) & 0x3f]);\n\t\tbuffer.push(SongTagCode.rhythm, base64IntToCharCode[this.rhythm]);\n\t\t\n\t\tbuffer.push(SongTagCode.instrumentCount, base64IntToCharCode[(<any>this.layeredInstruments << 1) | <any>this.patternInstruments]);\n\t\tif (this.layeredInstruments || this.patternInstruments) {\n\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\tbuffer.push(base64IntToCharCode[this.channels[channelIndex].instruments.length - Config.instrumentCountMin]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tbuffer.push(SongTagCode.channelOctave);\n\t\tfor (let channelIndex: number = 0; channelIndex < this.pitchChannelCount; channelIndex++) {\n\t\t\tbuffer.push(base64IntToCharCode[this.channels[channelIndex].octave]);\n\t\t}\n\t\t\n\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\tfor (let i: number = 0; i < this.channels[channelIndex].instruments.length; i++) {\n\t\t\t\tconst instrument: Instrument = this.channels[channelIndex].instruments[i];\n\t\t\t\tbuffer.push(SongTagCode.startInstrument, base64IntToCharCode[instrument.type]);\n\t\t\t\tbuffer.push(SongTagCode.volume, base64IntToCharCode[instrument.volume]);\n\t\t\t\tbuffer.push(SongTagCode.preset, base64IntToCharCode[instrument.preset >> 6], base64IntToCharCode[instrument.preset & 63]);\n\t\t\t\t\n\t\t\t\tbuffer.push(SongTagCode.eqFilter, base64IntToCharCode[instrument.eqFilter.controlPointCount]);\n\t\t\t\tfor (let j: number = 0; j < instrument.eqFilter.controlPointCount; j++) {\n\t\t\t\t\tconst point: FilterControlPoint = instrument.eqFilter.controlPoints[j];\n\t\t\t\t\tbuffer.push(base64IntToCharCode[point.type], base64IntToCharCode[point.freq], base64IntToCharCode[point.gain]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// The list of enabled effects is represented as a 12-bit bitfield using two six-bit characters.\n\t\t\t\tbuffer.push(SongTagCode.effects, base64IntToCharCode[instrument.effects >> 6], base64IntToCharCode[instrument.effects & 63]);\n\t\t\t\tif (effectsIncludeNoteFilter(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.noteFilter.controlPointCount]);\n\t\t\t\t\tfor (let j: number = 0; j < instrument.noteFilter.controlPointCount; j++) {\n\t\t\t\t\t\tconst point: FilterControlPoint = instrument.noteFilter.controlPoints[j];\n\t\t\t\t\t\tbuffer.push(base64IntToCharCode[point.type], base64IntToCharCode[point.freq], base64IntToCharCode[point.gain]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeTransition(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.transition]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeChord(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.chord]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludePitchShift(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.pitchShift]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeDetune(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.detune]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeVibrato(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.vibrato]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeDistortion(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.distortion]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeBitcrusher(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.bitcrusherFreq], base64IntToCharCode[instrument.bitcrusherQuantization]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludePanning(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.pan]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeChorus(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.chorus]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeEcho(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.echoSustain], base64IntToCharCode[instrument.echoDelay]);\n\t\t\t\t}\n\t\t\t\tif (effectsIncludeReverb(instrument.effects)) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.reverb]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (instrument.type != InstrumentType.drumset) {\n\t\t\t\t\tbuffer.push(SongTagCode.fadeInOut, base64IntToCharCode[instrument.fadeIn], base64IntToCharCode[instrument.fadeOut]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (instrument.type == InstrumentType.harmonics || instrument.type == InstrumentType.pickedString) {\n\t\t\t\t\tbuffer.push(SongTagCode.harmonics);\n\t\t\t\t\tconst harmonicsBits: BitFieldWriter = new BitFieldWriter();\n\t\t\t\t\tfor (let i: number = 0; i < Config.harmonicsControlPoints; i++) {\n\t\t\t\t\t\tharmonicsBits.write(Config.harmonicsControlPointBits, instrument.harmonicsWave.harmonics[i]);\n\t\t\t\t\t}\n\t\t\t\t\tharmonicsBits.encodeBase64(buffer);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (instrument.type == InstrumentType.chip) {\n\t\t\t\t\tbuffer.push(SongTagCode.wave, base64IntToCharCode[instrument.chipWave]);\n\t\t\t\t\tbuffer.push(SongTagCode.unison, base64IntToCharCode[instrument.unison]);\n\t\t\t\t} else if (instrument.type == InstrumentType.fm) {\n\t\t\t\t\tbuffer.push(SongTagCode.algorithm, base64IntToCharCode[instrument.algorithm]);\n\t\t\t\t\tbuffer.push(SongTagCode.feedbackType, base64IntToCharCode[instrument.feedbackType]);\n\t\t\t\t\tbuffer.push(SongTagCode.feedbackAmplitude, base64IntToCharCode[instrument.feedbackAmplitude]);\n\t\t\t\t\t\n\t\t\t\t\tbuffer.push(SongTagCode.operatorFrequencies);\n\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\n\t\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.operators[o].frequency]);\n\t\t\t\t\t}\n\t\t\t\t\tbuffer.push(SongTagCode.operatorAmplitudes);\n\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\n\t\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.operators[o].amplitude]);\n\t\t\t\t\t}\n\t\t\t\t} else if (instrument.type == InstrumentType.noise) {\n\t\t\t\t\tbuffer.push(SongTagCode.wave, base64IntToCharCode[instrument.chipNoise]);\n\t\t\t\t} else if (instrument.type == InstrumentType.spectrum) {\n\t\t\t\t\tbuffer.push(SongTagCode.spectrum);\n\t\t\t\t\tconst spectrumBits: BitFieldWriter = new BitFieldWriter();\n\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\tspectrumBits.write(Config.spectrumControlPointBits, instrument.spectrumWave.spectrum[i]);\n\t\t\t\t\t}\n\t\t\t\t\tspectrumBits.encodeBase64(buffer);\n\t\t\t\t} else if (instrument.type == InstrumentType.drumset) {\n\t\t\t\t\tbuffer.push(SongTagCode.drumsetEnvelopes);\n\t\t\t\t\tfor (let j: number = 0; j < Config.drumCount; j++) {\n\t\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.drumsetEnvelopes[j]]);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tbuffer.push(SongTagCode.spectrum);\n\t\t\t\t\tconst spectrumBits: BitFieldWriter = new BitFieldWriter();\n\t\t\t\t\tfor (let j: number = 0; j < Config.drumCount; j++) {\n\t\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\t\tspectrumBits.write(Config.spectrumControlPointBits, instrument.drumsetSpectrumWaves[j].spectrum[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tspectrumBits.encodeBase64(buffer);\n\t\t\t\t} else if (instrument.type == InstrumentType.harmonics) {\n\t\t\t\t\tbuffer.push(SongTagCode.unison, base64IntToCharCode[instrument.unison]);\n\t\t\t\t} else if (instrument.type == InstrumentType.pwm) {\n\t\t\t\t\tbuffer.push(SongTagCode.pulseWidth, base64IntToCharCode[instrument.pulseWidth]);\n\t\t\t\t} else if (instrument.type == InstrumentType.pickedString) {\n\t\t\t\t\tbuffer.push(SongTagCode.unison, base64IntToCharCode[instrument.unison]);\n\t\t\t\t\tbuffer.push(SongTagCode.stringSustain, base64IntToCharCode[instrument.stringSustain]);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(\"Unknown instrument type.\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tbuffer.push(SongTagCode.envelopes, base64IntToCharCode[instrument.envelopeCount]);\n\t\t\t\tfor (let envelopeIndex: number = 0; envelopeIndex < instrument.envelopeCount; envelopeIndex++) {\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.envelopes[envelopeIndex].target]);\n\t\t\t\t\tif (Config.instrumentAutomationTargets[instrument.envelopes[envelopeIndex].target].maxCount > 1) {\n\t\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.envelopes[envelopeIndex].index]);\n\t\t\t\t\t}\n\t\t\t\t\tbuffer.push(base64IntToCharCode[instrument.envelopes[envelopeIndex].envelope]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tbuffer.push(SongTagCode.bars);\n\t\tbits = new BitFieldWriter();\n\t\tlet neededBits: number = 0;\n\t\twhile ((1 << neededBits) < this.patternsPerChannel + 1) neededBits++;\n\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) for (let i: number = 0; i < this.barCount; i++) {\n\t\t\tbits.write(neededBits, this.channels[channelIndex].bars[i]);\n\t\t}\n\t\tbits.encodeBase64(buffer);\n\t\t\n\t\tbuffer.push(SongTagCode.patterns);\n\t\tbits = new BitFieldWriter();\n\t\tconst shapeBits: BitFieldWriter = new BitFieldWriter();\n\t\tconst bitsPerNoteSize: number = Song.getNeededBits(Config.noteSizeMax);\n\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\tconst channel: Channel = this.channels[channelIndex];\n\t\t\tconst maxInstrumentsPerPattern: number = this.getMaxInstrumentsPerPattern(channelIndex);\n\t\t\tconst neededInstrumentCountBits: number = Song.getNeededBits(maxInstrumentsPerPattern - Config.instrumentCountMin);\n\t\t\tconst neededInstrumentIndexBits: number = Song.getNeededBits(channel.instruments.length - 1);\n\t\t\tconst isNoiseChannel: boolean = this.getChannelIsNoise(channelIndex);\n\t\t\tconst octaveOffset: number = isNoiseChannel ? 0 : channel.octave * Config.pitchesPerOctave;\n\t\t\tlet lastPitch: number = (isNoiseChannel ? 4 : octaveOffset);\n\t\t\tconst recentPitches: number[] = isNoiseChannel ? [4,6,7,2,3,8,0,10] : [0, 7, 12, 19, 24, -5, -12];\n\t\t\tconst recentShapes: string[] = [];\n\t\t\tfor (let i: number = 0; i < recentPitches.length; i++) {\n\t\t\t\trecentPitches[i] += octaveOffset;\n\t\t\t}\n\t\t\tfor (const pattern of channel.patterns) {\n\t\t\t\tif (this.patternInstruments) {\n\t\t\t\t\tconst instrumentCount: number = validateRange(Config.instrumentCountMin, maxInstrumentsPerPattern, pattern.instruments.length);\n\t\t\t\t\tbits.write(neededInstrumentCountBits, instrumentCount - Config.instrumentCountMin);\n\t\t\t\t\tfor (let i: number = 0; i < instrumentCount; i++) {\n\t\t\t\t\t\tbits.write(neededInstrumentIndexBits, pattern.instruments[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (pattern.notes.length > 0) {\n\t\t\t\t\tbits.write(1, 1);\n\t\t\t\t\t\n\t\t\t\t\tlet curPart: number = 0;\n\t\t\t\t\tfor (const note of pattern.notes) {\n\t\t\t\t\t\tif (note.start > curPart) {\n\t\t\t\t\t\t\tbits.write(2, 0); // rest\n\t\t\t\t\t\t\tbits.writePartDuration(note.start - curPart);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tshapeBits.clear();\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 0: 1 pitch, 10: 2 pitches, 110: 3 pitches, 111: 4 pitches\n\t\t\t\t\t\tfor (let i: number = 1; i < note.pitches.length; i++) shapeBits.write(1,1);\n\t\t\t\t\t\tif (note.pitches.length < Config.maxChordSize) shapeBits.write(1,0);\n\t\t\t\t\t\t\n\t\t\t\t\t\tshapeBits.writePinCount(note.pins.length - 1);\n\t\t\t\t\t\t\n\t\t\t\t\t\tshapeBits.write(bitsPerNoteSize, note.pins[0].size);\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet shapePart: number = 0;\n\t\t\t\t\t\tlet startPitch: number = note.pitches[0];\n\t\t\t\t\t\tlet currentPitch: number = startPitch;\n\t\t\t\t\t\tconst pitchBends: number[] = [];\n\t\t\t\t\t\tfor (let i: number = 1; i < note.pins.length; i++) {\n\t\t\t\t\t\t\tconst pin: NotePin = note.pins[i];\n\t\t\t\t\t\t\tconst nextPitch: number = startPitch + pin.interval;\n\t\t\t\t\t\t\tif (currentPitch != nextPitch) {\n\t\t\t\t\t\t\t\tshapeBits.write(1, 1);\n\t\t\t\t\t\t\t\tpitchBends.push(nextPitch);\n\t\t\t\t\t\t\t\tcurrentPitch = nextPitch;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshapeBits.write(1, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tshapeBits.writePartDuration(pin.time - shapePart);\n\t\t\t\t\t\t\tshapePart = pin.time;\n\t\t\t\t\t\t\tshapeBits.write(bitsPerNoteSize, pin.size);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst shapeString: string = String.fromCharCode.apply(null, shapeBits.encodeBase64([]));\n\t\t\t\t\t\tconst shapeIndex: number = recentShapes.indexOf(shapeString);\n\t\t\t\t\t\tif (shapeIndex == -1) {\n\t\t\t\t\t\t\tbits.write(2, 1); // new shape\n\t\t\t\t\t\t\tbits.concat(shapeBits);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbits.write(1, 1); // old shape\n\t\t\t\t\t\t\tbits.writeLongTail(0, 0, shapeIndex);\n\t\t\t\t\t\t\trecentShapes.splice(shapeIndex, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trecentShapes.unshift(shapeString);\n\t\t\t\t\t\tif (recentShapes.length > 10) recentShapes.pop();\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst allPitches: number[] = note.pitches.concat(pitchBends);\n\t\t\t\t\t\tfor (let i: number = 0; i < allPitches.length; i++) {\n\t\t\t\t\t\t\tconst pitch: number = allPitches[i];\n\t\t\t\t\t\t\tconst pitchIndex: number = recentPitches.indexOf(pitch);\n\t\t\t\t\t\t\tif (pitchIndex == -1) {\n\t\t\t\t\t\t\t\tlet interval: number = 0;\n\t\t\t\t\t\t\t\tlet pitchIter: number = lastPitch;\n\t\t\t\t\t\t\t\tif (pitchIter < pitch) {\n\t\t\t\t\t\t\t\t\twhile (pitchIter != pitch) {\n\t\t\t\t\t\t\t\t\t\tpitchIter++;\n\t\t\t\t\t\t\t\t\t\tif (recentPitches.indexOf(pitchIter) == -1) interval++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\twhile (pitchIter != pitch) {\n\t\t\t\t\t\t\t\t\t\tpitchIter--;\n\t\t\t\t\t\t\t\t\t\tif (recentPitches.indexOf(pitchIter) == -1) interval--;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbits.write(1, 0);\n\t\t\t\t\t\t\t\tbits.writePitchInterval(interval);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbits.write(1, 1);\n\t\t\t\t\t\t\t\tbits.write(3, pitchIndex);\n\t\t\t\t\t\t\t\trecentPitches.splice(pitchIndex, 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trecentPitches.unshift(pitch);\n\t\t\t\t\t\t\tif (recentPitches.length > 8) recentPitches.pop();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (i == note.pitches.length - 1) {\n\t\t\t\t\t\t\t\tlastPitch = note.pitches[0];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlastPitch = pitch;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (note.start == 0) {\n\t\t\t\t\t\t\tbits.write(1, note.continuesLastPattern ? 1 : 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tcurPart = note.end;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (curPart < this.beatsPerBar * Config.partsPerBeat) {\n\t\t\t\t\t\tbits.write(2, 0); // rest\n\t\t\t\t\t\tbits.writePartDuration(this.beatsPerBar * Config.partsPerBeat - curPart);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbits.write(1, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet stringLength: number = bits.lengthBase64();\n\t\tlet digits: number[] = [];\n\t\twhile (stringLength > 0) {\n\t\t\tdigits.unshift(base64IntToCharCode[stringLength & 0x3f]);\n\t\t\tstringLength = stringLength >> 6;\n\t\t}\n\t\tbuffer.push(base64IntToCharCode[digits.length]);\n\t\tArray.prototype.push.apply(buffer, digits); // append digits to buffer.\n\t\tbits.encodeBase64(buffer);\n\t\t\n\t\tconst maxApplyArgs: number = 64000;\n\t\tif (buffer.length < maxApplyArgs) {\n\t\t\t// Note: Function.apply may break for long argument lists. \n\t\t\treturn String.fromCharCode.apply(null, buffer);\n\t\t} else {\n\t\t\tlet result: string = \"\";\n\t\t\tfor (let i: number = 0; i < buffer.length; i += maxApplyArgs) {\n\t\t\t\tresult += String.fromCharCode.apply(null, buffer.slice(i, i + maxApplyArgs));\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n\t\n\tprivate static _envelopeFromLegacyIndex(legacyIndex: number): Envelope {\n\t\t// I swapped the order of \"custom\"/\"steady\", now \"none\"/\"note size\".\n\t\tif (legacyIndex == 0) legacyIndex = 1; else if (legacyIndex == 1) legacyIndex = 0;\n\t\treturn Config.envelopes[clamp(0, Config.envelopes.length, legacyIndex)];\n\t}\n\t\n\tpublic fromBase64String(compressed: string): void {\n\t\tif (compressed == null || compressed == \"\") {\n\t\t\tthis.initToDefault(true);\n\t\t\treturn;\n\t\t}\n\t\tlet charIndex: number = 0;\n\t\t// skip whitespace.\n\t\twhile (compressed.charCodeAt(charIndex) <= CharCode.SPACE) charIndex++;\n\t\t// skip hash mark.\n\t\tif (compressed.charCodeAt(charIndex) == CharCode.HASH) charIndex++;\n\t\t// if it starts with curly brace, treat it as JSON.\n\t\tif (compressed.charCodeAt(charIndex) == CharCode.LEFT_CURLY_BRACE) {\n\t\t\tthis.fromJsonObject(JSON.parse(charIndex == 0 ? compressed : compressed.substring(charIndex)));\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tconst version: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\tif (version == -1 || version > Song._latestVersion || version < Song._oldestVersion) return;\n\t\tconst beforeThree: boolean = version < 3;\n\t\tconst beforeFour:  boolean = version < 4;\n\t\tconst beforeFive:  boolean = version < 5;\n\t\tconst beforeSix:   boolean = version < 6;\n\t\tconst beforeSeven: boolean = version < 7;\n\t\tconst beforeEight: boolean = version < 8;\n\t\tconst beforeNine:  boolean = version < 9;\n\t\tthis.initToDefault(beforeNine);\n\t\t\n\t\tif (beforeThree) {\n\t\t\t// Originally, the only instrument transition was \"instant\" and the only drum wave was \"retro\".\n\t\t\tfor (const channel of this.channels) {\n\t\t\t\tchannel.instruments[0].transition = Config.transitions.dictionary[\"interrupt\"].index;\n\t\t\t\tchannel.instruments[0].effects |= 1 << EffectType.transition;\n\t\t\t}\n\t\t\tthis.channels[3].instruments[0].chipNoise = 0;\n\t\t}\n\t\t\n\t\tlet legacySettingsCache: LegacySettings[][] | null = null;\n\t\tif (beforeNine) {\n\t\t\t// Unfortunately, old versions of BeepBox had a variety of different ways of saving\n\t\t\t// filter-and-envelope-related parameters in the URL, and none of them directly\n\t\t\t// correspond to the new way of saving these parameters. We can approximate the old\n\t\t\t// settings by collecting all the old settings for an instrument and passing them to\n\t\t\t// convertLegacySettings(), so I use this data structure to collect the settings\n\t\t\t// for each instrument if necessary.\n\t\t\tlegacySettingsCache = [];\n\t\t\tfor (let i: number = legacySettingsCache.length; i < this.getChannelCount(); i++) {\n\t\t\t\tlegacySettingsCache[i] = [];\n\t\t\t\tfor (let j: number = 0; j < Config.instrumentCountMin; j++) legacySettingsCache[i][j] = {};\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet legacyGlobalReverb: number = 0; // beforeNine reverb was song-global, record that reverb here and adapt it to instruments as needed.\n\t\t\n\t\tlet instrumentChannelIterator: number = 0;\n\t\tlet instrumentIndexIterator: number = -1;\n\t\tlet command: SongTagCode;\n\t\twhile (charIndex < compressed.length) switch(command = compressed.charCodeAt(charIndex++)) {\n\t\t\tcase SongTagCode.channelCount: {\n\t\t\t\tthis.pitchChannelCount = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\tthis.noiseChannelCount = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\tthis.pitchChannelCount = validateRange(Config.pitchChannelCountMin, Config.pitchChannelCountMax, this.pitchChannelCount);\n\t\t\t\tthis.noiseChannelCount = validateRange(Config.noiseChannelCountMin, Config.noiseChannelCountMax, this.noiseChannelCount);\n\t\t\t\tfor (let channelIndex = this.channels.length; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\tthis.channels[channelIndex] = new Channel();\n\t\t\t\t}\n\t\t\t\tthis.channels.length = this.getChannelCount();\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tfor (let i: number = legacySettingsCache!.length; i < this.getChannelCount(); i++) {\n\t\t\t\t\t\tlegacySettingsCache![i] = [];\n\t\t\t\t\t\tfor (let j: number = 0; j < Config.instrumentCountMin; j++) legacySettingsCache![i][j] = {};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.scale: {\n\t\t\t\tthis.scale = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\tif (beforeThree && this.scale == 10) this.scale = 11;\n\t\t\t} break;\n\t\t\tcase SongTagCode.key: {\n\t\t\t\tif (beforeSeven) {\n\t\t\t\t\tthis.key = clamp(0, Config.keys.length, 11 - base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.key = clamp(0, Config.keys.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.loopStart: {\n\t\t\t\tif (beforeFive) {\n\t\t\t\t\tthis.loopStart = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t} else {\n\t\t\t\t\tthis.loopStart = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.loopEnd: {\n\t\t\t\tif (beforeFive) {\n\t\t\t\t\tthis.loopLength = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t} else {\n\t\t\t\t\tthis.loopLength = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.tempo: {\n\t\t\t\tif (beforeFour) {\n\t\t\t\t\tthis.tempo = [95, 120, 151, 190][base64CharCodeToInt[compressed.charCodeAt(charIndex++)]];\n\t\t\t\t} else if (beforeSeven) {\n\t\t\t\t\tthis.tempo = [88, 95, 103, 111, 120, 130, 140, 151, 163, 176, 190, 206, 222, 240, 259][base64CharCodeToInt[compressed.charCodeAt(charIndex++)]];\n\t\t\t\t} else {\n\t\t\t\t\tthis.tempo = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) | (base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t}\n\t\t\t\tthis.tempo = clamp(Config.tempoMin, Config.tempoMax + 1, this.tempo);\n\t\t\t} break;\n\t\t\tcase SongTagCode.reverb: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tlegacyGlobalReverb = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tlegacyGlobalReverb = clamp(0, 4, legacyGlobalReverb);\n\t\t\t\t} else {\n\t\t\t\t\t// Do nothing? This song tag code is deprecated for now.\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.beatCount: {\n\t\t\t\tif (beforeThree) {\n\t\t\t\t\tthis.beatsPerBar = [6, 7, 8, 9, 10][base64CharCodeToInt[compressed.charCodeAt(charIndex++)]];\n\t\t\t\t} else {\n\t\t\t\t\tthis.beatsPerBar = base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\n\t\t\t\t}\n\t\t\t\tthis.beatsPerBar = Math.max(Config.beatsPerBarMin, Math.min(Config.beatsPerBarMax, this.beatsPerBar));\n\t\t\t} break;\n\t\t\tcase SongTagCode.barCount: {\n\t\t\t\tconst barCount: number = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\n\t\t\t\tthis.barCount = validateRange(Config.barCountMin, Config.barCountMax, barCount);\n\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\tfor (let bar = this.channels[channelIndex].bars.length; bar < this.barCount; bar++) {\n\t\t\t\t\t\tthis.channels[channelIndex].bars[bar] = 1;\n\t\t\t\t\t}\n\t\t\t\t\tthis.channels[channelIndex].bars.length = this.barCount;\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.patternCount: {\n\t\t\t\tlet patternsPerChannel: number;\n\t\t\t\tif (beforeEight) {\n\t\t\t\t\tpatternsPerChannel = base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\n\t\t\t\t} else {\n\t\t\t\t\tpatternsPerChannel = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) + base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1;\n\t\t\t\t}\n\t\t\t\tthis.patternsPerChannel = validateRange(1, Config.barCountMax, patternsPerChannel);\n\t\t\t\tconst channelCount: number = this.getChannelCount();\n\t\t\t\tfor (let channelIndex: number = 0; channelIndex < channelCount; channelIndex++) {\n\t\t\t\t\tconst patterns: Pattern[] = this.channels[channelIndex].patterns;\n\t\t\t\t\tfor (let pattern = patterns.length; pattern < this.patternsPerChannel; pattern++) {\n\t\t\t\t\t\tpatterns[pattern] = new Pattern();\n\t\t\t\t\t}\n\t\t\t\t\tpatterns.length = this.patternsPerChannel;\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.instrumentCount: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tconst instrumentsPerChannel: number = validateRange(Config.instrumentCountMin, Config.patternInstrumentCountMax, base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + Config.instrumentCountMin);\n\t\t\t\t\tthis.layeredInstruments = false;\n\t\t\t\t\tthis.patternInstruments = (instrumentsPerChannel > 1);\n\t\t\t\t\t\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tconst isNoiseChannel: boolean = channelIndex >= this.pitchChannelCount;\n\t\t\t\t\t\tfor (let instrumentIndex: number = this.channels[channelIndex].instruments.length; instrumentIndex < instrumentsPerChannel; instrumentIndex++) {\n\t\t\t\t\t\t\tthis.channels[channelIndex].instruments[instrumentIndex] = new Instrument(isNoiseChannel);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.channels[channelIndex].instruments.length = instrumentsPerChannel;\n\t\t\t\t\t\tif (beforeSix) {\n\t\t\t\t\t\t\tfor (let instrumentIndex: number = 0; instrumentIndex < instrumentsPerChannel; instrumentIndex++) {\n\t\t\t\t\t\t\t\tthis.channels[channelIndex].instruments[instrumentIndex].setTypeAndReset(isNoiseChannel ? InstrumentType.noise : InstrumentType.chip, isNoiseChannel);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (let j: number = legacySettingsCache![channelIndex].length; j < instrumentsPerChannel; j++) {\n\t\t\t\t\t\t\tlegacySettingsCache![channelIndex][j] = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst instrumentsFlagBits: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tthis.layeredInstruments = (instrumentsFlagBits & (1 << 1)) != 0;\n\t\t\t\t\tthis.patternInstruments = (instrumentsFlagBits & (1 << 0)) != 0;\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tlet instrumentCount: number = 1;\n\t\t\t\t\t\tif (this.layeredInstruments || this.patternInstruments) {\n\t\t\t\t\t\t\tinstrumentCount = validateRange(Config.instrumentCountMin, this.getMaxInstrumentsPerChannel(), base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + Config.instrumentCountMin);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst channel: Channel = this.channels[channelIndex];\n\t\t\t\t\t\tconst isNoiseChannel: boolean = this.getChannelIsNoise(channelIndex);\n\t\t\t\t\t\tfor (let i: number = channel.instruments.length; i < instrumentCount; i++) {\n\t\t\t\t\t\t\tchannel.instruments[i] = new Instrument(isNoiseChannel);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchannel.instruments.length = instrumentCount;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.rhythm: {\n\t\t\t\tthis.rhythm = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t} break;\n\t\t\tcase SongTagCode.channelOctave: {\n\t\t\t\tif (beforeThree) {\n\t\t\t\t\tconst channelIndex: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tthis.channels[channelIndex].octave = clamp(0, Config.pitchOctaves, base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1);\n\t\t\t\t\tif (channelIndex >= this.pitchChannelCount) this.channels[channelIndex].octave = 0;\n\t\t\t\t} else if (beforeNine) {\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tthis.channels[channelIndex].octave = clamp(0, Config.pitchOctaves, base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1);\n\t\t\t\t\t\tif (channelIndex >= this.pitchChannelCount) this.channels[channelIndex].octave = 0;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.pitchChannelCount; channelIndex++) {\n\t\t\t\t\t\tthis.channels[channelIndex].octave = clamp(0, Config.pitchOctaves, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.startInstrument: {\n\t\t\t\tinstrumentIndexIterator++;\n\t\t\t\tif (instrumentIndexIterator >= this.channels[instrumentChannelIterator].instruments.length) {\n\t\t\t\t\tinstrumentChannelIterator++;\n\t\t\t\t\tinstrumentIndexIterator = 0;\n\t\t\t\t}\n\t\t\t\tvalidateRange(0, this.channels.length - 1, instrumentChannelIterator);\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tconst instrumentType: number = validateRange(0, InstrumentType.length - 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\tinstrument.setTypeAndReset(instrumentType, instrumentChannelIterator >= this.pitchChannelCount);\n\t\t\t\t\n\t\t\t\tif (beforeSeven) {\n\t\t\t\t\tinstrument.effects = 0;\n\t\t\t\t\t// the reverb effect was applied to all pitched instruments if nonzero but never explicitly enabled if beforeSeven, so enable it here.\n\t\t\t\t\tif (legacyGlobalReverb > 0 && !this.getChannelIsNoise(instrumentChannelIterator)) {\n\t\t\t\t\t\tinstrument.reverb = legacyGlobalReverb;\n\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.reverb;\n\t\t\t\t\t}\n\t\t\t\t\t// Chip/noise instruments had arpeggio and FM had custom interval but neither\n\t\t\t\t\t// explicitly saved the chorus setting beforeSeven so enable it here.\n\t\t\t\t\tif (instrument.chord != Config.chords.dictionary[\"simultaneous\"].index) {\n\t\t\t\t\t\t// Enable chord if it was used.\n\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.chord;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.preset: {\n\t\t\t\tconst presetValue: number = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) | (base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].preset = presetValue;\n\t\t\t} break;\n\t\t\tcase SongTagCode.wave: {\n\t\t\t\tif (beforeThree) {\n\t\t\t\t\tconst legacyWaves: number[] = [1, 2, 3, 4, 5, 6, 7, 8, 0];\n\t\t\t\t\tconst channelIndex: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tconst instrument: Instrument = this.channels[channelIndex].instruments[0];\n\t\t\t\t\tinstrument.chipWave = clamp(0, Config.chipWaves.length, legacyWaves[base64CharCodeToInt[compressed.charCodeAt(charIndex++)]] | 0);\n\t\t\t\t\t\n\t\t\t\t\t// Version 2 didn't save any settings for settings for filters, or envelopes,\n\t\t\t\t\t// just waves, so initialize them here I guess.\n\t\t\t\t\tinstrument.convertLegacySettings(legacySettingsCache![channelIndex][0]);\n\t\t\t\t\t\n\t\t\t\t} else if (beforeSix) {\n\t\t\t\t\tconst legacyWaves: number[] = [1, 2, 3, 4, 5, 6, 7, 8, 0];\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tfor (const instrument of this.channels[channelIndex].instruments) {\n\t\t\t\t\t\t\tif (channelIndex >= this.pitchChannelCount) {\n\t\t\t\t\t\t\t\tinstrument.chipNoise = clamp(0, Config.chipNoises.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tinstrument.chipWave = clamp(0, Config.chipWaves.length, legacyWaves[base64CharCodeToInt[compressed.charCodeAt(charIndex++)]] | 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (beforeSeven) {\n\t\t\t\t\tconst legacyWaves: number[] = [1, 2, 3, 4, 5, 6, 7, 8, 0];\n\t\t\t\t\tif (instrumentChannelIterator >= this.pitchChannelCount) {\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].chipNoise = clamp(0, Config.chipNoises.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].chipWave = clamp(0, Config.chipWaves.length, legacyWaves[base64CharCodeToInt[compressed.charCodeAt(charIndex++)]] | 0);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (instrumentChannelIterator >= this.pitchChannelCount) {\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].chipNoise = clamp(0, Config.chipNoises.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].chipWave = clamp(0, Config.chipWaves.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.eqFilter: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tif (beforeSeven) {\n\t\t\t\t\t\tconst legacyToCutoff: number[] = [10, 6, 3, 0, 8, 5, 2];\n\t\t\t\t\t\tconst legacyToEnvelope: string[] = [\"none\", \"none\", \"none\", \"none\", \"decay 1\", \"decay 2\", \"decay 3\"];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (beforeThree) {\n\t\t\t\t\t\t\tconst channelIndex: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\t\t\tconst instrument: Instrument = this.channels[channelIndex].instruments[0];\n\t\t\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![channelIndex][0];\n\t\t\t\t\t\t\tconst legacyFilter: number = [1, 3, 4, 5][clamp(0, legacyToCutoff.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)])];\n\t\t\t\t\t\t\tlegacySettings.filterCutoff = legacyToCutoff[legacyFilter];\n\t\t\t\t\t\t\tlegacySettings.filterResonance = 0;\n\t\t\t\t\t\t\tlegacySettings.filterEnvelope = Config.envelopes.dictionary[legacyToEnvelope[legacyFilter]];\n\t\t\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t\t\t} else if (beforeSix) {\n\t\t\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\t\t\tfor (let i: number = 0; i < this.channels[channelIndex].instruments.length; i++) {\n\t\t\t\t\t\t\t\t\tconst instrument: Instrument = this.channels[channelIndex].instruments[i];\n\t\t\t\t\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![channelIndex][i];\n\t\t\t\t\t\t\t\t\tconst legacyFilter: number = clamp(0, legacyToCutoff.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)] + 1);\n\t\t\t\t\t\t\t\t\tif (channelIndex < this.pitchChannelCount) {\n\t\t\t\t\t\t\t\t\t\tlegacySettings.filterCutoff = legacyToCutoff[legacyFilter];\n\t\t\t\t\t\t\t\t\t\tlegacySettings.filterResonance = 0;\n\t\t\t\t\t\t\t\t\t\tlegacySettings.filterEnvelope = Config.envelopes.dictionary[legacyToEnvelope[legacyFilter]];\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tlegacySettings.filterCutoff = 10;\n\t\t\t\t\t\t\t\t\t\tlegacySettings.filterResonance = 0;\n\t\t\t\t\t\t\t\t\t\tlegacySettings.filterEnvelope = Config.envelopes.dictionary[\"none\"];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst legacyFilter: number = clamp(0, legacyToCutoff.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\t\t\tlegacySettings.filterCutoff = legacyToCutoff[legacyFilter];\n\t\t\t\t\t\t\tlegacySettings.filterResonance = 0;\n\t\t\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst filterCutoffRange: number = 11;\n\t\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\t\tlegacySettings.filterCutoff = clamp(0, filterCutoffRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\tconst originalControlPointCount: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tinstrument.eqFilter.controlPointCount = clamp(0, Config.filterMaxPoints + 1, originalControlPointCount);\n\t\t\t\t\tfor (let i: number = instrument.eqFilter.controlPoints.length; i < instrument.eqFilter.controlPointCount; i++) {\n\t\t\t\t\t\tinstrument.eqFilter.controlPoints[i] = new FilterControlPoint();\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i: number = 0; i < instrument.eqFilter.controlPointCount; i++) {\n\t\t\t\t\t\tconst point: FilterControlPoint = instrument.eqFilter.controlPoints[i];\n\t\t\t\t\t\tpoint.type = clamp(0, FilterType.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tpoint.freq = clamp(0, Config.filterFreqRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tpoint.gain = clamp(0, Config.filterGainRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i: number = instrument.eqFilter.controlPointCount; i < originalControlPointCount; i++) {\n\t\t\t\t\t\tcharIndex += 3;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.filterResonance: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tconst filterResonanceRange: number = 8;\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\tlegacySettings.filterResonance = clamp(0, filterResonanceRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t} else {\n\t\t\t\t\t// Do nothing? This song tag code is deprecated for now.\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.drumsetEnvelopes: {\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tif (instrument.type == InstrumentType.drumset) {\n\t\t\t\t\t\tfor (let i: number = 0; i < Config.drumCount; i++) {\n\t\t\t\t\t\t\tinstrument.drumsetEnvelopes[i] = Song._envelopeFromLegacyIndex(base64CharCodeToInt[compressed.charCodeAt(charIndex++)]).index;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// This used to be used for general filter envelopes.\n\t\t\t\t\t\t// The presence of an envelope affects how convertLegacySettings\n\t\t\t\t\t\t// decides the closest possible approximation, so update it.\n\t\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\t\tlegacySettings.filterEnvelope = Song._envelopeFromLegacyIndex(base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// This tag is now only used for drumset filter envelopes.\n\t\t\t\t\tfor (let i: number = 0; i < Config.drumCount; i++) {\n\t\t\t\t\t\tinstrument.drumsetEnvelopes[i] = clamp(0, Config.envelopes.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.pulseWidth: {\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tinstrument.pulseWidth = clamp(0, Config.pulseWidthRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\tlegacySettings.pulseEnvelope = Song._envelopeFromLegacyIndex(base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.stringSustain: {\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tinstrument.stringSustain = clamp(0, Config.stringSustainRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t} break;\n\t\t\tcase SongTagCode.fadeInOut: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\t// this tag was used for a combination of transition and fade in/out.\n\t\t\t\t\tconst legacySettings = [\n\t\t\t\t\t\t{transition: \"interrupt\", fadeInSeconds: 0.0,    fadeOutTicks: -1},\n\t\t\t\t\t\t{transition: \"normal\",    fadeInSeconds: 0.0,    fadeOutTicks: -3},\n\t\t\t\t\t\t{transition: \"normal\",    fadeInSeconds: 0.025,  fadeOutTicks: -3},\n\t\t\t\t\t\t{transition: \"slide in pattern\", fadeInSeconds: 0.025,  fadeOutTicks: -3},\n\t\t\t\t\t\t{transition: \"normal\",    fadeInSeconds: 0.04,   fadeOutTicks:  6},\n\t\t\t\t\t\t{transition: \"normal\",    fadeInSeconds: 0.0,    fadeOutTicks: 48},\n\t\t\t\t\t\t{transition: \"normal\",    fadeInSeconds: 0.0125, fadeOutTicks: 72},\n\t\t\t\t\t\t{transition: \"normal\",    fadeInSeconds: 0.06,   fadeOutTicks: 96},\n\t\t\t\t\t];\n\t\t\t\t\tif (beforeThree) {\n\t\t\t\t\t\tconst channelIndex: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\t\tconst settings = legacySettings[clamp(0, legacySettings.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)])];\n\t\t\t\t\t\tconst instrument: Instrument = this.channels[channelIndex].instruments[0];\n\t\t\t\t\t\tinstrument.fadeIn = Synth.secondsToFadeInSetting(settings.fadeInSeconds);\n\t\t\t\t\t\tinstrument.fadeOut = Synth.ticksToFadeOutSetting(settings.fadeOutTicks);\n\t\t\t\t\t\tinstrument.transition = Config.transitions.dictionary[settings.transition].index;\n\t\t\t\t\t\tif (instrument.transition != Config.transitions.dictionary[\"normal\"].index) {\n\t\t\t\t\t\t\t// Enable transition if it was used.\n\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.transition;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (beforeSix) {\n\t\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\t\tfor (const instrument of this.channels[channelIndex].instruments) {\n\t\t\t\t\t\t\t\tconst settings = legacySettings[clamp(0, legacySettings.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)])];\n\t\t\t\t\t\t\t\tinstrument.fadeIn = Synth.secondsToFadeInSetting(settings.fadeInSeconds);\n\t\t\t\t\t\t\t\tinstrument.fadeOut = Synth.ticksToFadeOutSetting(settings.fadeOutTicks);\n\t\t\t\t\t\t\t\tinstrument.transition = Config.transitions.dictionary[settings.transition].index;\n\t\t\t\t\t\t\t\tif (instrument.transition != Config.transitions.dictionary[\"normal\"].index) {\n\t\t\t\t\t\t\t\t\t// Enable transition if it was used.\n\t\t\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.transition;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst settings = legacySettings[clamp(0, legacySettings.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)])];\n\t\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\t\tinstrument.fadeIn = Synth.secondsToFadeInSetting(settings.fadeInSeconds);\n\t\t\t\t\t\tinstrument.fadeOut = Synth.ticksToFadeOutSetting(settings.fadeOutTicks);\n\t\t\t\t\t\tinstrument.transition = Config.transitions.dictionary[settings.transition].index;\n\t\t\t\t\t\tif (instrument.transition != Config.transitions.dictionary[\"normal\"].index) {\n\t\t\t\t\t\t\t// Enable transition if it was used.\n\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.transition;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\tinstrument.fadeIn = clamp(0, Config.fadeInRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\tinstrument.fadeOut = clamp(0, Config.fadeOutTicks.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.vibrato: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tif (beforeSeven) {\n\t\t\t\t\t\tif (beforeThree) {\n\t\t\t\t\t\t\tconst legacyEffects: number[] = [0, 3, 2, 0];\n\t\t\t\t\t\t\tconst legacyEnvelopes: string[] = [\"none\", \"none\", \"none\", \"tremolo2\"];\n\t\t\t\t\t\t\tconst channelIndex: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\t\t\tconst effect: number = clamp(0, legacyEffects.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t\tconst instrument: Instrument = this.channels[channelIndex].instruments[0];\n\t\t\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![channelIndex][0];\n\t\t\t\t\t\t\tinstrument.vibrato = legacyEffects[effect];\n\t\t\t\t\t\t\tif (legacySettings.filterEnvelope == undefined || legacySettings.filterEnvelope.type == EnvelopeType.none) {\n\t\t\t\t\t\t\t\t// Imitate the legacy tremolo with a filter envelope.\n\t\t\t\t\t\t\t\tlegacySettings.filterEnvelope = Config.envelopes.dictionary[legacyEnvelopes[effect]];\n\t\t\t\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (instrument.vibrato != Config.vibratos.dictionary[\"none\"].index) {\n\t\t\t\t\t\t\t\t// Enable vibrato if it was used.\n\t\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.vibrato;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (beforeSix) {\n\t\t\t\t\t\t\tconst legacyEffects: number[] = [0, 1, 2, 3, 0, 0];\n\t\t\t\t\t\t\tconst legacyEnvelopes: string[] = [\"none\", \"none\", \"none\", \"none\", \"tremolo5\", \"tremolo2\"];\n\t\t\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\t\t\tfor (let i: number = 0; i < this.channels[channelIndex].instruments.length; i++) {\n\t\t\t\t\t\t\t\t\tconst effect: number = clamp(0, legacyEffects.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t\t\t\tconst instrument: Instrument = this.channels[channelIndex].instruments[i];\n\t\t\t\t\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![channelIndex][i];\n\t\t\t\t\t\t\t\t\tinstrument.vibrato = legacyEffects[effect];\n\t\t\t\t\t\t\t\t\tif (legacySettings.filterEnvelope == undefined || legacySettings.filterEnvelope.type == EnvelopeType.none) {\n\t\t\t\t\t\t\t\t\t\t// Imitate the legacy tremolo with a filter envelope.\n\t\t\t\t\t\t\t\t\t\tlegacySettings.filterEnvelope = Config.envelopes.dictionary[legacyEnvelopes[effect]];\n\t\t\t\t\t\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (instrument.vibrato != Config.vibratos.dictionary[\"none\"].index) {\n\t\t\t\t\t\t\t\t\t\t// Enable vibrato if it was used.\n\t\t\t\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.vibrato;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (legacyGlobalReverb != 0 && !this.getChannelIsNoise(channelIndex)) {\n\t\t\t\t\t\t\t\t\t\t// Enable reverb if it was used globaly before. (Global reverb was added before the effects option so I need to pick somewhere else to initialize instrument reverb, and I picked the vibrato command.)\n\t\t\t\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.reverb;\n\t\t\t\t\t\t\t\t\t\tinstrument.reverb = legacyGlobalReverb;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst legacyEffects: number[] = [0, 1, 2, 3, 0, 0];\n\t\t\t\t\t\t\tconst legacyEnvelopes: string[] = [\"none\", \"none\", \"none\", \"none\", \"tremolo5\", \"tremolo2\"];\n\t\t\t\t\t\t\tconst effect: number = clamp(0, legacyEffects.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\t\t\tinstrument.vibrato = legacyEffects[effect];\n\t\t\t\t\t\t\tif (legacySettings.filterEnvelope == undefined || legacySettings.filterEnvelope.type == EnvelopeType.none) {\n\t\t\t\t\t\t\t\t// Imitate the legacy tremolo with a filter envelope.\n\t\t\t\t\t\t\t\tlegacySettings.filterEnvelope = Config.envelopes.dictionary[legacyEnvelopes[effect]];\n\t\t\t\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (instrument.vibrato != Config.vibratos.dictionary[\"none\"].index) {\n\t\t\t\t\t\t\t\t// Enable vibrato if it was used.\n\t\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.vibrato;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (legacyGlobalReverb != 0) {\n\t\t\t\t\t\t\t\t// Enable reverb if it was used globaly before. (Global reverb was added before the effects option so I need to pick somewhere else to initialize instrument reverb, and I picked the vibrato command.)\n\t\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.reverb;\n\t\t\t\t\t\t\t\tinstrument.reverb = legacyGlobalReverb;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\t\tconst vibrato: number = clamp(0, Config.vibratos.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tinstrument.vibrato = vibrato;\n\t\t\t\t\t\tif (instrument.vibrato != Config.vibratos.dictionary[\"none\"].index) {\n\t\t\t\t\t\t\t// Enable vibrato if it was used.\n\t\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.vibrato;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Do nothing? This song tag code is deprecated for now.\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.unison: {\n\t\t\t\tif (beforeThree) {\n\t\t\t\t\tconst channelIndex: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tthis.channels[channelIndex].instruments[0].unison = clamp(0, Config.unisons.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t} else if (beforeSix) {\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tfor (const instrument of this.channels[channelIndex].instruments) {\n\t\t\t\t\t\t\tconst originalValue: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\t\t\tlet unison: number = clamp(0, Config.unisons.length, originalValue);\n\t\t\t\t\t\t\tif (originalValue == 8) {\n\t\t\t\t\t\t\t\t// original \"custom harmony\" now maps to \"hum\" and \"custom interval\".\n\t\t\t\t\t\t\t\tunison = 2;\n\t\t\t\t\t\t\t\tinstrument.chord = 3;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinstrument.unison = unison;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (beforeSeven) {\n\t\t\t\t\tconst originalValue: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tlet unison: number = clamp(0, Config.unisons.length, originalValue);\n\t\t\t\t\tif (originalValue == 8) {\n\t\t\t\t\t\t// original \"custom harmony\" now maps to \"hum\" and \"custom interval\".\n\t\t\t\t\t\tunison = 2;\n\t\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].chord = 3;\n\t\t\t\t\t}\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].unison = unison;\n\t\t\t\t} else {\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].unison = clamp(0, Config.unisons.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.chord: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\tinstrument.chord = clamp(0, Config.chords.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\tif (instrument.chord != Config.chords.dictionary[\"simultaneous\"].index) {\n\t\t\t\t\t\t// Enable chord if it was used.\n\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.chord;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Do nothing? This song tag code is deprecated for now.\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.effects: {\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tinstrument.effects = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] & ((1 << EffectType.length) - 1));\n\t\t\t\t\tif (legacyGlobalReverb == 0) {\n\t\t\t\t\t\t// Disable reverb if legacy song reverb was zero.\n\t\t\t\t\t\tinstrument.effects &= ~(1 << EffectType.reverb);\n\t\t\t\t\t} else if (effectsIncludeReverb(instrument.effects)) {\n\t\t\t\t\t\tinstrument.reverb = legacyGlobalReverb;\n\t\t\t\t\t}\n\t\t\t\t\tif (instrument.pan != Config.panCenter) {\n\t\t\t\t\t\t// Enable panning if panning slider isn't centered.\n\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.panning;\n\t\t\t\t\t}\n\t\t\t\t\tif (instrument.vibrato != Config.vibratos.dictionary[\"none\"].index) {\n\t\t\t\t\t\t// Enable vibrato if it was used.\n\t\t\t\t\t\tinstrument.effects |= 1 << EffectType.panning;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// convertLegacySettings may need to force-enable note filter, call\n\t\t\t\t\t// it again here to make sure that this override takes precedence.\n\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t} else {\n\t\t\t\t\t// BeepBox currently uses two base64 characters at 6 bits each for a bitfield representing all the enabled effects.\n\t\t\t\t\tif (EffectType.length > 12) throw new Error();\n\t\t\t\t\tinstrument.effects = (base64CharCodeToInt[compressed.charCodeAt(charIndex++)] << 6) | (base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\n\t\t\t\t\tif (effectsIncludeNoteFilter(instrument.effects)) {\n\t\t\t\t\t\tconst originalControlPointCount: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\t\tinstrument.noteFilter.controlPointCount = clamp(0, Config.filterMaxPoints + 1, originalControlPointCount);\n\t\t\t\t\t\tfor (let i: number = instrument.noteFilter.controlPoints.length; i < instrument.noteFilter.controlPointCount; i++) {\n\t\t\t\t\t\t\tinstrument.noteFilter.controlPoints[i] = new FilterControlPoint();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (let i: number = 0; i < instrument.noteFilter.controlPointCount; i++) {\n\t\t\t\t\t\t\tconst point: FilterControlPoint = instrument.noteFilter.controlPoints[i];\n\t\t\t\t\t\t\tpoint.type = clamp(0, FilterType.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t\tpoint.freq = clamp(0, Config.filterFreqRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t\tpoint.gain = clamp(0, Config.filterGainRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (let i: number = instrument.noteFilter.controlPointCount; i < originalControlPointCount; i++) {\n\t\t\t\t\t\t\tcharIndex += 3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeTransition(instrument.effects)) {\n\t\t\t\t\t\tinstrument.transition = clamp(0, Config.transitions.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeChord(instrument.effects)) {\n\t\t\t\t\t\tinstrument.chord = clamp(0, Config.chords.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludePitchShift(instrument.effects)) {\n\t\t\t\t\t\tinstrument.pitchShift = clamp(0, Config.pitchShiftRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeDetune(instrument.effects)) {\n\t\t\t\t\t\tinstrument.detune = clamp(0, Config.detuneMax + 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeVibrato(instrument.effects)) {\n\t\t\t\t\t\tinstrument.vibrato = clamp(0, Config.vibratos.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeDistortion(instrument.effects)) {\n\t\t\t\t\t\tinstrument.distortion = clamp(0, Config.distortionRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeBitcrusher(instrument.effects)) {\n\t\t\t\t\t\tinstrument.bitcrusherFreq = clamp(0, Config.bitcrusherFreqRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tinstrument.bitcrusherQuantization = clamp(0, Config.bitcrusherQuantizationRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludePanning(instrument.effects)) {\n\t\t\t\t\t\tinstrument.pan = clamp(0, Config.panMax + 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeChorus(instrument.effects)) {\n\t\t\t\t\t\tinstrument.chorus = clamp(0, Config.chorusRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeEcho(instrument.effects)) {\n\t\t\t\t\t\tinstrument.echoSustain = clamp(0, Config.echoSustainRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tinstrument.echoDelay = clamp(0, Config.echoDelayRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tif (effectsIncludeReverb(instrument.effects)) {\n\t\t\t\t\t\tinstrument.reverb = clamp(0, Config.reverbRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Clamp the range.\n\t\t\t\tinstrument.effects &= (1 << EffectType.length) - 1;\n\t\t\t} break;\n\t\t\tcase SongTagCode.volume: {\n\t\t\t\tif (beforeThree) {\n\t\t\t\t\tconst channelIndex: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tconst instrument: Instrument = this.channels[channelIndex].instruments[0];\n\t\t\t\t\tinstrument.volume = clamp(0, Config.volumeRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t// legacy mute value:\n\t\t\t\t\tif (instrument.volume == 5) instrument.volume = Config.volumeRange - 1;\n\t\t\t\t} else if (beforeSix) {\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tfor (const instrument of this.channels[channelIndex].instruments) {\n\t\t\t\t\t\t\tinstrument.volume = clamp(0, Config.volumeRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t\t// legacy mute value:\n\t\t\t\t\t\t\tif (instrument.volume == 5) instrument.volume = Config.volumeRange - 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (beforeSeven) {\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\tinstrument.volume = clamp(0, Config.volumeRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t// legacy mute value:\n\t\t\t\t\tif (instrument.volume == 5) instrument.volume = Config.volumeRange - 1;\n\t\t\t\t} else {\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\tinstrument.volume = clamp(0, Config.volumeRange, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.pan: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\tinstrument.pan = clamp(0, Config.panMax + 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t} else {\n\t\t\t\t\t// Do nothing? This song tag code is deprecated for now.\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.algorithm: {\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tinstrument.algorithm = clamp(0, Config.algorithms.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\t// The algorithm determines the carrier count, which affects how legacy settings are imported.\n\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.feedbackType: {\n\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].feedbackType = clamp(0, Config.feedbacks.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t} break;\n\t\t\tcase SongTagCode.feedbackAmplitude: {\n\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].feedbackAmplitude = clamp(0, Config.operatorAmplitudeMax + 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t} break;\n\t\t\tcase SongTagCode.feedbackEnvelope: {\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\tlegacySettings.feedbackEnvelope = Song._envelopeFromLegacyIndex(base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t} else {\n\t\t\t\t\t// Do nothing? This song tag code is deprecated for now.\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.operatorFrequencies: {\n\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].operators[o].frequency = clamp(0, Config.operatorFrequencies.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.operatorAmplitudes: {\n\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\n\t\t\t\t\tthis.channels[instrumentChannelIterator].instruments[instrumentIndexIterator].operators[o].amplitude = clamp(0, Config.operatorAmplitudeMax + 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.envelopes: {\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tif (beforeNine) {\n\t\t\t\t\tconst legacySettings: LegacySettings = legacySettingsCache![instrumentChannelIterator][instrumentIndexIterator];\n\t\t\t\t\tlegacySettings.operatorEnvelopes = [];\n\t\t\t\t\tfor (let o: number = 0; o < Config.operatorCount; o++) {\n\t\t\t\t\t\tlegacySettings.operatorEnvelopes[o] = Song._envelopeFromLegacyIndex(base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t}\n\t\t\t\t\tinstrument.convertLegacySettings(legacySettings);\n\t\t\t\t} else {\n\t\t\t\t\tconst envelopeCount: number = clamp(0, Config.maxEnvelopeCount + 1, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\tfor (let i: number = 0; i < envelopeCount; i++) {\n\t\t\t\t\t\tconst target: number = clamp(0, Config.instrumentAutomationTargets.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tlet index: number = 0;\n\t\t\t\t\t\tconst maxCount: number = Config.instrumentAutomationTargets[target].maxCount;\n\t\t\t\t\t\tif (maxCount > 1) {\n\t\t\t\t\t\t\tindex = clamp(0, maxCount, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst envelope: number = clamp(0, Config.envelopes.length, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\t\tinstrument.addEnvelope(target, index, envelope);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.spectrum: {\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tif (instrument.type == InstrumentType.spectrum) {\n\t\t\t\t\tconst byteCount: number = Math.ceil(Config.spectrumControlPoints * Config.spectrumControlPointBits / 6)\n\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(compressed, charIndex, charIndex + byteCount);\n\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\tinstrument.spectrumWave.spectrum[i] = bits.read(Config.spectrumControlPointBits);\n\t\t\t\t\t}\n\t\t\t\t\tinstrument.spectrumWave.markCustomWaveDirty();\n\t\t\t\t\tcharIndex += byteCount;\n\t\t\t\t} else if (instrument.type == InstrumentType.drumset) {\n\t\t\t\t\tconst byteCount: number = Math.ceil(Config.drumCount * Config.spectrumControlPoints * Config.spectrumControlPointBits / 6)\n\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(compressed, charIndex, charIndex + byteCount);\n\t\t\t\t\tfor (let j: number = 0; j < Config.drumCount; j++) {\n\t\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\t\tinstrument.drumsetSpectrumWaves[j].spectrum[i] = bits.read(Config.spectrumControlPointBits);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinstrument.drumsetSpectrumWaves[j].markCustomWaveDirty();\n\t\t\t\t\t}\n\t\t\t\t\tcharIndex += byteCount;\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(\"Unhandled instrument type for spectrum song tag code.\");\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase SongTagCode.harmonics: {\n\t\t\t\tconst instrument: Instrument = this.channels[instrumentChannelIterator].instruments[instrumentIndexIterator];\n\t\t\t\tconst byteCount: number = Math.ceil(Config.harmonicsControlPoints * Config.harmonicsControlPointBits / 6)\n\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(compressed, charIndex, charIndex + byteCount);\n\t\t\t\tfor (let i: number = 0; i < Config.harmonicsControlPoints; i++) {\n\t\t\t\t\tinstrument.harmonicsWave.harmonics[i] = bits.read(Config.harmonicsControlPointBits);\n\t\t\t\t}\n\t\t\t\tinstrument.harmonicsWave.markCustomWaveDirty();\n\t\t\t\tcharIndex += byteCount;\n\t\t\t} break;\n\t\t\tcase SongTagCode.bars: {\n\t\t\t\tlet subStringLength: number;\n\t\t\t\tif (beforeThree) {\n\t\t\t\t\tconst channelIndex: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tconst barCount: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tsubStringLength = Math.ceil(barCount * 0.5);\n\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(compressed, charIndex, charIndex + subStringLength);\n\t\t\t\t\tfor (let i: number = 0; i < barCount; i++) {\n\t\t\t\t\t\tthis.channels[channelIndex].bars[i] = bits.read(3) + 1;\n\t\t\t\t\t}\n\t\t\t\t} else if (beforeFive) {\n\t\t\t\t\tlet neededBits: number = 0;\n\t\t\t\t\twhile ((1 << neededBits) < this.patternsPerChannel) neededBits++;\n\t\t\t\t\tsubStringLength = Math.ceil(this.getChannelCount() * this.barCount * neededBits / 6);\n\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(compressed, charIndex, charIndex + subStringLength);\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tfor (let i: number = 0; i < this.barCount; i++) {\n\t\t\t\t\t\t\tthis.channels[channelIndex].bars[i] = bits.read(neededBits) + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tlet neededBits: number = 0;\n\t\t\t\t\twhile ((1 << neededBits) < this.patternsPerChannel + 1) neededBits++;\n\t\t\t\t\tsubStringLength = Math.ceil(this.getChannelCount() * this.barCount * neededBits / 6);\n\t\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(compressed, charIndex, charIndex + subStringLength);\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tfor (let i: number = 0; i < this.barCount; i++) {\n\t\t\t\t\t\t\tthis.channels[channelIndex].bars[i] = bits.read(neededBits);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcharIndex += subStringLength;\n\t\t\t} break;\n\t\t\tcase SongTagCode.patterns: {\n\t\t\t\tlet bitStringLength: number = 0;\n\t\t\t\tlet channelIndex: number;\n\t\t\t\tif (beforeThree) {\n\t\t\t\t\tchannelIndex = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\t\n\t\t\t\t\t// The old format used the next character to represent the number of patterns in the channel, which is usually eight, the default. \n\t\t\t\t\tcharIndex++; //let patternCount: number = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\t\n\t\t\t\t\tbitStringLength = base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\tbitStringLength = bitStringLength << 6;\n\t\t\t\t\tbitStringLength += base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t} else {\n\t\t\t\t\tchannelIndex = 0;\n\t\t\t\t\tlet bitStringLengthLength: number = validateRange(1, 4, base64CharCodeToInt[compressed.charCodeAt(charIndex++)]);\n\t\t\t\t\twhile (bitStringLengthLength > 0) {\n\t\t\t\t\t\tbitStringLength = bitStringLength << 6;\n\t\t\t\t\t\tbitStringLength += base64CharCodeToInt[compressed.charCodeAt(charIndex++)];\n\t\t\t\t\t\tbitStringLengthLength--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst bits: BitFieldReader = new BitFieldReader(compressed, charIndex, charIndex + bitStringLength);\n\t\t\t\tcharIndex += bitStringLength;\n\t\t\t\t\n\t\t\t\tconst bitsPerNoteSize: number = Song.getNeededBits(Config.noteSizeMax);\n\t\t\t\twhile (true) {\n\t\t\t\t\tconst channel: Channel = this.channels[channelIndex];\n\t\t\t\t\tconst isNoiseChannel: boolean = this.getChannelIsNoise(channelIndex);\n\t\t\t\t\tconst maxInstrumentsPerPattern: number = this.getMaxInstrumentsPerPattern(channelIndex);\n\t\t\t\t\tconst neededInstrumentCountBits: number = Song.getNeededBits(maxInstrumentsPerPattern - Config.instrumentCountMin);\n\t\t\t\t\tconst neededInstrumentIndexBits: number = Song.getNeededBits(channel.instruments.length - 1);\n\t\t\t\t\t\n\t\t\t\t\tconst octaveOffset: number = isNoiseChannel ? 0 : channel.octave * 12;\n\t\t\t\t\tlet lastPitch: number = (isNoiseChannel ? 4 : octaveOffset);\n\t\t\t\t\tconst recentPitches: number[] = isNoiseChannel ? [4,6,7,2,3,8,0,10] : [0, 7, 12, 19, 24, -5, -12];\n\t\t\t\t\tconst recentShapes: any[] = [];\n\t\t\t\t\tfor (let i: number = 0; i < recentPitches.length; i++) {\n\t\t\t\t\t\trecentPitches[i] += octaveOffset;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i: number = 0; i < this.patternsPerChannel; i++) {\n\t\t\t\t\t\tconst newPattern: Pattern = channel.patterns[i];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (beforeNine) {\n\t\t\t\t\t\t\tnewPattern.instruments[0] = validateRange(0, channel.instruments.length - 1, bits.read(neededInstrumentIndexBits));\n\t\t\t\t\t\t\tnewPattern.instruments.length = 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (this.patternInstruments) {\n\t\t\t\t\t\t\t\tconst instrumentCount: number = validateRange(Config.instrumentCountMin, maxInstrumentsPerPattern, bits.read(neededInstrumentCountBits) + Config.instrumentCountMin);\n\t\t\t\t\t\t\t\tfor (let j: number = 0; j < instrumentCount; j++) {\n\t\t\t\t\t\t\t\t\tnewPattern.instruments[j] = validateRange(0, channel.instruments.length - 1, bits.read(neededInstrumentIndexBits));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnewPattern.instruments.length = instrumentCount;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewPattern.instruments[0] = 0;\n\t\t\t\t\t\t\t\tnewPattern.instruments.length = Config.instrumentCountMin;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!beforeThree && bits.read(1) == 0) {\n\t\t\t\t\t\t\tnewPattern.notes.length = 0;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet curPart: number = 0;\n\t\t\t\t\t\tconst newNotes: Note[] = newPattern.notes;\n\t\t\t\t\t\tlet noteCount: number = 0;\n\t\t\t\t\t\twhile (curPart < this.beatsPerBar * Config.partsPerBeat) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst useOldShape: boolean = bits.read(1) == 1;\n\t\t\t\t\t\t\tlet newNote: boolean = false;\n\t\t\t\t\t\t\tlet shapeIndex: number = 0;\n\t\t\t\t\t\t\tif (useOldShape) {\n\t\t\t\t\t\t\t\tshapeIndex = validateRange(0, recentShapes.length - 1, bits.readLongTail(0, 0));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewNote = bits.read(1) == 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (!useOldShape && !newNote) {\n\t\t\t\t\t\t\t\tconst restLength: number = beforeSeven\n\t\t\t\t\t\t\t\t\t? bits.readLegacyPartDuration() * Config.partsPerBeat / Config.rhythms[this.rhythm].stepsPerBeat\n\t\t\t\t\t\t\t\t\t: bits.readPartDuration();\n\t\t\t\t\t\t\t\tcurPart += restLength;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlet shape: any;\n\t\t\t\t\t\t\t\tif (useOldShape) {\n\t\t\t\t\t\t\t\t\tshape = recentShapes[shapeIndex];\n\t\t\t\t\t\t\t\t\trecentShapes.splice(shapeIndex, 1);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tshape = {};\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tshape.pitchCount = 1;\n\t\t\t\t\t\t\t\t\twhile (shape.pitchCount < Config.maxChordSize && bits.read(1) == 1) shape.pitchCount++;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tshape.pinCount = bits.readPinCount();\n\t\t\t\t\t\t\t\t\tshape.initialSize = bits.read(bitsPerNoteSize);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tshape.pins = [];\n\t\t\t\t\t\t\t\t\tshape.length = 0;\n\t\t\t\t\t\t\t\t\tshape.bendCount = 0;\n\t\t\t\t\t\t\t\t\tfor (let j: number = 0; j < shape.pinCount; j++) {\n\t\t\t\t\t\t\t\t\t\tlet pinObj: any = {};\n\t\t\t\t\t\t\t\t\t\tpinObj.pitchBend = bits.read(1) == 1;\n\t\t\t\t\t\t\t\t\t\tif (pinObj.pitchBend) shape.bendCount++;\n\t\t\t\t\t\t\t\t\t\tshape.length += beforeSeven\n\t\t\t\t\t\t\t\t\t\t\t? bits.readLegacyPartDuration() * Config.partsPerBeat / Config.rhythms[this.rhythm].stepsPerBeat\n\t\t\t\t\t\t\t\t\t\t\t: bits.readPartDuration();\n\t\t\t\t\t\t\t\t\t\tpinObj.time = shape.length;\n\t\t\t\t\t\t\t\t\t\tpinObj.size = bits.read(bitsPerNoteSize);\n\t\t\t\t\t\t\t\t\t\tshape.pins.push(pinObj);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trecentShapes.unshift(shape);\n\t\t\t\t\t\t\t\tif (recentShapes.length > 10) recentShapes.pop(); // TODO: Use Deque?\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlet note: Note;\n\t\t\t\t\t\t\t\tif (newNotes.length <= noteCount) {\n\t\t\t\t\t\t\t\t\tnote = new Note(0, curPart, curPart + shape.length, shape.initialSize);\n\t\t\t\t\t\t\t\t\tnewNotes[noteCount++] = note;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnote = newNotes[noteCount++];\n\t\t\t\t\t\t\t\t\tnote.start = curPart;\n\t\t\t\t\t\t\t\t\tnote.end = curPart + shape.length;\n\t\t\t\t\t\t\t\t\tnote.pins[0].size = shape.initialSize;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlet pitch: number;\n\t\t\t\t\t\t\t\tlet pitchCount: number = 0;\n\t\t\t\t\t\t\t\tconst pitchBends: number[] = []; // TODO: allocate this array only once! keep separate length and iterator index. Use Deque?\n\t\t\t\t\t\t\t\tfor (let j: number = 0; j < shape.pitchCount + shape.bendCount; j++) {\n\t\t\t\t\t\t\t\t\tconst useOldPitch: boolean = bits.read(1) == 1;\n\t\t\t\t\t\t\t\t\tif (!useOldPitch) {\n\t\t\t\t\t\t\t\t\t\tconst interval: number = bits.readPitchInterval();\n\t\t\t\t\t\t\t\t\t\tpitch = lastPitch;\n\t\t\t\t\t\t\t\t\t\tlet intervalIter: number = interval;\n\t\t\t\t\t\t\t\t\t\twhile (intervalIter > 0) {\n\t\t\t\t\t\t\t\t\t\t\tpitch++;\n\t\t\t\t\t\t\t\t\t\t\twhile (recentPitches.indexOf(pitch) != -1) pitch++;\n\t\t\t\t\t\t\t\t\t\t\tintervalIter--;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\twhile (intervalIter < 0) {\n\t\t\t\t\t\t\t\t\t\t\tpitch--;\n\t\t\t\t\t\t\t\t\t\t\twhile (recentPitches.indexOf(pitch) != -1) pitch--;\n\t\t\t\t\t\t\t\t\t\t\tintervalIter++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconst pitchIndex: number = validateRange(0, recentPitches.length - 1, bits.read(3));\n\t\t\t\t\t\t\t\t\t\tpitch = recentPitches[pitchIndex];\n\t\t\t\t\t\t\t\t\t\trecentPitches.splice(pitchIndex, 1);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\trecentPitches.unshift(pitch);\n\t\t\t\t\t\t\t\t\tif (recentPitches.length > 8) recentPitches.pop();\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (j < shape.pitchCount) {\n\t\t\t\t\t\t\t\t\t\tnote.pitches[pitchCount++] = pitch;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpitchBends.push(pitch);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (j == shape.pitchCount - 1) {\n\t\t\t\t\t\t\t\t\t\tlastPitch = note.pitches[0];\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tlastPitch = pitch;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnote.pitches.length = pitchCount;\n\t\t\t\t\t\t\t\tpitchBends.unshift(note.pitches[0]); // TODO: Use Deque?\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlet pinCount: number = 1;\n\t\t\t\t\t\t\t\tfor (const pinObj of shape.pins) {\n\t\t\t\t\t\t\t\t\tif (pinObj.pitchBend) pitchBends.shift();\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tconst interval: number = pitchBends[0] - note.pitches[0];\n\t\t\t\t\t\t\t\t\tif (note.pins.length <= pinCount) {\n\t\t\t\t\t\t\t\t\t\tnote.pins[pinCount++] = makeNotePin(interval, pinObj.time, pinObj.size);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconst pin: NotePin = note.pins[pinCount++];\n\t\t\t\t\t\t\t\t\t\tpin.interval = interval;\n\t\t\t\t\t\t\t\t\t\tpin.time = pinObj.time;\n\t\t\t\t\t\t\t\t\t\tpin.size = pinObj.size;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnote.pins.length = pinCount;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (note.start == 0 && !beforeNine) {\n\t\t\t\t\t\t\t\t\tnote.continuesLastPattern = (bits.read(1) == 1);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnote.continuesLastPattern = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tcurPart = validateRange(0, this.beatsPerBar * Config.partsPerBeat, note.end);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewNotes.length = noteCount;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (beforeThree) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tchannelIndex++;\n\t\t\t\t\t\tif (channelIndex >= this.getChannelCount()) break;\n\t\t\t\t\t}\n\t\t\t\t} // while (true)\n\t\t\t} break;\n\t\t\tdefault: {\n\t\t\t\tthrow new Error(\"Unrecognized song tag code \" + String.fromCharCode(command) + \" at index \" + (charIndex - 1));\n\t\t\t} break;\n\t\t}\n\t}\n\t\n\tpublic toJsonObject(enableIntro: boolean = true, loopCount: number = 1, enableOutro: boolean = true): Object {\n\t\tconst channelArray: Object[] = [];\n\t\tfor (let channelIndex: number = 0; channelIndex < this.getChannelCount(); channelIndex++) {\n\t\t\tconst channel: Channel = this.channels[channelIndex];\n\t\t\tconst instrumentArray: Object[] = [];\n\t\t\tconst isNoiseChannel: boolean = this.getChannelIsNoise(channelIndex);\n\t\t\tfor (const instrument of channel.instruments) {\n\t\t\t\tinstrumentArray.push(instrument.toJsonObject());\n\t\t\t}\n\t\t\t\n\t\t\tconst patternArray: Object[] = [];\n\t\t\tfor (const pattern of channel.patterns) {\n\t\t\t\tconst noteArray: Object[] = [];\n\t\t\t\tfor (const note of pattern.notes) {\n\t\t\t\t\tconst pointArray: Object[] = [];\n\t\t\t\t\tfor (const pin of note.pins) {\n\t\t\t\t\t\tpointArray.push({\n\t\t\t\t\t\t\t\"tick\": (pin.time + note.start) * Config.rhythms[this.rhythm].stepsPerBeat / Config.partsPerBeat,\n\t\t\t\t\t\t\t\"pitchBend\": pin.interval,\n\t\t\t\t\t\t\t\"volume\": Math.round(pin.size * 100 / 3),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst noteObject: any = {\n\t\t\t\t\t\t\"pitches\": note.pitches,\n\t\t\t\t\t\t\"points\": pointArray,\n\t\t\t\t\t};\n\t\t\t\t\tif (note.start == 0) {\n\t\t\t\t\t\tnoteObject[\"continuesLastPattern\"] = note.continuesLastPattern;\n\t\t\t\t\t}\n\t\t\t\t\tnoteArray.push(noteObject);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst patternObject: any = {\"notes\": noteArray};\n\t\t\t\tif (this.patternInstruments) {\n\t\t\t\t\tpatternObject[\"instruments\"] = pattern.instruments.map(i => i + 1);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tpatternArray.push(patternObject);\n\t\t\t}\n\t\t\t\n\t\t\tconst sequenceArray: number[] = [];\n\t\t\tif (enableIntro) for (let i: number = 0; i < this.loopStart; i++) {\n\t\t\t\tsequenceArray.push(channel.bars[i]);\n\t\t\t}\n\t\t\tfor (let l: number = 0; l < loopCount; l++) for (let i: number = this.loopStart; i < this.loopStart + this.loopLength; i++) {\n\t\t\t\tsequenceArray.push(channel.bars[i]);\n\t\t\t}\n\t\t\tif (enableOutro) for (let i: number = this.loopStart + this.loopLength; i < this.barCount; i++) {\n\t\t\t\tsequenceArray.push(channel.bars[i]);\n\t\t\t}\n\t\t\t\n\t\t\tconst channelObject: any = {\n\t\t\t\t\"type\": isNoiseChannel ? \"drum\" : \"pitch\",\n\t\t\t\t\"instruments\": instrumentArray,\n\t\t\t\t\"patterns\": patternArray,\n\t\t\t\t\"sequence\": sequenceArray,\n\t\t\t};\n\t\t\tif (!isNoiseChannel) {\n\t\t\t\t// For compatibility with old versions the octave is offset by one.\n\t\t\t\tchannelObject[\"octaveScrollBar\"] = channel.octave - 1;\n\t\t\t}\n\t\t\tchannelArray.push(channelObject);\n\t\t}\n\t\t\n\t\treturn {\n\t\t\t\"format\": Song._format,\n\t\t\t\"version\": Song._latestVersion,\n\t\t\t\"scale\": Config.scales[this.scale].name,\n\t\t\t\"key\": Config.keys[this.key].name,\n\t\t\t\"introBars\": this.loopStart,\n\t\t\t\"loopBars\": this.loopLength,\n\t\t\t\"beatsPerBar\": this.beatsPerBar,\n\t\t\t\"ticksPerBeat\": Config.rhythms[this.rhythm].stepsPerBeat,\n\t\t\t\"beatsPerMinute\": this.tempo,\n\t\t\t//\"patternCount\": this.patternsPerChannel, // derive this from pattern arrays.\n\t\t\t\"layeredInstruments\": this.layeredInstruments,\n\t\t\t\"patternInstruments\": this.patternInstruments,\n\t\t\t\"channels\": channelArray,\n\t\t};\n\t}\n\t\n\tpublic fromJsonObject(jsonObject: any): void {\n\t\tthis.initToDefault(true);\n\t\tif (!jsonObject) return;\n\t\t\n\t\t//const version: number = jsonObject[\"version\"] | 0;\n\t\t//if (version > Song._latestVersion) return; // Go ahead and try to parse something from the future I guess? JSON is pretty easy-going!\n\t\t\n\t\tthis.scale = 11; // default to expert.\n\t\tif (jsonObject[\"scale\"] != undefined) {\n\t\t\tconst oldScaleNames: Dictionary<string> = {\n\t\t\t\t\"romani :)\": \"dbl harmonic :)\",\n\t\t\t\t\"romani :(\": \"dbl harmonic :(\",\n\t\t\t\t\"enigma\": \"strange\",\n\t\t\t};\n\t\t\tconst scaleName: string = (oldScaleNames[jsonObject[\"scale\"]] != undefined) ? oldScaleNames[jsonObject[\"scale\"]] : jsonObject[\"scale\"];\n\t\t\tconst scale: number = Config.scales.findIndex(scale => scale.name == scaleName);\n\t\t\tif (scale != -1) this.scale = scale;\n\t\t}\n\t\t\n\t\tif (jsonObject[\"key\"] != undefined) {\n\t\t\tif (typeof(jsonObject[\"key\"]) == \"number\") {\n\t\t\t\tthis.key = ((jsonObject[\"key\"] + 1200) >>> 0) % Config.keys.length;\n\t\t\t} else if (typeof(jsonObject[\"key\"]) == \"string\") {\n\t\t\t\tconst key: string = jsonObject[\"key\"];\n\t\t\t\tconst letter: string = key.charAt(0).toUpperCase();\n\t\t\t\tconst symbol: string = key.charAt(1).toLowerCase();\n\t\t\t\tconst letterMap: Readonly<Dictionary<number>> = {\"C\": 0, \"D\": 2, \"E\": 4, \"F\": 5, \"G\": 7, \"A\": 9, \"B\": 11};\n\t\t\t\tconst accidentalMap: Readonly<Dictionary<number>> = {\"#\": 1, \"♯\": 1, \"b\": -1, \"♭\": -1};\n\t\t\t\tlet index: number | undefined = letterMap[letter];\n\t\t\t\tconst offset: number | undefined = accidentalMap[symbol];\n\t\t\t\tif (index != undefined) {\n\t\t\t\t\tif (offset != undefined) index += offset;\n\t\t\t\t\tif (index < 0) index += 12;\n\t\t\t\t\tindex = index % 12;\n\t\t\t\t\tthis.key = index;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (jsonObject[\"beatsPerMinute\"] != undefined) {\n\t\t\tthis.tempo = clamp(Config.tempoMin, Config.tempoMax + 1, jsonObject[\"beatsPerMinute\"] | 0);\n\t\t}\n\t\t\n\t\tlet legacyGlobalReverb: number = 0; // In older songs, reverb was song-global, record that here and pass it to Instrument.fromJsonObject() for context.\n\t\tif (jsonObject[\"reverb\"] != undefined) {\n\t\t\tlegacyGlobalReverb = clamp(0, 4, jsonObject[\"reverb\"] | 0);\n\t\t}\n\t\t\n\t\tif (jsonObject[\"beatsPerBar\"] != undefined) {\n\t\t\tthis.beatsPerBar = Math.max(Config.beatsPerBarMin, Math.min(Config.beatsPerBarMax, jsonObject[\"beatsPerBar\"] | 0));\n\t\t}\n\t\t\n\t\tlet importedPartsPerBeat: number = 4;\n\t\tif (jsonObject[\"ticksPerBeat\"] != undefined) {\n\t\t\timportedPartsPerBeat = (jsonObject[\"ticksPerBeat\"] | 0) || 4;\n\t\t\tthis.rhythm = Config.rhythms.findIndex(rhythm=>rhythm.stepsPerBeat==importedPartsPerBeat);\n\t\t\tif (this.rhythm == -1) {\n\t\t\t\tthis.rhythm = 1;\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet maxInstruments: number = 1;\n\t\tlet maxPatterns: number = 1;\n\t\tlet maxBars: number = 1;\n\t\tif (jsonObject[\"channels\"] != undefined) {\n\t\t\tfor (const channelObject of jsonObject[\"channels\"]) {\n\t\t\t\tif (channelObject[\"instruments\"]) maxInstruments = Math.max(maxInstruments, channelObject[\"instruments\"].length | 0);\n\t\t\t\tif (channelObject[\"patterns\"]) maxPatterns = Math.max(maxPatterns, channelObject[\"patterns\"].length | 0);\n\t\t\t\tif (channelObject[\"sequence\"]) maxBars = Math.max(maxBars, channelObject[\"sequence\"].length | 0);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (jsonObject[\"layeredInstruments\"] != undefined) {\n\t\t\tthis.layeredInstruments = !!jsonObject[\"layeredInstruments\"];\n\t\t} else {\n\t\t\tthis.layeredInstruments = false;\n\t\t}\n\t\tif (jsonObject[\"patternInstruments\"] != undefined) {\n\t\t\tthis.patternInstruments = !!jsonObject[\"patternInstruments\"];\n\t\t} else {\n\t\t\tthis.patternInstruments = (maxInstruments > 1);\n\t\t}\n\t\tthis.patternsPerChannel = Math.min(maxPatterns, Config.barCountMax);\n\t\tthis.barCount = Math.min(maxBars, Config.barCountMax);\n\t\t\n\t\tif (jsonObject[\"introBars\"] != undefined) {\n\t\t\tthis.loopStart = clamp(0, this.barCount, jsonObject[\"introBars\"] | 0);\n\t\t}\n\t\tif (jsonObject[\"loopBars\"] != undefined) {\n\t\t\tthis.loopLength = clamp(1, this.barCount - this.loopStart + 1, jsonObject[\"loopBars\"] | 0);\n\t\t}\n\t\t\n\t\tconst newPitchChannels: Channel[] = [];\n\t\tconst newNoiseChannels: Channel[] = [];\n\t\tif (jsonObject[\"channels\"] != undefined) {\n\t\t\tfor (let channelIndex: number = 0; channelIndex < jsonObject[\"channels\"].length; channelIndex++) {\n\t\t\t\tlet channelObject: any = jsonObject[\"channels\"][channelIndex];\n\t\t\t\t\n\t\t\t\tconst channel: Channel = new Channel();\n\t\t\t\t\n\t\t\t\tlet isNoiseChannel: boolean = false;\n\t\t\t\tif (channelObject[\"type\"] != undefined) {\n\t\t\t\t\tisNoiseChannel = (channelObject[\"type\"] == \"drum\");\n\t\t\t\t} else {\n\t\t\t\t\t// for older files, assume drums are channel 3.\n\t\t\t\t\tisNoiseChannel = (channelIndex >= 3);\n\t\t\t\t}\n\t\t\t\tif (isNoiseChannel) {\n\t\t\t\t\tnewNoiseChannels.push(channel);\n\t\t\t\t} else {\n\t\t\t\t\tnewPitchChannels.push(channel);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (channelObject[\"octaveScrollBar\"] != undefined) {\n\t\t\t\t\tchannel.octave = clamp(0, Config.pitchOctaves, (channelObject[\"octaveScrollBar\"] | 0) + 1);\n\t\t\t\t\tif (isNoiseChannel) channel.octave = 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (Array.isArray(channelObject[\"instruments\"])) {\n\t\t\t\t\tconst instrumentObjects: any[] = channelObject[\"instruments\"];\n\t\t\t\t\tfor (let i: number = 0; i < instrumentObjects.length; i++) {\n\t\t\t\t\t\tif (i >= this.getMaxInstrumentsPerChannel()) break;\n\t\t\t\t\t\tconst instrument: Instrument = new Instrument(isNoiseChannel);\n\t\t\t\t\t\tchannel.instruments[i] = instrument;\n\t\t\t\t\t\tinstrument.fromJsonObject(instrumentObjects[i], isNoiseChannel, legacyGlobalReverb);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (let i: number = 0; i < this.patternsPerChannel; i++) {\n\t\t\t\t\tconst pattern: Pattern = new Pattern();\n\t\t\t\t\tchannel.patterns[i] = pattern;\n\t\t\t\t\t\n\t\t\t\t\tlet patternObject: any = undefined;\n\t\t\t\t\tif (channelObject[\"patterns\"]) patternObject = channelObject[\"patterns\"][i];\n\t\t\t\t\tif (patternObject == undefined) continue;\n\t\t\t\t\t\n\t\t\t\t\tif (this.patternInstruments) {\n\t\t\t\t\t\tif (Array.isArray(patternObject[\"instruments\"])) {\n\t\t\t\t\t\t\tconst instruments: any[] = patternObject[\"instruments\"];\n\t\t\t\t\t\t\tconst instrumentCount: number = clamp(Config.instrumentCountMin, this.getMaxInstrumentsPerPatternForChannel(channel) + 1, instruments.length);\n\t\t\t\t\t\t\tfor (let j: number = 0; j < instrumentCount; j++) {\n\t\t\t\t\t\t\t\tpattern.instruments[j] = clamp(0, channel.instruments.length, (instruments[j] | 0) - 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpattern.instruments.length = instrumentCount;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpattern.instruments[0] = clamp(0, channel.instruments.length, (patternObject[\"instrument\"] | 0) - 1);\n\t\t\t\t\t\t\tpattern.instruments.length = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (patternObject[\"notes\"] && patternObject[\"notes\"].length > 0) {\n\t\t\t\t\t\tconst maxNoteCount: number = Math.min(this.beatsPerBar * Config.partsPerBeat, patternObject[\"notes\"].length >>> 0);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// TODO: Consider supporting notes specified in any timing order, sorting them and truncating as necessary. \n\t\t\t\t\t\tlet tickClock: number = 0;\n\t\t\t\t\t\tfor (let j: number = 0; j < patternObject[\"notes\"].length; j++) {\n\t\t\t\t\t\t\tif (j >= maxNoteCount) break;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst noteObject = patternObject[\"notes\"][j];\n\t\t\t\t\t\t\tif (!noteObject || !noteObject[\"pitches\"] || !(noteObject[\"pitches\"].length >= 1) || !noteObject[\"points\"] || !(noteObject[\"points\"].length >= 2)) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst note: Note = new Note(0, 0, 0, 0);\n\t\t\t\t\t\t\tnote.pitches = [];\n\t\t\t\t\t\t\tnote.pins = [];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfor (let k: number = 0; k < noteObject[\"pitches\"].length; k++) {\n\t\t\t\t\t\t\t\tconst pitch: number = noteObject[\"pitches\"][k] | 0;\n\t\t\t\t\t\t\t\tif (note.pitches.indexOf(pitch) != -1) continue;\n\t\t\t\t\t\t\t\tnote.pitches.push(pitch);\n\t\t\t\t\t\t\t\tif (note.pitches.length >= Config.maxChordSize) break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (note.pitches.length < 1) continue;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tlet noteClock: number = tickClock;\n\t\t\t\t\t\t\tlet startInterval: number = 0;\n\t\t\t\t\t\t\tfor (let k: number = 0; k < noteObject[\"points\"].length; k++) {\n\t\t\t\t\t\t\t\tconst pointObject: any = noteObject[\"points\"][k];\n\t\t\t\t\t\t\t\tif (pointObject == undefined || pointObject[\"tick\"] == undefined) continue;\n\t\t\t\t\t\t\t\tconst interval: number = (pointObject[\"pitchBend\"] == undefined) ? 0 : (pointObject[\"pitchBend\"] | 0);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tconst time: number = Math.round((+pointObject[\"tick\"]) * Config.partsPerBeat / importedPartsPerBeat);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tconst size: number = (pointObject[\"volume\"] == undefined) ? 3 : Math.max(0, Math.min(3, Math.round((pointObject[\"volume\"] | 0) * 3 / 100)));\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (time > this.beatsPerBar * Config.partsPerBeat) continue;\n\t\t\t\t\t\t\t\tif (note.pins.length == 0) {\n\t\t\t\t\t\t\t\t\tif (time < noteClock) continue;\n\t\t\t\t\t\t\t\t\tnote.start = time;\n\t\t\t\t\t\t\t\t\tstartInterval = interval;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (time <= noteClock) continue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnoteClock = time;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tnote.pins.push(makeNotePin(interval - startInterval, time - note.start, size));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (note.pins.length < 2) continue;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tnote.end = note.pins[note.pins.length - 1].time + note.start;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst maxPitch: number = isNoiseChannel ? Config.drumCount - 1 : Config.maxPitch;\n\t\t\t\t\t\t\tlet lowestPitch: number = maxPitch;\n\t\t\t\t\t\t\tlet highestPitch: number = 0;\n\t\t\t\t\t\t\tfor (let k: number = 0; k < note.pitches.length; k++) {\n\t\t\t\t\t\t\t\tnote.pitches[k] += startInterval;\n\t\t\t\t\t\t\t\tif (note.pitches[k] < 0 || note.pitches[k] > maxPitch) {\n\t\t\t\t\t\t\t\t\tnote.pitches.splice(k, 1);\n\t\t\t\t\t\t\t\t\tk--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (note.pitches[k] < lowestPitch) lowestPitch = note.pitches[k];\n\t\t\t\t\t\t\t\tif (note.pitches[k] > highestPitch) highestPitch = note.pitches[k];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (note.pitches.length < 1) continue;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfor (let k: number = 0; k < note.pins.length; k++) {\n\t\t\t\t\t\t\t\tconst pin: NotePin = note.pins[k];\n\t\t\t\t\t\t\t\tif (pin.interval + lowestPitch < 0) pin.interval = -lowestPitch;\n\t\t\t\t\t\t\t\tif (pin.interval + highestPitch > maxPitch) pin.interval = maxPitch - highestPitch;\n\t\t\t\t\t\t\t\tif (k >= 2) {\n\t\t\t\t\t\t\t\t\tif (pin.interval == note.pins[k-1].interval && \n\t\t\t\t\t\t\t\t\t\tpin.interval == note.pins[k-2].interval && \n\t\t\t\t\t\t\t\t\t\tpin.size == note.pins[k-1].size && \n\t\t\t\t\t\t\t\t\t\tpin.size == note.pins[k-2].size)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tnote.pins.splice(k-1, 1);\n\t\t\t\t\t\t\t\t\t\tk--;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (note.start == 0) {\n\t\t\t\t\t\t\t\tnote.continuesLastPattern = (noteObject[\"continuesLastPattern\"] === true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnote.continuesLastPattern = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tpattern.notes.push(note);\n\t\t\t\t\t\t\ttickClock = note.end;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tchannel.patterns.length = this.patternsPerChannel;\n\t\t\t\t\n\t\t\t\tfor (let i: number = 0; i < this.barCount; i++) {\n\t\t\t\t\tchannel.bars[i] = (channelObject[\"sequence\"] != undefined) ? Math.min(this.patternsPerChannel, channelObject[\"sequence\"][i] >>> 0) : 0;\n\t\t\t\t}\n\t\t\t\tchannel.bars.length = this.barCount;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (newPitchChannels.length > Config.pitchChannelCountMax) newPitchChannels.length = Config.pitchChannelCountMax;\n\t\tif (newNoiseChannels.length > Config.noiseChannelCountMax) newNoiseChannels.length = Config.noiseChannelCountMax;\n\t\tthis.pitchChannelCount = newPitchChannels.length;\n\t\tthis.noiseChannelCount = newNoiseChannels.length;\n\t\tthis.channels.length = 0;\n\t\tArray.prototype.push.apply(this.channels, newPitchChannels);\n\t\tArray.prototype.push.apply(this.channels, newNoiseChannels);\n\t}\n\t\n\tpublic getPattern(channelIndex: number, bar: number): Pattern | null {\n\t\tif (bar < 0 || bar >= this.barCount) return null;\n\t\tconst patternIndex: number = this.channels[channelIndex].bars[bar];\n\t\tif (patternIndex == 0) return null;\n\t\treturn this.channels[channelIndex].patterns[patternIndex - 1];\n\t}\n\t\n\tpublic getBeatsPerMinute(): number {\n\t\treturn this.tempo;\n\t}\n\t\n\tpublic static getNeededBits(maxValue: number): number {\n\t\treturn 32 - Math.clz32(Math.ceil(maxValue + 1) - 1);\n\t}\n}\n\nclass PickedString {\n\tpublic delayLine: Float32Array | null = null;\n\tpublic delayIndex: number;\n\tpublic allPassSample: number;\n\tpublic allPassPrevInput: number;\n\tpublic shelfSample: number;\n\tpublic shelfPrevInput: number;\n\tpublic fractionalDelaySample: number;\n\tpublic prevDelayLength: number;\n\tpublic delayResetOffset: number;\n\t\n\tconstructor() {\n\t\tthis.reset();\n\t}\n\t\n\tpublic reset(): void {\n\t\tthis.delayIndex = -1;\n\t\tthis.allPassSample = 0.0;\n\t\tthis.allPassPrevInput = 0.0;\n\t\tthis.shelfSample = 0.0;\n\t\tthis.shelfPrevInput = 0.0;\n\t\tthis.fractionalDelaySample = 0.0;\n\t\tthis.prevDelayLength = -1.0;\n\t\tthis.delayResetOffset = 0;\n\t}\n}\n\nclass EnvelopeComputer {\n\tpublic noteSecondsStart: number = 0.0;\n\tpublic noteSecondsEnd: number = 0.0;\n\tpublic noteTicksStart: number = 0.0;\n\tpublic noteTicksEnd: number = 0.0;\n\tpublic noteSizeStart: number = Config.noteSizeMax;\n\tpublic noteSizeEnd: number = Config.noteSizeMax;\n\tpublic prevNoteSize: number = Config.noteSizeMax;\n\tpublic nextNoteSize: number = Config.noteSizeMax;\n\tprivate _noteSizeFinal: number = Config.noteSizeMax;\n\tpublic prevNoteSecondsStart: number = 0.0;\n\tpublic prevNoteSecondsEnd: number = 0.0;\n\tpublic prevNoteTicksStart: number = 0.0;\n\tpublic prevNoteTicksEnd: number = 0.0;\n\tprivate _prevNoteSizeFinal: number = Config.noteSizeMax;\n\t\n\tpublic prevSlideStart: boolean = false;\n\tpublic prevSlideEnd: boolean = false;\n\tpublic nextSlideStart: boolean = false;\n\tpublic nextSlideEnd: boolean = false;\n\tpublic prevSlideRatioStart: number = 0.0;\n\tpublic prevSlideRatioEnd: number = 0.0;\n\tpublic nextSlideRatioStart: number = 0.0;\n\tpublic nextSlideRatioEnd: number = 0.0;\n\t\n\tpublic readonly envelopeStarts: number[] = [];\n\tpublic readonly envelopeEnds: number[] = [];\n\tpublic lowpassCutoffDecayVolumeCompensation: number = 1.0;\n\t\n\tconstructor(/*private _perNote: boolean*/) {\n\t\t//const length: number = this._perNote ? NoteAutomationIndex.length : InstrumentAutomationIndex.length;\n\t\tconst length: number = NoteAutomationIndex.length;\n\t\tfor (let i: number = 0; i < length; i++) {\n\t\t\tthis.envelopeStarts[i] = 1.0;\n\t\t\tthis.envelopeEnds[i] = 1.0;\n\t\t}\n\t\t\n\t\tthis.reset();\n\t}\n\t\n\tpublic reset(): void {\n\t\tthis.noteSecondsEnd = 0.0;\n\t\tthis.noteTicksEnd = 0.0;\n\t\tthis._noteSizeFinal = Config.noteSizeMax;\n\t\tthis.prevNoteSecondsEnd = 0.0;\n\t\tthis.prevNoteTicksEnd = 0.0;\n\t\tthis._prevNoteSizeFinal = Config.noteSizeMax;\n\t}\n\t\n\tpublic computeEnvelopes(instrument: Instrument, currentPart: number, tickTimeStart: number, tickTimeEnd: number, secondsPassing: number, tone: Tone | null): void {\n\t\tconst transition: Transition = instrument.getTransition();\n\t\tif (tone != null && tone.atNoteStart && !transition.continues && !tone.forceContinueAtStart) {\n\t\t\tthis.prevNoteSecondsEnd = this.noteSecondsEnd;\n\t\t\tthis.prevNoteTicksEnd = this.noteTicksEnd;\n\t\t\tthis._prevNoteSizeFinal = this._noteSizeFinal;\n\t\t\tthis.noteSecondsEnd = 0.0;\n\t\t\tthis.noteTicksEnd = 0.0;\n\t\t}\n\t\tif (tone != null) {\n\t\t\tif (tone.note != null) {\n\t\t\t\tthis._noteSizeFinal = tone.note.pins[tone.note.pins.length - 1].size;\n\t\t\t} else {\n\t\t\t\tthis._noteSizeFinal = Config.noteSizeMax;\n\t\t\t}\n\t\t}\n\t\t\n\t\tconst ticksPassing: number = tickTimeEnd - tickTimeStart;\n\t\tconst noteSecondsStart: number = this.noteSecondsEnd;\n\t\tconst noteSecondsEnd: number = noteSecondsStart + secondsPassing;\n\t\tconst noteTicksStart: number = this.noteTicksEnd;\n\t\tconst noteTicksEnd: number = noteTicksStart + ticksPassing;\n\t\tconst prevNoteSecondsStart: number = this.prevNoteSecondsEnd;\n\t\tconst prevNoteSecondsEnd: number = prevNoteSecondsStart + secondsPassing;\n\t\tconst prevNoteTicksStart: number = this.prevNoteTicksEnd;\n\t\tconst prevNoteTicksEnd: number = prevNoteTicksStart + ticksPassing;\n\t\t\n\t\tconst beatsPerTick: number = 1.0 / (Config.ticksPerPart * Config.partsPerBeat);\n\t\tconst beatTimeStart: number = beatsPerTick * tickTimeStart;\n\t\tconst beatTimeEnd:   number = beatsPerTick * tickTimeEnd;\n\t\t\n\t\tlet noteSizeStart: number = this._noteSizeFinal;\n\t\tlet noteSizeEnd: number = this._noteSizeFinal;\n\t\tlet prevNoteSize: number = this._prevNoteSizeFinal;\n\t\tlet nextNoteSize: number = 0;\n\t\tlet prevSlideStart: boolean = false;\n\t\tlet prevSlideEnd: boolean = false;\n\t\tlet nextSlideStart: boolean = false;\n\t\tlet nextSlideEnd: boolean = false;\n\t\tlet prevSlideRatioStart: number = 0.0;\n\t\tlet prevSlideRatioEnd: number = 0.0;\n\t\tlet nextSlideRatioStart: number = 0.0;\n\t\tlet nextSlideRatioEnd: number = 0.0;\n\t\tif (tone != null && tone.note != null && !tone.passedEndOfNote) {\n\t\t\tconst endPinIndex: number = tone.note.getEndPinIndex(currentPart);\n\t\t\tconst startPin: NotePin = tone.note.pins[endPinIndex-1];\n\t\t\tconst endPin:   NotePin = tone.note.pins[endPinIndex];\n\t\t\tconst startPinTick: number = (tone.note.start + startPin.time) * Config.ticksPerPart;\n\t\t\tconst endPinTick:   number = (tone.note.start + endPin.time)   * Config.ticksPerPart;\n\t\t\tconst ratioStart: number = (tickTimeStart - startPinTick) / (endPinTick - startPinTick);\n\t\t\tconst ratioEnd:   number = (tickTimeEnd   - startPinTick) / (endPinTick - startPinTick);\n\t\t\tnoteSizeStart = startPin.size + (endPin.size - startPin.size) * ratioStart;\n\t\t\tnoteSizeEnd   = startPin.size + (endPin.size - startPin.size) * ratioEnd;\n\t\t\t\n\t\t\tif (transition.slides) {\n\t\t\t\tconst noteStartTick: number = tone.noteStartPart * Config.ticksPerPart;\n\t\t\t\tconst noteEndTick:   number = tone.noteEndPart   * Config.ticksPerPart;\n\t\t\t\tconst noteLengthTicks: number = noteEndTick - noteStartTick;\n\t\t\t\tconst maximumSlideTicks: number = noteLengthTicks * 0.5;\n\t\t\t\tconst slideTicks: number = Math.min(maximumSlideTicks, transition.slideTicks);\n\t\t\t\tif (tone.prevNote != null && !tone.forceContinueAtStart) {\n\t\t\t\t\tif (tickTimeStart - noteStartTick < slideTicks) {\n\t\t\t\t\t\tprevSlideStart = true;\n\t\t\t\t\t\tprevSlideRatioStart = 0.5 * (1.0 - (tickTimeStart - noteStartTick) / slideTicks);\n\t\t\t\t\t}\n\t\t\t\t\tif (tickTimeEnd - noteStartTick < slideTicks) {\n\t\t\t\t\t\tprevSlideEnd = true;\n\t\t\t\t\t\tprevSlideRatioEnd = 0.5 * (1.0 - (tickTimeEnd - noteStartTick) / slideTicks);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (tone.nextNote != null && !tone.forceContinueAtEnd) {\n\t\t\t\t\tnextNoteSize = tone.nextNote.pins[0].size\n\t\t\t\t\tif (noteEndTick - tickTimeStart < slideTicks) {\n\t\t\t\t\t\tnextSlideStart = true;\n\t\t\t\t\t\tnextSlideRatioStart = 0.5 * (1.0 - (noteEndTick - tickTimeStart) / slideTicks);\n\t\t\t\t\t}\n\t\t\t\t\tif (noteEndTick - tickTimeEnd < slideTicks) {\n\t\t\t\t\t\tnextSlideEnd = true;\n\t\t\t\t\t\tnextSlideRatioEnd = 0.5 * (1.0 - (noteEndTick - tickTimeEnd) / slideTicks);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet lowpassCutoffDecayVolumeCompensation: number = 1.0;\n\t\tlet usedNoteSize: boolean = false;\n\t\tfor (let envelopeIndex: number = 0; envelopeIndex <= instrument.envelopeCount; envelopeIndex++) {\n\t\t\tlet automationTarget: AutomationTarget;\n\t\t\tlet targetIndex: number;\n\t\t\tlet envelope: Envelope;\n\t\t\tif (envelopeIndex == instrument.envelopeCount) {\n\t\t\t\tif (usedNoteSize /*|| !this._perNote*/) break;\n\t\t\t\t// Special case: if no other envelopes used note size, default to applying it to note volume.\n\t\t\t\tautomationTarget = Config.instrumentAutomationTargets.dictionary[\"noteVolume\"];\n\t\t\t\ttargetIndex = 0;\n\t\t\t\tenvelope = Config.envelopes.dictionary[\"note size\"];\n\t\t\t} else {\n\t\t\t\tlet envelopeSettings: EnvelopeSettings = instrument.envelopes[envelopeIndex];\n\t\t\t\tautomationTarget = Config.instrumentAutomationTargets[envelopeSettings.target];\n\t\t\t\ttargetIndex = envelopeSettings.index;\n\t\t\t\tenvelope = Config.envelopes[envelopeSettings.envelope];\n\t\t\t\tif (envelope.type == EnvelopeType.noteSize) usedNoteSize = true;\n\t\t\t}\n\t\t\tif (/*automationTarget.perNote == this._perNote &&*/ automationTarget.computeIndex != null) {\n\t\t\t\tconst computeIndex: number = automationTarget.computeIndex + targetIndex;\n\t\t\t\tlet envelopeStart: number = EnvelopeComputer.computeEnvelope(envelope, noteSecondsStart, beatTimeStart, noteSizeStart);\n\t\t\t\tlet envelopeEnd:   number = EnvelopeComputer.computeEnvelope(envelope, noteSecondsEnd,   beatTimeEnd,   noteSizeEnd);\n\t\t\t\t\n\t\t\t\tif (prevSlideStart) {\n\t\t\t\t\tconst other: number = EnvelopeComputer.computeEnvelope(envelope, prevNoteSecondsStart, beatTimeStart, prevNoteSize);\n\t\t\t\t\tenvelopeStart += (other - envelopeStart) * prevSlideRatioStart;\n\t\t\t\t}\n\t\t\t\tif (prevSlideEnd) {\n\t\t\t\t\tconst other: number = EnvelopeComputer.computeEnvelope(envelope, prevNoteSecondsEnd, beatTimeEnd, prevNoteSize);\n\t\t\t\t\tenvelopeEnd += (other - envelopeEnd) * prevSlideRatioEnd;\n\t\t\t\t}\n\t\t\t\tif (nextSlideStart) {\n\t\t\t\t\tconst other: number = EnvelopeComputer.computeEnvelope(envelope, 0.0, beatTimeStart, nextNoteSize);\n\t\t\t\t\tenvelopeStart += (other - envelopeStart) * nextSlideRatioStart;\n\t\t\t\t}\n\t\t\t\tif (nextSlideEnd) {\n\t\t\t\t\tconst other: number = EnvelopeComputer.computeEnvelope(envelope, 0.0, beatTimeEnd, nextNoteSize);\n\t\t\t\t\tenvelopeEnd += (other - envelopeEnd) * nextSlideRatioEnd;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.envelopeStarts[computeIndex] *= envelopeStart;\n\t\t\t\tthis.envelopeEnds[computeIndex]   *= envelopeEnd;\n\t\t\t\t\n\t\t\t\tif (automationTarget.isFilter) {\n\t\t\t\t\tconst filterSettings: FilterSettings = /*this._perNote ?*/ instrument.noteFilter /*: instrument.eqFilter*/;\n\t\t\t\t\tif (filterSettings.controlPointCount > targetIndex && filterSettings.controlPoints[targetIndex].type == FilterType.lowPass) {\n\t\t\t\t\t\tlowpassCutoffDecayVolumeCompensation = Math.max(lowpassCutoffDecayVolumeCompensation, EnvelopeComputer.getLowpassCutoffDecayVolumeCompensation(envelope));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.noteSecondsStart = noteSecondsStart;\n\t\tthis.noteSecondsEnd = noteSecondsEnd;\n\t\tthis.noteTicksStart = noteTicksStart;\n\t\tthis.noteTicksEnd = noteTicksEnd;\n\t\tthis.prevNoteSecondsStart = prevNoteSecondsStart;\n\t\tthis.prevNoteSecondsEnd = prevNoteSecondsEnd;\n\t\tthis.prevNoteTicksStart = prevNoteTicksStart;\n\t\tthis.prevNoteTicksEnd = prevNoteTicksEnd;\n\t\tthis.prevNoteSize = prevNoteSize;\n\t\tthis.nextNoteSize = nextNoteSize;\n\t\tthis.noteSizeStart = noteSizeStart;\n\t\tthis.noteSizeEnd = noteSizeEnd;\n\t\tthis.prevSlideStart = prevSlideStart;\n\t\tthis.prevSlideEnd = prevSlideEnd;\n\t\tthis.nextSlideStart = nextSlideStart;\n\t\tthis.nextSlideEnd = nextSlideEnd;\n\t\tthis.prevSlideRatioStart = prevSlideRatioStart;\n\t\tthis.prevSlideRatioEnd = prevSlideRatioEnd;\n\t\tthis.nextSlideRatioStart = nextSlideRatioStart;\n\t\tthis.nextSlideRatioEnd = nextSlideRatioEnd;\n\t\tthis.lowpassCutoffDecayVolumeCompensation = lowpassCutoffDecayVolumeCompensation;\n\t}\n\t\n\tpublic clearEnvelopes(instrument: Instrument): void {\n\t\tfor (let envelopeIndex: number = 0; envelopeIndex < instrument.envelopeCount; envelopeIndex++) {\n\t\t\tconst envelopeSettings: EnvelopeSettings = instrument.envelopes[envelopeIndex];\n\t\t\tconst automationTarget: AutomationTarget = Config.instrumentAutomationTargets[envelopeSettings.target];\n\t\t\tif (/*automationTarget.perNote == this._perNote &&*/ automationTarget.computeIndex != null) {\n\t\t\t\tconst computeIndex: number = automationTarget.computeIndex + envelopeSettings.index;\n\t\t\t\tthis.envelopeStarts[computeIndex] = 1.0;\n\t\t\t\tthis.envelopeEnds[computeIndex]   = 1.0;\n\t\t\t}\n\t\t}\n\t\t//if (this._perNote) {\n\t\t\t// As a special case, note volume may be altered even if there was no envelope for it.\n\t\t\tthis.envelopeStarts[NoteAutomationIndex.noteVolume] = 1.0;\n\t\t\tthis.envelopeEnds[  NoteAutomationIndex.noteVolume] = 1.0;\n\t\t//}\n\t}\n\t\n\tpublic static computeEnvelope(envelope: Envelope, time: number, beats: number, noteSize: number): number {\n\t\tswitch(envelope.type) {\n\t\t\tcase EnvelopeType.noteSize: return Synth.noteSizeToVolumeMult(noteSize);\n\t\t\tcase EnvelopeType.none:     return 1.0;\n\t\t\tcase EnvelopeType.twang:    return 1.0 / (1.0 + time * envelope.speed);\n\t\t\tcase EnvelopeType.swell:    return 1.0 - 1.0 / (1.0 + time * envelope.speed);\n\t\t\tcase EnvelopeType.tremolo:  return 0.5 - Math.cos(beats * 2.0 * Math.PI * envelope.speed) * 0.5;\n\t\t\tcase EnvelopeType.tremolo2: return 0.75 - Math.cos(beats * 2.0 * Math.PI * envelope.speed) * 0.25;\n\t\t\tcase EnvelopeType.punch:    return Math.max(1.0, 2.0 - time * 10.0);\n\t\t\tcase EnvelopeType.flare:    const attack: number = 0.25 / Math.sqrt(envelope.speed); return time < attack ? time / attack : 1.0 / (1.0 + (time - attack) * envelope.speed);\n\t\t\tcase EnvelopeType.decay:    return Math.pow(2, -envelope.speed * time);\n\t\t\tdefault: throw new Error(\"Unrecognized operator envelope type.\");\n\t\t}\n\t}\n\t\n\tpublic static getLowpassCutoffDecayVolumeCompensation(envelope: Envelope): number {\n\t\t// This is a little hokey in the details, but I designed it a while ago and keep it \n\t\t// around for compatibility. This decides how much to increase the volume (or\n\t\t// expression) to compensate for a decaying lowpass cutoff to maintain perceived\n\t\t// volume overall.\n\t\tif (envelope.type == EnvelopeType.decay) return 1.25 + 0.025 * envelope.speed;\n\t\tif (envelope.type == EnvelopeType.twang) return 1.0  + 0.02  * envelope.speed;\n\t\treturn 1.0;\n\t}\n}\n\nclass Tone {\n\tpublic instrumentIndex: number;\n\tpublic readonly pitches: number[] = Array(Config.maxChordSize).fill(0);\n\tpublic pitchCount: number = 0;\n\tpublic chordSize: number = 0;\n\tpublic drumsetPitch: number | null = null;\n\tpublic note: Note | null = null;\n\tpublic prevNote: Note | null = null;\n\tpublic nextNote: Note | null = null;\n\tpublic prevNotePitchIndex: number = 0;\n\tpublic nextNotePitchIndex: number = 0;\n\tpublic freshlyAllocated: boolean = true;\n\tpublic atNoteStart: boolean = false;\n\tpublic isOnLastTick: boolean = false; // Whether the tone is finished fading out and ready to be freed.\n\tpublic passedEndOfNote: boolean = false;\n\tpublic forceContinueAtStart: boolean = false;\n\tpublic forceContinueAtEnd: boolean = false;\n\tpublic noteStartPart: number = 0;\n\tpublic noteEndPart: number = 0;\n\tpublic ticksSinceReleased: number = 0;\n\tpublic liveInputSamplesHeld: number = 0;\n\tpublic lastInterval: number = 0;\n\tpublic sample: number = 0.0;\n\tpublic readonly phases: number[] = [];\n\tpublic readonly phaseDeltas: number[] = [];\n\tpublic readonly expressionStarts: number[] = [];\n\tpublic readonly expressionDeltas: number[] = [];\n\tpublic readonly phaseDeltaScales: number[] = [];\n\tpublic prevVibrato: number | null = null;\n\tpublic pulseWidth: number = 0.0;\n\tpublic pulseWidthDelta: number = 0.0;\n\tpublic readonly pickedStrings: PickedString[] = [];\n\t\n\tpublic readonly noteFilters: DynamicBiquadFilter[] = [];\n\tpublic noteFilterCount: number = 0;\n\tpublic initialNoteFilterInput1: number = 0.0;\n\tpublic initialNoteFilterInput2: number = 0.0;\n\t\n\tpublic specialIntervalMult: number = 0.0;\n\tpublic specialIntervalExpressionMult: number = 1.0;\n\tpublic readonly feedbackOutputs: number[] = [];\n\tpublic feedbackMult: number = 0.0;\n\tpublic feedbackDelta: number = 0.0;\n\t\n\tpublic readonly envelopeComputer: EnvelopeComputer = new EnvelopeComputer(/*true*/);\n\t\n\tconstructor() {\n\t\tthis.reset();\n\t}\n\t\n\tpublic reset(): void {\n\t\tthis.sample = 0.0;\n\t\tconst maxWaves: number = Math.max(Config.maxChordSize, Config.operatorCount);\n\t\tfor (let i: number = 0; i < maxWaves; i++) {\n\t\t\tthis.phases[i] = 0.0;\n\t\t\tthis.feedbackOutputs[i] = 0.0;\n\t\t}\n\t\tfor (let i: number = 0; i < this.noteFilterCount; i++) {\n\t\t\tthis.noteFilters[i].resetOutput();\n\t\t}\n\t\tthis.noteFilterCount = 0;\n\t\tthis.initialNoteFilterInput1 = 0.0;\n\t\tthis.initialNoteFilterInput2 = 0.0;\n\t\tthis.liveInputSamplesHeld = 0;\n\t\tfor (const pickedString of this.pickedStrings) {\n\t\t\tpickedString.reset();\n\t\t}\n\t\tthis.envelopeComputer.reset();\n\t\tthis.prevVibrato = null;\n\t\tthis.drumsetPitch = null;\n\t}\n}\n\nclass InstrumentState {\n\tpublic instrument: Instrument;\n\t\n\tpublic awake: boolean = false; // Whether the instrument's effects-processing loop should continue.\n\tpublic computed: boolean = false; // Whether the effects-processing parameters are up-to-date for the current synth run.\n\tpublic tonesAddedInThisTick: boolean = false; // Whether any instrument tones are currently active.\n\tpublic flushingDelayLines: boolean = false; // If no tones were active recently, enter a mode where the delay lines are filled with zeros to reset them for later use.\n\tpublic deactivateAfterThisTick: boolean = false; // Whether the instrument is ready to be deactivated because the delay lines, if any, are fully zeroed.\n\tpublic attentuationProgress: number = 0.0; // How long since an active tone introduced an input signal to the delay lines, normalized from 0 to 1 based on how long to wait until the delay lines signal will have audibly dissapated.\n\tpublic flushedSamples: number = 0; // How many delay line samples have been flushed to zero.\n\tpublic readonly activeTones: Deque<Tone> = new Deque<Tone>();\n\tpublic readonly releasedTones: Deque<Tone> = new Deque<Tone>(); // Tones that are in the process of fading out after the corresponding notes ended.\n\tpublic readonly liveInputTones: Deque<Tone> = new Deque<Tone>(); // Tones that are initiated by a source external to the loaded song data.\n\t\n\tpublic eqFilterVolumeStart: number = 1.0;\n\tpublic eqFilterVolumeDelta: number = 0.0;\n\tpublic mixVolumeStart: number = 1.0;\n\tpublic mixVolumeDelta: number = 0.0;\n\tpublic delayInputMultStart: number = 0.0;\n\tpublic delayInputMultDelta: number = 0.0;\n\t\n\tpublic distortionStart: number = 0.0;\n\tpublic distortionEnd: number = 0.0;\n\tpublic distortionFractionalInput1: number = 0.0;\n\tpublic distortionFractionalInput2: number = 0.0;\n\tpublic distortionFractionalInput3: number = 0.0;\n\tpublic distortionPrevInput: number = 0.0;\n\tpublic distortionNextOutput: number = 0.0;\n\t\n\tpublic bitcrusherPrevInput: number = 0.0;\n\tpublic bitcrusherCurrentOutput: number = 0.0;\n\tpublic bitcrusherPhase: number = 1.0;\n\tpublic bitcrusherPhaseDelta: number = 0.0;\n\tpublic bitcrusherPhaseDeltaScale: number = 1.0;\n\tpublic bitcrusherScale: number = 1.0;\n\tpublic bitcrusherScaleScale: number = 1.0;\n\tpublic bitcrusherFoldLevel: number = 1.0;\n\tpublic bitcrusherFoldLevelScale: number = 1.0;\n\t\n\tpublic readonly eqFilters: DynamicBiquadFilter[] = [];\n\tpublic eqFilterCount: number = 0;\n\tpublic initialEqFilterInput1: number = 0.0;\n\tpublic initialEqFilterInput2: number = 0.0;\n\t\n\tpublic panningDelayLine: Float32Array | null = null;\n\tpublic panningDelayPos: number = 0;\n\tpublic panningVolumeStartL: number = 0.0;\n\tpublic panningVolumeStartR: number = 0.0;\n\tpublic panningVolumeDeltaL: number = 0.0;\n\tpublic panningVolumeDeltaR: number = 0.0;\n\tpublic panningOffsetStartL: number = 0.0;\n\tpublic panningOffsetStartR: number = 0.0;\n\tpublic panningOffsetDeltaL: number = 0.0;\n\tpublic panningOffsetDeltaR: number = 0.0;\n\t\n\tpublic chorusDelayLineL: Float32Array | null = null;\n\tpublic chorusDelayLineR: Float32Array | null = null;\n\tpublic chorusDelayLineDirty: boolean = false;\n\tpublic chorusDelayPos: number = 0;\n\tpublic chorusPhase: number = 0;\n\tpublic chorusStart: number = 0;\n\tpublic chorusEnd: number = 0;\n\t\n\tpublic echoDelayLineL: Float32Array | null = null;\n\tpublic echoDelayLineR: Float32Array | null = null;\n\tpublic echoDelayLineDirty: boolean = false;\n\tpublic echoDelayPos: number = 0;\n\tpublic echoDelayOffsetStart: number = 0;\n\tpublic echoDelayOffsetEnd: number = 0;\n\tpublic echoDelayOffsetLastTick: number = 0;\n\tpublic echoDelayOffsetRatio: number = 0.0;\n\tpublic echoDelayOffsetRatioDelta: number = 0.0;\n\tpublic echoDelayOffsetLastTickIsComputed: boolean = false;\n\tpublic echoMultStart: number = 0.0;\n\tpublic echoMultDelta: number = 0.0;\n\tpublic echoShelfA1: number = 0.0;\n\tpublic echoShelfB0: number = 0.0;\n\tpublic echoShelfB1: number = 0.0;\n\tpublic echoShelfSampleL: number = 0.0;\n\tpublic echoShelfSampleR: number = 0.0;\n\tpublic echoShelfPrevInputL: number = 0.0;\n\tpublic echoShelfPrevInputR: number = 0.0;\n\t\n\tpublic reverbDelayLine: Float32Array | null = null;\n\tpublic reverbDelayLineDirty: boolean = false;\n\tpublic reverbDelayPos: number = 0;\n\tpublic reverbMultStart: number = 0.0;\n\tpublic reverbMultDelta: number = 0.0;\n\tpublic reverbShelfA1: number = 0.0;\n\tpublic reverbShelfB0: number = 0.0;\n\tpublic reverbShelfB1: number = 0.0;\n\tpublic reverbShelfSample0: number = 0.0;\n\tpublic reverbShelfSample1: number = 0.0;\n\tpublic reverbShelfSample2: number = 0.0;\n\tpublic reverbShelfSample3: number = 0.0;\n\tpublic reverbShelfPrevInput0: number = 0.0;\n\tpublic reverbShelfPrevInput1: number = 0.0;\n\tpublic reverbShelfPrevInput2: number = 0.0;\n\tpublic reverbShelfPrevInput3: number = 0.0;\n\t\n\t//public readonly envelopeComputer: EnvelopeComputer = new EnvelopeComputer(false);\n\t\n\tpublic allocateNecessaryBuffers(synth: Synth, instrument: Instrument, samplesPerTick: number): void {\n\t\tif (effectsIncludePanning(instrument.effects)) {\n\t\t\tif (this.panningDelayLine == null || this.panningDelayLine.length < synth.panningDelayBufferSize) {\n\t\t\t\tthis.panningDelayLine = new Float32Array(synth.panningDelayBufferSize);\n\t\t\t}\n\t\t}\n\t\tif (effectsIncludeChorus(instrument.effects)) {\n\t\t\tif (this.chorusDelayLineL == null || this.chorusDelayLineL.length < synth.chorusDelayBufferSize) {\n\t\t\t\tthis.chorusDelayLineL = new Float32Array(synth.chorusDelayBufferSize);\n\t\t\t}\n\t\t\tif (this.chorusDelayLineR == null || this.chorusDelayLineR.length < synth.chorusDelayBufferSize) {\n\t\t\t\tthis.chorusDelayLineR = new Float32Array(synth.chorusDelayBufferSize);\n\t\t\t}\n\t\t}\n\t\tif (effectsIncludeEcho(instrument.effects)) {\n\t\t\t// account for tempo and delay automation changing delay length during a tick?\n\t\t\tconst safeEchoDelaySteps: number = Math.max(Config.echoDelayRange >> 1, (instrument.echoDelay + 1)); // The delay may be very short now, but if it increases later make sure we have enough sample history.\n\t\t\tconst baseEchoDelayBufferSize: number = Synth.fittingPowerOfTwo(safeEchoDelaySteps * Config.echoDelayStepTicks * samplesPerTick);\n\t\t\tconst safeEchoDelayBufferSize: number = baseEchoDelayBufferSize * 2; // If the tempo or delay changes and we suddenly need a longer delay, make sure that we have enough sample history to accomodate the longer delay.\n\t\t\t\n\t\t\tif (this.echoDelayLineL == null || this.echoDelayLineR == null) {\n\t\t\t\tthis.echoDelayLineL = new Float32Array(safeEchoDelayBufferSize);\n\t\t\t\tthis.echoDelayLineR = new Float32Array(safeEchoDelayBufferSize);\n\t\t\t} else if (this.echoDelayLineL.length < safeEchoDelayBufferSize || this.echoDelayLineR.length < safeEchoDelayBufferSize) {\n\t\t\t\t// The echo delay length may change whlie the song is playing if tempo changes,\n\t\t\t\t// so buffers may need to be reallocated, but we don't want to lose any echoes\n\t\t\t\t// so we need to copy the contents of the old buffer to the new one.\n\t\t\t\tconst newDelayLineL: Float32Array = new Float32Array(safeEchoDelayBufferSize);\n\t\t\t\tconst newDelayLineR: Float32Array = new Float32Array(safeEchoDelayBufferSize);\n\t\t\t\tconst oldMask: number = this.echoDelayLineL.length - 1;\n\t\t\t\t\n\t\t\t\tfor (let i = 0; i < this.echoDelayLineL.length; i++) {\n\t\t\t\t\tnewDelayLineL[i] = this.echoDelayLineL[(this.echoDelayPos + i) & oldMask];\n\t\t\t\t\tnewDelayLineR[i] = this.echoDelayLineL[(this.echoDelayPos + i) & oldMask];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.echoDelayPos = this.echoDelayLineL.length;\n\t\t\t\tthis.echoDelayLineL = newDelayLineL;\n\t\t\t\tthis.echoDelayLineR = newDelayLineR;\n\t\t\t}\n\t\t}\n\t\tif (effectsIncludeReverb(instrument.effects)) {\n\t\t\t// TODO: Make reverb delay line sample rate agnostic. Maybe just double buffer size for 96KHz? Adjust attenuation and shelf cutoff appropriately?\n\t\t\tif (this.reverbDelayLine == null) {\n\t\t\t\tthis.reverbDelayLine = new Float32Array(Config.reverbDelayBufferSize);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic deactivate(): void {\n\t\tthis.bitcrusherPrevInput = 0.0;\n\t\tthis.bitcrusherCurrentOutput = 0.0;\n\t\tthis.bitcrusherPhase = 1.0;\n\t\tfor (let i: number = 0; i < this.eqFilterCount; i++) {\n\t\t\tthis.eqFilters[i].resetOutput();\n\t\t}\n\t\tthis.eqFilterCount = 0;\n\t\tthis.initialEqFilterInput1 = 0.0;\n\t\tthis.initialEqFilterInput2 = 0.0;\n\t\tthis.distortionFractionalInput1 = 0.0;\n\t\tthis.distortionFractionalInput2 = 0.0;\n\t\tthis.distortionFractionalInput3 = 0.0;\n\t\tthis.distortionPrevInput = 0.0;\n\t\tthis.distortionNextOutput = 0.0;\n\t\tthis.panningDelayPos = 0;\n\t\tif (this.panningDelayLine != null) for (let i: number = 0; i < this.panningDelayLine.length; i++) this.panningDelayLine[i] = 0.0;\n\t\tthis.echoDelayOffsetLastTickIsComputed = false;\n\t\tthis.echoShelfSampleL = 0.0;\n\t\tthis.echoShelfSampleR = 0.0;\n\t\tthis.echoShelfPrevInputL = 0.0;\n\t\tthis.echoShelfPrevInputR = 0.0;\n\t\tthis.reverbShelfSample0 = 0.0;\n\t\tthis.reverbShelfSample1 = 0.0;\n\t\tthis.reverbShelfSample2 = 0.0;\n\t\tthis.reverbShelfSample3 = 0.0;\n\t\tthis.reverbShelfPrevInput0 = 0.0;\n\t\tthis.reverbShelfPrevInput1 = 0.0;\n\t\tthis.reverbShelfPrevInput2 = 0.0;\n\t\tthis.reverbShelfPrevInput3 = 0.0;\n\t\t\n\t\tthis.awake = false;\n\t\tthis.flushingDelayLines = false;\n\t\tthis.deactivateAfterThisTick = false;\n\t\tthis.attentuationProgress = 0.0;\n\t\tthis.flushedSamples = 0;\n\t}\n\t\n\tpublic resetAllEffects(): void {\n\t\tthis.deactivate();\n\t\t\n\t\tif (this.chorusDelayLineDirty) {\n\t\t\tfor (let i: number = 0; i < this.chorusDelayLineL!.length; i++) this.chorusDelayLineL![i] = 0.0;\n\t\t\tfor (let i: number = 0; i < this.chorusDelayLineR!.length; i++) this.chorusDelayLineR![i] = 0.0;\n\t\t}\n\t\tif (this.echoDelayLineDirty) {\n\t\t\tfor (let i: number = 0; i < this.echoDelayLineL!.length; i++) this.echoDelayLineL![i] = 0.0;\n\t\t\tfor (let i: number = 0; i < this.echoDelayLineR!.length; i++) this.echoDelayLineR![i] = 0.0;\n\t\t}\n\t\tif (this.reverbDelayLineDirty) {\n\t\t\tfor (let i: number = 0; i < this.reverbDelayLine!.length; i++) this.reverbDelayLine![i] = 0.0;\n\t\t}\n\t\t\n\t\tthis.chorusPhase = 0.0;\n\t}\n\t\n\tpublic compute(synth: Synth, instrument: Instrument, samplesPerTick: number, runLength: number, tone: Tone | null): void {\n\t\tthis.computed = true;\n\t\t\n\t\tthis.allocateNecessaryBuffers(synth, instrument, samplesPerTick);\n\t\t\n\t\tconst samplesPerSecond: number = synth.samplesPerSecond;\n\t\tconst tickSampleCountdown: number = synth.tickSampleCountdown;\n\t\tconst tickRemainingStart: number = (tickSampleCountdown            ) / samplesPerTick;\n\t\tconst tickRemainingEnd:   number = (tickSampleCountdown - runLength) / samplesPerTick;\n\t\t\n\t\t//const ticksIntoBar: number = synth.getTicksIntoBar();\n\t\t//const tickTimeStart: number = ticksIntoBar + (1.0 - tickRemainingStart);\n\t\t//const tickTimeEnd:   number = ticksIntoBar + (1.0 - tickRemainingEnd);\n\t\t//const secondsPerTick: number = samplesPerTick / synth.samplesPerSecond;\n\t\t//const currentPart: number = synth.getCurrentPart();\n\t\t//this.envelopeComputer.computeEnvelopes(instrument, currentPart, tickTimeStart, tickTimeEnd, secondsPerTick * (tickTimeEnd - tickTimeStart), tone);\n\t\t//const envelopeStarts: number[] = this.envelopeComputer.envelopeStarts;\n\t\t//const envelopeEnds: number[] = this.envelopeComputer.envelopeEnds;\n\t\t\n\t\tconst usesDistortion: boolean = effectsIncludeDistortion(instrument.effects);\n\t\tconst usesBitcrusher: boolean = effectsIncludeBitcrusher(instrument.effects);\n\t\tconst usesPanning: boolean = effectsIncludePanning(instrument.effects);\n\t\tconst usesChorus: boolean = effectsIncludeChorus(instrument.effects);\n\t\tconst usesEcho: boolean = effectsIncludeEcho(instrument.effects);\n\t\tconst usesReverb: boolean = effectsIncludeReverb(instrument.effects);\n\t\t\n\t\tif (usesDistortion) {\n\t\t\tthis.distortionStart = Math.min(1.0, /*envelopeStarts[InstrumentAutomationIndex.distortion] **/ instrument.distortion / (Config.distortionRange - 1));\n\t\t\tthis.distortionEnd   = Math.min(1.0, /*envelopeEnds[  InstrumentAutomationIndex.distortion] **/ instrument.distortion / (Config.distortionRange - 1));\n\t\t}\n\t\t\n\t\tif (usesBitcrusher) {\n\t\t\tconst freqSettingStart: number = instrument.bitcrusherFreq /** Math.sqrt(envelopeStarts[InstrumentAutomationIndex.bitcrusherFrequency])*/;\n\t\t\tconst freqSettingEnd:   number = instrument.bitcrusherFreq /** Math.sqrt(envelopeEnds[  InstrumentAutomationIndex.bitcrusherFrequency])*/;\n\t\t\tconst quantizationSettingStart: number = instrument.bitcrusherQuantization /** Math.sqrt(envelopeStarts[InstrumentAutomationIndex.bitcrusherQuantization])*/;\n\t\t\tconst quantizationSettingEnd:   number = instrument.bitcrusherQuantization /** Math.sqrt(envelopeEnds[  InstrumentAutomationIndex.bitcrusherQuantization])*/;\n\t\t\t\n\t\t\tconst basePitch: number = Config.keys[synth.song!.key].basePitch; // TODO: What if there's a key change mid-song?\n\t\t\tconst freqStart: number = Instrument.frequencyFromPitch(basePitch + 60) * Math.pow(2.0, (Config.bitcrusherFreqRange - 1 - freqSettingStart) * Config.bitcrusherOctaveStep);\n\t\t\tconst freqEnd:   number = Instrument.frequencyFromPitch(basePitch + 60) * Math.pow(2.0, (Config.bitcrusherFreqRange - 1 - freqSettingEnd)   * Config.bitcrusherOctaveStep);\n\t\t\tconst phaseDeltaStart: number = Math.min(1.0, freqStart / samplesPerSecond);\n\t\t\tconst phaseDeltaEnd:   number = Math.min(1.0, freqEnd   / samplesPerSecond);\n\t\t\tthis.bitcrusherPhaseDelta = phaseDeltaStart;\n\t\t\tthis.bitcrusherPhaseDeltaScale = Math.pow(phaseDeltaEnd / phaseDeltaStart, 1.0 / runLength);\n\t\t\t\n\t\t\tconst scaleStart: number = 2.0 * Config.bitcrusherBaseVolume * Math.pow(2.0, 1.0 - Math.pow(2.0, (Config.bitcrusherQuantizationRange - 1 - quantizationSettingStart) * 0.5));\n\t\t\tconst scaleEnd:   number = 2.0 * Config.bitcrusherBaseVolume * Math.pow(2.0, 1.0 - Math.pow(2.0, (Config.bitcrusherQuantizationRange - 1 - quantizationSettingEnd)   * 0.5));\n\t\t\tthis.bitcrusherScale = scaleStart;\n\t\t\tthis.bitcrusherScaleScale = Math.pow(scaleEnd / scaleStart, 1.0 / runLength);\n\t\t\t\n\t\t\tconst foldLevelStart: number = 2.0 * Config.bitcrusherBaseVolume * Math.pow(1.5, Config.bitcrusherQuantizationRange - 1 - quantizationSettingStart);\n\t\t\tconst foldLevelEnd:   number = 2.0 * Config.bitcrusherBaseVolume * Math.pow(1.5, Config.bitcrusherQuantizationRange - 1 - quantizationSettingEnd);\n\t\t\tthis.bitcrusherFoldLevel = foldLevelStart;\n\t\t\tthis.bitcrusherFoldLevelScale = Math.pow(foldLevelEnd / foldLevelStart, 1.0 / runLength);\n\t\t}\n\t\t\n\t\tlet eqFilterVolume: number = 1.0; //this.envelopeComputer.lowpassCutoffDecayVolumeCompensation;\n\t\tconst eqFilterSettings: FilterSettings = instrument.eqFilter;\n\t\t//const eqAllFreqsEnvelopeStart: number = envelopeStarts[InstrumentAutomationIndex.eqFilterAllFreqs];\n\t\t//const eqAllFreqsEnvelopeEnd:   number = envelopeEnds[  InstrumentAutomationIndex.eqFilterAllFreqs];\n\t\tfor (let i: number = 0; i < eqFilterSettings.controlPointCount; i++) {\n\t\t\t//const eqFreqEnvelopeStart: number = envelopeStarts[InstrumentAutomationIndex.eqFilterFreq0 + i];\n\t\t\t//const eqFreqEnvelopeEnd:   number = envelopeEnds[  InstrumentAutomationIndex.eqFilterFreq0 + i];\n\t\t\t//const eqPeakEnvelopeStart: number = envelopeStarts[InstrumentAutomationIndex.eqFilterGain0 + i];\n\t\t\t//const eqPeakEnvelopeEnd:   number = envelopeEnds[  InstrumentAutomationIndex.eqFilterGain0 + i];\n\t\t\tconst point: FilterControlPoint = eqFilterSettings.controlPoints[i];\n\t\t\tpoint.toCoefficients(Synth.tempFilterStartCoefficients, samplesPerSecond, /*eqAllFreqsEnvelopeStart * eqFreqEnvelopeStart*/ 1.0, /*eqPeakEnvelopeStart*/ 1.0);\n\t\t\tpoint.toCoefficients(Synth.tempFilterEndCoefficients,   samplesPerSecond, /*eqAllFreqsEnvelopeEnd   * eqFreqEnvelopeEnd*/   1.0, /*eqPeakEnvelopeEnd*/   1.0);\n\t\t\tif (this.eqFilters.length <= i) this.eqFilters[i] = new DynamicBiquadFilter();\n\t\t\tthis.eqFilters[i].loadCoefficientsWithGradient(Synth.tempFilterStartCoefficients, Synth.tempFilterEndCoefficients, 1.0 / runLength, point.type == FilterType.lowPass);\n\t\t\teqFilterVolume *= point.getVolumeCompensationMult();\n\t\t}\n\t\tthis.eqFilterCount = eqFilterSettings.controlPointCount;\n\t\teqFilterVolume = Math.min(3.0, eqFilterVolume);\n\t\t\n\t\tconst mainInstrumentVolume: number = Synth.instrumentVolumeToVolumeMult(instrument.volume);\n\t\tthis.mixVolumeStart = mainInstrumentVolume /** envelopeStarts[InstrumentAutomationIndex.mixVolume]*/;\n\t\tconst mixVolumeEnd  = mainInstrumentVolume /** envelopeEnds[  InstrumentAutomationIndex.mixVolume]*/;\n\t\tthis.mixVolumeDelta = (mixVolumeEnd - this.mixVolumeStart) / runLength;\n\t\t\n\t\tlet eqFilterVolumeStart: number = eqFilterVolume;\n\t\tlet eqFilterVolumeEnd: number = eqFilterVolume;\n\t\tlet delayInputMultStart: number = 1.0;\n\t\tlet delayInputMultEnd: number = 1.0;\n\t\t\n\t\tif (usesPanning) {\n\t\t\t//const panEnvelopeStart: number = envelopeStarts[InstrumentAutomationIndex.panning] * 2.0 - 1.0;\n\t\t\t//const panEnvelopeEnd:   number = envelopeEnds[  InstrumentAutomationIndex.panning] * 2.0 - 1.0;\n\t\t\tconst pan: number = (instrument.pan - Config.panCenter) / Config.panCenter;\n\t\t\tconst panStart: number = Math.max(-1.0, Math.min(1.0, pan /** panEnvelopeStart*/));\n\t\t\tconst panEnd:   number = Math.max(-1.0, Math.min(1.0, pan /** panEnvelopeEnd  */));\n\t\t\tconst volumeStartL: number = Math.cos((1 + panStart) * Math.PI * 0.25) * 1.414;\n\t\t\tconst volumeStartR: number = Math.cos((1 - panStart) * Math.PI * 0.25) * 1.414;\n\t\t\tconst volumeEndL:   number = Math.cos((1 + panEnd)   * Math.PI * 0.25) * 1.414;\n\t\t\tconst volumeEndR:   number = Math.cos((1 - panEnd)   * Math.PI * 0.25) * 1.414;\n\t\t\tconst maxDelaySamples: number = samplesPerSecond * Config.panDelaySecondsMax;\n\t\t\tconst delayStart: number = panStart * maxDelaySamples;\n\t\t\tconst delayEnd:   number = panEnd   * maxDelaySamples;\n\t\t\tconst delayStartL: number = Math.max(0.0,  delayStart);\n\t\t\tconst delayStartR: number = Math.max(0.0, -delayStart);\n\t\t\tconst delayEndL:   number = Math.max(0.0,  delayEnd);\n\t\t\tconst delayEndR:   number = Math.max(0.0, -delayEnd);\n\t\t\t\n\t\t\tthis.panningVolumeStartL = volumeStartL;\n\t\t\tthis.panningVolumeStartR = volumeStartR;\n\t\t\tthis.panningVolumeDeltaL = (volumeEndL - volumeStartL) / runLength;\n\t\t\tthis.panningVolumeDeltaR = (volumeEndR - volumeStartR) / runLength;\n\t\t\tthis.panningOffsetStartL = delayStartL;\n\t\t\tthis.panningOffsetStartR = delayStartR;\n\t\t\tthis.panningOffsetDeltaL = (delayEndL - delayStartL) / runLength;\n\t\t\tthis.panningOffsetDeltaR = (delayEndR - delayStartR) / runLength;\n\t\t}\n\t\t\n\t\tif (usesChorus) {\n\t\t\t//const chorusEnvelopeStart: number = envelopeStarts[InstrumentAutomationIndex.chorus];\n\t\t\t//const chorusEnvelopeEnd:   number = envelopeEnds[  InstrumentAutomationIndex.chorus];\n\t\t\tconst chorusStart: number = Math.min(1.0, /*chorusEnvelopeStart **/ instrument.chorus / (Config.chorusRange - 1));\n\t\t\tconst chorusEnd:   number = Math.min(1.0, /*chorusEnvelopeEnd   **/ instrument.chorus / (Config.chorusRange - 1));\n\t\t\tthis.chorusStart = chorusStart * 0.6 + (Math.pow(chorusStart, 6.0)) * 0.4;\n\t\t\tthis.chorusEnd   = chorusEnd   * 0.6 + (Math.pow(chorusEnd,   6.0)) * 0.4;\n\t\t}\n\t\t\n\t\tlet maxEchoMult = 0.0;\n\t\tif (usesEcho) {\n\t\t\t//const echoSustainEnvelopeStart: number = envelopeStarts[InstrumentAutomationIndex.echoSustain];\n\t\t\t//const echoSustainEnvelopeEnd:   number = envelopeEnds[  InstrumentAutomationIndex.echoSustain];\n\t\t\tconst echoMultStart: number = Math.min(1.0, Math.pow(/*echoSustainEnvelopeStart **/ instrument.echoSustain / Config.echoSustainRange, 1.1)) * 0.9;\n\t\t\tconst echoMultEnd:   number = Math.min(1.0, Math.pow(/*echoSustainEnvelopeEnd   **/ instrument.echoSustain / Config.echoSustainRange, 1.1)) * 0.9;\n\t\t\tthis.echoMultStart = echoMultStart;\n\t\t\tthis.echoMultDelta = (echoMultEnd - echoMultStart) / runLength;\n\t\t\tmaxEchoMult = Math.max(echoMultStart, echoMultEnd);\n\t\t\t\n\t\t\t// TODO: After computing a tick's settings once for multiple run lengths (which is\n\t\t\t// good for audio worklet threads), compute the echo delay envelopes at tick (or\n\t\t\t// part) boundaries to interpolate between two delay taps.\n\t\t\t//const echoDelayEnvelopeStart:   number = envelopeStarts[InstrumentAutomationIndex.echoDelay];\n\t\t\t//const echoDelayEnvelopeEnd:     number = envelopeEnds[  InstrumentAutomationIndex.echoDelay];\n\t\t\tconst echoDelayOffset: number = Math.round((instrument.echoDelay + 1) * Config.echoDelayStepTicks * samplesPerTick);\n\t\t\tif (this.echoDelayOffsetLastTickIsComputed) {\n\t\t\t\tthis.echoDelayOffsetStart = this.echoDelayOffsetLastTick;\n\t\t\t} else {\n\t\t\t\tthis.echoDelayOffsetStart = echoDelayOffset;\n\t\t\t}\n\t\t\tif (synth.isAtEndOfTick) {\n\t\t\t\tthis.echoDelayOffsetLastTick = echoDelayOffset;\n\t\t\t\tthis.echoDelayOffsetLastTickIsComputed = true;\n\t\t\t}\n\t\t\tthis.echoDelayOffsetEnd = echoDelayOffset;\n\t\t\t\n\t\t\tthis.echoDelayOffsetRatio = 1.0 - tickRemainingStart;\n\t\t\tthis.echoDelayOffsetRatioDelta = (tickRemainingStart - tickRemainingEnd) / runLength;\n\t\t\t\n\t\t\tconst shelfRadians: number = 2.0 * Math.PI * Config.echoShelfHz / synth.samplesPerSecond;\n\t\t\tSynth.tempFilterStartCoefficients.highShelf1stOrder(shelfRadians, Config.echoShelfGain);\n\t\t\tthis.echoShelfA1 = Synth.tempFilterStartCoefficients.a[1];\n\t\t\tthis.echoShelfB0 = Synth.tempFilterStartCoefficients.b[0];\n\t\t\tthis.echoShelfB1 = Synth.tempFilterStartCoefficients.b[1];\n\t\t}\n\t\t\n\t\tlet maxReverbMult = 0.0;\n\t\tif (usesReverb) {\n\t\t\t//const reverbEnvelopeStart: number = envelopeStarts[InstrumentAutomationIndex.reverb];\n\t\t\t//const reverbEnvelopeEnd:   number = envelopeEnds[  InstrumentAutomationIndex.reverb];\n\t\t\tconst reverbStart: number = Math.min(1.0, Math.pow(/*reverbEnvelopeStart **/ instrument.reverb / Config.reverbRange, 0.667)) * 0.425;\n\t\t\tconst reverbEnd:   number = Math.min(1.0, Math.pow(/*reverbEnvelopeEnd   **/ instrument.reverb / Config.reverbRange, 0.667)) * 0.425;\n\t\t\tthis.reverbMultStart = reverbStart;\n\t\t\tthis.reverbMultDelta = (reverbEnd - reverbStart) / runLength;\n\t\t\tmaxReverbMult = Math.max(reverbStart, reverbEnd);\n\t\t\t\n\t\t\tconst shelfRadians: number = 2.0 * Math.PI * Config.reverbShelfHz / synth.samplesPerSecond;\n\t\t\tSynth.tempFilterStartCoefficients.highShelf1stOrder(shelfRadians, Config.reverbShelfGain);\n\t\t\tthis.reverbShelfA1 = Synth.tempFilterStartCoefficients.a[1];\n\t\t\tthis.reverbShelfB0 = Synth.tempFilterStartCoefficients.b[0];\n\t\t\tthis.reverbShelfB1 = Synth.tempFilterStartCoefficients.b[1];\n\t\t}\n\t\t\n\t\tif (this.tonesAddedInThisTick) {\n\t\t\tthis.attentuationProgress = 0.0;\n\t\t\tthis.flushedSamples = 0;\n\t\t\tthis.flushingDelayLines = false;\n\t\t} else if (!this.flushingDelayLines) {\n\t\t\t// If this instrument isn't playing tones anymore, the volume can fade out by the\n\t\t\t// end of the first tick. It's possible for filters and the panning delay line to\n\t\t\t// continue past the end of the tone but they should have mostly dissipated by the\n\t\t\t// end of the tick anyway.\n\t\t\tif (this.attentuationProgress == 0.0) {\n\t\t\t\teqFilterVolumeStart *= tickRemainingStart;\n\t\t\t\teqFilterVolumeEnd *= tickRemainingEnd;\n\t\t\t} else {\n\t\t\t\teqFilterVolumeStart = 0.0;\n\t\t\t\teqFilterVolumeEnd = 0.0;\n\t\t\t}\n\t\t\t\n\t\t\tconst attenuationThreshold: number = 1.0 / 256.0; // when the delay line signal has attenuated this much, it should be inaudible and should be flushed to zero.\n\t\t\tconst halfLifeMult: number = -Math.log2(attenuationThreshold);\n\t\t\tlet delayDuration: number = 0.0;\n\t\t\t\n\t\t\tif (usesChorus) {\n\t\t\t\tdelayDuration += Config.chorusMaxDelay;\n\t\t\t}\n\t\t\t\n\t\t\tif (usesEcho) {\n\t\t\t\tconst averageDelaySeconds: number = (this.echoDelayOffsetStart + this.echoDelayOffsetEnd) * 0.5 / samplesPerSecond;\n\t\t\t\tconst attenuationPerSecond: number = Math.pow(maxEchoMult, 1.0 / averageDelaySeconds);\n\t\t\t\tconst halfLife: number = -1.0 / Math.log2(attenuationPerSecond);\n\t\t\t\tconst echoDuration: number = halfLife * halfLifeMult;\n\t\t\t\tdelayDuration += echoDuration;\n\t\t\t}\n\t\t\t\n\t\t\tif (usesReverb) {\n\t\t\t\tconst averageMult: number = maxReverbMult * 2.0;\n\t\t\t\tconst averageDelaySeconds: number = (Config.reverbDelayBufferSize / 4.0) / samplesPerSecond;\n\t\t\t\tconst attenuationPerSecond: number = Math.pow(averageMult, 1.0 / averageDelaySeconds);\n\t\t\t\tconst halfLife: number = -1.0 / Math.log2(attenuationPerSecond);\n\t\t\t\tconst reverbDuration: number = halfLife * halfLifeMult;\n\t\t\t\tdelayDuration += reverbDuration;\n\t\t\t}\n\t\t\t\n\t\t\tconst secondsInTick: number = samplesPerTick / samplesPerSecond;\n\t\t\tconst progressInTick: number = secondsInTick / delayDuration;\n\t\t\tconst progressAtEndOfTick: number = this.attentuationProgress + progressInTick;\n\t\t\tif (progressAtEndOfTick >= 1.0) {\n\t\t\t\tdelayInputMultStart *= tickRemainingStart;\n\t\t\t\tdelayInputMultEnd *= tickRemainingEnd;\n\t\t\t}\n\t\t\tif (synth.isAtEndOfTick) {\n\t\t\t\tthis.attentuationProgress = progressAtEndOfTick;\n\t\t\t\tif (this.attentuationProgress >= 1.0) {\n\t\t\t\t\tthis.flushingDelayLines = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Flushing delay lines to zero since the signal has mostly dissipated.\n\t\t\teqFilterVolumeStart = 0.0;\n\t\t\teqFilterVolumeEnd = 0.0;\n\t\t\tdelayInputMultStart = 0.0;\n\t\t\tdelayInputMultEnd = 0.0;\n\t\t\t\n\t\t\tlet totalDelaySamples: number = 0;\n\t\t\tif (usesChorus) totalDelaySamples += synth.chorusDelayBufferSize;\n\t\t\tif (usesEcho) totalDelaySamples += this.echoDelayLineL!.length;\n\t\t\tif (usesReverb) totalDelaySamples += Config.reverbDelayBufferSize;\n\t\t\t\n\t\t\tthis.flushedSamples += runLength;\n\t\t\tif (this.flushedSamples >= totalDelaySamples) {\n\t\t\t\tthis.deactivateAfterThisTick = true;\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.eqFilterVolumeStart = eqFilterVolumeStart;\n\t\tthis.eqFilterVolumeDelta = (eqFilterVolumeEnd - eqFilterVolumeStart) / runLength;\n\t\tthis.delayInputMultStart = delayInputMultStart;\n\t\tthis.delayInputMultDelta = (delayInputMultEnd - delayInputMultStart) / runLength;\n\t}\n}\n\nclass ChannelState {\n\tpublic readonly instruments: InstrumentState[] = [];\n\tpublic muted: boolean = false;\n\tpublic singleSeamlessInstrument: number | null = null; // Seamless tones from a pattern with a single instrument can be transferred to a different single seamless instrument in the next pattern.\n}\n\nexport class Synth {\n\n\tprivate syncSongState(): void {\n\t\tconst channelCount: number = this.song!.getChannelCount();\n\t\tfor (let i: number = this.channels.length; i < channelCount; i++) {\n\t\t\tthis.channels[i] = new ChannelState();\n\t\t}\n\t\tthis.channels.length = channelCount;\n\t\tfor (let i: number = 0; i < channelCount; i++) {\n\t\t\tconst channel: Channel = this.song!.channels[i];\n\t\t\tconst channelState: ChannelState = this.channels[i];\n\t\t\tfor (let j: number = channelState.instruments.length; j < channel.instruments.length; j++) {\n\t\t\t\tchannelState.instruments[j] = new InstrumentState();\n\t\t\t}\n\t\t\tchannelState.instruments.length = channel.instruments.length;\n\t\t\t\n\t\t\tif (channelState.muted != channel.muted) {\n\t\t\t\tchannelState.muted = channel.muted;\n\t\t\t\tif (channelState.muted) {\n\t\t\t\t\tfor (const instrumentState of channelState.instruments) {\n\t\t\t\t\t\tinstrumentState.resetAllEffects();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate warmUpSynthesizer(song: Song | null): void {\n\t\tif (song != null) {\n\t\t\tthis.syncSongState();\n\t\t\tconst samplesPerTick: number = this.getSamplesPerTick();\n\t\t\tfor (let j: number = 0; j < song.getChannelCount(); j++) {\n\t\t\t\tfor (let i: number = 0; i < song.channels[j].instruments.length; i++) {\n\t\t\t\t\tconst instrument: Instrument = song.channels[j].instruments[i];\n\t\t\t\t\tconst instrumentState: InstrumentState = this.channels[j].instruments[i];\n\t\t\t\t\tSynth.getInstrumentSynthFunction(instrument);\n\t\t\t\t\tinstrument.warmUp(this.samplesPerSecond);\n\t\t\t\t\tinstrumentState.allocateNecessaryBuffers(this, instrument, samplesPerTick);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate static operatorAmplitudeCurve(amplitude: number): number {\n\t\treturn (Math.pow(16.0, amplitude / 15.0) - 1.0) / 15.0;\n\t}\n\t\n\tpublic samplesPerSecond: number = 44100;\n\tpublic panningDelayBufferSize: number;\n\tpublic panningDelayBufferMask: number;\n\tpublic chorusDelayBufferSize: number;\n\tpublic chorusDelayBufferMask: number;\n\t// TODO: reverb\n\t\n\tpublic song: Song | null = null;\n\tpublic liveInputDuration: number = 0;\n\tpublic liveInputStarted: boolean = false;\n\tpublic liveInputPitches: number[] = [];\n\tpublic liveInputChannel: number = 0;\n\tpublic liveInputInstruments: number[] = [];\n\tpublic loopRepeatCount: number = -1;\n\tpublic volume: number = 1.0;\n\t\n\tprivate playheadInternal: number = 0.0;\n\tprivate bar: number = 0;\n\tprivate prevBar: number | null = null;\n\tprivate nextBar: number | null = null;\n\tprivate beat: number = 0;\n\tprivate part: number = 0;\n\tprivate tick: number = 0;\n\tpublic isAtStartOfTick: boolean = true;\n\tpublic isAtEndOfTick: boolean = true;\n\tpublic tickSampleCountdown: number = 0;\n\tprivate isPlayingSong: boolean = false;\n\tprivate liveInputEndTime: number = 0.0;\n\tprivate browserAutomaticallyClearsAudioBuffer: boolean = true; // Assume true until proven otherwise. Older Chrome does not clear the buffer so it needs to be cleared manually.\n\t\n\tpublic static readonly tempFilterStartCoefficients: FilterCoefficients = new FilterCoefficients();\n\tpublic static readonly tempFilterEndCoefficients: FilterCoefficients = new FilterCoefficients();\n\tprivate tempDrumSetControlPoint: FilterControlPoint = new FilterControlPoint();\n\tpublic tempFrequencyResponse: FrequencyResponse = new FrequencyResponse();\n\t\n\tprivate static readonly fmSynthFunctionCache: Dictionary<Function> = {};\n\tprivate static readonly effectsFunctionCache: Function[] = Array(1 << 7).fill(undefined); // keep in sync with the number of post-process effects.\n\tprivate static readonly pickedStringFunctionCache: Function[] = Array(3).fill(undefined); // keep in sync with the number of unison voices.\n\t\n\tprivate readonly channels: ChannelState[] = [];\n\tprivate readonly tonePool: Deque<Tone> = new Deque<Tone>();\n\tprivate readonly tempMatchedPitchTones: Array<Tone | null> = Array(Config.maxChordSize).fill(null);\n\t\n\tprivate limit: number = 0.0;\n\t\n\tprivate tempMonoInstrumentSampleBuffer: Float32Array | null = null;\n\t\n\tprivate audioCtx: any | null = null;\n\tprivate scriptNode: any | null = null;\n\t\n\tpublic get playing(): boolean {\n\t\treturn this.isPlayingSong;\n\t}\n\t\n\tpublic get playhead(): number {\n\t\treturn this.playheadInternal;\n\t}\n\t\n\tpublic set playhead(value: number) {\n\t\tif (this.song != null) {\n\t\t\tthis.playheadInternal = Math.max(0, Math.min(this.song.barCount, value));\n\t\t\tlet remainder: number = this.playheadInternal;\n\t\t\tthis.bar = Math.floor(remainder);\n\t\t\tremainder = this.song.beatsPerBar * (remainder - this.bar);\n\t\t\tthis.beat = Math.floor(remainder);\n\t\t\tremainder = Config.partsPerBeat * (remainder - this.beat);\n\t\t\tthis.part = Math.floor(remainder);\n\t\t\tremainder = Config.ticksPerPart * (remainder - this.part);\n\t\t\tthis.tick = Math.floor(remainder);\n\t\t\tconst samplesPerTick: number = this.getSamplesPerTick();\n\t\t\tremainder = samplesPerTick * (remainder - this.tick);\n\t\t\tthis.tickSampleCountdown = samplesPerTick - remainder;\n\t\t\tthis.prevBar = null;\n\t\t}\n\t}\n\t\n\tpublic getSamplesPerBar(): number {\n\t\tif (this.song == null) throw new Error();\n\t\treturn this.getSamplesPerTick() * Config.ticksPerPart * Config.partsPerBeat * this.song.beatsPerBar;\n\t}\n\t\n\tpublic getTicksIntoBar(): number {\n\t\treturn (this.beat * Config.partsPerBeat + this.part) * Config.ticksPerPart + this.tick;\n\t}\n\tpublic getCurrentPart(): number {\n\t\treturn (this.beat * Config.partsPerBeat + this.part);\n\t}\n\t\n\tpublic getTotalBars(enableIntro: boolean, enableOutro: boolean): number {\n\t\tif (this.song == null) throw new Error();\n\t\tlet bars: number = this.song.loopLength * (this.loopRepeatCount + 1);\n\t\tif (enableIntro) bars += this.song.loopStart;\n\t\tif (enableOutro) bars += this.song.barCount - (this.song.loopStart + this.song.loopLength);\n\t\treturn bars;\n\t}\n\t\n\tconstructor(song: Song | string | null = null) {\n\t\tthis.computeDelayBufferSizes();\n\t\tif (song != null) this.setSong(song);\n\t}\n\t\n\tpublic setSong(song: Song | string): void {\n\t\tif (typeof(song) == \"string\") {\n\t\t\tthis.song = new Song(song);\n\t\t} else if (song instanceof Song) {\n\t\t\tthis.song = song;\n\t\t}\n\t\tthis.prevBar = null;\n\t}\n\t\n\tprivate computeDelayBufferSizes(): void {\n\t\tthis.panningDelayBufferSize = Synth.fittingPowerOfTwo(this.samplesPerSecond * Config.panDelaySecondsMax);\n\t\tthis.panningDelayBufferMask = this.panningDelayBufferSize - 1;\n\t\tthis.chorusDelayBufferSize = Synth.fittingPowerOfTwo(this.samplesPerSecond * Config.chorusMaxDelay);\n\t\tthis.chorusDelayBufferMask = this.chorusDelayBufferSize - 1;\n\t}\n\t\n\tprivate activateAudio(): void {\n\t\tif (this.audioCtx == null || this.scriptNode == null) {\n\t\t\tthis.audioCtx = this.audioCtx || new (window.AudioContext || window.webkitAudioContext)();\n\t\t\tthis.samplesPerSecond = this.audioCtx.sampleRate;\n\t\t\tthis.scriptNode = this.audioCtx.createScriptProcessor ? this.audioCtx.createScriptProcessor(2048, 0, 2) : this.audioCtx.createJavaScriptNode(2048, 0, 2); // 2048, 0 input channels, 2 output channels\n\t\t\tthis.scriptNode.onaudioprocess = this.audioProcessCallback;\n\t\t\tthis.scriptNode.channelCountMode = 'explicit';\n\t\t\tthis.scriptNode.channelInterpretation = 'speakers';\n\t\t\tthis.scriptNode.connect(this.audioCtx.destination);\n\t\t\t\n\t\t\tthis.computeDelayBufferSizes();\n\t\t}\n\t\tthis.audioCtx.resume();\n\t}\n\t\n\tprivate deactivateAudio(): void {\n\t\tif (this.audioCtx != null && this.scriptNode != null) {\n\t\t\tthis.scriptNode.disconnect(this.audioCtx.destination);\n\t\t\tthis.scriptNode = null;\n\t\t\tif (this.audioCtx.close) this.audioCtx.close(); // firefox is missing this function?\n\t\t\tthis.audioCtx = null;\n\t\t}\n\t}\n\t\n\tpublic maintainLiveInput(): void {\n\t\tthis.activateAudio();\n\t\tthis.liveInputEndTime = performance.now() + 10000.0;\n\t}\n\t\n\tpublic play(): void {\n\t\tif (this.isPlayingSong) return;\n\t\tthis.isPlayingSong = true;\n\t\tthis.activateAudio();\n\t\tthis.warmUpSynthesizer(this.song);\n\t}\n\t\n\tpublic pause(): void {\n\t\tif (!this.isPlayingSong) return;\n\t\tthis.isPlayingSong = false;\n\t}\n\t\n\tpublic snapToStart(): void {\n\t\tthis.bar = 0;\n\t\tthis.snapToBar();\n\t}\n\t\n\tpublic goToBar(bar: number): void {\n\t\tthis.bar = bar;\n\t\tthis.playheadInternal = this.bar;\n\t\tthis.prevBar = null;\n\t}\n\t\n\tpublic snapToBar(): void {\n\t\tthis.playheadInternal = this.bar;\n\t\tthis.beat = 0;\n\t\tthis.part = 0;\n\t\tthis.tick = 0;\n\t\tthis.tickSampleCountdown = 0;\n\t\tthis.isAtStartOfTick = true;\n\t\tthis.prevBar = null;\n\t}\n\t\n\tpublic resetEffects(): void {\n\t\tthis.limit = 0.0;\n\t\tthis.freeAllTones();\n\t\tif (this.song != null) {\n\t\t\tfor (const channelState of this.channels) {\n\t\t\t\tfor (const instrumentState of channelState.instruments) {\n\t\t\t\t\tinstrumentState.resetAllEffects();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic jumpIntoLoop(): void {\n\t\tif (!this.song) return;\n\t\tif (this.bar < this.song.loopStart || this.bar >= this.song.loopStart + this.song.loopLength) {\n\t\t\tconst oldBar: number = this.bar;\n\t\t\tthis.bar = this.song.loopStart;\n\t\t\tthis.playheadInternal += this.bar - oldBar;\n\t\t\tthis.prevBar = null;\n\t\t}\n\t}\n\t\n\tpublic goToNextBar(): void {\n\t\tif (!this.song) return;\n\t\tthis.prevBar = this.bar;\n\t\tconst oldBar: number = this.bar;\n\t\tthis.bar++;\n\t\tif (this.bar >= this.song.barCount) {\n\t\t\tthis.bar = 0;\n\t\t}\n\t\tthis.playheadInternal += this.bar - oldBar;\n\t}\n\t\n\tpublic goToPrevBar(): void {\n\t\tif (!this.song) return;\n\t\tthis.prevBar = null;\n\t\tconst oldBar: number = this.bar;\n\t\tthis.bar--;\n\t\tif (this.bar < 0 || this.bar >= this.song.barCount) {\n\t\t\tthis.bar = this.song.barCount - 1;\n\t\t}\n\t\tthis.playheadInternal += this.bar - oldBar;\n\t}\n\t\n\tprivate audioProcessCallback = (audioProcessingEvent: any): void => {\n\t\tconst outputBuffer = audioProcessingEvent.outputBuffer;\n\t\tconst outputDataL: Float32Array = outputBuffer.getChannelData(0);\n\t\tconst outputDataR: Float32Array = outputBuffer.getChannelData(1);\n\t\t\n\t\tif (this.browserAutomaticallyClearsAudioBuffer && (outputDataL[0] != 0.0 || outputDataR[0] != 0.0 || outputDataL[outputBuffer.length-1] != 0.0 || outputDataR[outputBuffer.length-1] != 0.0)) {\n\t\t\t// If the buffer is ever initially nonzero, then this must be an older browser that doesn't automatically clear the audio buffer.\n\t\t\tthis.browserAutomaticallyClearsAudioBuffer = false;\n\t\t}\n\t\tif (!this.browserAutomaticallyClearsAudioBuffer) {\n\t\t\t// If this browser does not clear the buffer automatically, do so manually before continuing.\n\t\t\tconst length: number = outputBuffer.length;\n\t\t\tfor (let i: number = 0; i < length; i++) {\n\t\t\t\toutputDataL[i] = 0.0;\n\t\t\t\toutputDataR[i] = 0.0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tconst isPlayingLiveTones = performance.now() < this.liveInputEndTime;\n\t\tif (!isPlayingLiveTones && !this.isPlayingSong) {\n\t\t\tthis.deactivateAudio();\n\t\t} else {\n\t\t\tthis.synthesize(outputDataL, outputDataR, outputBuffer.length, this.isPlayingSong);\n\t\t}\n\t}\n\t\n\tpublic synthesize(outputDataL: Float32Array, outputDataR: Float32Array, outputBufferLength: number, playSong: boolean = true): void {\n\t\tif (this.song == null) {\n\t\t\tfor (let i: number = 0; i < outputBufferLength; i++) {\n\t\t\t\toutputDataL[i] = 0.0;\n\t\t\t\toutputDataR[i] = 0.0;\n\t\t\t}\n\t\t\tthis.deactivateAudio();\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tconst song: Song = this.song;\n\t\tconst samplesPerTick: number = this.getSamplesPerTick();\n\t\tlet ended: boolean = false;\n\t\t\n\t\t// Check the bounds of the playhead:\n\t\twhile (this.tickSampleCountdown <= 0) this.tickSampleCountdown += samplesPerTick;\n\t\tif (this.tickSampleCountdown > samplesPerTick) this.tickSampleCountdown = samplesPerTick;\n\t\tif (playSong) {\n\t\t\tif (this.beat >= song.beatsPerBar) {\n\t\t\t\tthis.bar++;\n\t\t\t\tthis.beat = 0;\n\t\t\t\tthis.part = 0;\n\t\t\t\tthis.tick = 0;\n\t\t\t\tthis.tickSampleCountdown = samplesPerTick;\n\t\t\t\n\t\t\t\tif (this.loopRepeatCount != 0 && this.bar == song.loopStart + song.loopLength) {\n\t\t\t\t\tthis.bar = song.loopStart;\n\t\t\t\t\tif (this.loopRepeatCount > 0) this.loopRepeatCount--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.bar >= song.barCount) {\n\t\t\t\tthis.bar = 0;\n\t\t\t\tif (this.loopRepeatCount != -1) {\n\t\t\t\t\tended = true;\n\t\t\t\t\tthis.pause();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t//const synthStartTime: number = performance.now();\n\t\t\n\t\tthis.syncSongState();\n\t\t\n\t\tif (this.tempMonoInstrumentSampleBuffer == null || this.tempMonoInstrumentSampleBuffer.length < outputBufferLength) {\n\t\t\tthis.tempMonoInstrumentSampleBuffer = new Float32Array(outputBufferLength);\n\t\t}\n\t\t\n\t\t// Post processing parameters:\n\t\tconst volume: number = +this.volume;\n\t\tconst limitDecay: number = 1.0 - Math.pow(0.5, 4.0 / this.samplesPerSecond);\n\t\tconst limitRise: number = 1.0 - Math.pow(0.5, 4000.0 / this.samplesPerSecond);\n\t\tlet limit: number = +this.limit;\n\t\t\n\t\tlet bufferIndex: number = 0;\n\t\twhile (bufferIndex < outputBufferLength && !ended) {\n\t\t\t\n\t\t\tthis.nextBar = this.bar + 1;\n\t\t\tif (this.loopRepeatCount != 0 && this.nextBar == song.loopStart + song.loopLength) {\n\t\t\t\tthis.nextBar = song.loopStart;\n\t\t\t}\n\t\t\tif (this.nextBar >= song.barCount) this.nextBar = null;\n\t\t\t\n\t\t\tconst samplesLeftInBuffer: number = outputBufferLength - bufferIndex;\n\t\t\tconst samplesLeftInTick: number = Math.ceil(this.tickSampleCountdown);\n\t\t\tconst runLength: number = Math.min(samplesLeftInTick, samplesLeftInBuffer);\n\t\t\tthis.isAtEndOfTick = (runLength >= this.tickSampleCountdown);\n\t\t\tfor (let channelIndex: number = 0; channelIndex < song.getChannelCount(); channelIndex++) {\n\t\t\t\tconst channel: Channel = song.channels[channelIndex];\n\t\t\t\tconst channelState: ChannelState = this.channels[channelIndex];\n\t\t\t\t\n\t\t\t\tthis.determineCurrentActiveTones(song, channelIndex, playSong);\n\t\t\t\tthis.determineLiveInputTones(song, channelIndex);\n\t\t\t\t\n\t\t\t\tfor (let instrumentIndex: number = 0; instrumentIndex < channel.instruments.length; instrumentIndex++) {\n\t\t\t\t\tconst instrument: Instrument = channel.instruments[instrumentIndex];\n\t\t\t\t\tconst instrumentState: InstrumentState = channelState.instruments[instrumentIndex];\n\t\t\t\t\tlet tonesPlayedInThisInstrument: number = 0;\n\t\t\t\t\t\n\t\t\t\t\tfor (let i: number = 0; i < instrumentState.activeTones.count(); i++) {\n\t\t\t\t\t\tconst tone: Tone = instrumentState.activeTones.get(i);\n\t\t\t\t\t\tthis.playTone(song, channelIndex, samplesPerTick, bufferIndex, runLength, tone, false, false);\n\t\t\t\t\t\ttonesPlayedInThisInstrument++;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tfor (let i: number = 0; i < instrumentState.liveInputTones.count(); i++) {\n\t\t\t\t\t\tconst tone: Tone = instrumentState.liveInputTones.get(i);\n\t\t\t\t\t\tthis.playTone(song, channelIndex, samplesPerTick, bufferIndex, runLength, tone, false, false);\n\t\t\t\t\t\ttonesPlayedInThisInstrument++;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tfor (let i: number = 0; i < instrumentState.releasedTones.count(); i++) {\n\t\t\t\t\t\tconst tone: Tone = instrumentState.releasedTones.get(i);\n\t\t\t\t\t\tif (tone.ticksSinceReleased >= Math.abs(instrument.getFadeOutTicks())) {\n\t\t\t\t\t\t\tthis.freeReleasedTone(instrumentState, i);\n\t\t\t\t\t\t\ti--;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst shouldFadeOutFast: boolean = (tonesPlayedInThisInstrument >= Config.maximumTonesPerChannel);\n\t\t\t\t\t\tthis.playTone(song, channelIndex, samplesPerTick, bufferIndex, runLength, tone, true, shouldFadeOutFast);\n\t\t\t\t\t\ttonesPlayedInThisInstrument++;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (instrumentState.awake) {\n\t\t\t\t\t\tif (!instrumentState.computed) {\n\t\t\t\t\t\t\tinstrumentState.compute(this, instrument, samplesPerTick, runLength, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tSynth.effectsSynth(this, outputDataL, outputDataR, bufferIndex, runLength, instrument, instrumentState);\n\t\t\t\t\t\t\n\t\t\t\t\t\tinstrumentState.computed = false;\n\t\t\t\t\t\t//instrumentState.envelopeComputer.clearEnvelopes(instrument);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Post processing:\n\t\t\tconst runEnd: number = bufferIndex + runLength;\n\t\t\tfor (let i: number = bufferIndex; i < runEnd; i++) {\n\t\t\t\t// A compressor/limiter.\n\t\t\t\tconst sampleL = outputDataL[i];\n\t\t\t\tconst sampleR = outputDataR[i];\n\t\t\t\tconst abs: number = Math.max(Math.abs(sampleL), Math.abs(sampleR));\n\t\t\t\tlimit += (abs - limit) * (limit < abs ? limitRise : limitDecay * (1.0 + limit));\n\t\t\t\tconst limitedVolume = volume / (limit >= 1 ? limit * 1.05 : limit * 0.8 + 0.25);\n\t\t\t\toutputDataL[i] = sampleL * limitedVolume;\n\t\t\t\toutputDataR[i] = sampleR * limitedVolume;\n\t\t\t}\n\t\t\t\n\t\t\tbufferIndex += runLength;\n\t\t\t\n\t\t\tthis.isAtStartOfTick = false;\n\t\t\tthis.tickSampleCountdown -= runLength;\n\t\t\tif (this.tickSampleCountdown <= 0) {\n\t\t\t\tthis.isAtStartOfTick = true;\n\t\t\t\t\n\t\t\t\t// Track how long tones have been released, and free ones that are marked as ending.\n\t\t\t\t// Also reset awake InstrumentStates that didn't have any Tones during this tick.\n\t\t\t\tfor (const channelState of this.channels) {\n\t\t\t\t\tfor (const instrumentState of channelState.instruments) {\n\t\t\t\t\t\tfor (let i: number = 0; i < instrumentState.releasedTones.count(); i++) {\n\t\t\t\t\t\t\tconst tone: Tone = instrumentState.releasedTones.get(i);\n\t\t\t\t\t\t\tif (tone.isOnLastTick) {\n\t\t\t\t\t\t\t\tthis.freeReleasedTone(instrumentState, i);\n\t\t\t\t\t\t\t\ti--;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttone.ticksSinceReleased++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (instrumentState.deactivateAfterThisTick) {\n\t\t\t\t\t\t\tinstrumentState.deactivate();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinstrumentState.tonesAddedInThisTick = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.tick++;\n\t\t\t\tthis.tickSampleCountdown += samplesPerTick;\n\t\t\t\tif (this.tick == Config.ticksPerPart) {\n\t\t\t\t\tthis.tick = 0;\n\t\t\t\t\tthis.part++;\n\t\t\t\t\tthis.liveInputDuration--;\n\t\t\t\t\t\n\t\t\t\t\tif (this.part == Config.partsPerBeat) {\n\t\t\t\t\t\tthis.part = 0;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (playSong) {\n\t\t\t\t\t\t\tthis.beat++;\n\t\t\t\t\t\t\tif (this.beat == song.beatsPerBar) {\n\t\t\t\t\t\t\t\t// bar changed, reset for next bar:\n\t\t\t\t\t\t\t\tthis.beat = 0;\n\t\t\t\t\t\t\t\tthis.prevBar = this.bar;\n\t\t\t\t\t\t\t\tthis.bar++;\n\t\t\t\t\t\t\t\tif (this.loopRepeatCount != 0 && this.bar == song.loopStart + song.loopLength) {\n\t\t\t\t\t\t\t\t\tthis.bar = song.loopStart;\n\t\t\t\t\t\t\t\t\tif (this.loopRepeatCount > 0) this.loopRepeatCount--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (this.bar >= song.barCount) {\n\t\t\t\t\t\t\t\t\tthis.bar = 0;\n\t\t\t\t\t\t\t\t\tif (this.loopRepeatCount != -1) {\n\t\t\t\t\t\t\t\t\t\tended = true;\n\t\t\t\t\t\t\t\t\t\tthis.resetEffects();\n\t\t\t\t\t\t\t\t\t\tthis.pause();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Avoid persistent denormal or NaN values.\n\t\tif (!Number.isFinite(limit) || Math.abs(limit) < epsilon) limit = 0.0;\n\t\tthis.limit = limit;\n\t\t\n\t\tif (playSong) {\n\t\t\tthis.playheadInternal = (((this.tick + 1.0 - this.tickSampleCountdown / samplesPerTick) / 2.0 + this.part) / Config.partsPerBeat + this.beat) / song.beatsPerBar + this.bar;\n\t\t}\n\t\t\n\t\t/*\n\t\tconst synthDuration: number = performance.now() - synthStartTime;\n\t\t// Performance measurements:\n\t\tsamplesAccumulated += outputBufferLength;\n\t\tsamplePerformance += synthDuration;\n\t\t\n\t\tif (samplesAccumulated >= 44100 * 4) {\n\t\t\tconst secondsGenerated = samplesAccumulated / 44100;\n\t\t\tconst secondsRequired = samplePerformance / 1000;\n\t\t\tconst ratio = secondsRequired / secondsGenerated;\n\t\t\tconsole.log(ratio);\n\t\t\tsamplePerformance = 0;\n\t\t\tsamplesAccumulated = 0;\n\t\t}\n\t\t*/\n\t}\n\t\n\tprivate freeTone(tone: Tone): void {\n\t\tthis.tonePool.pushBack(tone);\n\t}\n\t\n\tprivate newTone(): Tone {\n\t\tif (this.tonePool.count() > 0) {\n\t\t\tconst tone: Tone = this.tonePool.popBack();\n\t\t\ttone.freshlyAllocated = true;\n\t\t\treturn tone;\n\t\t}\n\t\treturn new Tone();\n\t}\n\t\n\tprivate releaseTone(instrumentState: InstrumentState, tone: Tone): void {\n\t\tinstrumentState.releasedTones.pushFront(tone);\n\t\ttone.atNoteStart = false;\n\t\ttone.passedEndOfNote = true;\n\t}\n\t\n\tprivate freeReleasedTone(instrumentState: InstrumentState, toneIndex: number): void {\n\t\tthis.freeTone(instrumentState.releasedTones.get(toneIndex));\n\t\tinstrumentState.releasedTones.remove(toneIndex);\n\t}\n\t\n\tpublic freeAllTones(): void {\n\t\tfor (const channelState of this.channels) {\n\t\t\tfor (const instrumentState of channelState.instruments) {\n\t\t\t\twhile (instrumentState.activeTones.count()    > 0) this.freeTone(instrumentState.activeTones.popBack());\n\t\t\t\twhile (instrumentState.releasedTones.count()  > 0) this.freeTone(instrumentState.releasedTones.popBack());\n\t\t\t\twhile (instrumentState.liveInputTones.count() > 0) this.freeTone(instrumentState.liveInputTones.popBack());\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate determineLiveInputTones(song: Song, channelIndex: number): void {\n\t\tconst channel: Channel = song.channels[channelIndex];\n\t\tconst channelState: ChannelState = this.channels[channelIndex];\n\t\tconst pitches: number[] = this.liveInputPitches;\n\t\t\n\t\tfor (let instrumentIndex: number = 0; instrumentIndex < channel.instruments.length; instrumentIndex++) {\n\t\t\tconst instrumentState: InstrumentState = channelState.instruments[instrumentIndex];\n\t\t\tconst toneList: Deque<Tone> = instrumentState.liveInputTones;\n\t\t\tlet toneCount: number = 0;\n\t\t\tif (this.liveInputDuration > 0 && channelIndex == this.liveInputChannel && pitches.length > 0 && this.liveInputInstruments.indexOf(instrumentIndex) != -1) {\n\t\t\t\tconst instrument: Instrument = channel.instruments[instrumentIndex];\n\t\t\t\t\n\t\t\t\tif (instrument.getChord().singleTone) {\n\t\t\t\t\tlet tone: Tone;\n\t\t\t\t\tif (toneList.count() <= toneCount) {\n\t\t\t\t\t\ttone = this.newTone();\n\t\t\t\t\t\ttoneList.pushBack(tone);\n\t\t\t\t\t} else if (!instrument.getTransition().isSeamless && this.liveInputStarted) {\n\t\t\t\t\t\tthis.releaseTone(instrumentState, toneList.get(toneCount));\n\t\t\t\t\t\ttone = this.newTone();\n\t\t\t\t\t\ttoneList.set(toneCount, tone);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttone = toneList.get(toneCount);\n\t\t\t\t\t}\n\t\t\t\t\ttoneCount++;\n\t\t\t\t\t\n\t\t\t\t\tfor (let i: number = 0; i < pitches.length; i++) {\n\t\t\t\t\t\ttone.pitches[i] = pitches[i];\n\t\t\t\t\t}\n\t\t\t\t\ttone.pitchCount = pitches.length;\n\t\t\t\t\ttone.chordSize = 1;\n\t\t\t\t\ttone.instrumentIndex = instrumentIndex;\n\t\t\t\t\ttone.note = tone.prevNote = tone.nextNote = null;\n\t\t\t\t\ttone.atNoteStart = this.liveInputStarted;\n\t\t\t\t\ttone.forceContinueAtStart = false;\n\t\t\t\t\ttone.forceContinueAtEnd = false;\n\t\t\t\t} else {\n\t\t\t\t\t//const transition: Transition = instrument.getTransition();\n\t\t\t\t\tfor (let i: number = 0; i < pitches.length; i++) {\n\t\t\t\t\t\t//const strumOffsetParts: number = i * instrument.getChord().strumParts;\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet tone: Tone;\n\t\t\t\t\t\tif (toneList.count() <= toneCount) {\n\t\t\t\t\t\t\ttone = this.newTone();\n\t\t\t\t\t\t\ttoneList.pushBack(tone);\n\t\t\t\t\t\t} else if (!instrument.getTransition().isSeamless && this.liveInputStarted) {\n\t\t\t\t\t\t\tthis.releaseTone(instrumentState, toneList.get(toneCount));\n\t\t\t\t\t\t\ttone = this.newTone();\n\t\t\t\t\t\t\ttoneList.set(toneCount, tone);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttone = toneList.get(toneCount);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttoneCount++;\n\t\t\t\t\t\t\n\t\t\t\t\t\ttone.pitches[0] = pitches[i];\n\t\t\t\t\t\ttone.pitchCount = 1;\n\t\t\t\t\t\ttone.chordSize = pitches.length;\n\t\t\t\t\t\ttone.instrumentIndex = instrumentIndex;\n\t\t\t\t\t\ttone.note = tone.prevNote = tone.nextNote = null;\n\t\t\t\t\t\ttone.atNoteStart = this.liveInputStarted;\n\t\t\t\t\t\ttone.forceContinueAtStart = false;\n\t\t\t\t\t\ttone.forceContinueAtEnd = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\twhile (toneList.count() > toneCount) {\n\t\t\t\tthis.releaseTone(instrumentState, toneList.popBack());\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.liveInputStarted = false;\n\t}\n\t\n\t// Returns the chord type of the instrument in the adjacent pattern if it is compatible for a\n\t// seamless transition across patterns, otherwise returns null.\n\tprivate adjacentPatternHasCompatibleInstrumentTransition(song: Song, channel: Channel, pattern: Pattern, otherPattern: Pattern, instrumentIndex: number, transition: Transition, chord: Chord, note: Note, otherNote: Note, forceContinue: boolean): Chord | null {\n\t\tif (song.patternInstruments && otherPattern.instruments.indexOf(instrumentIndex) == -1) {\n\t\t\t// The adjacent pattern does not contain the same instrument as the current pattern.\n\t\t\t\n\t\t\tif (pattern.instruments.length > 1 || otherPattern.instruments.length > 1) {\n\t\t\t\t// The current or adjacent pattern contains more than one instrument, don't bother\n\t\t\t\t// trying to connect them.\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// Otherwise, the two patterns each contain one instrument, but not the same instrument.\n\t\t\t// Try to connect them.\n\t\t\tconst otherInstrument: Instrument = channel.instruments[otherPattern.instruments[0]];\n\t\t\t\n\t\t\tif (forceContinue) {\n\t\t\t\t// Even non-seamless instruments can be connected across patterns if forced.\n\t\t\t\treturn otherInstrument.getChord();\n\t\t\t}\n\t\t\t\n\t\t\t// Otherwise, check that both instruments are seamless across patterns.\n\t\t\tconst otherTransition: Transition = otherInstrument.getTransition();\n\t\t\tif (transition.includeAdjacentPatterns && otherTransition.includeAdjacentPatterns && otherTransition.slides == transition.slides) {\n\t\t\t\treturn otherInstrument.getChord();\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\t// If both patterns contain the same instrument, check that it is seamless across patterns.\n\t\t\treturn (forceContinue || transition.includeAdjacentPatterns) ? chord : null;\n\t\t}\n\t}\n\t\n\tpublic static adjacentNotesHaveMatchingPitches(firstNote: Note, secondNote: Note): boolean {\n\t\tif (firstNote.pitches.length != secondNote.pitches.length) return false;\n\t\tconst firstNoteInterval: number = firstNote.pins[firstNote.pins.length - 1].interval;\n\t\tfor (const pitch of firstNote.pitches) {\n\t\t\tif (secondNote.pitches.indexOf(pitch + firstNoteInterval) == -1) return false;\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tprivate determineCurrentActiveTones(song: Song, channelIndex: number, playSong: boolean): void {\n\t\tconst channel: Channel = song.channels[channelIndex];\n\t\tconst channelState: ChannelState = this.channels[channelIndex];\n\t\tconst pattern: Pattern | null = song.getPattern(channelIndex, this.bar);\n\t\tconst currentPart: number = this.getCurrentPart();\n\t\tconst currentTick: number = this.tick + Config.ticksPerPart * currentPart;\n\t\tlet note: Note | null = null;\n\t\tlet prevNote: Note | null = null;\n\t\tlet nextNote: Note | null = null;\n\t\t\n\t\tif (playSong && pattern != null && !channel.muted) {\n\t\t\tfor (let i: number = 0; i < pattern.notes.length; i++) {\n\t\t\t\tif (pattern.notes[i].end <= currentPart) {\n\t\t\t\t\tprevNote = pattern.notes[i];\n\t\t\t\t} else if (pattern.notes[i].start <= currentPart && pattern.notes[i].end > currentPart) {\n\t\t\t\t\tnote = pattern.notes[i];\n\t\t\t\t} else if (pattern.notes[i].start > currentPart) {\n\t\t\t\t\tnextNote = pattern.notes[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (note != null) {\n\t\t\t\tif (prevNote != null && prevNote.end != note.start) prevNote = null;\n\t\t\t\tif (nextNote != null && nextNote.start != note.end) nextNote = null;\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Seamless tones from a pattern with a single instrument can be transferred to a different single seamless instrument in the next pattern.\n\t\tif (pattern != null && (!song.layeredInstruments || channel.instruments.length == 1 || (song.patternInstruments && pattern.instruments.length == 1))) {\n\t\t\tconst newInstrumentIndex: number = song.patternInstruments ? pattern.instruments[0] : 0;\n\t\t\tif (channelState.singleSeamlessInstrument != null && channelState.singleSeamlessInstrument != newInstrumentIndex && channelState.singleSeamlessInstrument < channelState.instruments.length) {\n\t\t\t\tconst sourceInstrumentState: InstrumentState = channelState.instruments[channelState.singleSeamlessInstrument];\n\t\t\t\tconst destInstrumentState: InstrumentState = channelState.instruments[newInstrumentIndex];\n\t\t\t\twhile (sourceInstrumentState.activeTones.count() > 0) {\n\t\t\t\t\tdestInstrumentState.activeTones.pushFront(sourceInstrumentState.activeTones.popBack());\n\t\t\t\t}\n\t\t\t}\n\t\t\tchannelState.singleSeamlessInstrument = newInstrumentIndex;\n\t\t} else {\n\t\t\tchannelState.singleSeamlessInstrument = null;\n\t\t}\n\t\t\n\t\tfor (let instrumentIndex: number = 0; instrumentIndex < channel.instruments.length; instrumentIndex++) {\n\t\t\tconst instrumentState: InstrumentState = channelState.instruments[instrumentIndex];\n\t\t\tconst toneList: Deque<Tone> = instrumentState.activeTones;\n\t\t\tlet toneCount: number = 0;\n\t\t\tif ((note != null) && (!song.patternInstruments || (pattern!.instruments.indexOf(instrumentIndex) != -1))) {\n\t\t\t\tconst instrument: Instrument = channel.instruments[instrumentIndex];\n\t\t\t\tlet prevNoteForThisInstrument: Note | null = prevNote;\n\t\t\t\tlet nextNoteForThisInstrument: Note | null = nextNote;\n\t\t\t\t\n\t\t\t\tconst partsPerBar: Number = Config.partsPerBeat * song.beatsPerBar;\n\t\t\t\tconst transition: Transition = instrument.getTransition();\n\t\t\t\tconst chord: Chord = instrument.getChord();\n\t\t\t\tlet forceContinueAtStart: boolean = false;\n\t\t\t\tlet forceContinueAtEnd: boolean = false;\n\t\t\t\tlet tonesInPrevNote: number = 0;\n\t\t\t\tlet tonesInNextNote: number = 0;\n\t\t\t\tif (note.start == 0) {\n\t\t\t\t\t// If the beginning of the note coincides with the beginning of the pattern,\n\t\t\t\t\t// look for an adjacent note at the end of the previous pattern.\n\t\t\t\t\tlet prevPattern: Pattern | null = (this.prevBar == null) ? null : song.getPattern(channelIndex, this.prevBar);\n\t\t\t\t\tif (prevPattern != null) {\n\t\t\t\t\t\tconst lastNote: Note | null = (prevPattern.notes.length <= 0) ? null : prevPattern.notes[prevPattern.notes.length - 1];\n\t\t\t\t\t\tif (lastNote != null && lastNote.end == partsPerBar) {\n\t\t\t\t\t\t\tconst patternForcesContinueAtStart: boolean = note.continuesLastPattern && Synth.adjacentNotesHaveMatchingPitches(lastNote, note);\n\t\t\t\t\t\t\tconst chordOfCompatibleInstrument: Chord | null = this.adjacentPatternHasCompatibleInstrumentTransition(song, channel, pattern!, prevPattern, instrumentIndex, transition, chord, note, lastNote, patternForcesContinueAtStart);\n\t\t\t\t\t\t\tif (chordOfCompatibleInstrument != null) {\n\t\t\t\t\t\t\t\tprevNoteForThisInstrument = lastNote;\n\t\t\t\t\t\t\t\ttonesInPrevNote = chordOfCompatibleInstrument.singleTone ? 1 : prevNoteForThisInstrument.pitches.length\n\t\t\t\t\t\t\t\tforceContinueAtStart = patternForcesContinueAtStart;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (prevNoteForThisInstrument != null) {\n\t\t\t\t\ttonesInPrevNote = chord.singleTone ? 1 : prevNoteForThisInstrument.pitches.length\n\t\t\t\t}\n\t\t\t\tif (note.end == partsPerBar) {\n\t\t\t\t\t// If the end of the note coincides with the end of the pattern, look for an\n\t\t\t\t\t// adjacent note at the beginning of the next pattern.\n\t\t\t\t\tlet nextPattern: Pattern | null = (this.nextBar == null) ? null : song.getPattern(channelIndex, this.nextBar);\n\t\t\t\t\tif (nextPattern != null) {\n\t\t\t\t\t\tconst firstNote: Note | null = (nextPattern.notes.length <= 0) ? null : nextPattern.notes[0];\n\t\t\t\t\t\tif (firstNote != null && firstNote.start == 0) {\n\t\t\t\t\t\t\tconst nextPatternForcesContinueAtStart: boolean = firstNote.continuesLastPattern && Synth.adjacentNotesHaveMatchingPitches(note, firstNote);\n\t\t\t\t\t\t\tconst chordOfCompatibleInstrument: Chord | null = this.adjacentPatternHasCompatibleInstrumentTransition(song, channel, pattern!, nextPattern, instrumentIndex, transition, chord, note, firstNote, nextPatternForcesContinueAtStart);\n\t\t\t\t\t\t\tif (chordOfCompatibleInstrument != null) {\n\t\t\t\t\t\t\t\tnextNoteForThisInstrument = firstNote;\n\t\t\t\t\t\t\t\ttonesInNextNote = chordOfCompatibleInstrument.singleTone ? 1 : nextNoteForThisInstrument.pitches.length\n\t\t\t\t\t\t\t\tforceContinueAtEnd = nextPatternForcesContinueAtStart;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (nextNoteForThisInstrument != null) {\n\t\t\t\t\ttonesInNextNote = chord.singleTone ? 1 : nextNoteForThisInstrument.pitches.length\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (chord.singleTone) {\n\t\t\t\t\tconst atNoteStart: boolean = (Config.ticksPerPart * note.start == currentTick) && this.isAtStartOfTick;\n\t\t\t\t\tlet tone: Tone;\n\t\t\t\t\tif (toneList.count() <= toneCount) {\n\t\t\t\t\t\ttone = this.newTone();\n\t\t\t\t\t\ttoneList.pushBack(tone);\n\t\t\t\t\t} else if (atNoteStart && ((!transition.isSeamless && !forceContinueAtStart) || prevNoteForThisInstrument == null)) {\n\t\t\t\t\t\tconst oldTone: Tone = toneList.get(toneCount);\n\t\t\t\t\t\tif (oldTone.isOnLastTick) {\n\t\t\t\t\t\t\tthis.freeTone(oldTone);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.releaseTone(instrumentState, oldTone);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttone = this.newTone();\n\t\t\t\t\t\ttoneList.set(toneCount, tone);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttone = toneList.get(toneCount);\n\t\t\t\t\t}\n\t\t\t\t\ttoneCount++;\n\t\t\t\t\t\n\t\t\t\t\tfor (let i: number = 0; i < note.pitches.length; i++) {\n\t\t\t\t\t\ttone.pitches[i] = note.pitches[i];\n\t\t\t\t\t}\n\t\t\t\t\ttone.pitchCount = note.pitches.length;\n\t\t\t\t\ttone.chordSize = 1;\n\t\t\t\t\ttone.instrumentIndex = instrumentIndex;\n\t\t\t\t\ttone.note = note;\n\t\t\t\t\ttone.noteStartPart = note.start;\n\t\t\t\t\ttone.noteEndPart = note.end;\n\t\t\t\t\ttone.prevNote = prevNoteForThisInstrument;\n\t\t\t\t\ttone.nextNote = nextNoteForThisInstrument;\n\t\t\t\t\ttone.prevNotePitchIndex = 0;\n\t\t\t\t\ttone.nextNotePitchIndex = 0;\n\t\t\t\t\ttone.atNoteStart = atNoteStart;\n\t\t\t\t\ttone.passedEndOfNote = false;\n\t\t\t\t\ttone.forceContinueAtStart = forceContinueAtStart;\n\t\t\t\t\ttone.forceContinueAtEnd = forceContinueAtEnd;\n\t\t\t\t} else {\n\t\t\t\t\tconst transition: Transition = instrument.getTransition();\n\t\t\t\t\t\n\t\t\t\t\tif (((transition.isSeamless && !transition.slides && chord.strumParts == 0) || forceContinueAtStart) && (Config.ticksPerPart * note.start == currentTick) && this.isAtStartOfTick && prevNoteForThisInstrument != null) {\n\t\t\t\t\t\t// The tones are about to seamlessly transition to a new note. The pitches\n\t\t\t\t\t\t// from the old note may or may not match any of the pitches in the new\n\t\t\t\t\t\t// note, and not necessarily in order, but if any do match, they'll sound\n\t\t\t\t\t\t// better if those tones continue to have the same pitch. Attempt to find\n\t\t\t\t\t\t// the right spot for each old tone in the new chord if possible.\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (let i: number = 0; i < toneList.count(); i++) {\n\t\t\t\t\t\t\tconst tone: Tone = toneList.get(i);\n\t\t\t\t\t\t\tconst pitch: number = tone.pitches[0] + tone.lastInterval;\n\t\t\t\t\t\t\tfor (let j: number = 0; j < note.pitches.length; j++) {\n\t\t\t\t\t\t\t\tif (note.pitches[j] == pitch) {\n\t\t\t\t\t\t\t\t\tthis.tempMatchedPitchTones[j] = tone;\n\t\t\t\t\t\t\t\t\ttoneList.remove(i);\n\t\t\t\t\t\t\t\t\ti--;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Any tones that didn't get matched should just fill in the gaps.\n\t\t\t\t\t\twhile (toneList.count() > 0) {\n\t\t\t\t\t\t\tconst tone: Tone = toneList.popFront();\n\t\t\t\t\t\t\tfor (let j: number = 0; j < this.tempMatchedPitchTones.length; j++) {\n\t\t\t\t\t\t\t\tif (this.tempMatchedPitchTones[j] == null) {\n\t\t\t\t\t\t\t\t\tthis.tempMatchedPitchTones[j] = tone;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlet strumOffsetParts: number = 0;\n\t\t\t\t\tfor (let i: number = 0; i < note.pitches.length; i++) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet prevNoteForThisTone: Note | null = (tonesInPrevNote > i) ? prevNoteForThisInstrument : null;\n\t\t\t\t\t\tlet noteForThisTone: Note = note;\n\t\t\t\t\t\tlet nextNoteForThisTone: Note | null = (tonesInNextNote > i) ? nextNoteForThisInstrument : null;\n\t\t\t\t\t\tlet noteStartPart: number = noteForThisTone.start + strumOffsetParts;\n\t\t\t\t\t\tlet passedEndOfNote: boolean = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Strumming may mean that a note's actual start time may be after the\n\t\t\t\t\t\t// note's displayed start time. If the note start hasn't been reached yet,\n\t\t\t\t\t\t// carry over the previous tone if available and seamless, otherwise skip\n\t\t\t\t\t\t// the new tone until it is ready to start.\n\t\t\t\t\t\tif (noteStartPart > currentPart) {\n\t\t\t\t\t\t\tif (toneList.count() > i && (transition.isSeamless || forceContinueAtStart) && prevNoteForThisTone != null) {\n\t\t\t\t\t\t\t\t// Continue the previous note's chord until the current one takes over.\n\t\t\t\t\t\t\t\tnextNoteForThisTone = noteForThisTone;\n\t\t\t\t\t\t\t\tnoteForThisTone = prevNoteForThisTone;\n\t\t\t\t\t\t\t\tprevNoteForThisTone = null;\n\t\t\t\t\t\t\t\tnoteStartPart = noteForThisTone.start + strumOffsetParts;\n\t\t\t\t\t\t\t\tpassedEndOfNote = true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// This and the rest of the tones in the chord shouldn't start yet.\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet noteEndPart: number = noteForThisTone.end;\n\t\t\t\t\t\tif ((transition.isSeamless || forceContinueAtStart) && nextNoteForThisTone != null) {\n\t\t\t\t\t\t\tnoteEndPart = Math.min(Config.partsPerBeat * this.song!.beatsPerBar, noteEndPart + strumOffsetParts);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((!transition.continues && !forceContinueAtStart) || prevNoteForThisTone == null) {\n\t\t\t\t\t\t\tstrumOffsetParts += chord.strumParts;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst atNoteStart: boolean = (Config.ticksPerPart * noteStartPart == currentTick) && this.isAtStartOfTick;\n\t\t\t\t\t\tlet tone: Tone;\n\t\t\t\t\t\tif (this.tempMatchedPitchTones[toneCount] != null) {\n\t\t\t\t\t\t\ttone = this.tempMatchedPitchTones[toneCount]!;\n\t\t\t\t\t\t\tthis.tempMatchedPitchTones[toneCount] = null;\n\t\t\t\t\t\t\ttoneList.pushBack(tone);\n\t\t\t\t\t\t} else if (toneList.count() <= toneCount) {\n\t\t\t\t\t\t\ttone = this.newTone();\n\t\t\t\t\t\t\ttoneList.pushBack(tone);\n\t\t\t\t\t\t} else if (atNoteStart && ((!transition.isSeamless && !forceContinueAtStart) || prevNoteForThisTone == null)) {\n\t\t\t\t\t\t\tconst oldTone: Tone = toneList.get(toneCount);\n\t\t\t\t\t\t\tif (oldTone.isOnLastTick) {\n\t\t\t\t\t\t\t\tthis.freeTone(oldTone);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.releaseTone(instrumentState, oldTone);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttone = this.newTone();\n\t\t\t\t\t\t\ttoneList.set(toneCount, tone);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttone = toneList.get(toneCount);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttoneCount++;\n\t\t\t\t\t\t\n\t\t\t\t\t\ttone.pitches[0] = noteForThisTone.pitches[i];\n\t\t\t\t\t\ttone.pitchCount = 1;\n\t\t\t\t\t\ttone.chordSize = noteForThisTone.pitches.length;\n\t\t\t\t\t\ttone.instrumentIndex = instrumentIndex;\n\t\t\t\t\t\ttone.note = noteForThisTone;\n\t\t\t\t\t\ttone.noteStartPart = noteStartPart;\n\t\t\t\t\t\ttone.noteEndPart = noteEndPart;\n\t\t\t\t\t\ttone.prevNote = prevNoteForThisTone;\n\t\t\t\t\t\ttone.nextNote = nextNoteForThisTone;\n\t\t\t\t\t\ttone.prevNotePitchIndex = i;\n\t\t\t\t\t\ttone.nextNotePitchIndex = i;\n\t\t\t\t\t\ttone.atNoteStart = atNoteStart;\n\t\t\t\t\t\ttone.passedEndOfNote = passedEndOfNote;\n\t\t\t\t\t\ttone.forceContinueAtStart = forceContinueAtStart && prevNoteForThisTone != null;\n\t\t\t\t\t\ttone.forceContinueAtEnd = forceContinueAtEnd && nextNoteForThisTone != null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Automatically free or release seamless tones if there's no new note to take over.\n\t\t\twhile (toneList.count() > toneCount) {\n\t\t\t\tconst tone: Tone = toneList.popBack();\n\t\t\t\tconst channel: Channel = song.channels[channelIndex];\n\t\t\t\tif (tone.instrumentIndex < channel.instruments.length && !tone.isOnLastTick) {\n\t\t\t\t\tconst instrumentState: InstrumentState = this.channels[channelIndex].instruments[tone.instrumentIndex];\n\t\t\t\t\tthis.releaseTone(instrumentState, tone);\n\t\t\t\t} else {\n\t\t\t\t\tthis.freeTone(tone);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor (let i: number = toneCount; i < this.tempMatchedPitchTones.length; i++) {\n\t\t\t\tconst oldTone: Tone | null = this.tempMatchedPitchTones[i];\n\t\t\t\tif (oldTone != null) {\n\t\t\t\t\tif (oldTone.isOnLastTick) {\n\t\t\t\t\t\tthis.freeTone(oldTone);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.releaseTone(instrumentState, oldTone);\n\t\t\t\t\t}\n\t\t\t\t\tthis.tempMatchedPitchTones[i] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate playTone(song: Song, channelIndex: number, samplesPerTick: number, bufferIndex: number, runLength: number, tone: Tone, released: boolean, shouldFadeOutFast: boolean): void {\n\t\tconst channel: Channel = song.channels[channelIndex];\n\t\tconst channelState: ChannelState = this.channels[channelIndex];\n\t\tconst instrument: Instrument = channel.instruments[tone.instrumentIndex];\n\t\tconst instrumentState: InstrumentState = channelState.instruments[tone.instrumentIndex];\n\t\t\n\t\tinstrumentState.awake = true;\n\t\tinstrumentState.tonesAddedInThisTick = true;\n\t\tif (!instrumentState.computed) {\n\t\t\tinstrumentState.compute(this, instrument, samplesPerTick, runLength, tone);\n\t\t}\n\t\t\n\t\tSynth.computeTone(this, song, channelIndex, samplesPerTick, runLength, tone, released, shouldFadeOutFast);\n\t\tconst synthesizer: Function = Synth.getInstrumentSynthFunction(instrument);\n\t\tsynthesizer(this, bufferIndex, runLength, tone, instrument);\n\t\ttone.envelopeComputer.clearEnvelopes(instrument);\n\t}\n\t\n\tprivate static computeChordExpression(chordSize: number): number {\n\t\treturn 1.0 / ((chordSize - 1) * 0.25 + 1.0);\n\t}\n\t\n\tprivate static computeTone(synth: Synth, song: Song, channelIndex: number, samplesPerTick: number, runLength: number, tone: Tone, released: boolean, shouldFadeOutFast: boolean): void {\n\t\tconst channel: Channel = song.channels[channelIndex];\n\t\tconst instrument: Instrument = channel.instruments[tone.instrumentIndex];\n\t\tconst transition: Transition = instrument.getTransition();\n\t\tconst chord: Chord = instrument.getChord();\n\t\tconst chordExpression: number = chord.singleTone ? 1.0 : Synth.computeChordExpression(tone.chordSize);\n\t\tconst isNoiseChannel: boolean = song.getChannelIsNoise(channelIndex);\n\t\tconst intervalScale: number = isNoiseChannel ? Config.noiseInterval : 1;\n\t\tconst secondsPerPart: number = Config.ticksPerPart * samplesPerTick / synth.samplesPerSecond;\n\t\tconst sampleTime: number = 1.0 / synth.samplesPerSecond;\n\t\tconst beatsPerPart: number = 1.0 / Config.partsPerBeat;\n\t\tconst tickSampleCountdown: number = synth.tickSampleCountdown;\n\t\tconst startRatio: number = 1.0 - (tickSampleCountdown            ) / samplesPerTick;\n\t\tconst endRatio:   number = 1.0 - (tickSampleCountdown - runLength) / samplesPerTick;\n\t\tconst ticksIntoBar: number = synth.getTicksIntoBar();\n\t\tconst partTimeTickStart: number = (ticksIntoBar    ) / Config.ticksPerPart;\n\t\tconst partTimeTickEnd:   number = (ticksIntoBar + 1) / Config.ticksPerPart;\n\t\tconst partTimeStart: number = partTimeTickStart + (partTimeTickEnd - partTimeTickStart) * startRatio;\n\t\tconst partTimeEnd: number   = partTimeTickStart + (partTimeTickEnd - partTimeTickStart) * endRatio;\n\t\tconst currentPart: number = synth.getCurrentPart();\n\t\t\n\t\ttone.specialIntervalMult = 1.0;\n\t\ttone.specialIntervalExpressionMult = 1.0;\n\t\t\n\t\tlet toneIsOnLastTick: boolean = shouldFadeOutFast;\n\t\tlet intervalStart: number = 0.0;\n\t\tlet intervalEnd: number = 0.0;\n\t\tlet transitionExpressionStart: number = 1.0;\n\t\tlet transitionExpressionEnd: number = 1.0;\n\t\tlet chordExpressionStart: number = chordExpression;\n\t\tlet chordExpressionEnd:   number = chordExpression;\n\t\t\n\t\tlet expressionReferencePitch: number = 16; // A low \"E\" as a MIDI pitch.\n\t\tlet basePitch: number = Config.keys[song.key].basePitch;\n\t\tlet baseExpression: number = 1.0;\n\t\tlet pitchDamping: number = 48;\n\t\tif (instrument.type == InstrumentType.spectrum) {\n\t\t\tbaseExpression = Config.spectrumBaseExpression;\n\t\t\tif (isNoiseChannel) {\n\t\t\t\tbasePitch = Config.spectrumBasePitch;\n\t\t\t\tbaseExpression *= 2.0; // Note: spectrum is louder for drum channels than pitch channels!\n\t\t\t}\n\t\t\texpressionReferencePitch = Config.spectrumBasePitch;\n\t\t\tpitchDamping = 28;\n\t\t} else if (instrument.type == InstrumentType.drumset) {\n\t\t\tbasePitch = Config.spectrumBasePitch;\n\t\t\tbaseExpression = Config.drumsetBaseExpression;\n\t\t\texpressionReferencePitch = basePitch;\n\t\t} else if (instrument.type == InstrumentType.noise) {\n\t\t\tbasePitch = Config.chipNoises[instrument.chipNoise].basePitch;\n\t\t\tbaseExpression = Config.noiseBaseExpression;\n\t\t\texpressionReferencePitch = basePitch;\n\t\t\tpitchDamping = Config.chipNoises[instrument.chipNoise].isSoft ? 24.0 : 60.0;\n\t\t} else if (instrument.type == InstrumentType.fm) {\n\t\t\tbaseExpression = Config.fmBaseExpression;\n\t\t} else if (instrument.type == InstrumentType.chip) {\n\t\t\tbaseExpression = Config.chipBaseExpression;\n\t\t} else if (instrument.type == InstrumentType.harmonics) {\n\t\t\tbaseExpression = Config.harmonicsBaseExpression;\n\t\t} else if (instrument.type == InstrumentType.pwm) {\n\t\t\tbaseExpression = Config.pwmBaseExpression;\n\t\t} else if (instrument.type == InstrumentType.pickedString) {\n\t\t\tbaseExpression = Config.pickedStringBaseExpression;\n\t\t} else {\n\t\t\tthrow new Error(\"Unknown instrument type in computeTone.\");\n\t\t}\n\t\t\n\t\tif ((tone.atNoteStart && !transition.isSeamless && !tone.forceContinueAtStart) || tone.freshlyAllocated) {\n\t\t\ttone.reset();\n\t\t}\n\t\ttone.freshlyAllocated = false;\n\t\t\n\t\tconst maxWaves: number = Math.max(Config.maxChordSize, Config.operatorCount);\n\t\tfor (let i: number = 0; i < maxWaves; i++) {\n\t\t\ttone.phaseDeltas[i] = 0.0;\n\t\t\ttone.expressionStarts[i] = 0.0;\n\t\t\ttone.expressionDeltas[i] = 0.0;\n\t\t\ttone.phaseDeltaScales[i] = 0.0;\n\t\t}\n\n\t\tif (released) {\n\t\t\tconst startTicksSinceReleased: number = tone.ticksSinceReleased + startRatio;\n\t\t\tconst endTicksSinceReleased:   number = tone.ticksSinceReleased + endRatio;\n\t\t\tintervalStart = intervalEnd = tone.lastInterval;\n\t\t\tconst fadeOutTicks: number = Math.abs(instrument.getFadeOutTicks());\n\t\t\ttransitionExpressionStart = Synth.noteSizeToVolumeMult((1.0 - startTicksSinceReleased / fadeOutTicks) * Config.noteSizeMax);\n\t\t\ttransitionExpressionEnd   = Synth.noteSizeToVolumeMult((1.0 - endTicksSinceReleased / fadeOutTicks) * Config.noteSizeMax);\n\t\t\t\n\t\t\tif (shouldFadeOutFast) {\n\t\t\t\ttransitionExpressionStart *= 1.0 - startRatio;\n\t\t\t\ttransitionExpressionEnd *= 1.0 - endRatio;\n\t\t\t}\n\t\t\t\n\t\t\tif (tone.ticksSinceReleased + 1 >= fadeOutTicks) toneIsOnLastTick = true;\n\t\t} else if (tone.note == null) {\n\t\t\ttransitionExpressionStart = transitionExpressionEnd = 1;\n\t\t\ttone.lastInterval = 0;\n\t\t\ttone.ticksSinceReleased = 0;\n\t\t\ttone.liveInputSamplesHeld += runLength;\n\t\t} else {\n\t\t\tconst note: Note = tone.note;\n\t\t\tconst nextNote: Note | null = tone.nextNote;\n\n\t\t\tconst noteStartPart: number = tone.noteStartPart;\n\t\t\tconst noteEndPart: number = tone.noteEndPart;\n\t\t\t\n\t\t\tconst endPinIndex: number = note.getEndPinIndex(currentPart);\n\t\t\tconst startPin: NotePin = note.pins[endPinIndex-1];\n\t\t\tconst endPin: NotePin = note.pins[endPinIndex];\n\t\t\tconst noteStartTick: number = noteStartPart * Config.ticksPerPart;\n\t\t\tconst noteEndTick:   number = noteEndPart   * Config.ticksPerPart;\n\t\t\tconst pinStart: number  = (note.start + startPin.time) * Config.ticksPerPart;\n\t\t\tconst pinEnd:   number  = (note.start +   endPin.time) * Config.ticksPerPart;\n\t\t\t\n\t\t\ttone.ticksSinceReleased = 0;\n\t\t\t\n\t\t\tconst tickTimeStart: number = currentPart * Config.ticksPerPart + synth.tick;\n\t\t\tconst tickTimeEnd:   number = currentPart * Config.ticksPerPart + synth.tick + 1;\n\t\t\tconst noteTicksPassedTickStart: number = tickTimeStart - noteStartTick;\n\t\t\tconst noteTicksPassedTickEnd: number = tickTimeEnd - noteStartTick;\n\t\t\tconst pinRatioStart: number = Math.min(1.0, (tickTimeStart - pinStart) / (pinEnd - pinStart));\n\t\t\tconst pinRatioEnd:   number = Math.min(1.0, (tickTimeEnd   - pinStart) / (pinEnd - pinStart));\n\t\t\tlet transitionExpressionTickStart: number = 1.0;\n\t\t\tlet transitionExpressionTickEnd:   number = 1.0;\n\t\t\tlet intervalTickStart: number = startPin.interval + (endPin.interval - startPin.interval) * pinRatioStart;\n\t\t\tlet intervalTickEnd:   number = startPin.interval + (endPin.interval - startPin.interval) * pinRatioEnd;\n\t\t\ttone.lastInterval = intervalTickEnd;\n\t\t\t\n\t\t\tif ((!transition.isSeamless && !tone.forceContinueAtEnd) || nextNote == null) {\n\t\t\t\tconst fadeOutTicks: number = -instrument.getFadeOutTicks();\n\t\t\t\tif (fadeOutTicks > 0.0) {\n\t\t\t\t\t// If the tone should fade out before the end of the note, do so here.\n\t\t\t\t\tconst noteLengthTicks: number = noteEndTick - noteStartTick;\n\t\t\t\t\ttransitionExpressionTickStart *= Math.min(1.0, (noteLengthTicks - noteTicksPassedTickStart) / fadeOutTicks);\n\t\t\t\t\ttransitionExpressionTickEnd   *= Math.min(1.0, (noteLengthTicks - noteTicksPassedTickEnd) / fadeOutTicks);\n\t\t\t\t\tif (tickTimeEnd >= noteStartTick + noteLengthTicks) toneIsOnLastTick = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tintervalStart = intervalTickStart + (intervalTickEnd - intervalTickStart) * startRatio;\n\t\t\tintervalEnd   = intervalTickStart + (intervalTickEnd - intervalTickStart) * endRatio;\n\t\t\ttransitionExpressionStart = transitionExpressionTickStart + (transitionExpressionTickEnd - transitionExpressionTickStart) * startRatio;\n\t\t\ttransitionExpressionEnd   = transitionExpressionTickStart + (transitionExpressionTickEnd - transitionExpressionTickStart) * endRatio;\n\t\t}\n\t\t\n\t\ttone.isOnLastTick = toneIsOnLastTick;\n\t\t\n\t\t// Compute envelopes *after* resetting the tone, otherwise the envelope computer gets reset too!\n\t\tconst envelopeComputer: EnvelopeComputer = tone.envelopeComputer;\n\t\tenvelopeComputer.computeEnvelopes(instrument, currentPart, Config.ticksPerPart * partTimeStart, Config.ticksPerPart * partTimeEnd, secondsPerPart * (partTimeEnd - partTimeStart), tone);\n\t\tconst envelopeStarts: number[] = tone.envelopeComputer.envelopeStarts;\n\t\tconst envelopeEnds: number[] = tone.envelopeComputer.envelopeEnds;\n\t\t\n\t\tif (tone.note != null && transition.slides) {\n\t\t\t// Slide interval and chordExpression at the start and/or end of the note if necessary.\n\t\t\tconst prevNote: Note | null = tone.prevNote;\n\t\t\tconst nextNote: Note | null = tone.nextNote;\n\t\t\tif (prevNote != null) {\n\t\t\t\tconst intervalDiff: number = prevNote.pitches[tone.prevNotePitchIndex] + prevNote.pins[prevNote.pins.length-1].interval - tone.pitches[0];\n\t\t\t\tif (envelopeComputer.prevSlideStart) intervalStart += intervalDiff * envelopeComputer.prevSlideRatioStart;\n\t\t\t\tif (envelopeComputer.prevSlideEnd)   intervalEnd   += intervalDiff * envelopeComputer.prevSlideRatioEnd;\n\t\t\t\tif (!chord.singleTone) {\n\t\t\t\t\tconst chordSizeDiff: number = prevNote.pitches.length - tone.chordSize;\n\t\t\t\t\tif (envelopeComputer.prevSlideStart) chordExpressionStart = Synth.computeChordExpression(tone.chordSize + chordSizeDiff * envelopeComputer.prevSlideRatioStart);\n\t\t\t\t\tif (envelopeComputer.prevSlideEnd)   chordExpressionEnd   = Synth.computeChordExpression(tone.chordSize + chordSizeDiff * envelopeComputer.prevSlideRatioEnd);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (nextNote != null) {\n\t\t\t\tconst intervalDiff: number = nextNote.pitches[tone.nextNotePitchIndex] - (tone.pitches[0] + tone.note.pins[tone.note.pins.length-1].interval);\n\t\t\t\tif (envelopeComputer.nextSlideStart) intervalStart += intervalDiff * envelopeComputer.nextSlideRatioStart;\n\t\t\t\tif (envelopeComputer.nextSlideEnd)   intervalEnd   += intervalDiff * envelopeComputer.nextSlideRatioEnd;\n\t\t\t\tif (!chord.singleTone) {\n\t\t\t\t\tconst chordSizeDiff: number = nextNote.pitches.length - tone.chordSize;\n\t\t\t\t\tif (envelopeComputer.nextSlideStart) chordExpressionStart = Synth.computeChordExpression(tone.chordSize + chordSizeDiff * envelopeComputer.nextSlideRatioStart);\n\t\t\t\t\tif (envelopeComputer.nextSlideEnd)   chordExpressionEnd   = Synth.computeChordExpression(tone.chordSize + chordSizeDiff * envelopeComputer.nextSlideRatioEnd);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (effectsIncludePitchShift(instrument.effects)) {\n\t\t\tconst pitchShift: number = Config.justIntonationSemitones[instrument.pitchShift] / intervalScale;\n\t\t\tconst envelopeStart: number = envelopeStarts[NoteAutomationIndex.pitchShift];\n\t\t\tconst envelopeEnd:   number = envelopeEnds[  NoteAutomationIndex.pitchShift];\n\t\t\tintervalStart += pitchShift * envelopeStart;\n\t\t\tintervalEnd   += pitchShift * envelopeEnd;\n\t\t}\n\t\tif (effectsIncludeDetune(instrument.effects)) {\n\t\t\tconst envelopeStart: number = envelopeStarts[NoteAutomationIndex.detune];\n\t\t\tconst envelopeEnd:   number = envelopeEnds[  NoteAutomationIndex.detune];\n\t\t\tintervalStart += Synth.detuneToCents((instrument.detune - Config.detuneCenter) * envelopeStart) * Config.pitchesPerOctave / (12.0 * 100.0);\n\t\t\tintervalEnd   += Synth.detuneToCents((instrument.detune - Config.detuneCenter) * envelopeEnd  ) * Config.pitchesPerOctave / (12.0 * 100.0);\n\t\t}\n\t\t\n\t\tif (effectsIncludeVibrato(instrument.effects)) {\n\t\t\tconst delayTicks: number = Config.vibratos[instrument.vibrato].delayTicks;\n\t\t\tconst vibratoAmplitude: number = Config.vibratos[instrument.vibrato].amplitude;\n\t\t\t\n\t\t\t// To maintain pitch continuity, (mostly for picked string which retriggers impulse\n\t\t\t// otherwise) remember the vibrato at the end of this run and reuse it at the start\n\t\t\t// of the next run if available.\n\t\t\tlet vibratoStart: number;\n\t\t\tif (tone.prevVibrato != null) {\n\t\t\t\tvibratoStart = tone.prevVibrato;\n\t\t\t} else {\n\t\t\t\tlet lfoStart: number = Synth.getLFOAmplitude(instrument, secondsPerPart * partTimeStart);\n\t\t\t\tconst vibratoDepthEnvelopeStart: number = envelopeStarts[NoteAutomationIndex.vibratoDepth];\n\t\t\t\tvibratoStart = vibratoAmplitude * lfoStart * vibratoDepthEnvelopeStart;\n\t\t\t\tif (delayTicks > 0.0) {\n\t\t\t\t\tconst ticksUntilVibratoStart: number = delayTicks - envelopeComputer.noteTicksStart;\n\t\t\t\t\tvibratoStart *= Math.max(0.0, Math.min(1.0, 1.0 - ticksUntilVibratoStart / 2.0));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tlet lfoEnd:   number = Synth.getLFOAmplitude(instrument, secondsPerPart * partTimeEnd);\n\t\t\tconst vibratoDepthEnvelopeEnd:   number = envelopeEnds[  NoteAutomationIndex.vibratoDepth];\n\t\t\tlet vibratoEnd:   number = vibratoAmplitude * lfoEnd   * vibratoDepthEnvelopeEnd;\n\t\t\tif (delayTicks > 0.0) {\n\t\t\t\tconst ticksUntilVibratoEnd:   number = delayTicks - envelopeComputer.noteTicksEnd;\n\t\t\t\tvibratoEnd   *= Math.max(0.0, Math.min(1.0, 1.0 - ticksUntilVibratoEnd   / 2.0));\n\t\t\t}\n\t\t\ttone.prevVibrato = vibratoEnd;\n\t\t\t\n\t\t\tintervalStart += vibratoStart;\n\t\t\tintervalEnd   += vibratoEnd;\n\t\t}\n\t\t\n\t\tif ((!transition.isSeamless && !tone.forceContinueAtStart) || tone.prevNote == null) {\n\t\t\t// Fade in the beginning of the note.\n\t\t\tconst fadeInSeconds: number = instrument.getFadeInSeconds();\n\t\t\tif (fadeInSeconds > 0.0) {\n\t\t\t\ttransitionExpressionStart *= Math.min(1.0, envelopeComputer.noteSecondsStart / fadeInSeconds);\n\t\t\t\ttransitionExpressionEnd   *= Math.min(1.0, envelopeComputer.noteSecondsEnd   / fadeInSeconds);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (instrument.type == InstrumentType.drumset && tone.drumsetPitch == null) {\n\t\t\t// It's possible that the note will change while the user is editing it,\n\t\t\t// but the tone's pitches don't get updated because the tone has already\n\t\t\t// ended and is fading out. To avoid an array index out of bounds error, clamp the pitch.\n\t\t\ttone.drumsetPitch = tone.pitches[0];\n\t\t\tif (tone.note != null) tone.drumsetPitch += tone.note.pickMainInterval();\n\t\t\ttone.drumsetPitch = Math.max(0, Math.min(Config.drumCount - 1, tone.drumsetPitch));\n\t\t}\n\t\t\n\t\tlet noteFilterExpression: number = envelopeComputer.lowpassCutoffDecayVolumeCompensation;\n\t\tif (!effectsIncludeNoteFilter(instrument.effects)) {\n\t\t\ttone.noteFilterCount = 0;\n\t\t} else {\n\t\t\tconst noteFilterSettings: FilterSettings = instrument.noteFilter;\n\t\t\t\n\t\t\tconst noteAllFreqsEnvelopeStart: number = envelopeStarts[NoteAutomationIndex.noteFilterAllFreqs];\n\t\t\tconst noteAllFreqsEnvelopeEnd:   number = envelopeEnds[  NoteAutomationIndex.noteFilterAllFreqs];\n\t\t\tfor (let i: number = 0; i < noteFilterSettings.controlPointCount; i++) {\n\t\t\t\tconst noteFreqEnvelopeStart: number = envelopeStarts[NoteAutomationIndex.noteFilterFreq0 + i];\n\t\t\t\tconst noteFreqEnvelopeEnd:   number = envelopeEnds[  NoteAutomationIndex.noteFilterFreq0 + i];\n\t\t\t\tconst notePeakEnvelopeStart: number = envelopeStarts[NoteAutomationIndex.noteFilterGain0 + i];\n\t\t\t\tconst notePeakEnvelopeEnd:   number = envelopeEnds[  NoteAutomationIndex.noteFilterGain0 + i];\n\t\t\t\tconst point: FilterControlPoint = noteFilterSettings.controlPoints[i];\n\t\t\t\tpoint.toCoefficients(Synth.tempFilterStartCoefficients, synth.samplesPerSecond, noteAllFreqsEnvelopeStart * noteFreqEnvelopeStart, notePeakEnvelopeStart);\n\t\t\t\tpoint.toCoefficients(Synth.tempFilterEndCoefficients,   synth.samplesPerSecond, noteAllFreqsEnvelopeEnd   * noteFreqEnvelopeEnd,   notePeakEnvelopeEnd);\n\t\t\t\tif (tone.noteFilters.length <= i) tone.noteFilters[i] = new DynamicBiquadFilter();\n\t\t\t\ttone.noteFilters[i].loadCoefficientsWithGradient(Synth.tempFilterStartCoefficients, Synth.tempFilterEndCoefficients, 1.0 / runLength, point.type == FilterType.lowPass);\n\t\t\t\tnoteFilterExpression *= point.getVolumeCompensationMult();\n\t\t\t}\n\t\t\ttone.noteFilterCount = noteFilterSettings.controlPointCount;\n\t\t}\n\t\t\n\t\tif (instrument.type == InstrumentType.drumset) {\n\t\t\tconst drumsetFilterEnvelope: Envelope = instrument.getDrumsetEnvelope(tone.drumsetPitch!);\n\t\t\t// If the drumset lowpass cutoff decays, compensate by increasing expression.\n\t\t\tnoteFilterExpression *= EnvelopeComputer.getLowpassCutoffDecayVolumeCompensation(drumsetFilterEnvelope)\n\t\t\t\n\t\t\t// Drumset filters use the same envelope timing as the rest of the envelopes, but do not include support for slide transitions.\n\t\t\tlet drumsetFilterEnvelopeStart: number = EnvelopeComputer.computeEnvelope(drumsetFilterEnvelope, envelopeComputer.noteSecondsStart, beatsPerPart * partTimeStart, envelopeComputer.noteSizeStart);\n\t\t\tlet drumsetFilterEnvelopeEnd:   number = EnvelopeComputer.computeEnvelope(drumsetFilterEnvelope, envelopeComputer.noteSecondsEnd,   beatsPerPart * partTimeEnd,   envelopeComputer.noteSizeEnd);\n\t\t\t\n\t\t\t// Apply slide interpolation to drumset envelope.\n\t\t\tif (envelopeComputer.prevSlideStart) {\n\t\t\t\tconst other: number = EnvelopeComputer.computeEnvelope(drumsetFilterEnvelope, envelopeComputer.prevNoteSecondsStart, beatsPerPart * partTimeStart, envelopeComputer.prevNoteSize);\n\t\t\t\tdrumsetFilterEnvelopeStart += (other - drumsetFilterEnvelopeStart) * envelopeComputer.prevSlideRatioStart;\n\t\t\t}\n\t\t\tif (envelopeComputer.prevSlideEnd) {\n\t\t\t\tconst other: number = EnvelopeComputer.computeEnvelope(drumsetFilterEnvelope, envelopeComputer.prevNoteSecondsEnd, beatsPerPart * partTimeEnd, envelopeComputer.prevNoteSize);\n\t\t\t\tdrumsetFilterEnvelopeEnd += (other - drumsetFilterEnvelopeEnd) * envelopeComputer.prevSlideRatioEnd;\n\t\t\t}\n\t\t\tif (envelopeComputer.nextSlideStart) {\n\t\t\t\tconst other: number = EnvelopeComputer.computeEnvelope(drumsetFilterEnvelope, 0.0, beatsPerPart * partTimeStart, envelopeComputer.nextNoteSize);\n\t\t\t\tdrumsetFilterEnvelopeStart += (other - drumsetFilterEnvelopeStart) * envelopeComputer.nextSlideRatioStart;\n\t\t\t}\n\t\t\tif (envelopeComputer.nextSlideEnd) {\n\t\t\t\tconst other: number = EnvelopeComputer.computeEnvelope(drumsetFilterEnvelope, 0.0, beatsPerPart * partTimeEnd, envelopeComputer.nextNoteSize);\n\t\t\t\tdrumsetFilterEnvelopeEnd += (other - drumsetFilterEnvelopeEnd) * envelopeComputer.nextSlideRatioEnd;\n\t\t\t}\n\t\t\t\n\t\t\tconst point: FilterControlPoint = synth.tempDrumSetControlPoint;\n\t\t\tpoint.type = FilterType.lowPass;\n\t\t\tpoint.gain = FilterControlPoint.getRoundedSettingValueFromLinearGain(0.5);\n\t\t\tpoint.freq = FilterControlPoint.getRoundedSettingValueFromHz(8000.0);\n\t\t\t// Drumset envelopes are warped to better imitate the legacy simplified 2nd order lowpass at ~48000Hz that I used to use.\n\t\t\tpoint.toCoefficients(Synth.tempFilterStartCoefficients, synth.samplesPerSecond, drumsetFilterEnvelopeStart * (1.0 + drumsetFilterEnvelopeStart), 1.0);\n\t\t\tpoint.toCoefficients(Synth.tempFilterEndCoefficients, synth.samplesPerSecond, drumsetFilterEnvelopeEnd * (1.0 + drumsetFilterEnvelopeEnd), 1.0);\n\t\t\tif (tone.noteFilters.length == tone.noteFilterCount) tone.noteFilters[tone.noteFilterCount] = new DynamicBiquadFilter();\n\t\t\ttone.noteFilters[tone.noteFilterCount].loadCoefficientsWithGradient(Synth.tempFilterStartCoefficients, Synth.tempFilterEndCoefficients, 1.0 / runLength, true);\n\t\t\ttone.noteFilterCount++;\n\t\t}\n\t\t\n\t\tnoteFilterExpression = Math.min(3.0, noteFilterExpression);\n\t\t\n\t\tif (instrument.type == InstrumentType.fm) {\n\t\t\t// phase modulation!\n\t\t\t\n\t\t\tlet sineExpressionBoost: number = 1.0;\n\t\t\tlet totalCarrierExpression: number = 0.0;\n\n\t\t\tlet arpeggioInterval: number = 0;\n\t\t\tconst arpeggiates: boolean = chord.arpeggiates;\n\t\t\tif (tone.pitchCount > 1 && arpeggiates) {\n\t\t\t\tconst arpeggio: number = Math.floor((synth.tick + synth.part * Config.ticksPerPart) / Config.rhythms[song.rhythm].ticksPerArpeggio);\n\t\t\t\tarpeggioInterval = tone.pitches[getArpeggioPitchIndex(tone.pitchCount, song.rhythm, arpeggio)] - tone.pitches[0];\n\t\t\t}\n\t\t\t\n\t\t\tconst carrierCount: number = Config.algorithms[instrument.algorithm].carrierCount;\n\t\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\n\t\t\t\tconst associatedCarrierIndex: number = Config.algorithms[instrument.algorithm].associatedCarrier[i] - 1;\n\t\t\t\tconst pitch: number = tone.pitches[arpeggiates ? 0 : ((i < tone.pitchCount) ? i : ((associatedCarrierIndex < tone.pitchCount) ? associatedCarrierIndex : 0))];\n\t\t\t\tconst freqMult = Config.operatorFrequencies[instrument.operators[i].frequency].mult;\n\t\t\t\tconst interval = Config.operatorCarrierInterval[associatedCarrierIndex] + arpeggioInterval;\n\t\t\t\tconst pitchStart: number = basePitch + (pitch + intervalStart) * intervalScale + interval;\n\t\t\t\tconst pitchEnd: number = basePitch + (pitch + intervalEnd) * intervalScale + interval;\n\t\t\t\tconst baseFreqStart: number = Instrument.frequencyFromPitch(pitchStart);\n\t\t\t\tconst baseFreqEnd:   number = Instrument.frequencyFromPitch(pitchEnd);\n\t\t\t\tconst hzOffset: number = Config.operatorFrequencies[instrument.operators[i].frequency].hzOffset;\n\t\t\t\tconst targetFreqStart: number = freqMult * baseFreqStart + hzOffset;\n\t\t\t\tconst targetFreqEnd:   number = freqMult * baseFreqEnd   + hzOffset;\n\t\t\t\t\n\t\t\t\tconst freqEnvelopeStart: number = envelopeStarts[NoteAutomationIndex.operatorFrequency0 + i];\n\t\t\t\tconst freqEnvelopeEnd:   number = envelopeEnds[  NoteAutomationIndex.operatorFrequency0 + i];\n\t\t\t\tlet freqStart: number;\n\t\t\t\tlet freqEnd:   number;\n\t\t\t\tif (freqEnvelopeStart != 1.0 || freqEnvelopeEnd != 1.0) {\n\t\t\t\t\tfreqStart = Math.pow(2.0, Math.log2(targetFreqStart / baseFreqStart) * freqEnvelopeStart) * baseFreqStart;\n\t\t\t\t\tfreqEnd   = Math.pow(2.0, Math.log2(targetFreqEnd   / baseFreqEnd)   * freqEnvelopeEnd)   * baseFreqEnd;\n\t\t\t\t} else {\n\t\t\t\t\tfreqStart = targetFreqStart;\n\t\t\t\t\tfreqEnd   = targetFreqEnd;\n\t\t\t\t}\n\t\t\t\ttone.phaseDeltas[i] = freqStart * sampleTime * Config.sineWaveLength;\n\t\t\t\ttone.phaseDeltaScales[i] = Math.pow(freqEnd / freqStart, 1.0 / runLength);\n\t\t\t\t\n\t\t\t\tconst amplitudeCurve: number = Synth.operatorAmplitudeCurve(instrument.operators[i].amplitude);\n\t\t\t\tconst amplitudeMult: number = amplitudeCurve * Config.operatorFrequencies[instrument.operators[i].frequency].amplitudeSign;\n\t\t\t\tlet expressionStart: number = amplitudeMult;\n\t\t\t\tlet expressionEnd: number = amplitudeMult;\n\t\t\t\tif (i < carrierCount) {\n\t\t\t\t\t// carrier\n\t\t\t\t\tconst pitchExpressionStart: number = Math.pow(2.0, -(pitchStart - expressionReferencePitch) / pitchDamping);\n\t\t\t\t\tconst pitchExpressionEnd: number   = Math.pow(2.0, -(pitchEnd   - expressionReferencePitch) / pitchDamping);\n\t\t\t\t\texpressionStart *= baseExpression * pitchExpressionStart * transitionExpressionStart * noteFilterExpression * chordExpressionStart;\n\t\t\t\t\texpressionEnd *= baseExpression * pitchExpressionEnd * transitionExpressionEnd * noteFilterExpression * chordExpressionEnd;\n\t\t\t\t\texpressionStart *= envelopeStarts[NoteAutomationIndex.noteVolume];\n\t\t\t\t\texpressionEnd *= envelopeEnds[NoteAutomationIndex.noteVolume];\n\t\t\t\t\t\n\t\t\t\t\ttotalCarrierExpression += amplitudeCurve;\n\t\t\t\t} else {\n\t\t\t\t\t// modulator\n\t\t\t\t\texpressionStart *= Config.sineWaveLength * 1.5;\n\t\t\t\t\texpressionEnd *= Config.sineWaveLength * 1.5;\n\t\t\t\t\t\n\t\t\t\t\tsineExpressionBoost *= 1.0 - Math.min(1.0, instrument.operators[i].amplitude / 15);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\texpressionStart *= envelopeStarts[NoteAutomationIndex.operatorAmplitude0 + i];\n\t\t\t\texpressionEnd   *= envelopeEnds[  NoteAutomationIndex.operatorAmplitude0 + i];\n\t\t\t\t\n\t\t\t\ttone.expressionStarts[i] = expressionStart;\n\t\t\t\ttone.expressionDeltas[i] = (expressionEnd - expressionStart) / runLength;\n\t\t\t}\n\t\t\t\n\t\t\tsineExpressionBoost *= (Math.pow(2.0, (2.0 - 1.4 * instrument.feedbackAmplitude / 15.0)) - 1.0) / 3.0;\n\t\t\tsineExpressionBoost *= 1.0 - Math.min(1.0, Math.max(0.0, totalCarrierExpression - 1) / 2.0);\n\t\t\tsineExpressionBoost = 1.0 + sineExpressionBoost * 3.0;\n\t\t\tfor (let i: number = 0; i < carrierCount; i++) {\n\t\t\t\ttone.expressionStarts[i] *= sineExpressionBoost;\n\t\t\t\ttone.expressionDeltas[i] *= sineExpressionBoost;\n\t\t\t}\n\t\t\t\n\t\t\tconst feedbackAmplitude: number = Config.sineWaveLength * 0.3 * instrument.feedbackAmplitude / 15.0;\n\t\t\tlet feedbackStart: number = feedbackAmplitude * envelopeStarts[NoteAutomationIndex.feedbackAmplitude];\n\t\t\tlet feedbackEnd:   number = feedbackAmplitude * envelopeEnds[  NoteAutomationIndex.feedbackAmplitude];\n\t\t\ttone.feedbackMult = feedbackStart;\n\t\t\ttone.feedbackDelta = (feedbackEnd - tone.feedbackMult) / runLength;\n\t\t} else {\n\t\t\tconst basePhaseDeltaScale: number = Math.pow(2.0, ((intervalEnd - intervalStart) * intervalScale / 12.0) / runLength);\n\t\t\t\n\t\t\tlet pitch: number = tone.pitches[0];\n\t\t\tif (tone.pitchCount > 1 && (chord.arpeggiates || chord.customInterval)) {\n\t\t\t\tconst arpeggio: number = Math.floor((synth.tick + synth.part * Config.ticksPerPart) / Config.rhythms[song.rhythm].ticksPerArpeggio);\n\t\t\t\tif (chord.customInterval) {\n\t\t\t\t\tconst intervalOffset: number = tone.pitches[1 + getArpeggioPitchIndex(tone.pitchCount - 1, song.rhythm, arpeggio)] - tone.pitches[0];\n\t\t\t\t\ttone.specialIntervalMult = Math.pow(2.0, intervalOffset / 12.0);\n\t\t\t\t\ttone.specialIntervalExpressionMult = Math.pow(2.0, -intervalOffset / pitchDamping);\n\t\t\t\t} else {\n\t\t\t\t\tpitch = tone.pitches[getArpeggioPitchIndex(tone.pitchCount, song.rhythm, arpeggio)];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconst startPitch: number = basePitch + (pitch + intervalStart) * intervalScale;\n\t\t\tconst endPitch:   number = basePitch + (pitch + intervalEnd)   * intervalScale;\n\t\t\tconst pitchExpressionStart: number = Math.pow(2.0, -(startPitch - expressionReferencePitch) / pitchDamping);\n\t\t\tconst pitchExpressionEnd:   number = Math.pow(2.0,   -(endPitch - expressionReferencePitch) / pitchDamping);\n\t\t\tlet settingsExpressionMult: number = baseExpression * noteFilterExpression;\n\t\t\t\n\t\t\tif (instrument.type == InstrumentType.noise) {\n\t\t\t\tsettingsExpressionMult *= Config.chipNoises[instrument.chipNoise].expression;\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.chip) {\n\t\t\t\tsettingsExpressionMult *= Config.chipWaves[instrument.chipWave].expression;\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.pwm) {\n\t\t\t\tconst basePulseWidth: number = getPulseWidthRatio(instrument.pulseWidth);\n\t\t\t\tconst pulseWidthStart: number = basePulseWidth * envelopeStarts[NoteAutomationIndex.pulseWidth];\n\t\t\t\tconst pulseWidthEnd:   number = basePulseWidth * envelopeEnds[  NoteAutomationIndex.pulseWidth];\n\t\t\t\ttone.pulseWidth = pulseWidthStart;\n\t\t\t\ttone.pulseWidthDelta = (pulseWidthEnd - pulseWidthStart) / runLength;\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.pickedString) {\n\t\t\t\t// Increase expression to compensate for string decay.\n\t\t\t\tsettingsExpressionMult *= Math.pow(2.0, 0.7 * (1.0 - instrument.stringSustain / (Config.stringSustainRange - 1)));\n\t\t\t\t\n\t\t\t\tconst unison: Unison = Config.unisons[instrument.unison];\n\t\t\t\tfor (let i: number = tone.pickedStrings.length; i < unison.voices; i++) {\n\t\t\t\t\ttone.pickedStrings[i] = new PickedString();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (tone.atNoteStart && !transition.continues && !tone.forceContinueAtStart) {\n\t\t\t\t\tfor (const pickedString of tone.pickedStrings) {\n\t\t\t\t\t\t// Force the picked string to retrigger the attack impulse at the start of the note.\n\t\t\t\t\t\tpickedString.delayIndex = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconst startFreq: number = Instrument.frequencyFromPitch(startPitch);\n\t\t\tif (instrument.type == InstrumentType.chip || instrument.type == InstrumentType.harmonics || instrument.type == InstrumentType.pickedString) {\n\t\t\t\t// These instruments have two waves at different frequencies for the unison feature.\n\t\t\t\tconst unison: Unison = Config.unisons[instrument.unison];\n\t\t\t\tconst voiceCountExpression: number = (instrument.type == InstrumentType.pickedString) ? 1 : unison.voices / 2.0;\n\t\t\t\tsettingsExpressionMult *= unison.expression * voiceCountExpression;\n\t\t\t\tconst unisonEnvelopeStart = envelopeStarts[NoteAutomationIndex.unison];\n\t\t\t\tconst unisonEnvelopeEnd   = envelopeEnds[  NoteAutomationIndex.unison];\n\t\t\t\tconst unisonAStart: number = Math.pow(2.0, (unison.offset + unison.spread) * unisonEnvelopeStart / 12.0);\n\t\t\t\tconst unisonAEnd:   number = Math.pow(2.0, (unison.offset + unison.spread) * unisonEnvelopeEnd   / 12.0);\n\t\t\t\tconst unisonBStart: number = Math.pow(2.0, (unison.offset - unison.spread) * unisonEnvelopeStart / 12.0) * tone.specialIntervalMult;\n\t\t\t\tconst unisonBEnd:   number = Math.pow(2.0, (unison.offset - unison.spread) * unisonEnvelopeEnd   / 12.0) * tone.specialIntervalMult;\n\t\t\t\ttone.phaseDeltas[0] = startFreq * sampleTime * unisonAStart;\n\t\t\t\ttone.phaseDeltas[1] = startFreq * sampleTime * unisonBStart;\n\t\t\t\ttone.phaseDeltaScales[0] = basePhaseDeltaScale * Math.pow(unisonAEnd / unisonAStart, 1.0 / runLength);\n\t\t\t\ttone.phaseDeltaScales[1] = basePhaseDeltaScale * Math.pow(unisonBEnd / unisonBStart, 1.0 / runLength);\n\t\t\t} else {\n\t\t\t\ttone.phaseDeltas[0] = startFreq * sampleTime;\n\t\t\t\ttone.phaseDeltaScales[0] = basePhaseDeltaScale;\n\t\t\t}\n\t\t\t\n\t\t\tlet expressionStart: number = settingsExpressionMult * transitionExpressionStart * chordExpressionStart * pitchExpressionStart * envelopeStarts[NoteAutomationIndex.noteVolume];\n\t\t\tlet expressionEnd:   number = settingsExpressionMult * transitionExpressionEnd   * chordExpressionEnd   * pitchExpressionEnd   * envelopeEnds[  NoteAutomationIndex.noteVolume];\n\t\t\ttone.expressionStarts[0] = expressionStart;\n\t\t\ttone.expressionDeltas[0] = (expressionEnd - expressionStart) / runLength;\n\t\t}\n\t}\n\t\n\tpublic static getLFOAmplitude(instrument: Instrument, secondsIntoBar: number): number {\n\t\tlet effect: number = 0.0;\n\t\tfor (const vibratoPeriodSeconds of Config.vibratos[instrument.vibrato].periodsSeconds) {\n\t\t\teffect += Math.sin(Math.PI * 2.0 * secondsIntoBar / vibratoPeriodSeconds);\n\t\t}\n\t\treturn effect;\n\t}\n\t\n\tprivate static getInstrumentSynthFunction(instrument: Instrument): Function {\n\t\tif (instrument.type == InstrumentType.fm) {\n\t\t\tconst fingerprint: string = instrument.algorithm + \"_\" + instrument.feedbackType;\n\t\t\tif (Synth.fmSynthFunctionCache[fingerprint] == undefined) {\n\t\t\t\tconst synthSource: string[] = [];\n\t\t\t\t\n\t\t\t\tfor (const line of Synth.fmSourceTemplate) {\n\t\t\t\t\tif (line.indexOf(\"// CARRIER OUTPUTS\") != -1) {\n\t\t\t\t\t\tconst outputs: string[] = [];\n\t\t\t\t\t\tfor (let j: number = 0; j < Config.algorithms[instrument.algorithm].carrierCount; j++) {\n\t\t\t\t\t\t\toutputs.push(\"operator\" + j + \"Scaled\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsynthSource.push(line.replace(\"/*operator#Scaled*/\", outputs.join(\" + \")));\n\t\t\t\t\t} else if (line.indexOf(\"// INSERT OPERATOR COMPUTATION HERE\") != -1) {\n\t\t\t\t\t\tfor (let j: number = Config.operatorCount - 1; j >= 0; j--) {\n\t\t\t\t\t\t\tfor (const operatorLine of Synth.operatorSourceTemplate) {\n\t\t\t\t\t\t\t\tif (operatorLine.indexOf(\"/* + operator@Scaled*/\") != -1) {\n\t\t\t\t\t\t\t\t\tlet modulators = \"\";\n\t\t\t\t\t\t\t\t\tfor (const modulatorNumber of Config.algorithms[instrument.algorithm].modulatedBy[j]) {\n\t\t\t\t\t\t\t\t\t\tmodulators += \" + operator\" + (modulatorNumber - 1) + \"Scaled\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tconst feedbackIndices: ReadonlyArray<number> = Config.feedbacks[instrument.feedbackType].indices[j];\n\t\t\t\t\t\t\t\t\tif (feedbackIndices.length > 0) {\n\t\t\t\t\t\t\t\t\t\tmodulators += \" + feedbackMult * (\";\n\t\t\t\t\t\t\t\t\t\tconst feedbacks: string[] = [];\n\t\t\t\t\t\t\t\t\t\tfor (const modulatorNumber of feedbackIndices) {\n\t\t\t\t\t\t\t\t\t\t\tfeedbacks.push(\"operator\" + (modulatorNumber - 1) + \"Output\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tmodulators += feedbacks.join(\" + \") + \")\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tsynthSource.push(operatorLine.replace(/\\#/g, j + \"\").replace(\"/* + operator@Scaled*/\", modulators));\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tsynthSource.push(operatorLine.replace(/\\#/g, j + \"\"));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (line.indexOf(\"#\") != -1) {\n\t\t\t\t\t\tfor (let j: number = 0; j < Config.operatorCount; j++) {\n\t\t\t\t\t\t\tsynthSource.push(line.replace(/\\#/g, j + \"\"));\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsynthSource.push(line);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//console.log(synthSource.join(\"\\n\"));\n\t\t\t\t\n\t\t\t\tSynth.fmSynthFunctionCache[fingerprint] = new Function(\"synth\", \"bufferIndex\", \"runLength\", \"tone\", \"instrument\", synthSource.join(\"\\n\"));\n\t\t\t}\n\t\t\treturn Synth.fmSynthFunctionCache[fingerprint];\n\t\t} else if (instrument.type == InstrumentType.chip) {\n\t\t\treturn Synth.chipSynth;\n\t\t} else if (instrument.type == InstrumentType.harmonics) {\n\t\t\treturn Synth.harmonicsSynth;\n\t\t} else if (instrument.type == InstrumentType.pwm) {\n\t\t\treturn Synth.pulseWidthSynth;\n\t\t} else if (instrument.type == InstrumentType.pickedString) {\n\t\t\treturn Synth.pickedStringSynth;\n\t\t} else if (instrument.type == InstrumentType.noise) {\n\t\t\treturn Synth.noiseSynth;\n\t\t} else if (instrument.type == InstrumentType.spectrum) {\n\t\t\treturn Synth.spectrumSynth;\n\t\t} else if (instrument.type == InstrumentType.drumset) {\n\t\t\treturn Synth.drumsetSynth;\n\t\t} else {\n\t\t\tthrow new Error(\"Unrecognized instrument type: \" + instrument.type);\n\t\t}\n\t}\n\t\n\tprivate static chipSynth(synth: Synth, bufferIndex: number, runLength: number, tone: Tone, instrument: Instrument): void {\n\t\tconst data: Float32Array = synth.tempMonoInstrumentSampleBuffer!;\n\t\tconst wave: Float64Array = Config.chipWaves[instrument.chipWave].samples;\n\t\tconst waveLength: number = wave.length - 1; // The first sample is duplicated at the end, don't double-count it.\n\t\t\n\t\tconst unisonSign: number = tone.specialIntervalExpressionMult * Config.unisons[instrument.unison].sign;\n\t\tif (instrument.unison == 0 && !instrument.getChord().customInterval) tone.phases[1] = tone.phases[0];\n\t\tlet phaseDeltaA: number = tone.phaseDeltas[0] * waveLength;\n\t\tlet phaseDeltaB: number = tone.phaseDeltas[1] * waveLength;\n\t\tconst phaseDeltaScaleA: number = +tone.phaseDeltaScales[0];\n\t\tconst phaseDeltaScaleB: number = +tone.phaseDeltaScales[1];\n\t\tlet expression: number = +tone.expressionStarts[0];\n\t\tconst expressionDelta: number = +tone.expressionDeltas[0];\n\t\tlet phaseA: number = (tone.phases[0] % 1) * waveLength;\n\t\tlet phaseB: number = (tone.phases[1] % 1) * waveLength;\n\t\t\n\t\tconst filters: DynamicBiquadFilter[] = tone.noteFilters;\n\t\tconst filterCount: number = tone.noteFilterCount|0;\n\t\tlet initialFilterInput1: number = +tone.initialNoteFilterInput1;\n\t\tlet initialFilterInput2: number = +tone.initialNoteFilterInput2;\n\t\tconst applyFilters: Function = Synth.applyFilters;\n\t\t\n\t\tconst phaseAInt: number = phaseA|0;\n\t\tconst phaseBInt: number = phaseB|0;\n\t\tconst indexA: number = phaseAInt % waveLength;\n\t\tconst indexB: number = phaseBInt % waveLength;\n\t\tconst phaseRatioA: number = phaseA - phaseAInt;\n\t\tconst phaseRatioB: number = phaseB - phaseBInt;\n\t\tlet prevWaveIntegralA: number = +wave[indexA];\n\t\tlet prevWaveIntegralB: number = +wave[indexB];\n\t\tprevWaveIntegralA += (wave[indexA+1] - prevWaveIntegralA) * phaseRatioA;\n\t\tprevWaveIntegralB += (wave[indexB+1] - prevWaveIntegralB) * phaseRatioB;\n\t\t\n\t\tconst stopIndex: number = bufferIndex + runLength;\n\t\tfor (let sampleIndex: number = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\t\n\t\t\tphaseA += phaseDeltaA;\n\t\t\tphaseB += phaseDeltaB;\n\t\t\t\n\t\t\tconst phaseAInt: number = phaseA|0;\n\t\t\tconst phaseBInt: number = phaseB|0;\n\t\t\tconst indexA: number = phaseAInt % waveLength;\n\t\t\tconst indexB: number = phaseBInt % waveLength;\n\t\t\tlet nextWaveIntegralA: number = wave[indexA];\n\t\t\tlet nextWaveIntegralB: number = wave[indexB];\n\t\t\tconst phaseRatioA: number = phaseA - phaseAInt;\n\t\t\tconst phaseRatioB: number = phaseB - phaseBInt;\n\t\t\tnextWaveIntegralA += (wave[indexA+1] - nextWaveIntegralA) * phaseRatioA;\n\t\t\tnextWaveIntegralB += (wave[indexB+1] - nextWaveIntegralB) * phaseRatioB;\n\t\t\tconst waveA: number = (nextWaveIntegralA - prevWaveIntegralA) / phaseDeltaA;\n\t\t\tconst waveB: number = (nextWaveIntegralB - prevWaveIntegralB) / phaseDeltaB;\n\t\t\tprevWaveIntegralA = nextWaveIntegralA;\n\t\t\tprevWaveIntegralB = nextWaveIntegralB;\n\t\t\t\n\t\t\tconst inputSample: number = waveA + waveB * unisonSign;\n\t\t\tconst sample: number = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\tinitialFilterInput1 = inputSample;\n\t\t\t\n\t\t\tphaseDeltaA *= phaseDeltaScaleA;\n\t\t\tphaseDeltaB *= phaseDeltaScaleB;\n\t\t\t\n\t\t\tconst output: number = sample * expression;\n\t\t\texpression += expressionDelta;\n\t\t\t\n\t\t\tdata[sampleIndex] += output;\n\t\t}\n\t\t\n\t\ttone.phases[0] = phaseA / waveLength;\n\t\ttone.phases[1] = phaseB / waveLength;\n\t\t\n\t\tsynth.sanitizeFilters(filters);\n\t\ttone.initialNoteFilterInput1 = initialFilterInput1;\n\t\ttone.initialNoteFilterInput2 = initialFilterInput2;\n\t}\n\t\n\tprivate static harmonicsSynth(synth: Synth, bufferIndex: number, runLength: number, tone: Tone, instrument: Instrument): void {\n\t\tconst data: Float32Array = synth.tempMonoInstrumentSampleBuffer!;\n\t\tconst wave: Float32Array = instrument.harmonicsWave.getCustomWave(instrument.type);\n\t\tconst waveLength: number = wave.length - 1; // The first sample is duplicated at the end, don't double-count it.\n\t\t\n\t\tconst unisonSign: number = tone.specialIntervalExpressionMult * Config.unisons[instrument.unison].sign;\n\t\tif (instrument.unison == 0 && !instrument.getChord().customInterval) tone.phases[1] = tone.phases[0];\n\t\tlet phaseDeltaA: number = tone.phaseDeltas[0] * waveLength;\n\t\tlet phaseDeltaB: number = tone.phaseDeltas[1] * waveLength;\n\t\tconst phaseDeltaScaleA: number = +tone.phaseDeltaScales[0];\n\t\tconst phaseDeltaScaleB: number = +tone.phaseDeltaScales[1];\n\t\tlet expression: number = +tone.expressionStarts[0];\n\t\tconst expressionDelta: number = +tone.expressionDeltas[0];\n\t\tlet phaseA: number = (tone.phases[0] % 1) * waveLength;\n\t\tlet phaseB: number = (tone.phases[1] % 1) * waveLength;\n\t\t\n\t\tconst filters: DynamicBiquadFilter[] = tone.noteFilters;\n\t\tconst filterCount: number = tone.noteFilterCount|0;\n\t\tlet initialFilterInput1: number = +tone.initialNoteFilterInput1;\n\t\tlet initialFilterInput2: number = +tone.initialNoteFilterInput2;\n\t\tconst applyFilters: Function = Synth.applyFilters;\n\t\t\n\t\tconst phaseAInt: number = phaseA|0;\n\t\tconst phaseBInt: number = phaseB|0;\n\t\tconst indexA: number = phaseAInt % waveLength;\n\t\tconst indexB: number = phaseBInt % waveLength;\n\t\tconst phaseRatioA: number = phaseA - phaseAInt;\n\t\tconst phaseRatioB: number = phaseB - phaseBInt;\n\t\tlet prevWaveIntegralA: number = +wave[indexA];\n\t\tlet prevWaveIntegralB: number = +wave[indexB];\n\t\tprevWaveIntegralA += (wave[indexA+1] - prevWaveIntegralA) * phaseRatioA;\n\t\tprevWaveIntegralB += (wave[indexB+1] - prevWaveIntegralB) * phaseRatioB;\n\t\t\n\t\tconst stopIndex: number = bufferIndex + runLength;\n\t\tfor (let sampleIndex: number = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\t\n\t\t\tphaseA += phaseDeltaA;\n\t\t\tphaseB += phaseDeltaB;\n\t\t\t\n\t\t\tconst phaseAInt: number = phaseA|0;\n\t\t\tconst phaseBInt: number = phaseB|0;\n\t\t\tconst indexA: number = phaseAInt % waveLength;\n\t\t\tconst indexB: number = phaseBInt % waveLength;\n\t\t\tlet nextWaveIntegralA: number = wave[indexA];\n\t\t\tlet nextWaveIntegralB: number = wave[indexB];\n\t\t\tconst phaseRatioA: number = phaseA - phaseAInt;\n\t\t\tconst phaseRatioB: number = phaseB - phaseBInt;\n\t\t\tnextWaveIntegralA += (wave[indexA+1] - nextWaveIntegralA) * phaseRatioA;\n\t\t\tnextWaveIntegralB += (wave[indexB+1] - nextWaveIntegralB) * phaseRatioB;\n\t\t\tconst waveA: number = (nextWaveIntegralA - prevWaveIntegralA) / phaseDeltaA;\n\t\t\tconst waveB: number = (nextWaveIntegralB - prevWaveIntegralB) / phaseDeltaB;\n\t\t\tprevWaveIntegralA = nextWaveIntegralA;\n\t\t\tprevWaveIntegralB = nextWaveIntegralB;\n\t\t\t\n\t\t\tconst inputSample: number = waveA + waveB * unisonSign;\n\t\t\tconst sample: number = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\tinitialFilterInput1 = inputSample;\n\t\t\t\n\t\t\tphaseDeltaA *= phaseDeltaScaleA;\n\t\t\tphaseDeltaB *= phaseDeltaScaleB;\n\t\t\t\n\t\t\tconst output: number = sample * expression;\n\t\t\texpression += expressionDelta;\n\t\t\t\n\t\t\tdata[sampleIndex] += output;\n\t\t}\n\t\t\n\t\ttone.phases[0] = phaseA / waveLength;\n\t\ttone.phases[1] = phaseB / waveLength;\n\t\t\n\t\tsynth.sanitizeFilters(filters);\n\t\ttone.initialNoteFilterInput1 = initialFilterInput1;\n\t\ttone.initialNoteFilterInput2 = initialFilterInput2;\n\t}\n\t\n\tprivate static pickedStringSynth(synth: Synth, bufferIndex: number, runLength: number, tone: Tone, instrument: Instrument): void {\n\t\t// This algorithm is similar to the Karpluss-Strong algorithm in principle, but with an\n\t\t// all-pass filter for dispersion and with more control over the impulse.\n\t\t// The source code is processed as a string before being compiled, in order to\n\t\t// handle the unison feature. If unison is disabled or set to none, then only one\n\t\t// string voice is required, otherwise two string voices are required. We only want\n\t\t// to compute the minimum possible number of string voices, so omit the code for\n\t\t// processing extra ones if possible. Any line containing a \"#\" is duplicated for\n\t\t// each required voice, replacing the \"#\" with the voice index.\n\t\t\n\t\tconst voiceCount: number = Config.unisons[instrument.unison].voices;\n\t\tlet pickedStringFunction: Function = Synth.pickedStringFunctionCache[voiceCount];\n\t\tif (pickedStringFunction == undefined) {\n\t\t\tlet pickedStringSource: string = \"\";\n\t\t\t\n\t\t\tpickedStringSource += `\n\t\t\t\t\n\t\t\t\tconst Config = beepbox.Config;\n\t\t\t\tconst Synth = beepbox.Synth;\n\t\t\t\tconst NoteAutomationStringSustainIndex = ${NoteAutomationIndex.stringSustain};\n\t\t\t\tconst voiceCount = ${voiceCount};\n\t\t\t\tconst data = synth.tempMonoInstrumentSampleBuffer;\n\t\t\t\t\n\t\t\t\tconst sustainEnvelopeStart = tone.envelopeComputer.envelopeStarts[NoteAutomationStringSustainIndex];\n\t\t\t\tconst sustainEnvelopeEnd   = tone.envelopeComputer.envelopeEnds[  NoteAutomationStringSustainIndex];\n\t\t\t\tconst stringDecayStart = 1.0 - Math.min(1.0, sustainEnvelopeStart * instrument.stringSustain / (Config.stringSustainRange - 1));\n\t\t\t\tconst stringDecayEnd   = 1.0 - Math.min(1.0, sustainEnvelopeEnd   * instrument.stringSustain / (Config.stringSustainRange - 1));\n\t\t\t\t\n\t\t\t\tlet pickedString# = tone.pickedStrings[#];\n\t\t\t\t\n\t\t\t\tconst prevDelayLength# = +pickedString#.prevDelayLength;\n\t\t\t\tlet allPassSample# = +pickedString#.allPassSample;\n\t\t\t\tlet allPassPrevInput# = +pickedString#.allPassPrevInput;\n\t\t\t\tlet shelfSample# = +pickedString#.shelfSample;\n\t\t\t\tlet shelfPrevInput# = +pickedString#.shelfPrevInput;\n\t\t\t\tlet fractionalDelaySample# = +pickedString#.fractionalDelaySample;\n\t\t\t\t\n\t\t\t\tlet expression = +tone.expressionStarts[0];\n\t\t\t\tconst expressionDelta = +tone.expressionDeltas[0];\n\t\t\t\t\n\t\t\t\tconst phaseDeltaStart# = +tone.phaseDeltas[#];\n\t\t\t\tconst phaseDeltaScale# = +tone.phaseDeltaScales[#];\n\t\t\t\tconst phaseDeltaEnd# = phaseDeltaStart# * Math.pow(phaseDeltaScale#, runLength);\n\t\t\t\t\n\t\t\t\tconst radiansPerSampleStart# = Math.PI * 2.0 * phaseDeltaStart#;\n\t\t\t\tconst radiansPerSampleEnd#   = Math.PI * 2.0 * phaseDeltaEnd#;\n\t\t\t\t\n\t\t\t\tconst centerHarmonicStart# = radiansPerSampleStart# * 2.0;\n\t\t\t\tconst centerHarmonicEnd#   = radiansPerSampleEnd# * 2.0;\n\t\t\t\t\n\t\t\t\tconst allPassCenter = 2.0 * Math.PI * Config.pickedStringDispersionCenterFreq / synth.samplesPerSecond;\n\t\t\t\tconst allPassRadiansStart# = Math.min(Math.PI, radiansPerSampleStart# * Config.pickedStringDispersionFreqMult * Math.pow(allPassCenter / radiansPerSampleStart#, Config.pickedStringDispersionFreqScale));\n\t\t\t\tconst allPassRadiansEnd# = Math.min(Math.PI, radiansPerSampleEnd# * Config.pickedStringDispersionFreqMult * Math.pow(allPassCenter / radiansPerSampleEnd#, Config.pickedStringDispersionFreqScale));\n\t\t\t\t\n\t\t\t\tconst shelfRadians = 2.0 * Math.PI * Config.pickedStringShelfHz / synth.samplesPerSecond;\n\t\t\t\tconst decayCurveStart = (Math.pow(100.0, stringDecayStart) - 1.0) / 99.0;\n\t\t\t\tconst decayCurveEnd   = (Math.pow(100.0, stringDecayEnd  ) - 1.0) / 99.0;\n\t\t\t\tconst decayRateStart# = Math.pow(0.5, decayCurveStart * shelfRadians / radiansPerSampleStart#);\n\t\t\t\tconst decayRateEnd#   = Math.pow(0.5, decayCurveEnd   * shelfRadians / radiansPerSampleEnd#);\n\t\t\t\tconst shelfGainStart# = Math.pow(decayRateStart#, Config.stringDecayRate);\n\t\t\t\tconst shelfGainEnd#   = Math.pow(decayRateEnd#,   Config.stringDecayRate);\n\t\t\t\tconst expressionDecayStart# = Math.pow(decayRateStart#, 0.002);\n\t\t\t\tconst expressionDecayEnd#   = Math.pow(decayRateEnd#,   0.002);`\n\t\t\t\n\t\t\tfor (let voice: number = 0; voice < voiceCount; voice++) {\n\t\t\t\tpickedStringSource += `\n\t\t\t\t\n\t\t\t\tSynth.tempFilterStartCoefficients.allPass1stOrderInvertPhaseAbove(allPassRadiansStart#);\n\t\t\t\tsynth.tempFrequencyResponse.analyze(Synth.tempFilterStartCoefficients, centerHarmonicStart#);\n\t\t\t\tlet allPassG# = +Synth.tempFilterStartCoefficients.b[0]; /* same as a[1] */\n\t\t\t\tconst allPassPhaseDelayStart# = -synth.tempFrequencyResponse.angle() / centerHarmonicStart#;\n\t\t\t\t\n\t\t\t\tSynth.tempFilterEndCoefficients.allPass1stOrderInvertPhaseAbove(allPassRadiansEnd#);\n\t\t\t\tsynth.tempFrequencyResponse.analyze(Synth.tempFilterEndCoefficients, centerHarmonicEnd#);\n\t\t\t\tconst allPassGEnd# = +Synth.tempFilterEndCoefficients.b[0]; /* same as a[1] */\n\t\t\t\tconst allPassPhaseDelayEnd# = -synth.tempFrequencyResponse.angle() / centerHarmonicEnd#;\n\t\t\t\t\n\t\t\t\tSynth.tempFilterStartCoefficients.highShelf1stOrder(shelfRadians, shelfGainStart#);\n\t\t\t\tsynth.tempFrequencyResponse.analyze(Synth.tempFilterStartCoefficients, centerHarmonicStart#)\n\t\t\t\tlet shelfA1# = +Synth.tempFilterStartCoefficients.a[1]\n\t\t\t\tlet shelfB0# = Synth.tempFilterStartCoefficients.b[0] * expressionDecayStart#\n\t\t\t\tlet shelfB1# = Synth.tempFilterStartCoefficients.b[1] * expressionDecayStart#\n\t\t\t\tconst shelfPhaseDelayStart# = -synth.tempFrequencyResponse.angle() / centerHarmonicStart#;\n\t\t\t\t\n\t\t\t\tSynth.tempFilterEndCoefficients.highShelf1stOrder(shelfRadians, shelfGainEnd#)\n\t\t\t\tsynth.tempFrequencyResponse.analyze(Synth.tempFilterEndCoefficients, centerHarmonicEnd#)\n\t\t\t\tconst shelfA1End# = +Synth.tempFilterEndCoefficients.a[1]\n\t\t\t\tconst shelfB0End# = Synth.tempFilterEndCoefficients.b[0] * expressionDecayEnd#\n\t\t\t\tconst shelfB1End# = Synth.tempFilterEndCoefficients.b[1] * expressionDecayEnd#\n\t\t\t\tconst shelfPhaseDelayEnd# = -synth.tempFrequencyResponse.angle() / centerHarmonicEnd#;`.replace(/\\#/g, String(voice));\n\t\t\t}\n\t\t\t\n\t\t\tpickedStringSource += `\n\t\t\t\t\n\t\t\t\tconst periodLengthStart# = 1.0 / phaseDeltaStart#;\n\t\t\t\tconst periodLengthEnd# = 1.0 / phaseDeltaEnd#;\n\t\t\t\tconst minBufferLength# = Math.ceil(Math.max(periodLengthStart#, periodLengthEnd#) * 2);\n\t\t\t\tlet delayLength# = periodLengthStart# - allPassPhaseDelayStart# - shelfPhaseDelayStart#;\n\t\t\t\tconst delayLengthEnd# = periodLengthEnd# - allPassPhaseDelayEnd# - shelfPhaseDelayEnd#;\n\t\t\t\t\n\t\t\t\tconst delayLengthDelta# = (delayLengthEnd# - delayLength#) / runLength;\n\t\t\t\tconst allPassGDelta# = (allPassGEnd# - allPassG#) / runLength;\n\t\t\t\tconst shelfA1Delta# = (shelfA1End# - shelfA1#) / runLength;\n\t\t\t\tconst shelfB0Delta# = (shelfB0End# - shelfB0#) / runLength;\n\t\t\t\tconst shelfB1Delta# = (shelfB1End# - shelfB1#) / runLength;\n\t\t\t\t\n\t\t\t\tconst filters = tone.noteFilters;\n\t\t\t\tconst filterCount = tone.noteFilterCount|0;\n\t\t\t\tlet initialFilterInput1 = +tone.initialNoteFilterInput1;\n\t\t\t\tlet initialFilterInput2 = +tone.initialNoteFilterInput2;\n\t\t\t\tconst applyFilters = Synth.applyFilters;\n\t\t\t\t\n\t\t\t\tconst pitchChanged# = Math.abs(Math.log2(delayLength# / prevDelayLength#)) > 0.01;\n\t\t\t\tlet delayIndex# = pickedString#.delayIndex|0;`\n\t\t\t\n\t\t\tfor (let voice: number = 0; voice < voiceCount; voice++) {\n\t\t\t\tpickedStringSource += `\n\t\t\t\t\n\t\t\t\tconst reinitializeImpulse# = (delayIndex# == -1 || pitchChanged#);\n\t\t\t\tif (pickedString#.delayLine == null || pickedString#.delayLine.length <= minBufferLength#) {\n\t\t\t\t\t// The delay line buffer will get reused for other tones so might as well\n\t\t\t\t\t// start off with a buffer size that is big enough for most notes.\n\t\t\t\t\tconst likelyMaximumLength = Math.ceil(2 * synth.samplesPerSecond / beepbox.Instrument.frequencyFromPitch(12));\n\t\t\t\t\tconst newDelayLine = new Float32Array(Synth.fittingPowerOfTwo(Math.max(likelyMaximumLength, minBufferLength#)));\n\t\t\t\t\tif (!reinitializeImpulse# && pickedString#.delayLine != null) {\n\t\t\t\t\t\t// If the tone has already started but the buffer needs to be reallocated,\n\t\t\t\t\t\t// transfer the old data to the new buffer.\n\t\t\t\t\t\tconst oldDelayBufferMask = (pickedString#.delayLine.length - 1) >> 0;\n\t\t\t\t\t\tconst startCopyingFromIndex = delayIndex# + pickedString#.delayResetOffset;\n\t\t\t\t\t\tdelayIndex# = pickedString#.delayLine.length - pickedString#.delayResetOffset;\n\t\t\t\t\t\tfor (let i = 0; i < pickedString#.delayLine.length; i++) {\n\t\t\t\t\t\t\tnewDelayLine[i] = pickedString#.delayLine[(startCopyingFromIndex + i) & oldDelayBufferMask];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tpickedString#.delayLine = newDelayLine;\n\t\t\t\t}\n\t\t\t\tconst delayLine# = pickedString#.delayLine;\n\t\t\t\tconst delayBufferMask# = (delayLine#.length - 1) >> 0;\n\t\t\t\t\n\t\t\t\tif (reinitializeImpulse#) {\n\t\t\t\t\t// -1 delay index means the tone was reset.\n\t\t\t\t\t// Also, if the pitch changed suddenly (e.g. from seamless or arpeggio) then reset the wave.\n\t\t\t\t\t\n\t\t\t\t\tdelayIndex# = 0;\n\t\t\t\t\tallPassSample# = 0.0;\n\t\t\t\t\tallPassPrevInput# = 0.0;\n\t\t\t\t\tshelfSample# = 0.0;\n\t\t\t\t\tshelfPrevInput# = 0.0;\n\t\t\t\t\tfractionalDelaySample# = 0.0;\n\t\t\t\t\t\n\t\t\t\t\t// Clear away a region of the delay buffer for the new impulse.\n\t\t\t\t\tconst startImpulseFrom = -delayLength#;\n\t\t\t\t\tconst startZerosFrom = Math.floor(startImpulseFrom - periodLengthStart# / 2);\n\t\t\t\t\tconst stopZerosAt = Math.ceil(startZerosFrom + periodLengthStart# * 2);\n\t\t\t\t\tpickedString#.delayResetOffset = stopZerosAt; // And continue clearing the area in front of the delay line.\n\t\t\t\t\tfor (let i = startZerosFrom; i <= stopZerosAt; i++) {\n\t\t\t\t\t\tdelayLine#[i & delayBufferMask#] = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst impulseWave = instrument.harmonicsWave.getCustomWave(instrument.type);\n\t\t\t\t\tconst impulseWaveLength = impulseWave.length - 1; // The first sample is duplicated at the end, don't double-count it.\n\t\t\t\t\tconst impulsePhaseDelta = impulseWaveLength / periodLengthStart#;\n\t\t\t\t\t\n\t\t\t\t\tconst fadeDuration = Math.min(periodLengthStart# * 0.2, synth.samplesPerSecond * 0.003);\n\t\t\t\t\tconst startImpulseFromSample = Math.ceil(startImpulseFrom);\n\t\t\t\t\tconst stopImpulseAt = startImpulseFrom + periodLengthStart# + fadeDuration;\n\t\t\t\t\tconst stopImpulseAtSample = stopImpulseAt;\n\t\t\t\t\tlet impulsePhase = (startImpulseFromSample - startImpulseFrom) * impulsePhaseDelta;\n\t\t\t\t\tlet prevWaveIntegral = 0.0;\n\t\t\t\t\tfor (let i = startImpulseFromSample; i <= stopImpulseAtSample; i++) {\n\t\t\t\t\t\tconst impulsePhaseInt = impulsePhase|0;\n\t\t\t\t\t\tconst index = impulsePhaseInt % impulseWaveLength;\n\t\t\t\t\t\tlet nextWaveIntegral = impulseWave[index];\n\t\t\t\t\t\tconst phaseRatio = impulsePhase - impulsePhaseInt;\n\t\t\t\t\t\tnextWaveIntegral += (impulseWave[index+1] - nextWaveIntegral) * phaseRatio;\n\t\t\t\t\t\tconst sample = (nextWaveIntegral - prevWaveIntegral) / impulsePhaseDelta;\n\t\t\t\t\t\tconst fadeIn = Math.min(1.0, (i - startImpulseFrom) / fadeDuration);\n\t\t\t\t\t\tconst fadeOut = Math.min(1.0, (stopImpulseAt - i) / fadeDuration);\n\t\t\t\t\t\tconst combinedFade = fadeIn * fadeOut;\n\t\t\t\t\t\tconst curvedFade = combinedFade * combinedFade * (3.0 - 2.0 * combinedFade); // A cubic sigmoid from 0 to 1.\n\t\t\t\t\t\tdelayLine#[i & delayBufferMask#] += sample * curvedFade;\n\t\t\t\t\t\tprevWaveIntegral = nextWaveIntegral;\n\t\t\t\t\t\timpulsePhase += impulsePhaseDelta;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdelayIndex# = (delayIndex# & delayBufferMask#) + delayLine#.length;`.replace(/\\#/g, String(voice));\n\t\t\t}\n\t\t\t\n\t\t\tpickedStringSource += `\n\t\t\t\t\n\t\t\t\tconst unisonSign = tone.specialIntervalExpressionMult * Config.unisons[instrument.unison].sign;\n\t\t\t\tconst delayResetOffset# = pickedString#.delayResetOffset|0;\n\t\t\t\t\n\t\t\t\tconst stopIndex = bufferIndex + runLength;\n\t\t\t\tfor (let sampleIndex = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\t\t\tconst targetSampleTime# = delayIndex# - delayLength#;\n\t\t\t\t\tconst lowerIndex# = (targetSampleTime# + 0.125) | 0; // Offset to improve stability of all-pass filter.\n\t\t\t\t\tconst upperIndex# = lowerIndex# + 1;\n\t\t\t\t\tconst fractionalDelay# = upperIndex# - targetSampleTime#;\n\t\t\t\t\tconst fractionalDelayG# = (1.0 - fractionalDelay#) / (1.0 + fractionalDelay#); // Inlined version of FilterCoefficients.prototype.allPass1stOrderFractionalDelay\n\t\t\t\t\tconst prevInput# = delayLine#[lowerIndex# & delayBufferMask#];\n\t\t\t\t\tconst input# = delayLine#[upperIndex# & delayBufferMask#];\n\t\t\t\t\tfractionalDelaySample# = fractionalDelayG# * input# + prevInput# - fractionalDelayG# * fractionalDelaySample#;\n\t\t\t\t\t\n\t\t\t\t\tallPassSample# = fractionalDelaySample# * allPassG# + allPassPrevInput# - allPassG# * allPassSample#;\n\t\t\t\t\tallPassPrevInput# = fractionalDelaySample#;\n\t\t\t\t\t\n\t\t\t\t\tshelfSample# = shelfB0# * allPassSample# + shelfB1# * shelfPrevInput# - shelfA1# * shelfSample#;\n\t\t\t\t\tshelfPrevInput# = allPassSample#;\n\t\t\t\t\t\n\t\t\t\t\tdelayLine#[delayIndex# & delayBufferMask#] += shelfSample#;\n\t\t\t\t\tdelayLine#[(delayIndex# + delayResetOffset#) & delayBufferMask#] = 0.0;\n\t\t\t\t\tdelayIndex#++;\n\t\t\t\t\t\n\t\t\t\t\tconst inputSample = (`\n\t\t\t\n\t\t\tconst sampleList: string[] = [];\n\t\t\tfor (let voice: number = 0; voice < voiceCount; voice++) {\n\t\t\t\tsampleList.push(\"fractionalDelaySample\" + voice + (voice == 1 ? \" * unisonSign\" : \"\"));\n\t\t\t}\n\t\t\t\n\t\t\tpickedStringSource += sampleList.join(\" + \");\n\t\t\t\n\t\t\tpickedStringSource += `) * expression;\n\t\t\t\t\tconst sample = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\t\t\tinitialFilterInput1 = inputSample;\n\t\t\t\t\tdata[sampleIndex] += sample;\n\t\t\t\t\t\n\t\t\t\t\texpression += expressionDelta;\n\t\t\t\t\tdelayLength# += delayLengthDelta#;\n\t\t\t\t\tallPassG# += allPassGDelta#;\n\t\t\t\t\tshelfA1# += shelfA1Delta#;\n\t\t\t\t\tshelfB0# += shelfB0Delta#;\n\t\t\t\t\tshelfB1# += shelfB1Delta#;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Avoid persistent denormal or NaN values in the delay buffers and filter history.\n\t\t\t\tconst epsilon = (1.0e-24);\n\t\t\t\tif (!Number.isFinite(allPassSample#) || Math.abs(allPassSample#) < epsilon) allPassSample# = 0.0;\n\t\t\t\tif (!Number.isFinite(allPassPrevInput#) || Math.abs(allPassPrevInput#) < epsilon) allPassPrevInput# = 0.0;\n\t\t\t\tif (!Number.isFinite(shelfSample#) || Math.abs(shelfSample#) < epsilon) shelfSample# = 0.0;\n\t\t\t\tif (!Number.isFinite(shelfPrevInput#) || Math.abs(shelfPrevInput#) < epsilon) shelfPrevInput# = 0.0;\n\t\t\t\tif (!Number.isFinite(fractionalDelaySample#) || Math.abs(fractionalDelaySample#) < epsilon) fractionalDelaySample# = 0.0;\n\t\t\t\tpickedString#.allPassSample = allPassSample#;\n\t\t\t\tpickedString#.allPassPrevInput = allPassPrevInput#;\n\t\t\t\tpickedString#.shelfSample = shelfSample#;\n\t\t\t\tpickedString#.shelfPrevInput = shelfPrevInput#;\n\t\t\t\tpickedString#.fractionalDelaySample = fractionalDelaySample#;\n\t\t\t\tpickedString#.delayIndex = delayIndex#;\n\t\t\t\tpickedString#.prevDelayLength = delayLength#;\n\t\t\t\t\n\t\t\t\tsynth.sanitizeFilters(filters);\n\t\t\t\ttone.initialNoteFilterInput1 = initialFilterInput1;\n\t\t\t\ttone.initialNoteFilterInput2 = initialFilterInput2;`\n\t\t\t\n\t\t\t// Duplicate lines containing \"#\" for each voice and replace the \"#\" with the voice index.\n\t\t\tpickedStringSource = pickedStringSource.replace(/^.*\\#.*$/mg, line => {\n\t\t\t\tconst lines = [];\n\t\t\t\tfor (let voice: number = 0; voice < voiceCount; voice++) {\n\t\t\t\t\tlines.push(line.replace(/\\#/g, String(voice)));\n\t\t\t\t}\n\t\t\t\treturn lines.join(\"\\n\");\n\t\t\t});\n\t\t\t\n\t\t\t//console.log(pickedStringSource);\n\t\t\tpickedStringFunction = new Function(\"synth\", \"bufferIndex\", \"runLength\", \"tone\", \"instrument\", pickedStringSource);\n\t\t\tSynth.pickedStringFunctionCache[voiceCount] = pickedStringFunction;\n\t\t}\n\t\t\n\t\tpickedStringFunction(synth, bufferIndex, runLength, tone, instrument);\n\t}\n\t\n\tprivate static effectsSynth(synth: Synth, outputDataL: Float32Array, outputDataR: Float32Array, bufferIndex: number, runLength: number, instrument: Instrument, instrumentState: InstrumentState): void {\n\t\t// TODO: If automation is involved, don't assume sliders will stay at zero.\n\t\tconst usesDistortion: boolean = effectsIncludeDistortion(instrument.effects) && instrument.distortion != 0;\n\t\tconst usesBitcrusher: boolean = effectsIncludeBitcrusher(instrument.effects);\n\t\tconst usesEqFilter: boolean = instrumentState.eqFilterCount > 0;\n\t\tconst usesPanning: boolean = effectsIncludePanning(instrument.effects) && instrument.pan != Config.panCenter;\n\t\tconst usesChorus: boolean = effectsIncludeChorus(instrument.effects) && instrument.chorus != 0;\n\t\tconst usesEcho: boolean = effectsIncludeEcho(instrument.effects) && instrument.echoSustain != 0;\n\t\tconst usesReverb: boolean = effectsIncludeReverb(instrument.effects) && instrument.reverb != 0;\n\t\tlet signature: number = 0;  if (usesDistortion) signature = signature | 1;\n\t\tsignature = signature << 1; if (usesBitcrusher) signature = signature | 1;\n\t\tsignature = signature << 1; if (usesEqFilter) signature = signature | 1;\n\t\tsignature = signature << 1; if (usesPanning) signature = signature | 1;\n\t\tsignature = signature << 1; if (usesChorus) signature = signature | 1;\n\t\tsignature = signature << 1; if (usesEcho) signature = signature | 1;\n\t\tsignature = signature << 1; if (usesReverb) signature = signature | 1;\n\t\t\n\t\tlet effectsFunction: Function = Synth.effectsFunctionCache[signature];\n\t\tif (effectsFunction == undefined) {\n\t\t\tlet effectsSource: string = \"\";\n\t\t\t\n\t\t\tconst usesDelays: boolean = usesChorus || usesReverb || usesEcho;\n\t\t\t\n\t\t\teffectsSource += `\n\t\t\t\tconst tempMonoInstrumentSampleBuffer = synth.tempMonoInstrumentSampleBuffer;\n\t\t\t\t\n\t\t\t\tlet mixVolume = +instrumentState.mixVolumeStart;\n\t\t\t\tconst mixVolumeDelta = +instrumentState.mixVolumeDelta;`\n\t\t\t\n\t\t\tif (usesDelays) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tlet delayInputMult = +instrumentState.delayInputMultStart;\n\t\t\t\tconst delayInputMultDelta = +instrumentState.delayInputMultDelta;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesDistortion) {\n\t\t\t\t// Distortion can sometimes create noticeable aliasing.\n\t\t\t\t// It seems the established industry best practice for distortion antialiasing\n\t\t\t\t// is to upsample the inputs (\"zero stuffing\" followed by a brick wall lowpass\n\t\t\t\t// at the original nyquist frequency), perform the distortion, then downsample\n\t\t\t\t// (the lowpass again followed by dropping in-between samples). This is\n\t\t\t\t// \"mathematically correct\" in that it preserves only the intended frequencies,\n\t\t\t\t// but it has several unfortunate tradeoffs depending on the choice of filter,\n\t\t\t\t// introducing latency and/or time smearing, since no true brick wall filter\n\t\t\t\t// exists. For the time being, I've opted to instead generate in-between input\n\t\t\t\t// samples using fractional delay all-pass filters, and after distorting them,\n\t\t\t\t// I \"downsample\" these with a simple weighted sum.\n\t\t\t\t\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tconst distortionBaseVolume = +beepbox.Config.distortionBaseVolume;\n\t\t\t\tconst distortionStart = +Math.pow(1.0 - 0.895 * (Math.pow(20.0, instrumentState.distortionStart) - 1.0) / 19.0, 2.0)\n\t\t\t\tconst distortionEnd   = +Math.pow(1.0 - 0.895 * (Math.pow(20.0, instrumentState.distortionEnd  ) - 1.0) / 19.0, 2.0)\n\t\t\t\tlet distortion = distortionStart;\n\t\t\t\tconst distortionDelta = (distortionEnd - distortionStart) / runLength;\n\t\t\t\tconst distortionDriveStart = (1.0 + 2.0 * instrumentState.distortionStart) / distortionBaseVolume;\n\t\t\t\tconst distortionDriveEnd   = (1.0 + 2.0 * instrumentState.distortionEnd)   / distortionBaseVolume;\n\t\t\t\tlet distortionDrive = distortionDriveStart;\n\t\t\t\tconst distortionDriveDelta = (distortionDriveEnd - distortionDriveStart) / runLength;\n\t\t\t\tconst distortionFractionalResolution = 4.0;\n\t\t\t\tconst distortionOversampleCompensation = distortionBaseVolume / distortionFractionalResolution;\n\t\t\t\tconst distortionFractionalDelay1 = 1.0 / distortionFractionalResolution;\n\t\t\t\tconst distortionFractionalDelay2 = 2.0 / distortionFractionalResolution;\n\t\t\t\tconst distortionFractionalDelay3 = 3.0 / distortionFractionalResolution;\n\t\t\t\tconst distortionFractionalDelayG1 = (1.0 - distortionFractionalDelay1) / (1.0 + distortionFractionalDelay1); // Inlined version of FilterCoefficients.prototype.allPass1stOrderFractionalDelay\n\t\t\t\tconst distortionFractionalDelayG2 = (1.0 - distortionFractionalDelay2) / (1.0 + distortionFractionalDelay2); // Inlined version of FilterCoefficients.prototype.allPass1stOrderFractionalDelay\n\t\t\t\tconst distortionFractionalDelayG3 = (1.0 - distortionFractionalDelay3) / (1.0 + distortionFractionalDelay3); // Inlined version of FilterCoefficients.prototype.allPass1stOrderFractionalDelay\n\t\t\t\tconst distortionNextOutputWeight1 = Math.cos(Math.PI * distortionFractionalDelay1) * 0.5 + 0.5;\n\t\t\t\tconst distortionNextOutputWeight2 = Math.cos(Math.PI * distortionFractionalDelay2) * 0.5 + 0.5;\n\t\t\t\tconst distortionNextOutputWeight3 = Math.cos(Math.PI * distortionFractionalDelay3) * 0.5 + 0.5;\n\t\t\t\tconst distortionPrevOutputWeight1 = 1.0 - distortionNextOutputWeight1;\n\t\t\t\tconst distortionPrevOutputWeight2 = 1.0 - distortionNextOutputWeight2;\n\t\t\t\tconst distortionPrevOutputWeight3 = 1.0 - distortionNextOutputWeight3;\n\t\t\t\t\n\t\t\t\tlet distortionFractionalInput1 = +instrumentState.distortionFractionalInput1;\n\t\t\t\tlet distortionFractionalInput2 = +instrumentState.distortionFractionalInput2;\n\t\t\t\tlet distortionFractionalInput3 = +instrumentState.distortionFractionalInput3;\n\t\t\t\tlet distortionPrevInput = +instrumentState.distortionPrevInput;\n\t\t\t\tlet distortionNextOutput = +instrumentState.distortionNextOutput;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesBitcrusher) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tlet bitcrusherPrevInput = +instrumentState.bitcrusherPrevInput;\n\t\t\t\tlet bitcrusherCurrentOutput = +instrumentState.bitcrusherCurrentOutput;\n\t\t\t\tlet bitcrusherPhase = +instrumentState.bitcrusherPhase;\n\t\t\t\tlet bitcrusherPhaseDelta = +instrumentState.bitcrusherPhaseDelta;\n\t\t\t\tconst bitcrusherPhaseDeltaScale = +instrumentState.bitcrusherPhaseDeltaScale;\n\t\t\t\tlet bitcrusherScale = +instrumentState.bitcrusherScale;\n\t\t\t\tconst bitcrusherScaleScale = +instrumentState.bitcrusherScaleScale;\n\t\t\t\tlet bitcrusherFoldLevel = +instrumentState.bitcrusherFoldLevel;\n\t\t\t\tconst bitcrusherFoldLevelScale = +instrumentState.bitcrusherFoldLevelScale;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesEqFilter) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tlet filters = instrumentState.eqFilters;\n\t\t\t\tconst filterCount = instrumentState.eqFilterCount|0;\n\t\t\t\tlet initialFilterInput1 = +instrumentState.initialEqFilterInput1;\n\t\t\t\tlet initialFilterInput2 = +instrumentState.initialEqFilterInput2;\n\t\t\t\tconst applyFilters = beepbox.Synth.applyFilters;`\n\t\t\t}\n\t\t\t\n\t\t\t// The eq filter volume is also used to fade out the instrument state, so always include it.\n\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tlet eqFilterVolume = +instrumentState.eqFilterVolumeStart;\n\t\t\t\tconst eqFilterVolumeDelta = +instrumentState.eqFilterVolumeDelta;`\n\t\t\t\n\t\t\tif (usesPanning) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tconst panningMask = synth.panningDelayBufferMask >>> 0;\n\t\t\t\tconst panningDelayLine = instrumentState.panningDelayLine;\n\t\t\t\tlet panningDelayPos = instrumentState.panningDelayPos & panningMask;\n\t\t\t\tlet   panningVolumeL      = +instrumentState.panningVolumeStartL;\n\t\t\t\tlet   panningVolumeR      = +instrumentState.panningVolumeStartR;\n\t\t\t\tconst panningVolumeDeltaL = +instrumentState.panningVolumeDeltaL;\n\t\t\t\tconst panningVolumeDeltaR = +instrumentState.panningVolumeDeltaR;\n\t\t\t\tlet   panningOffsetL      = panningDelayPos - instrumentState.panningOffsetStartL + synth.panningDelayBufferSize;\n\t\t\t\tlet   panningOffsetR      = panningDelayPos - instrumentState.panningOffsetStartR + synth.panningDelayBufferSize;\n\t\t\t\tconst panningOffsetDeltaL = 1.0 - instrumentState.panningOffsetDeltaL;\n\t\t\t\tconst panningOffsetDeltaR = 1.0 - instrumentState.panningOffsetDeltaR;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesChorus) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tconst chorusMask = synth.chorusDelayBufferMask >>> 0;\n\t\t\t\tconst chorusDelayLineL = instrumentState.chorusDelayLineL;\n\t\t\t\tconst chorusDelayLineR = instrumentState.chorusDelayLineR;\n\t\t\t\tinstrumentState.chorusDelayLineDirty = true;\n\t\t\t\tlet chorusDelayPos = instrumentState.chorusDelayPos & chorusMask;\n\t\t\t\t\n\t\t\t\tconst chorusStart = +instrumentState.chorusStart;\n\t\t\t\tconst chorusEnd   = +instrumentState.chorusEnd;\n\t\t\t\tlet chorusVoiceMult = chorusStart;\n\t\t\t\tconst chorusVoiceMultDelta = (chorusEnd - chorusStart) / runLength;\n\t\t\t\tlet chorusCombinedMult = 1.0 / Math.sqrt(3.0 * chorusStart * chorusStart + 1.0);\n\t\t\t\tconst chorusCombinedMultEnd = 1.0 / Math.sqrt(3.0 * chorusEnd * chorusEnd + 1.0);\n\t\t\t\tconst chorusCombinedMultDelta = (chorusCombinedMultEnd - chorusCombinedMult) / runLength;\n\t\t\t\t\n\t\t\t\tconst chorusDuration = +beepbox.Config.chorusPeriodSeconds;\n\t\t\t\tconst chorusAngle = Math.PI * 2.0 / (chorusDuration * synth.samplesPerSecond);\n\t\t\t\tconst chorusRange = synth.samplesPerSecond * beepbox.Config.chorusDelayRange;\n\t\t\t\tconst chorusOffset0 = synth.chorusDelayBufferSize - beepbox.Config.chorusDelayOffsets[0][0] * chorusRange;\n\t\t\t\tconst chorusOffset1 = synth.chorusDelayBufferSize - beepbox.Config.chorusDelayOffsets[0][1] * chorusRange;\n\t\t\t\tconst chorusOffset2 = synth.chorusDelayBufferSize - beepbox.Config.chorusDelayOffsets[0][2] * chorusRange;\n\t\t\t\tconst chorusOffset3 = synth.chorusDelayBufferSize - beepbox.Config.chorusDelayOffsets[1][0] * chorusRange;\n\t\t\t\tconst chorusOffset4 = synth.chorusDelayBufferSize - beepbox.Config.chorusDelayOffsets[1][1] * chorusRange;\n\t\t\t\tconst chorusOffset5 = synth.chorusDelayBufferSize - beepbox.Config.chorusDelayOffsets[1][2] * chorusRange;\n\t\t\t\tlet chorusPhase = instrumentState.chorusPhase % (Math.PI * 2.0);\n\t\t\t\tlet chorusTap0Index = chorusDelayPos + chorusOffset0 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[0][0]);\n\t\t\t\tlet chorusTap1Index = chorusDelayPos + chorusOffset1 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[0][1]);\n\t\t\t\tlet chorusTap2Index = chorusDelayPos + chorusOffset2 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[0][2]);\n\t\t\t\tlet chorusTap3Index = chorusDelayPos + chorusOffset3 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[1][0]);\n\t\t\t\tlet chorusTap4Index = chorusDelayPos + chorusOffset4 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[1][1]);\n\t\t\t\tlet chorusTap5Index = chorusDelayPos + chorusOffset5 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[1][2]);\n\t\t\t\tchorusPhase += chorusAngle * runLength;\n\t\t\t\tconst chorusTap0End = chorusDelayPos + chorusOffset0 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[0][0]) + runLength;\n\t\t\t\tconst chorusTap1End = chorusDelayPos + chorusOffset1 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[0][1]) + runLength;\n\t\t\t\tconst chorusTap2End = chorusDelayPos + chorusOffset2 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[0][2]) + runLength;\n\t\t\t\tconst chorusTap3End = chorusDelayPos + chorusOffset3 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[1][0]) + runLength;\n\t\t\t\tconst chorusTap4End = chorusDelayPos + chorusOffset4 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[1][1]) + runLength;\n\t\t\t\tconst chorusTap5End = chorusDelayPos + chorusOffset5 - chorusRange * Math.sin(chorusPhase + beepbox.Config.chorusPhaseOffsets[1][2]) + runLength;\n\t\t\t\tconst chorusTap0Delta = (chorusTap0End - chorusTap0Index) / runLength;\n\t\t\t\tconst chorusTap1Delta = (chorusTap1End - chorusTap1Index) / runLength;\n\t\t\t\tconst chorusTap2Delta = (chorusTap2End - chorusTap2Index) / runLength;\n\t\t\t\tconst chorusTap3Delta = (chorusTap3End - chorusTap3Index) / runLength;\n\t\t\t\tconst chorusTap4Delta = (chorusTap4End - chorusTap4Index) / runLength;\n\t\t\t\tconst chorusTap5Delta = (chorusTap5End - chorusTap5Index) / runLength;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesEcho) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tlet echoMult = +instrumentState.echoMultStart;\n\t\t\t\tconst echoMultDelta = +instrumentState.echoMultDelta;\n\t\t\t\t\n\t\t\t\tconst echoDelayLineL = instrumentState.echoDelayLineL;\n\t\t\t\tconst echoDelayLineR = instrumentState.echoDelayLineR;\n\t\t\t\tconst echoMask = (echoDelayLineL.length - 1) >>> 0;\n\t\t\t\tinstrumentState.echoDelayLineDirty = true;\n\t\t\t\t\n\t\t\t\tlet echoDelayPos = instrumentState.echoDelayPos & echoMask;\n\t\t\t\tconst echoDelayOffsetStart = (echoDelayLineL.length - instrumentState.echoDelayOffsetStart) & echoMask;\n\t\t\t\tconst echoDelayOffsetEnd   = (echoDelayLineL.length - instrumentState.echoDelayOffsetEnd) & echoMask;\n\t\t\t\tlet echoDelayOffsetRatio = +instrumentState.echoDelayOffsetRatio;\n\t\t\t\tconst echoDelayOffsetRatioDelta = +instrumentState.echoDelayOffsetRatioDelta;\n\t\t\t\t\n\t\t\t\tconst echoShelfA1 = +instrumentState.echoShelfA1;\n\t\t\t\tconst echoShelfB0 = +instrumentState.echoShelfB0;\n\t\t\t\tconst echoShelfB1 = +instrumentState.echoShelfB1;\n\t\t\t\tlet echoShelfSampleL = +instrumentState.echoShelfSampleL;\n\t\t\t\tlet echoShelfSampleR = +instrumentState.echoShelfSampleR;\n\t\t\t\tlet echoShelfPrevInputL = +instrumentState.echoShelfPrevInputL;\n\t\t\t\tlet echoShelfPrevInputR = +instrumentState.echoShelfPrevInputR;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesReverb) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tconst reverbMask = beepbox.Config.reverbDelayBufferMask >>> 0; //TODO: Dynamic reverb buffer size.\n\t\t\t\tconst reverbDelayLine = instrumentState.reverbDelayLine;\n\t\t\t\tinstrumentState.reverbDelayLineDirty = true;\n\t\t\t\tlet reverbDelayPos = instrumentState.reverbDelayPos & reverbMask;\n\t\t\t\t\n\t\t\t\tlet reverb = +instrumentState.reverbMultStart;\n\t\t\t\tconst reverbDelta = +instrumentState.reverbMultDelta;\n\t\t\t\t\n\t\t\t\tconst reverbShelfA1 = +instrumentState.reverbShelfA1;\n\t\t\t\tconst reverbShelfB0 = +instrumentState.reverbShelfB0;\n\t\t\t\tconst reverbShelfB1 = +instrumentState.reverbShelfB1;\n\t\t\t\tlet reverbShelfSample0 = +instrumentState.reverbShelfSample0;\n\t\t\t\tlet reverbShelfSample1 = +instrumentState.reverbShelfSample1;\n\t\t\t\tlet reverbShelfSample2 = +instrumentState.reverbShelfSample2;\n\t\t\t\tlet reverbShelfSample3 = +instrumentState.reverbShelfSample3;\n\t\t\t\tlet reverbShelfPrevInput0 = +instrumentState.reverbShelfPrevInput0;\n\t\t\t\tlet reverbShelfPrevInput1 = +instrumentState.reverbShelfPrevInput1;\n\t\t\t\tlet reverbShelfPrevInput2 = +instrumentState.reverbShelfPrevInput2;\n\t\t\t\tlet reverbShelfPrevInput3 = +instrumentState.reverbShelfPrevInput3;`\n\t\t\t}\n\t\t\t\n\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tconst stopIndex = bufferIndex + runLength;\n\t\t\t\tfor (let sampleIndex = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\t\t\tlet sample = tempMonoInstrumentSampleBuffer[sampleIndex];\n\t\t\t\t\ttempMonoInstrumentSampleBuffer[sampleIndex] = 0.0;`\n\t\t\t\n\t\t\tif (usesDistortion) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tconst distortionReverse = 1.0 - distortion;\n\t\t\t\t\tconst distortionNextInput = sample * distortionDrive;\n\t\t\t\t\tsample = distortionNextOutput;\n\t\t\t\t\tdistortionNextOutput = distortionNextInput / (distortionReverse * Math.abs(distortionNextInput) + distortion);\n\t\t\t\t\tdistortionFractionalInput1 = distortionFractionalDelayG1 * distortionNextInput + distortionPrevInput - distortionFractionalDelayG1 * distortionFractionalInput1;\n\t\t\t\t\tdistortionFractionalInput2 = distortionFractionalDelayG2 * distortionNextInput + distortionPrevInput - distortionFractionalDelayG2 * distortionFractionalInput2;\n\t\t\t\t\tdistortionFractionalInput3 = distortionFractionalDelayG3 * distortionNextInput + distortionPrevInput - distortionFractionalDelayG3 * distortionFractionalInput3;\n\t\t\t\t\tconst distortionOutput1 = distortionFractionalInput1 / (distortionReverse * Math.abs(distortionFractionalInput1) + distortion);\n\t\t\t\t\tconst distortionOutput2 = distortionFractionalInput2 / (distortionReverse * Math.abs(distortionFractionalInput2) + distortion);\n\t\t\t\t\tconst distortionOutput3 = distortionFractionalInput3 / (distortionReverse * Math.abs(distortionFractionalInput3) + distortion);\n\t\t\t\t\tdistortionNextOutput += distortionOutput1 * distortionNextOutputWeight1 + distortionOutput2 * distortionNextOutputWeight2 + distortionOutput3 * distortionNextOutputWeight3;\n\t\t\t\t\tsample += distortionOutput1 * distortionPrevOutputWeight1 + distortionOutput2 * distortionPrevOutputWeight2 + distortionOutput3 * distortionPrevOutputWeight3;\n\t\t\t\t\tsample *= distortionOversampleCompensation;\n\t\t\t\t\tdistortionPrevInput = distortionNextInput;\n\t\t\t\t\tdistortion += distortionDelta;\n\t\t\t\t\tdistortionDrive += distortionDriveDelta;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesBitcrusher) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tbitcrusherPhase += bitcrusherPhaseDelta;\n\t\t\t\t\tif (bitcrusherPhase < 1.0) {\n\t\t\t\t\t\tbitcrusherPrevInput = sample;\n\t\t\t\t\t\tsample = bitcrusherCurrentOutput;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbitcrusherPhase = bitcrusherPhase % 1.0;\n\t\t\t\t\t\tconst ratio = bitcrusherPhase / bitcrusherPhaseDelta;\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst lerpedInput = sample + (bitcrusherPrevInput - sample) * ratio;\n\t\t\t\t\t\tbitcrusherPrevInput = sample;\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst bitcrusherWrapLevel = bitcrusherFoldLevel * 4.0;\n\t\t\t\t\t\tconst wrappedSample = (((lerpedInput + bitcrusherFoldLevel) % bitcrusherWrapLevel) + bitcrusherWrapLevel) % bitcrusherWrapLevel;\n\t\t\t\t\t\tconst foldedSample = bitcrusherFoldLevel - Math.abs(bitcrusherFoldLevel * 2.0 - wrappedSample);\n\t\t\t\t\t\tconst scaledSample = foldedSample / bitcrusherScale;\n\t\t\t\t\t\tconst oldValue = bitcrusherCurrentOutput;\n\t\t\t\t\t\tconst newValue = (((scaledSample > 0 ? scaledSample + 1 : scaledSample)|0)-.5) * bitcrusherScale;\n\t\t\t\t\t\t\n\t\t\t\t\t\tsample = oldValue + (newValue - oldValue) * ratio;\n\t\t\t\t\t\tbitcrusherCurrentOutput = newValue;\n\t\t\t\t\t}\n\t\t\t\t\tbitcrusherPhaseDelta *= bitcrusherPhaseDeltaScale;\n\t\t\t\t\tbitcrusherScale *= bitcrusherScaleScale;\n\t\t\t\t\tbitcrusherFoldLevel *= bitcrusherFoldLevelScale;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesEqFilter) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tconst inputSample = sample;\n\t\t\t\t\tsample = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\t\t\tinitialFilterInput1 = inputSample;`\n\t\t\t}\n\t\t\t\n\t\t\t// The eq filter volume is also used to fade out the instrument state, so always include it.\n\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tsample *= eqFilterVolume;\n\t\t\t\t\teqFilterVolume += eqFilterVolumeDelta;`\n\t\t\t\n\t\t\tif (usesPanning) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tpanningDelayLine[panningDelayPos] = sample;\n\t\t\t\t\tconst panningRatioL  = panningOffsetL % 1;\n\t\t\t\t\tconst panningRatioR  = panningOffsetR % 1;\n\t\t\t\t\tconst panningTapLA   = panningDelayLine[(panningOffsetL) & panningMask];\n\t\t\t\t\tconst panningTapLB   = panningDelayLine[(panningOffsetL + 1) & panningMask];\n\t\t\t\t\tconst panningTapRA   = panningDelayLine[(panningOffsetR) & panningMask];\n\t\t\t\t\tconst panningTapRB   = panningDelayLine[(panningOffsetR + 1) & panningMask];\n\t\t\t\t\tconst panningTapL    = panningTapLA + (panningTapLB - panningTapLA) * panningRatioL;\n\t\t\t\t\tconst panningTapR    = panningTapRA + (panningTapRB - panningTapRA) * panningRatioR;\n\t\t\t\t\tlet sampleL = panningTapL * panningVolumeL;\n\t\t\t\t\tlet sampleR = panningTapR * panningVolumeR;\n\t\t\t\t\tpanningDelayPos = (panningDelayPos + 1) & panningMask;\n\t\t\t\t\tpanningVolumeL += panningVolumeDeltaL;\n\t\t\t\t\tpanningVolumeR += panningVolumeDeltaR;\n\t\t\t\t\tpanningOffsetL += panningOffsetDeltaL;\n\t\t\t\t\tpanningOffsetR += panningOffsetDeltaR;`\n\t\t\t} else {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tlet sampleL = sample;\n\t\t\t\t\tlet sampleR = sample;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesChorus) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tconst chorusTap0Ratio = chorusTap0Index % 1;\n\t\t\t\t\tconst chorusTap1Ratio = chorusTap1Index % 1;\n\t\t\t\t\tconst chorusTap2Ratio = chorusTap2Index % 1;\n\t\t\t\t\tconst chorusTap3Ratio = chorusTap3Index % 1;\n\t\t\t\t\tconst chorusTap4Ratio = chorusTap4Index % 1;\n\t\t\t\t\tconst chorusTap5Ratio = chorusTap5Index % 1;\n\t\t\t\t\tconst chorusTap0A = chorusDelayLineL[(chorusTap0Index) & chorusMask];\n\t\t\t\t\tconst chorusTap0B = chorusDelayLineL[(chorusTap0Index + 1) & chorusMask];\n\t\t\t\t\tconst chorusTap1A = chorusDelayLineL[(chorusTap1Index) & chorusMask];\n\t\t\t\t\tconst chorusTap1B = chorusDelayLineL[(chorusTap1Index + 1) & chorusMask];\n\t\t\t\t\tconst chorusTap2A = chorusDelayLineL[(chorusTap2Index) & chorusMask];\n\t\t\t\t\tconst chorusTap2B = chorusDelayLineL[(chorusTap2Index + 1) & chorusMask];\n\t\t\t\t\tconst chorusTap3A = chorusDelayLineR[(chorusTap3Index) & chorusMask];\n\t\t\t\t\tconst chorusTap3B = chorusDelayLineR[(chorusTap3Index + 1) & chorusMask];\n\t\t\t\t\tconst chorusTap4A = chorusDelayLineR[(chorusTap4Index) & chorusMask];\n\t\t\t\t\tconst chorusTap4B = chorusDelayLineR[(chorusTap4Index + 1) & chorusMask];\n\t\t\t\t\tconst chorusTap5A = chorusDelayLineR[(chorusTap5Index) & chorusMask];\n\t\t\t\t\tconst chorusTap5B = chorusDelayLineR[(chorusTap5Index + 1) & chorusMask];\n\t\t\t\t\tconst chorusTap0 = chorusTap0A + (chorusTap0B - chorusTap0A) * chorusTap0Ratio;\n\t\t\t\t\tconst chorusTap1 = chorusTap1A + (chorusTap1B - chorusTap1A) * chorusTap1Ratio;\n\t\t\t\t\tconst chorusTap2 = chorusTap2A + (chorusTap2B - chorusTap2A) * chorusTap2Ratio;\n\t\t\t\t\tconst chorusTap3 = chorusTap3A + (chorusTap3B - chorusTap3A) * chorusTap3Ratio;\n\t\t\t\t\tconst chorusTap4 = chorusTap4A + (chorusTap4B - chorusTap4A) * chorusTap4Ratio;\n\t\t\t\t\tconst chorusTap5 = chorusTap5A + (chorusTap5B - chorusTap5A) * chorusTap5Ratio;\n\t\t\t\t\tchorusDelayLineL[chorusDelayPos] = sampleL * delayInputMult;\n\t\t\t\t\tchorusDelayLineR[chorusDelayPos] = sampleR * delayInputMult;\n\t\t\t\t\tsampleL = chorusCombinedMult * (sampleL + chorusVoiceMult * (chorusTap1 - chorusTap0 - chorusTap2));\n\t\t\t\t\tsampleR = chorusCombinedMult * (sampleR + chorusVoiceMult * (chorusTap4 - chorusTap3 - chorusTap5));\n\t\t\t\t\tchorusDelayPos = (chorusDelayPos + 1) & chorusMask;\n\t\t\t\t\tchorusTap0Index += chorusTap0Delta;\n\t\t\t\t\tchorusTap1Index += chorusTap1Delta;\n\t\t\t\t\tchorusTap2Index += chorusTap2Delta;\n\t\t\t\t\tchorusTap3Index += chorusTap3Delta;\n\t\t\t\t\tchorusTap4Index += chorusTap4Delta;\n\t\t\t\t\tchorusTap5Index += chorusTap5Delta;\n\t\t\t\t\tchorusVoiceMult += chorusVoiceMultDelta;\n\t\t\t\t\tchorusCombinedMult += chorusCombinedMultDelta;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesEcho) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tconst echoTapStartIndex = (echoDelayPos + echoDelayOffsetStart) & echoMask;\n\t\t\t\t\tconst echoTapEndIndex   = (echoDelayPos + echoDelayOffsetEnd  ) & echoMask;\n\t\t\t\t\tconst echoTapStartL = echoDelayLineL[echoTapStartIndex];\n\t\t\t\t\tconst echoTapEndL   = echoDelayLineL[echoTapEndIndex];\n\t\t\t\t\tconst echoTapStartR = echoDelayLineR[echoTapStartIndex];\n\t\t\t\t\tconst echoTapEndR   = echoDelayLineR[echoTapEndIndex];\n\t\t\t\t\tconst echoTapL = (echoTapStartL + (echoTapEndL - echoTapStartL) * echoDelayOffsetRatio) * echoMult;\n\t\t\t\t\tconst echoTapR = (echoTapStartR + (echoTapEndR - echoTapStartR) * echoDelayOffsetRatio) * echoMult;\n\t\t\t\t\t\n\t\t\t\t\techoShelfSampleL = echoShelfB0 * echoTapL + echoShelfB1 * echoShelfPrevInputL - echoShelfA1 * echoShelfSampleL;\n\t\t\t\t\techoShelfSampleR = echoShelfB0 * echoTapR + echoShelfB1 * echoShelfPrevInputR - echoShelfA1 * echoShelfSampleR;\n\t\t\t\t\techoShelfPrevInputL = echoTapL;\n\t\t\t\t\techoShelfPrevInputR = echoTapR;\n\t\t\t\t\tsampleL += echoShelfSampleL;\n\t\t\t\t\tsampleR += echoShelfSampleR;\n\t\t\t\t\t\n\t\t\t\t\techoDelayLineL[echoDelayPos] = sampleL * delayInputMult;\n\t\t\t\t\techoDelayLineR[echoDelayPos] = sampleR * delayInputMult;\n\t\t\t\t\techoDelayPos = (echoDelayPos + 1) & echoMask;\n\t\t\t\t\techoDelayOffsetRatio += echoDelayOffsetRatioDelta;\n\t\t\t\t\techoMult += echoMultDelta;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesReverb) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\t// Reverb, implemented using a feedback delay network with a Hadamard matrix and lowpass filters.\n\t\t\t\t\t// good ratios:    0.555235 + 0.618033 + 0.818 +   1.0 = 2.991268\n\t\t\t\t\t// Delay lengths:  3041     + 3385     + 4481  +  5477 = 16384 = 2^14\n\t\t\t\t\t// Buffer offsets: 3041    -> 6426   -> 10907 -> 16384\n\t\t\t\t\tconst reverbDelayPos1 = (reverbDelayPos +  3041) & reverbMask;\n\t\t\t\t\tconst reverbDelayPos2 = (reverbDelayPos +  6426) & reverbMask;\n\t\t\t\t\tconst reverbDelayPos3 = (reverbDelayPos + 10907) & reverbMask;\n\t\t\t\t\tconst reverbSample0 = (reverbDelayLine[reverbDelayPos]);\n\t\t\t\t\tconst reverbSample1 = reverbDelayLine[reverbDelayPos1];\n\t\t\t\t\tconst reverbSample2 = reverbDelayLine[reverbDelayPos2];\n\t\t\t\t\tconst reverbSample3 = reverbDelayLine[reverbDelayPos3];\n\t\t\t\t\tconst reverbTemp0 = -(reverbSample0 + sampleL) + reverbSample1;\n\t\t\t\t\tconst reverbTemp1 = -(reverbSample0 + sampleR) - reverbSample1;\n\t\t\t\t\tconst reverbTemp2 = -reverbSample2 + reverbSample3;\n\t\t\t\t\tconst reverbTemp3 = -reverbSample2 - reverbSample3;\n\t\t\t\t\tconst reverbShelfInput0 = (reverbTemp0 + reverbTemp2) * reverb;\n\t\t\t\t\tconst reverbShelfInput1 = (reverbTemp1 + reverbTemp3) * reverb;\n\t\t\t\t\tconst reverbShelfInput2 = (reverbTemp0 - reverbTemp2) * reverb;\n\t\t\t\t\tconst reverbShelfInput3 = (reverbTemp1 - reverbTemp3) * reverb;\n\t\t\t\t\treverbShelfSample0 = reverbShelfB0 * reverbShelfInput0 + reverbShelfB1 * reverbShelfPrevInput0 - reverbShelfA1 * reverbShelfSample0;\n\t\t\t\t\treverbShelfSample1 = reverbShelfB0 * reverbShelfInput1 + reverbShelfB1 * reverbShelfPrevInput1 - reverbShelfA1 * reverbShelfSample1;\n\t\t\t\t\treverbShelfSample2 = reverbShelfB0 * reverbShelfInput2 + reverbShelfB1 * reverbShelfPrevInput2 - reverbShelfA1 * reverbShelfSample2;\n\t\t\t\t\treverbShelfSample3 = reverbShelfB0 * reverbShelfInput3 + reverbShelfB1 * reverbShelfPrevInput3 - reverbShelfA1 * reverbShelfSample3;\n\t\t\t\t\treverbShelfPrevInput0 = reverbShelfInput0;\n\t\t\t\t\treverbShelfPrevInput1 = reverbShelfInput1;\n\t\t\t\t\treverbShelfPrevInput2 = reverbShelfInput2;\n\t\t\t\t\treverbShelfPrevInput3 = reverbShelfInput3;\n\t\t\t\t\treverbDelayLine[reverbDelayPos1] = reverbShelfSample0 * delayInputMult;\n\t\t\t\t\treverbDelayLine[reverbDelayPos2] = reverbShelfSample1 * delayInputMult;\n\t\t\t\t\treverbDelayLine[reverbDelayPos3] = reverbShelfSample2 * delayInputMult;\n\t\t\t\t\treverbDelayLine[reverbDelayPos ] = reverbShelfSample3 * delayInputMult;\n\t\t\t\t\treverbDelayPos = (reverbDelayPos + 1) & reverbMask;\n\t\t\t\t\tsampleL += reverbSample1 + reverbSample2 + reverbSample3;\n\t\t\t\t\tsampleR += reverbSample0 + reverbSample2 - reverbSample3;\n\t\t\t\t\treverb += reverbDelta;`\n\t\t\t}\n\t\t\t\n\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\toutputDataL[sampleIndex] += sampleL * mixVolume;\n\t\t\t\t\toutputDataR[sampleIndex] += sampleR * mixVolume;\n\t\t\t\t\tmixVolume += mixVolumeDelta;`\n\t\t\t\n\t\t\tif (usesDelays) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\t\tdelayInputMult += delayInputMultDelta;`\n\t\t\t}\n\t\t\t\n\t\t\teffectsSource += `\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Avoid persistent denormal or NaN values in the delay buffers and filter history.\n\t\t\t\tconst epsilon = (1.0e-24);`\n\t\t\t\n\t\t\tif (usesDistortion) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tif (!Number.isFinite(distortionFractionalInput1) || Math.abs(distortionFractionalInput1) < epsilon) distortionFractionalInput1 = 0.0;\n\t\t\t\tif (!Number.isFinite(distortionFractionalInput2) || Math.abs(distortionFractionalInput2) < epsilon) distortionFractionalInput2 = 0.0;\n\t\t\t\tif (!Number.isFinite(distortionFractionalInput3) || Math.abs(distortionFractionalInput3) < epsilon) distortionFractionalInput3 = 0.0;\n\t\t\t\tif (!Number.isFinite(distortionPrevInput) || Math.abs(distortionPrevInput) < epsilon) distortionPrevInput = 0.0;\n\t\t\t\tif (!Number.isFinite(distortionNextOutput) || Math.abs(distortionNextOutput) < epsilon) distortionNextOutput = 0.0;\n\t\t\t\t\n\t\t\t\tinstrumentState.distortionFractionalInput1 = distortionFractionalInput1;\n\t\t\t\tinstrumentState.distortionFractionalInput2 = distortionFractionalInput2;\n\t\t\t\tinstrumentState.distortionFractionalInput3 = distortionFractionalInput3;\n\t\t\t\tinstrumentState.distortionPrevInput = distortionPrevInput;\n\t\t\t\tinstrumentState.distortionNextOutput = distortionNextOutput;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesBitcrusher) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\tif (Math.abs(bitcrusherPrevInput) < epsilon) bitcrusherPrevInput = 0.0;\n\t\t\t\tif (Math.abs(bitcrusherCurrentOutput) < epsilon) bitcrusherCurrentOutput = 0.0;\n\t\t\t\tinstrumentState.bitcrusherPrevInput = bitcrusherPrevInput;\n\t\t\t\tinstrumentState.bitcrusherCurrentOutput = bitcrusherCurrentOutput;\n\t\t\t\tinstrumentState.bitcrusherPhase = bitcrusherPhase;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesEqFilter) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\t\n\t\t\t\tsynth.sanitizeFilters(filters);\n\t\t\t\t// The filter input here is downstream from another filter so we\n\t\t\t\t// better make sure it's safe too.\n\t\t\t\tif (!(initialFilterInput1 < 100) || !(initialFilterInput2 < 100)) {\n\t\t\t\t\tinitialFilterInput1 = 0.0;\n\t\t\t\t\tinitialFilterInput2 = 0.0;\n\t\t\t\t}\n\t\t\t\tif (Math.abs(initialFilterInput1) < epsilon) initialFilterInput1 = 0.0;\n\t\t\t\tif (Math.abs(initialFilterInput2) < epsilon) initialFilterInput2 = 0.0;\n\t\t\t\tinstrumentState.initialEqFilterInput1 = initialFilterInput1;\n\t\t\t\tinstrumentState.initialEqFilterInput2 = initialFilterInput2;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesPanning) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(panningDelayLine, panningDelayPos, panningMask);\n\t\t\t\tinstrumentState.panningDelayPos = panningDelayPos;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesChorus) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(chorusDelayLineL, chorusDelayPos, chorusMask);\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(chorusDelayLineR, chorusDelayPos, chorusMask);\n\t\t\t\tinstrumentState.chorusPhase = chorusPhase;\n\t\t\t\tinstrumentState.chorusDelayPos = chorusDelayPos;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesEcho) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(echoDelayLineL, echoDelayPos, echoMask);\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(echoDelayLineR, echoDelayPos, echoMask);\n\t\t\t\tinstrumentState.echoDelayPos = echoDelayPos;\n\t\t\t\t\n\t\t\t\tif (!Number.isFinite(echoShelfSampleL) || Math.abs(echoShelfSampleL) < epsilon) echoShelfSampleL = 0.0;\n\t\t\t\tif (!Number.isFinite(echoShelfSampleR) || Math.abs(echoShelfSampleR) < epsilon) echoShelfSampleR = 0.0;\n\t\t\t\tif (!Number.isFinite(echoShelfPrevInputL) || Math.abs(echoShelfPrevInputL) < epsilon) echoShelfPrevInputL = 0.0;\n\t\t\t\tif (!Number.isFinite(echoShelfPrevInputR) || Math.abs(echoShelfPrevInputR) < epsilon) echoShelfPrevInputR = 0.0;\n\t\t\t\tinstrumentState.echoShelfSampleL = echoShelfSampleL;\n\t\t\t\tinstrumentState.echoShelfSampleR = echoShelfSampleR;\n\t\t\t\tinstrumentState.echoShelfPrevInputL = echoShelfPrevInputL;\n\t\t\t\tinstrumentState.echoShelfPrevInputR = echoShelfPrevInputR;`\n\t\t\t}\n\t\t\t\n\t\t\tif (usesReverb) {\n\t\t\t\teffectsSource += `\n\t\t\t\t\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(reverbDelayLine, reverbDelayPos        , reverbMask);\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(reverbDelayLine, reverbDelayPos +  3041, reverbMask);\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(reverbDelayLine, reverbDelayPos +  6426, reverbMask);\n\t\t\t\tbeepbox.Synth.sanitizeDelayLine(reverbDelayLine, reverbDelayPos + 10907, reverbMask);\n\t\t\t\tinstrumentState.reverbDelayPos  = reverbDelayPos;\n\t\t\t\t\n\t\t\t\tif (!Number.isFinite(reverbShelfSample0) || Math.abs(reverbShelfSample0) < epsilon) reverbShelfSample0 = 0.0;\n\t\t\t\tif (!Number.isFinite(reverbShelfSample1) || Math.abs(reverbShelfSample1) < epsilon) reverbShelfSample1 = 0.0;\n\t\t\t\tif (!Number.isFinite(reverbShelfSample2) || Math.abs(reverbShelfSample2) < epsilon) reverbShelfSample2 = 0.0;\n\t\t\t\tif (!Number.isFinite(reverbShelfSample3) || Math.abs(reverbShelfSample3) < epsilon) reverbShelfSample3 = 0.0;\n\t\t\t\tif (!Number.isFinite(reverbShelfPrevInput0) || Math.abs(reverbShelfPrevInput0) < epsilon) reverbShelfPrevInput0 = 0.0;\n\t\t\t\tif (!Number.isFinite(reverbShelfPrevInput1) || Math.abs(reverbShelfPrevInput1) < epsilon) reverbShelfPrevInput1 = 0.0;\n\t\t\t\tif (!Number.isFinite(reverbShelfPrevInput2) || Math.abs(reverbShelfPrevInput2) < epsilon) reverbShelfPrevInput2 = 0.0;\n\t\t\t\tif (!Number.isFinite(reverbShelfPrevInput3) || Math.abs(reverbShelfPrevInput3) < epsilon) reverbShelfPrevInput3 = 0.0;\n\t\t\t\tinstrumentState.reverbShelfSample0 = reverbShelfSample0;\n\t\t\t\tinstrumentState.reverbShelfSample1 = reverbShelfSample1;\n\t\t\t\tinstrumentState.reverbShelfSample2 = reverbShelfSample2;\n\t\t\t\tinstrumentState.reverbShelfSample3 = reverbShelfSample3;\n\t\t\t\tinstrumentState.reverbShelfPrevInput0 = reverbShelfPrevInput0;\n\t\t\t\tinstrumentState.reverbShelfPrevInput1 = reverbShelfPrevInput1;\n\t\t\t\tinstrumentState.reverbShelfPrevInput2 = reverbShelfPrevInput2;\n\t\t\t\tinstrumentState.reverbShelfPrevInput3 = reverbShelfPrevInput3;`\n\t\t\t}\n\t\t\t\n\t\t\t//console.log(effectsSource);\n\t\t\teffectsFunction = new Function(\"synth\", \"outputDataL\", \"outputDataR\", \"bufferIndex\", \"runLength\", \"instrument\", \"instrumentState\", effectsSource);\n\t\t\tSynth.effectsFunctionCache[signature] = effectsFunction;\n\t\t}\n\t\t\n\t\teffectsFunction(synth, outputDataL, outputDataR, bufferIndex, runLength, instrument, instrumentState);\n\t}\n\t\n\tprivate static pulseWidthSynth(synth: Synth, bufferIndex: number, runLength: number, tone: Tone, instrument: Instrument): void {\n\t\tconst data: Float32Array = synth.tempMonoInstrumentSampleBuffer!;\n\t\t\n\t\tlet phaseDelta: number = tone.phaseDeltas[0];\n\t\tconst phaseDeltaScale: number = +tone.phaseDeltaScales[0];\n\t\tlet expression: number = +tone.expressionStarts[0];\n\t\tconst expressionDelta: number = +tone.expressionDeltas[0];\n\t\tlet phase: number = (tone.phases[0] % 1);\n\t\t\n\t\tlet pulseWidth: number = tone.pulseWidth;\n\t\tconst pulseWidthDelta: number = tone.pulseWidthDelta;\n\t\t\n\t\tconst filters: DynamicBiquadFilter[] = tone.noteFilters;\n\t\tconst filterCount: number = tone.noteFilterCount|0;\n\t\tlet initialFilterInput1: number = +tone.initialNoteFilterInput1;\n\t\tlet initialFilterInput2: number = +tone.initialNoteFilterInput2;\n\t\tconst applyFilters: Function = Synth.applyFilters;\n\t\t\n\t\tconst stopIndex: number = bufferIndex + runLength;\n\t\tfor (let sampleIndex: number = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\t\n\t\t\tconst sawPhaseA: number = phase % 1;\n\t\t\tconst sawPhaseB: number = (phase + pulseWidth) % 1;\n\t\t\t\n\t\t\tlet pulseWave: number = sawPhaseB - sawPhaseA;\n\t\t\t\n\t\t\t// This is a PolyBLEP, which smooths out discontinuities at any frequency to reduce aliasing. \n\t\t\tif (sawPhaseA < phaseDelta) {\n\t\t\t\tvar t = sawPhaseA / phaseDelta;\n\t\t\t\tpulseWave += (t+t-t*t-1) * 0.5;\n\t\t\t} else if (sawPhaseA > 1.0 - phaseDelta) {\n\t\t\t\tvar t = (sawPhaseA - 1.0) / phaseDelta;\n\t\t\t\tpulseWave += (t+t+t*t+1) * 0.5;\n\t\t\t}\n\t\t\tif (sawPhaseB < phaseDelta) {\n\t\t\t\tvar t = sawPhaseB / phaseDelta;\n\t\t\t\tpulseWave -= (t+t-t*t-1) * 0.5;\n\t\t\t} else if (sawPhaseB > 1.0 - phaseDelta) {\n\t\t\t\tvar t = (sawPhaseB - 1.0) / phaseDelta;\n\t\t\t\tpulseWave -= (t+t+t*t+1) * 0.5;\n\t\t\t}\n\t\t\t\n\t\t\tconst inputSample: number = pulseWave;\n\t\t\tconst sample: number = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\tinitialFilterInput1 = inputSample;\n\t\t\t\n\t\t\tphase += phaseDelta;\n\t\t\tphaseDelta *= phaseDeltaScale;\n\t\t\tpulseWidth += pulseWidthDelta;\n\t\t\t\n\t\t\tconst output: number = sample * expression;\n\t\t\texpression += expressionDelta;\n\t\t\t\n\t\t\tdata[sampleIndex] += output;\n\t\t}\n\t\t\n\t\ttone.phases[0] = phase;\n\t\t\n\t\tsynth.sanitizeFilters(filters);\n\t\ttone.initialNoteFilterInput1 = initialFilterInput1;\n\t\ttone.initialNoteFilterInput2 = initialFilterInput2;\n\t}\n\t\n\tprivate static fmSourceTemplate: string[] = (`\n\t\tconst data = synth.tempMonoInstrumentSampleBuffer;\n\t\tconst sineWave = beepbox.Config.sineWave;\n\t\t\n\t\t// I'm adding 1000 to the phase to ensure that it's never negative even when modulated by other waves because negative numbers don't work with the modulus operator very well.\n\t\tlet operator#Phase       = +((tone.phases[#] % 1) + 1000) * beepbox.Config.sineWaveLength;\n\t\tlet operator#PhaseDelta  = +tone.phaseDeltas[#];\n\t\tlet operator#PhaseDeltaScale = +tone.phaseDeltaScales[#];\n\t\tlet operator#OutputMult  = +tone.expressionStarts[#];\n\t\tconst operator#OutputDelta = +tone.expressionDeltas[#];\n\t\tlet operator#Output      = +tone.feedbackOutputs[#];\n\t\tlet feedbackMult         = +tone.feedbackMult;\n\t\tconst feedbackDelta      = +tone.feedbackDelta;\n\t\t\n\t\tconst filters = tone.noteFilters;\n\t\tconst filterCount = tone.noteFilterCount|0;\n\t\tlet initialFilterInput1 = +tone.initialNoteFilterInput1;\n\t\tlet initialFilterInput2 = +tone.initialNoteFilterInput2;\n\t\tconst applyFilters = beepbox.Synth.applyFilters;\n\t\t\n\t\tconst stopIndex = bufferIndex + runLength;\n\t\tfor (let sampleIndex = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\t// INSERT OPERATOR COMPUTATION HERE\n\t\t\tconst fmOutput = (/*operator#Scaled*/); // CARRIER OUTPUTS\n\t\t\t\n\t\t\tconst inputSample = fmOutput;\n\t\t\tconst sample = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\tinitialFilterInput1 = inputSample;\n\t\t\t\n\t\t\tfeedbackMult += feedbackDelta;\n\t\t\toperator#OutputMult += operator#OutputDelta;\n\t\t\toperator#Phase += operator#PhaseDelta;\n\t\t\toperator#PhaseDelta *= operator#PhaseDeltaScale;\n\t\t\t\n\t\t\tdata[sampleIndex] += sample;\n\t\t}\n\t\t\n\t\ttone.phases[#] = operator#Phase / ` + Config.sineWaveLength + `;\n\t\ttone.feedbackOutputs[#] = operator#Output;\n\t\t\n\t\tsynth.sanitizeFilters(filters);\n\t\ttone.initialNoteFilterInput1 = initialFilterInput1;\n\t\ttone.initialNoteFilterInput2 = initialFilterInput2;\n\t`).split(\"\\n\");\n\t\n\tprivate static operatorSourceTemplate: string[] = (`\n\t\t\tconst operator#PhaseMix = operator#Phase/* + operator@Scaled*/;\n\t\t\tconst operator#PhaseInt = operator#PhaseMix|0;\n\t\t\tconst operator#Index    = operator#PhaseInt & ` + Config.sineWaveMask + `;\n\t\t\tconst operator#Sample   = sineWave[operator#Index];\n\t\t\toperator#Output         = operator#Sample + (sineWave[operator#Index + 1] - operator#Sample) * (operator#PhaseMix - operator#PhaseInt);\n\t\t\tconst operator#Scaled   = operator#OutputMult * operator#Output;\n\t`).split(\"\\n\");\n\t\n\tprivate static noiseSynth(synth: Synth, bufferIndex: number, runLength: number, tone: Tone, instrument: Instrument): void {\n\t\tconst data: Float32Array = synth.tempMonoInstrumentSampleBuffer!;\n\t\tlet wave: Float32Array = instrument.getDrumWave();\n\t\tlet phaseDelta: number = +tone.phaseDeltas[0];\n\t\tconst phaseDeltaScale: number = +tone.phaseDeltaScales[0];\n\t\tlet expression: number = +tone.expressionStarts[0];\n\t\tconst expressionDelta: number = +tone.expressionDeltas[0];\n\t\tlet phase: number = (tone.phases[0] % 1) * Config.chipNoiseLength;\n\t\tif (tone.phases[0] == 0) {\n\t\t\t// Zero phase means the tone was reset, just give noise a random start phase instead.\n\t\t\tphase = Math.random() * Config.chipNoiseLength;\n\t\t}\n\t\tconst phaseMask: number = Config.chipNoiseLength - 1;\n\t\tlet noiseSample: number = +tone.sample;\n\t\t\n\t\tconst filters: DynamicBiquadFilter[] = tone.noteFilters;\n\t\tconst filterCount: number = tone.noteFilterCount|0;\n\t\tlet initialFilterInput1: number = +tone.initialNoteFilterInput1;\n\t\tlet initialFilterInput2: number = +tone.initialNoteFilterInput2;\n\t\tconst applyFilters: Function = Synth.applyFilters;\n\t\t\n\t\t// This is for a \"legacy\" style simplified 1st order lowpass filter with\n\t\t// a cutoff frequency that is relative to the tone's fundamental frequency.\n\t\tconst pitchRelativefilter: number = Math.min(1.0, tone.phaseDeltas[0] * Config.chipNoises[instrument.chipNoise].pitchFilterMult);\n\t\t\n\t\tconst stopIndex: number = bufferIndex + runLength;\n\t\tfor (let sampleIndex: number = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\tconst waveSample: number = wave[phase & phaseMask];\n\t\t\t\n\t\t\tnoiseSample += (waveSample - noiseSample) * pitchRelativefilter;\n\t\t\t\n\t\t\tconst inputSample: number = noiseSample;\n\t\t\tconst sample: number = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\tinitialFilterInput1 = inputSample;\n\t\t\t\n\t\t\tphase += phaseDelta;\n\t\t\tphaseDelta *= phaseDeltaScale;\n\t\t\t\n\t\t\tconst output: number = sample * expression;\n\t\t\texpression += expressionDelta;\n\t\t\t\n\t\t\tdata[sampleIndex] += output;\n\t\t}\n\t\t\n\t\ttone.phases[0] = phase / Config.chipNoiseLength;\n\t\ttone.sample = noiseSample;\n\t\t\n\t\tsynth.sanitizeFilters(filters);\n\t\ttone.initialNoteFilterInput1 = initialFilterInput1;\n\t\ttone.initialNoteFilterInput2 = initialFilterInput2;\n\t}\n\t\n\tprivate static spectrumSynth(synth: Synth, bufferIndex: number, runLength: number, tone: Tone, instrument: Instrument): void {\n\t\tconst data: Float32Array = synth.tempMonoInstrumentSampleBuffer!;\n\t\tlet wave: Float32Array = instrument.getDrumWave();\n\t\tlet phaseDelta: number = tone.phaseDeltas[0] * (1 << 7);\n\t\tconst phaseDeltaScale: number = +tone.phaseDeltaScales[0];\n\t\tlet expression: number = +tone.expressionStarts[0];\n\t\tconst expressionDelta: number = +tone.expressionDeltas[0];\n\t\tlet noiseSample: number = +tone.sample;\n\t\t\n\t\tconst filters: DynamicBiquadFilter[] = tone.noteFilters;\n\t\tconst filterCount: number = tone.noteFilterCount|0;\n\t\tlet initialFilterInput1: number = +tone.initialNoteFilterInput1;\n\t\tlet initialFilterInput2: number = +tone.initialNoteFilterInput2;\n\t\tconst applyFilters: Function = Synth.applyFilters;\n\t\t\n\t\tlet phase: number = (tone.phases[0] % 1) * Config.spectrumNoiseLength;\n\t\t// Zero phase means the tone was reset, just give noise a random start phase instead.\n\t\tif (tone.phases[0] == 0) phase = Synth.findRandomZeroCrossing(wave, Config.spectrumNoiseLength) + phaseDelta;\n\t\tconst phaseMask: number = Config.spectrumNoiseLength - 1;\n\t\t\n\t\t// This is for a \"legacy\" style simplified 1st order lowpass filter with\n\t\t// a cutoff frequency that is relative to the tone's fundamental frequency.\n\t\tconst pitchRelativefilter: number = Math.min(1.0, phaseDelta);\n\t\t\n\t\tconst stopIndex: number = bufferIndex + runLength;\n\t\tfor (let sampleIndex: number = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\tconst phaseInt: number = phase|0;\n\t\t\tconst index: number = phaseInt & phaseMask;\n\t\t\tlet waveSample: number = wave[index];\n\t\t\tconst phaseRatio: number = phase - phaseInt;\n\t\t\twaveSample += (wave[index + 1] - waveSample) * phaseRatio;\n\t\t\t\n\t\t\tnoiseSample += (waveSample - noiseSample) * pitchRelativefilter;\n\t\t\t\n\t\t\tconst inputSample: number = noiseSample;\n\t\t\tconst sample: number = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\tinitialFilterInput1 = inputSample;\n\t\t\n\t\t\tphase += phaseDelta;\n\t\t\tphaseDelta *= phaseDeltaScale;\n\t\t\t\n\t\t\tconst output: number = sample * expression;\n\t\t\texpression += expressionDelta;\n\t\t\t\n\t\t\tdata[sampleIndex] += output;\n\t\t}\n\t\t\n\t\ttone.phases[0] = phase / Config.spectrumNoiseLength;\n\t\ttone.sample = noiseSample;\n\t\t\n\t\tsynth.sanitizeFilters(filters);\n\t\ttone.initialNoteFilterInput1 = initialFilterInput1;\n\t\ttone.initialNoteFilterInput2 = initialFilterInput2;\n\t}\n\t\n\tprivate static drumsetSynth(synth: Synth, bufferIndex: number, runLength: number, tone: Tone, instrument: Instrument): void {\n\t\tconst data: Float32Array = synth.tempMonoInstrumentSampleBuffer!;\n\t\tlet wave: Float32Array = instrument.getDrumsetWave(tone.drumsetPitch!);\n\t\tlet phaseDelta: number = tone.phaseDeltas[0] / Instrument.drumsetIndexReferenceDelta(tone.drumsetPitch!);\n\t\tconst phaseDeltaScale: number = +tone.phaseDeltaScales[0];\n\t\tlet expression: number = +tone.expressionStarts[0];\n\t\tconst expressionDelta: number = +tone.expressionDeltas[0];\n\t\t\n\t\tconst filters: DynamicBiquadFilter[] = tone.noteFilters;\n\t\tconst filterCount: number = tone.noteFilterCount|0;\n\t\tlet initialFilterInput1: number = +tone.initialNoteFilterInput1;\n\t\tlet initialFilterInput2: number = +tone.initialNoteFilterInput2;\n\t\tconst applyFilters: Function = Synth.applyFilters;\n\t\t\n\t\tlet phase: number = (tone.phases[0] % 1) * Config.spectrumNoiseLength;\n\t\t// Zero phase means the tone was reset, just give noise a random start phase instead.\n\t\tif (tone.phases[0] == 0) phase = Synth.findRandomZeroCrossing(wave, Config.spectrumNoiseLength) + phaseDelta;\n\t\tconst phaseMask: number = Config.spectrumNoiseLength - 1;\n\t\t\n\t\tconst stopIndex: number = bufferIndex + runLength;\n\t\tfor (let sampleIndex: number = bufferIndex; sampleIndex < stopIndex; sampleIndex++) {\n\t\t\tconst phaseInt: number = phase|0;\n\t\t\tconst index: number = phaseInt & phaseMask;\n\t\t\tlet noiseSample: number = wave[index];\n\t\t\tconst phaseRatio: number = phase - phaseInt;\n\t\t\tnoiseSample += (wave[index + 1] - noiseSample) * phaseRatio;\n\t\t\t\n\t\t\tconst inputSample: number = noiseSample;\n\t\t\tconst sample: number = applyFilters(inputSample, initialFilterInput1, initialFilterInput2, filterCount, filters);\n\t\t\tinitialFilterInput2 = initialFilterInput1;\n\t\t\tinitialFilterInput1 = inputSample;\n\t\t\n\t\t\tphase += phaseDelta;\n\t\t\tphaseDelta *= phaseDeltaScale;\n\t\t\t\n\t\t\tconst output: number = sample * expression;\n\t\t\texpression += expressionDelta;\n\t\t\t\n\t\t\tdata[sampleIndex] += output;\n\t\t}\n\t\t\n\t\ttone.phases[0] = phase / Config.spectrumNoiseLength;\n\t\t\n\t\tsynth.sanitizeFilters(filters);\n\t\ttone.initialNoteFilterInput1 = initialFilterInput1;\n\t\ttone.initialNoteFilterInput2 = initialFilterInput2;\n\t}\n\t\n\tprivate static findRandomZeroCrossing(wave: Float32Array, waveLength: number): number {\n\t\tlet phase: number = Math.random() * waveLength;\n\t\tconst phaseMask: number = waveLength - 1;\n\t\t\n\t\t// Spectrum and drumset waves sounds best when they start at a zero crossing,\n\t\t// otherwise they pop. Try to find a zero crossing.\n\t\tlet indexPrev: number = phase & phaseMask;\n\t\tlet wavePrev: number = wave[indexPrev];\n\t\tconst stride: number = 16;\n\t\tfor (let attemptsRemaining: number = 128; attemptsRemaining > 0; attemptsRemaining--) {\n\t\t\tconst indexNext: number = (indexPrev + stride) & phaseMask;\n\t\t\tconst waveNext: number = wave[indexNext];\n\t\t\tif (wavePrev * waveNext <= 0.0) {\n\t\t\t\t// Found a zero crossing! Now let's narrow it down to two adjacent sample indices.\n\t\t\t\tfor (let i: number = 0; i < stride; i++) {\n\t\t\t\t\tconst innerIndexNext: number = (indexPrev + 1) & phaseMask;\n\t\t\t\t\tconst innerWaveNext: number = wave[innerIndexNext];\n\t\t\t\t\tif (wavePrev * innerWaveNext <= 0.0) {\n\t\t\t\t\t\t// Found the zero crossing again! Now let's find the exact intersection.\n\t\t\t\t\t\tconst slope: number = innerWaveNext - wavePrev;\n\t\t\t\t\t\tphase = indexPrev;\n\t\t\t\t\t\tif (Math.abs(slope) > 0.00000001) {\n\t\t\t\t\t\t\tphase += -wavePrev / slope;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tphase = Math.max(0, phase) % waveLength;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindexPrev = innerIndexNext;\n\t\t\t\t\t\twavePrev = innerWaveNext;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tindexPrev = indexNext;\n\t\t\t\twavePrev = waveNext;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn phase;\n\t}\n\t\n\tpublic static instrumentVolumeToVolumeMult(instrumentVolume: number): number {\n\t\treturn (instrumentVolume == Config.volumeRange - 1) ? 0.0 : Math.pow(2, Config.volumeLogScale * instrumentVolume);\n\t}\n\tpublic static volumeMultToInstrumentVolume(volumeMult: number): number {\n\t\treturn (volumeMult <= 0.0) ? Config.volumeRange - 1 : Math.min(Config.volumeRange - 2, Math.log2(volumeMult) / Config.volumeLogScale);\n\t}\n\tpublic static noteSizeToVolumeMult(size: number): number {\n\t\treturn Math.pow(Math.max(0.0, size) / Config.noteSizeMax, 1.5);\n\t}\n\tpublic static volumeMultToNoteSize(volumeMult: number): number {\n\t\treturn Math.pow(Math.max(0.0, volumeMult), 1/1.5) * Config.noteSizeMax;\n\t}\n\t\n\tpublic static fadeInSettingToSeconds(setting: number): number {\n\t\treturn 0.0125 * (0.95 * setting + 0.05 * setting * setting);\n\t}\n\tpublic static secondsToFadeInSetting(seconds: number): number {\n\t\treturn clamp(0, Config.fadeInRange, Math.round((-0.95 + Math.sqrt(0.9025 + 0.2 * seconds / 0.0125)) / 0.1));\n\t}\n\tpublic static fadeOutSettingToTicks(setting: number): number {\n\t\treturn Config.fadeOutTicks[setting];\n\t}\n\tpublic static ticksToFadeOutSetting(ticks: number): number {\n\t\tlet lower: number = Config.fadeOutTicks[0];\n\t\tif (ticks <= lower) return 0;\n\t\tfor (let i: number = 1; i < Config.fadeOutTicks.length; i++) {\n\t\t\tlet upper: number = Config.fadeOutTicks[i];\n\t\t\tif (ticks <= upper) return (ticks < (lower + upper) / 2) ? i - 1 : i;\n\t\t\tlower = upper;\n\t\t}\n\t\treturn Config.fadeOutTicks.length - 1;\n\t}\n\t\n\tpublic static detuneToCents(detune: number): number {\n\t\treturn detune * (Math.abs(detune)+1) / 2;\n\t}\n\tpublic static centsToDetune(cents: number): number {\n\t\treturn Math.sign(cents) * (Math.sqrt(1 + 8 * Math.abs(cents)) - 1) / 2.0;\n\t}\n\t\n\tprivate getSamplesPerTick(): number {\n\t\tif (this.song == null) return 0;\n\t\tconst beatsPerMinute: number = this.song.getBeatsPerMinute();\n\t\tconst beatsPerSecond: number = beatsPerMinute / 60.0;\n\t\tconst partsPerSecond: number = Config.partsPerBeat * beatsPerSecond;\n\t\tconst tickPerSecond: number = Config.ticksPerPart * partsPerSecond;\n\t\treturn this.samplesPerSecond / tickPerSecond;\n\t}\n\t\n\tpublic static fittingPowerOfTwo(x: number): number {\n\t\treturn 1 << (32 - Math.clz32(Math.ceil(x) - 1));\n\t}\n\t\n\tprivate sanitizeFilters(filters: DynamicBiquadFilter[]): void {\n\t\tlet reset: boolean = false;\n\t\tfor (const filter of filters) {\n\t\t\tconst output1: number = Math.abs(filter.output1);\n\t\t\tconst output2: number = Math.abs(filter.output2);\n\t\t\t// If either is a large value, Infinity, or NaN, then just reset all filter history.\n\t\t\tif (!(output1 < 100) || !(output2 < 100)) {\n\t\t\t\treset = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (output1 < epsilon) filter.output1 = 0.0;\n\t\t\tif (output2 < epsilon) filter.output2 = 0.0;\n\t\t}\n\t\tif (reset) {\n\t\t\tfor (const filter of filters) {\n\t\t\t\tfilter.output1 = 0.0;\n\t\t\t\tfilter.output2 = 0.0;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic static sanitizeDelayLine(delayLine: Float32Array, lastIndex: number, mask: number): void {\n\t\twhile (true) {\n\t\t\tlastIndex--;\n\t\t\tconst index: number = lastIndex & mask;\n\t\t\tconst sample: number = Math.abs(delayLine[index]);\n\t\t\tif (Number.isFinite(sample) && (sample == 0.0 || sample >= epsilon)) break;\n\t\t\tdelayLine[index] = 0.0;\n\t\t}\n\t}\n\t\n\tpublic static applyFilters(sample: number, input1: number, input2: number, filterCount: number, filters: DynamicBiquadFilter[]): number {\n\t\tfor (let i: number = 0; i < filterCount; i++) {\n\t\t\tconst filter: DynamicBiquadFilter = filters[i];\n\t\t\tconst output1: number = filter.output1;\n\t\t\tconst output2: number = filter.output2;\n\t\t\tconst a1: number = filter.a1;\n\t\t\tconst a2: number = filter.a2;\n\t\t\tconst b0: number = filter.b0;\n\t\t\tconst b1: number = filter.b1;\n\t\t\tconst b2: number = filter.b2;\n\t\t\tsample = b0 * sample + b1 * input1 + b2 * input2 - a1 * output1 - a2 * output2;\n\t\t\tfilter.a1 = a1 + filter.a1Delta;\n\t\t\tfilter.a2 = a2 + filter.a2Delta;\n\t\t\tif (filter.useMultiplicativeInputCoefficients) {\n\t\t\t\tfilter.b0 = b0 * filter.b0Delta;\n\t\t\t\tfilter.b1 = b1 * filter.b1Delta;\n\t\t\t\tfilter.b2 = b2 * filter.b2Delta;\n\t\t\t} else {\n\t\t\t\tfilter.b0 = b0 + filter.b0Delta;\n\t\t\t\tfilter.b1 = b1 + filter.b1Delta;\n\t\t\t\tfilter.b2 = b2 + filter.b2Delta;\n\t\t\t}\n\t\t\tfilter.output2 = output1;\n\t\t\tfilter.output1 = sample;\n\t\t\t// Updating the input values is waste if the next filter doesn't exist...\n\t\t\tinput2 = output2;\n\t\t\tinput1 = output1;\n\t\t}\n\t\treturn sample;\n\t}\n}\n\n// When compiling synth.ts as a standalone module named \"beepbox\", expose these imported classes as members to JavaScript:\nexport {Dictionary, DictionaryArray, FilterType, EnvelopeType, InstrumentType, Transition, Chord, Envelope, Config};\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {Prompt} from \"./Prompt\";\nimport {SongDocument} from \"./SongDocument\";\n\nconst {button, div, p, h2} = HTML;\n\nexport class TipPrompt implements Prompt {\n\tprivate readonly _closeButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\t\n\tpublic readonly container: HTMLDivElement;\n\t\n\tconstructor(private _doc: SongDocument, type: string) {\n\t\tlet message: HTMLDivElement;\n\t\t\n\t\tswitch (type) {\n\t\t\tcase \"scale\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Scale\"),\n\t\t\t\t\tp(\"This setting limits the available pitches for adding notes. You may think that there's no point in limiting your choices, but the set of pitches you use has a strong influence on the mood and feel of your song, and these scales serve as guides to help you choose appropriate pitches. Don't worry, you can change the scale at any time, so you're not locked into it. Try making little melodies using all the available pitches of a scale to get a sense for how it sounds.\"),\n\t\t\t\t\tp(\"Most of the scales have a major version, marked with a smiley face, and a minor version, marked with a sad face. Assuming your song uses all pitches in the scale and especially \\\"tonic\\\" pitches (the brown rows in the pattern editor) then major scales tend to sound more playful or optimistic, whereas minor scales sound more serious or sad.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"key\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Song Key\"),\n\t\t\t\t\tp(\"This setting can shift the frequency of every note in your entire song up or down, aligning the \\\"tonic\\\" pitches (the brown rows in the pattern editor) with the selected \\\"key\\\" pitch.\"),\n\t\t\t\t\tp(\"If you've already composed a song but it doesn't emphasize \\\"tonic\\\" pitches then the selected key isn't very meaningful. You can select the \\\"Detect Key\\\" option in the key menu to automatically align the most emphasized notes with \\\"tonic\\\" pitches.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"tempo\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Song Tempo\"),\n\t\t\t\t\tp(\"This setting controls the speed of your song, measured in beats-per-minute. A \\\"beat\\\" is the length of the little gray rectangles in the pattern editor. (In conventional music notation, a \\\"quarter note\\\" is usually equivalent to \\\"beat\\\".)\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"reverb\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Reverb\"),\n\t\t\t\t\tp(\"Reverb is like a continuous echo effect. A little bit helps instruments sound more natural. Adding a lot of reverb can add sense of depth or mystery, but too much reverb can kinda \\\"smear\\\" sounds so that it's harder to distinguish notes or instruments.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"rhythm\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Rhythm\"),\n\t\t\t\t\tp(\"This setting determines how beats are divided. The pattern editor helps you align notes to fractions of a beat based on this setting.\"),\n\t\t\t\t\tp(\"If you've already composed a song but the notes don't align with the selected rhythm, you can select the \\\"Snap Notes To Rhythm\\\" option in the rhythm menu to force the notes in the currently selected pattern(s) to align with the selected rhythm.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"instrumentIndex\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Instrument Number\"),\n\t\t\t\t\tp(\"In the \\\"Channel Settings\\\" option from BeepBox's \\\"File\\\" menu, there are a couple ways to enable multiple instruments per channel, in which case you can click the + button to add more instruments to a channel.\"),\n\t\t\t\t\tp(\"First, you could enable multiple simultaneous instruments per channel. All of the channel's instruments will play all of the notes in the channel at the same time, and you can click an instrument number to view and edit its settings.\"),\n\t\t\t\t\tp(\"Second, you could enable different instruments per pattern. Only one of the instruments will play at any given time, but you can click the instrument number to change which instrument is used for the currently selected pattern(s).\"),\n\t\t\t\t\tp(\"Finally, you can enable them both, in which case you can click an instrument number once to view it, and again to toggle whether the instrument is used for the currently selected pattern(s).\"),\n\t\t\t\t\tp(\"Either way, you can also press shift and a number key to select an instrument.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"instrumentVolume\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Instrument Volume\"),\n\t\t\t\t\tp(\"This setting controls the volume of the selected instrument without affecting the volume of the other instruments. This allows you to balance the loudness of each instrument relative to each other.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"pan\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Instrument Panning\"),\n\t\t\t\t\tp(\"If you're listening through headphones or some other stereo sound system, this controls the position of the instrument and where the sound is coming from, ranging from left to right.\"),\n\t\t\t\t\tp(\"As a suggestion, composers often put lead melodies, drums, and basses in the center, and spread other instruments toward either side. If too many instruments seem like they're coming from the same place, it can feel crowded and harder to distinguish individual sounds, especially if they cover a similar pitch range.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"instrumentType\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Instrument Type\"),\n\t\t\t\t\tp(\"BeepBox comes with many instrument presets, try them out! You can also create your own custom instruments!\"),\n\t\t\t\t\tp(\"There are also options for copying and pasting instrument settings and for generating random instruments at the top of the instrument type menu.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"eqFilter\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"EQ Filter\"),\n\t\t\t\t\tp(\"Filters are a way of emphasizing or diminishing different parts of a sound. Musical notes have a fundamental (base) frequency, but the sound of a musical note also has parts at higher frequencies and filters can adjust the volume of each of these parts based on their frequency.\"),\n\t\t\t\t\tp(\"Click in the filter editor to insert, delete, or drag a filter control point. The horizontal position of the point determines which frequencies it affects, and the vertical position determines how the volume is affected at that frequency.\"),\n\t\t\t\t\tp(\"Insert a new point on the left side of the filter editor to add a \\\"high-pass\\\" filter point, which additionally reduces the volume of lower frequencies, or insert a new point on the right side to add a \\\"low-pass\\\" filter point which reduces the volume of higher frequencies.\"),\n\t\t\t\t\tp(\"You can also enable a \\\"Note Filter\\\" as an effect. EQ and note filters are mostly the same, but have different purposes. EQ filters are for basic adjustments, whereas note filters can be moved dynamically with envelopes. Note filters also change how the distortion effect sounds.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"noteFilter\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Note Filter\"),\n\t\t\t\t\tp(\"Note filters are mostly the same as EQ filters, but have a different purpose. EQ filters are for basic adjustments, whereas note filters can be moved dynamically with envelopes. Note filters also change how the distortion effect sounds.\"),\n\t\t\t\t\tp(\"Filters are a way of emphasizing or diminishing different parts of a sound. Musical notes have a fundamental (base) frequency, but the sound of a musical note also has parts at higher frequencies and filters can adjust the volume of each of these parts based on their frequency.\"),\n\t\t\t\t\tp(\"Click in the filter editor to insert, delete, or drag a filter control point. The horizontal position of the point determines which frequencies it affects, and the vertical position determines how the volume is affected at that frequency.\"),\n\t\t\t\t\tp(\"Insert a new point on the left side of the filter editor to add a \\\"high-pass\\\" filter point, which additionally reduces the volume of lower frequencies, or insert a new point on the right side to add a \\\"low-pass\\\" filter point which reduces the volume of higher frequencies.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"fadeInOut\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Fade In/Out\"),\n\t\t\t\t\tp(\"This setting controls how long it takes for notes to reach full volume at the beginning or decay to silence at the end.\"),\n\t\t\t\t\tp(\"An instant fade-in sounds like instruments that are played by hitting or plucking, whereas slower fade-ins sound like instruments that are played by blowing air.\"),\n\t\t\t\t\tp(\"You can also make the fade-out start before the note ends to leave a gap before the next note starts, or after the note ends to allow the sound of the end of the note to overlap with the start of the next note.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"transition\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Transition\"),\n\t\t\t\t\tp(\"Usually, when one note ends at the same time another begins, the old note will fade out and the new note will fade in based on the fade in/out settings, but this setting can override that, connecting the end of one note to the beginning of the next.\"),\n\t\t\t\t\tp(\"The \\\"interrupt\\\" transition makes the wave suddenly change from the old note's frequency to the new note's frequency without any fading, and restarts any envelopes. The \\\"continue\\\" transition is similar but it doesn't restart envelopes.\"),\n\t\t\t\t\tp(\"The \\\"slide\\\" transition makes the pitch shift quickly but not instantaneously from the old note's frequency to the new note's frequency, and softly restarts envelopes. The \\\"slide in pattern\\\" transition is the same except it doesn't connect the last note in a pattern to the first note in the next pattern.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"chipWave\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Chip Wave\"),\n\t\t\t\t\tp(\"BeepBox comes with some sound waves based on classic electronic sound chips, as well as several unique waves. This is the basic source of the sound of the instrument, which is modified by the other instrument settings.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"chipNoise\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Noise\"),\n\t\t\t\t\tp(\"BeepBox comes with several basic noise sounds. These do not have any distinct musical pitch, and can be used like drums to create beats and emphasize your song's rhythm.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"pulseWidth\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Pulse Wave Width\"),\n\t\t\t\t\tp(\"This setting controls the shape and sound of a pulse wave. At the minimum width, it sounds light and buzzy. At the maximum width, it is shaped like a classic square wave.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"unison\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Unison\"),\n\t\t\t\t\tp(\"This instrument can play two identical waves at slightly different frequencies. When two waves play at slightly different frequencies, they move in and out of phase with each other over time as different parts of the waves line up. This creates a dynamic, shifting sound. Pianos are a common example of this kind of sound, because each piano key strikes multiple strings that are tuned to slightly different frequencies.\"),\n\t\t\t\t\tp(\"The distance between two frequencies is called an \\\"interval\\\", and this setting controls how large it is. If the interval is too wide, then the waves may sound out-of-tune and \\\"dissonant\\\". However, if the interval is even larger, then the two frequencies can even be distinct pitches.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"chords\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Chords\"),\n\t\t\t\t\tp(\"When multiple different notes occur at the same time, this is called a chord. Chords can be created in BeepBox's pattern editor by adding notes above or below another note.\"),\n\t\t\t\t\tp(\"This setting determines how chords are played. The standard option is \\\"simultaneous\\\" which starts playing all of the pitches in a chord at the same instant. The \\\"strum\\\" option is similar, but plays the notes starting at slightly different times. The \\\"arpeggio\\\" option is used in \\\"chiptune\\\" style music and plays a single tone that rapidly alternates between all of the pitches in the chord.\"),\n\t\t\t\t\tp(\"Some BeepBox instruments have an option called \\\"custom interval\\\" which uses the chord notes to control the interval between the waves of a single tone. This can create strange sound effects when combined with FM modulators.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"vibrato\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Vibrato\"),\n\t\t\t\t\tp(\"This setting causes the frequency of a note to wobble slightly. Singers and violinists often use vibrato.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"algorithm\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"FM Algorithm\"),\n\t\t\t\t\tp('FM Synthesis is a mysterious but powerful technique for crafting sounds, popularized by Yamaha keyboards and the Sega Genesis/Mega Drive. It may seem confusing, but try playing around with the options until you get a feel for it, or check out some of the preset examples!'),\n\t\t\t\t\tp('This FM synthesizer uses up to four waves, numbered 1, 2, 3, and 4. Each wave may have its own frequency and volume.'),\n\t\t\t\t\tp('There are two kinds of waves: \"carrier\" waves play a tone out loud, but \"modulator\" waves distort other waves instead. Wave 1 is always a carrier and plays a tone, but other waves may distort it. The \"Algorithm\" setting determines which waves are modulators, and which other waves those modulators distort. For example, \"1←2\" means that wave 2 modulates wave 1, and wave 1 plays out loud.'),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"feedbackType\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Feedback Type\"),\n\t\t\t\t\tp('Modulators distort in one direction (like 1←2), but you can also use the feedback setting to make any wave distort in the opposite direction (1→2), or even itself (1⟲).'),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"feedbackVolume\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Feedback Distortion\"),\n\t\t\t\t\tp(\"This setting controls the amount of feedback distortion based on the feedback type setting.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"operatorFrequency\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Operator Frequency\"),\n\t\t\t\t\tp('This setting controls the frequency of an individual FM wave, relative to the fundamental frequency of the note. The multiplier 1× is the same as the fundamental frequency, whereas 2x would be an octave (12 semitones) above it. The frequencies with a \"~\" are slightly detuned and shift in and out of phase over time compared to the other frequencies.'),\n\t\t\t\t\tp('Try different combinations of a \"carrier\" wave and a \"modulator\" wave with different frequencies to get a feel for how they sound together.'),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"operatorVolume\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Operator Volume\"),\n\t\t\t\t\tp(\"This setting controls the volume of \\\"carrier\\\" waves, or the amount of distortion that \\\"modulator\\\" waves apply to other waves.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"spectrum\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Spectrum\"),\n\t\t\t\t\tp(\"This setting allows you to draw your own noise spectrum! This is good for making drum sounds.\"),\n\t\t\t\t\tp(\"If you only use certain frequencies and a soft fade in/out, it's also possible to make howling wind sounds or even musical wind instruments.\"),\n\t\t\t\t\tp(\"The left side of the spectrum editor controls the noise energy at lower frequencies, and the right side controls higher frequencies.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"harmonics\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Harmonics\"),\n\t\t\t\t\tp(\"This setting allows you to design your own sound wave! Most musical waves are actually a combination of sine waves at certain frequencies, and this lets you control the volume of each sine wave individually.\"),\n\t\t\t\t\tp(\"The left side of the harmonics editor controls the sine wave volumes at lower frequencies, and the right side controls higher frequencies.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"effects\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Effects\"),\n\t\t\t\t\tp(\"BeepBox has many different kinds of special effects you can add to instruments. You can turn on multiple effects at once, and they can be configured individually. Try them all out!\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"drumsetEnvelope\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Drumset Envelope\"),\n\t\t\t\t\tp(\"This drumset comes with a low-pass filter, and this setting can dynamically change the low-pass filter frequency over time. Each row in the pattern editor can have a different envelope shape.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"drumsetSpectrum\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Drumset Spectrum\"),\n\t\t\t\t\tp(\"This setting allows you to draw your own noise spectrum! This is good for making drumsets. Each row in the pattern editor gets its own spectrum.\"),\n\t\t\t\t\tp(\"The left side of the spectrum editor controls the noise energy at lower frequencies, and the right side controls higher frequencies.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"chorus\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Chorus\"),\n\t\t\t\t\tp(\"The chorus effect combines multiple copies of the instrument's sound and adds a bit of vibrato to simulate an ensemble of instruments or voices. Drag the slider to control how much chorus is added.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"echoSustain\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Echo Volume\"),\n\t\t\t\t\tp(\"The echo effect repeats the instrument's sound after a delay. Each echo is a little bit quieter than the last, and this setting controls how much quieter.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"echoDelay\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Echo Delay\"),\n\t\t\t\t\tp(\"The echo effect repeats the instrument's sound after a delay, and this setting controls how long the delay is.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"pitchShift\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Pitch Shift\"),\n\t\t\t\t\tp(\"This setting makes instruments play higher or lower pitches than the ones displayed in the pattern editor. Be careful that you don't confuse yourself!\"),\n\t\t\t\t\tp(\"You can combine this with envelopes to bend pitch over time, or play multiple simultaneous instruments with different pitch shifts for interesting layered sounds.\"),\n\t\t\t\t\tp(\"The intervals created by this setting are in \\\"just intonation\\\" which means they stay in phase with the original pitch instead of shifting in and out of phase over time. If you want the shifting, add the detune effect!\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"detune\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Detune\"),\n\t\t\t\t\tp(\"This setting slightly adjusts the frequency of notes played by the instrument. You can use a little bit to add a pleasing shifting sound similar to the \\\"unison\\\" feature when combined with other instruments. If you use too much, then the instrument may sound unpleasantly out-of-tune.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"distortion\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Distortion\"),\n\t\t\t\t\tp(\"This is the famous electric guitar effect! However, there are some things to be aware of.\"),\n\t\t\t\t\tp(\"First, most chords don't sound right when combined with heavy distortion. The only chords commonly used with distorted electric guitars are \\\"power chords\\\" which consist of a root note, a \\\"fifth\\\" note above that, and/or any octaves of those two notes.\"),\n\t\t\t\t\tp(\"Second, the distortion sound depends a lot on filtering. In particular, I recommend enabling the note filter effect, and adding both high-pass and low-pass points to the note filter. (Note filters are applied first, then distortion which transforms the sound based on that filtering, then the EQ filter is applied last.)\"),\n\t\t\t\t\tp(\"Finally, I recommend adjusting the fade-out setting to allow the end of each note to overlap a little bit with the beginning of the next, but not too much!\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"bitcrusherQuantization\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Bitcrusher Quantization\"),\n\t\t\t\t\tp(\"This effect makes stuff sounds harsher, artificial, and \\\"low quality\\\", which is great if that's what you're going for!\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"bitcrusherFreq\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Frequency Quantization\"),\n\t\t\t\t\tp(\"The bitcrusher effect comes with an additional frequency quantization effect! This is a fun one to play with, especially when combined with the note filter effect.\"),\n\t\t\t\t\tp(\"Every other notch on this slider is aligned with the currently selected key of the song, and the in-between notches are aligned with the tritones of the key.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"stringSustain\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"String sustain\"),\n\t\t\t\t\tp(\"This setting controls how quickly the picked string vibration decays.\"),\n\t\t\t\t\tp(\"Unlike most of BeepBox's instrument synthesizer features, a picked string cannot change frequency suddenly while maintaining its decay. If a tone's pitch changes suddenly (e.g. if the chord type is set to \\\"arpeggio\\\" or the transition type is set to \\\"continues\\\") then the string will be re-picked and start decaying from the beginning again, even if the envelopes don't otherwise restart.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tcase \"envelopes\": {\n\t\t\t\tmessage = div(\n\t\t\t\t\th2(\"Envelopes\"),\n\t\t\t\t\tp(\"Envelopes are a way to dynamically adjust various other settings over time, usually based on how long the note lasts. Press the + button to add an envelope, then use the menus below to select which setting to control and the curve of the envelope. Try different combinations to see how they sound!\"),\n\t\t\t\t\tp(\"Most envelope curves restart from the beginning every time a new note plays. The \\\"note size\\\" option is based on the note width as drawn in the pattern editor.\"),\n\t\t\t\t\tp(\"Envelope curves move in the range from 0 to 1 (or vice versa), where 0 means as quiet as possible and 1 is the same as the corresponding position selected in the instrument settings above. If multiple envelopes are targetting the same setting, they are multiplied before applying to the setting.\"),\n\t\t\t\t);\n\t\t\t} break;\n\t\t\tdefault: throw new Error(\"Unhandled TipPrompt type: \" + type);\n\t\t}\n\t\t\n\t\tthis.container = div({class: \"prompt\", style: \"width: 300px;\"},\n\t\t\tmessage,\n\t\t\tthis._closeButton,\n\t\t);\n\t\t\n\t\tsetTimeout(()=>this._closeButton.focus());\n\t\t\n\t\tthis._closeButton.addEventListener(\"click\", this._close);\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => { \n\t\tthis._closeButton.removeEventListener(\"click\", this._close);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nexport class Change {\n\tprivate _noop: boolean = true;\n\t\n\tprotected _didSomething(): void {\n\t\tthis._noop = false;\n\t}\n\t\n\tpublic isNoop(): boolean {\n\t\treturn this._noop;\n\t}\n\t\n\tpublic commit(): void {}\n}\n\nexport class UndoableChange extends Change {\n\tprivate _reversed: boolean;\n\tprivate _doneForwards: boolean;\n\tconstructor(reversed: boolean) {\n\t\tsuper();\n\t\tthis._reversed = reversed;\n\t\tthis._doneForwards = !reversed;\n\t}\n\t\n\tpublic undo(): void {\n\t\tif (this._reversed) {\n\t\t\tthis._doForwards();\n\t\t\tthis._doneForwards = true;\n\t\t} else {\n\t\t\tthis._doBackwards();\n\t\t\tthis._doneForwards = false;\n\t\t}\n\t}\n\t\n\tpublic redo(): void {\n\t\tif (this._reversed) {\n\t\t\tthis._doBackwards();\n\t\t\tthis._doneForwards = false;\n\t\t} else {\n\t\t\tthis._doForwards();\n\t\t\tthis._doneForwards = true;\n\t\t}\n\t}\n\t\n\t// isDoneForwards() returns whether or not the Change was most recently \n\t// performed forwards or backwards. If the change created something, do not \n\t// delete it in the change destructor unless the Change was performed \n\t// backwards: \n\tprotected _isDoneForwards(): boolean {\n\t\treturn this._doneForwards;\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthrow new Error(\"Change.doForwards(): Override me.\");\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthrow new Error(\"Change.doBackwards(): Override me.\");\n\t}\n}\n\nexport class ChangeGroup extends Change {\n\tconstructor() {\n\t\tsuper();\n\t}\n\t\n\tpublic append(change: Change): void {\n\t\tif (change.isNoop()) return;\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeSequence extends UndoableChange {\n\tprivate _changes: UndoableChange[];\n\tconstructor(changes?: UndoableChange[]) {\n\t\tsuper(false);\n\t\tif (changes == undefined) {\n\t\t\tthis._changes = [];\n\t\t} else {\n\t\t\tthis._changes = changes.concat();\n\t\t}\n\t}\n\t\n\tpublic append(change: UndoableChange): void {\n\t\tif (change.isNoop()) return;\n\t\tthis._changes[this._changes.length] = change;\n\t\tthis._didSomething();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tfor (let i: number = 0; i < this._changes.length; i++) {\n\t\t\tthis._changes[i].redo();\n\t\t}\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tfor (let i: number = this._changes.length-1; i >= 0 ; i--) {\n\t\t\tthis._changes[i].undo();\n\t\t}\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Algorithm, Dictionary, FilterType, InstrumentType, EffectType, AutomationTarget, Config, effectsIncludePanning, effectsIncludeDistortion} from \"../synth/SynthConfig\";\nimport {NotePin, Note, makeNotePin, Pattern, FilterSettings, FilterControlPoint, SpectrumWave, HarmonicsWave, Instrument, Channel, Song, Synth} from \"../synth/synth\";\nimport {Preset, PresetCategory, EditorConfig} from \"./EditorConfig\";\nimport {Change, ChangeGroup, ChangeSequence, UndoableChange} from \"./Change\";\nimport {SongDocument} from \"./SongDocument\";\n\nexport function patternsContainSameInstruments(pattern1Instruments: number[], pattern2Instruments: number[]): boolean {\n\tconst pattern2Has1Instruments: boolean = pattern1Instruments.every(instrument => pattern2Instruments.indexOf(instrument) != -1);\n\tconst pattern1Has2Instruments: boolean = pattern2Instruments.every(instrument => pattern1Instruments.indexOf(instrument) != -1);\n\treturn pattern2Has1Instruments && pattern1Has2Instruments && pattern2Instruments.length == pattern1Instruments.length;\n}\n\nexport function discardInvalidPatternInstruments(instruments: number[], song: Song, channelIndex: number) {\n\tconst uniqueInstruments: Set<number> = new Set(instruments);\n\tinstruments.length = 0;\n\tinstruments.push(...uniqueInstruments);\n\tfor (let i: number = 0; i < instruments.length; i++) {\n\t\tif (instruments[i] >= song.channels[channelIndex].instruments.length) {\n\t\t\tinstruments.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n\tif (instruments.length > song.getMaxInstrumentsPerPattern(channelIndex)) {\n\t\tinstruments.length = song.getMaxInstrumentsPerPattern(channelIndex);\n\t}\n\tif (instruments.length <= 0) {\n\t\tinstruments[0] = 0;\n\t}\n}\n\nexport function unionOfUsedNotes(pattern: Pattern, flags: boolean[]): void {\n\tfor (const note of pattern.notes) {\n\t\tfor (const pitch of note.pitches) {\n\t\t\tfor (const pin of note.pins) {\n\t\t\t\tconst key: number = (pitch + pin.interval) % 12;\n\t\t\t\tif (!flags[key]) {\n\t\t\t\t\tflags[key] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function generateScaleMap(oldScaleFlags: ReadonlyArray<boolean>, newScaleValue: number): number[] {\n\tconst newScaleFlags: ReadonlyArray<boolean> = Config.scales[newScaleValue].flags;\n\tconst oldScale: number[] = [];\n\tconst newScale: number[] = [];\n\tfor (let i: number = 0; i <  12; i++) {\n\t\tif (oldScaleFlags[i]) oldScale.push(i);\n\t\tif (newScaleFlags[i]) newScale.push(i);\n\t}\n\tconst largerToSmaller: boolean = oldScale.length > newScale.length;\n\tconst smallerScale: number[] = largerToSmaller ? newScale : oldScale;\n\tconst largerScale: number[] = largerToSmaller ? oldScale : newScale;\n\n\tconst roles: string[] = [\"root\", \"second\", \"second\", \"third\", \"third\", \"fourth\", \"tritone\", \"fifth\", \"sixth\", \"sixth\", \"seventh\", \"seventh\", \"root\"];\n\tlet bestScore: number = Number.MAX_SAFE_INTEGER;\n\tlet bestIndexMap: number[] = [];\n\tconst stack: number[][] = [[0]]; // Root always maps to root.\n\n\twhile (stack.length > 0) {\n\t\tconst indexMap: number[] = stack.pop()!;\n\n\t\tif (indexMap.length == smallerScale.length) {\n\t\t\t// Score this mapping.\n\t\t\tlet score: number = 0;\n\t\t\tfor (let i: number = 0; i < indexMap.length; i++) {\n\t\t\t\tscore += Math.abs(smallerScale[i] - largerScale[indexMap[i]]);\n\t\t\t\tif (roles[smallerScale[i]] != roles[largerScale[indexMap[i]]]) {\n\t\t\t\t\t// Penalize changing roles.\n\t\t\t\t\tscore += 0.75;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (bestScore > score) {\n\t\t\t\tbestScore = score;\n\t\t\t\tbestIndexMap = indexMap;\n\t\t\t}\n\t\t} else {\n\t\t\t// Recursively choose next indices for mapping.\n\t\t\tconst lowIndex: number = indexMap[indexMap.length - 1] + 1;\n\t\t\tconst highIndex: number = largerScale.length - smallerScale.length + indexMap.length;\n\t\t\tfor (let i: number = lowIndex; i <= highIndex; i++) {\n\t\t\t\tstack.push(indexMap.concat(i));\n\t\t\t}\n\t\t}\n\t}\n\n\tconst sparsePitchMap: number[][] = [];\n\tfor (let i: number = 0; i < bestIndexMap.length; i++) {\n\t\tconst smallerScalePitch = smallerScale[i];\n\t\tconst largerScalePitch = largerScale[bestIndexMap[i]];\n\t\tsparsePitchMap[i] = largerToSmaller\n\t\t\t? [largerScalePitch, smallerScalePitch]\n\t\t\t: [smallerScalePitch, largerScalePitch];\n\t}\n\n\t// To make it easier to wrap around.\n\tsparsePitchMap.push([12, 12]);\n\tnewScale.push(12);\n\n\tlet sparseIndex: number = 0;\n\tconst fullPitchMap: number[] = [];\n\tfor (let i: number = 0; i <  12; i++) {\n\t\tconst oldLow: number = sparsePitchMap[sparseIndex][0];\n\t\tconst newLow: number = sparsePitchMap[sparseIndex][1];\n\t\tconst oldHigh: number = sparsePitchMap[sparseIndex + 1][0];\n\t\tconst newHigh: number = sparsePitchMap[sparseIndex + 1][1];\n\t\tif (i == oldHigh - 1) sparseIndex++;\n\n\t\tconst transformedPitch: number = (i - oldLow) * (newHigh - newLow) / (oldHigh - oldLow) + newLow;\n\n\t\tlet nearestPitch: number = 0;\n\t\tlet nearestPitchDistance: number = Number.MAX_SAFE_INTEGER;\n\t\tfor (const newPitch of newScale) {\n\t\t\tlet distance: number = Math.abs(newPitch - transformedPitch);\n\t\t\tif (roles[newPitch] != roles[i]) {\n\t\t\t\t// Again, penalize changing roles.\n\t\t\t\tdistance += 0.1;\n\t\t\t}\n\t\t\tif (nearestPitchDistance > distance) {\n\t\t\t\tnearestPitchDistance = distance;\n\t\t\t\tnearestPitch = newPitch;\n\t\t\t}\n\t\t}\n\n\t\tfullPitchMap[i] = nearestPitch;\n\t}\n\t\n\treturn fullPitchMap;\n}\n\nfunction removeRedundantPins(pins: NotePin[]): void {\n\tfor (let i: number = 1; i < pins.length - 1; ) {\n\t\tconst prevPin: NotePin = pins[i-1];\n\t\tconst pin: NotePin = pins[i];\n\t\tconst nextPin: NotePin = pins[i+1];\n\t\tconst prevTimeSpan: number = pin.time - prevPin.time;\n\t\tconst nextTimeSpan: number = nextPin.time - pin.time;\n\t\tif ((pin.interval - prevPin.interval) * nextTimeSpan == (nextPin.interval - pin.interval) * prevTimeSpan &&\n\t\t\t(pin.size - prevPin.size) * nextTimeSpan == (nextPin.size - pin.size) * prevTimeSpan)\n\t\t{\n\t\t\tpins.splice(i, 1);\n\t\t} else {\n\t\t\ti++;\n\t\t}\n\t}\n}\n\nfunction projectNoteIntoBar(oldNote: Note, timeOffset: number, noteStartPart: number, noteEndPart: number, newNotes: Note[]): void {\n\t// Create a new note, and interpret the pitch bend and size events\n\t// to determine where we need to insert pins to control interval and volume.\n\tconst newNote: Note = new Note(-1, noteStartPart, noteEndPart, Config.noteSizeMax, false);\n\tnewNote.pins.length = 0;\n\tnewNote.pitches.length = 0;\n\tconst newNoteLength: number = noteEndPart - noteStartPart;\n\n\tfor (const pitch of oldNote.pitches) {\n\t\tnewNote.pitches.push(pitch);\n\t}\n\t\n\tfor (let pinIndex: number = 0; pinIndex < oldNote.pins.length; pinIndex++) {\n\t\tconst pin: NotePin = oldNote.pins[pinIndex];\n\t\tconst newPinTime: number = pin.time + timeOffset;\n\t\tif (newPinTime < 0) {\n\t\t\tif (pinIndex + 1 >= oldNote.pins.length) throw new Error(\"Error converting pins in note overflow.\");\n\t\t\tconst nextPin: NotePin = oldNote.pins[pinIndex + 1];\n\t\t\tconst nextPinTime: number = nextPin.time + timeOffset;\n\t\t\tif (nextPinTime > 0) {\n\t\t\t\t// Insert an interpolated pin at the start of the new note.\n\t\t\t\tconst ratio: number = (-newPinTime) / (nextPinTime - newPinTime);\n\t\t\t\tnewNote.pins.push(makeNotePin(Math.round(pin.interval + ratio * (nextPin.interval - pin.interval)), 0, Math.round(pin.size + ratio * (nextPin.size - pin.size))));\n\t\t\t}\n\t\t} else if (newPinTime <= newNoteLength) {\n\t\t\tnewNote.pins.push(makeNotePin(pin.interval, newPinTime, pin.size));\n\t\t} else {\n\t\t\tif (pinIndex < 1) throw new Error(\"Error converting pins in note overflow.\");\n\t\t\tconst prevPin: NotePin = oldNote.pins[pinIndex - 1];\n\t\t\tconst prevPinTime: number = prevPin.time + timeOffset;\n\t\t\tif (prevPinTime < newNoteLength) {\n\t\t\t\t// Insert an interpolated pin at the end of the new note.\n\t\t\t\tconst ratio: number = (newNoteLength - prevPinTime) / (newPinTime - prevPinTime);\n\t\t\t\tnewNote.pins.push(makeNotePin(Math.round(prevPin.interval + ratio * (pin.interval - prevPin.interval)), newNoteLength, Math.round(prevPin.size + ratio * (pin.size - prevPin.size))));\n\t\t\t}\n\t\t}\n\t}\n\t\n\t// Fix from Jummbus: Ensure the first pin's interval is zero, adjust pitches and pins to compensate.\n\tconst offsetInterval: number = newNote.pins[0].interval;\n\tfor (let pitchIdx: number = 0; pitchIdx < newNote.pitches.length; pitchIdx++) {\n\t\tnewNote.pitches[pitchIdx] += offsetInterval;\n\t}\n\tfor (let pinIdx: number = 0; pinIdx < newNote.pins.length; pinIdx++) {\n\t\tnewNote.pins[pinIdx].interval -= offsetInterval;\n\t}\n\t\n\tlet joinedWithPrevNote: boolean = false;\n\tif (newNote.start == 0) {\n\t\tnewNote.continuesLastPattern = (timeOffset < 0 || oldNote.continuesLastPattern);\n\t} else {\n\t\tnewNote.continuesLastPattern = false;\n\t\tif (newNotes.length > 0 && oldNote.continuesLastPattern) {\n\t\t\tconst prevNote: Note = newNotes[newNotes.length - 1];\n\t\t\tif (prevNote.end == newNote.start && Synth.adjacentNotesHaveMatchingPitches(prevNote, newNote)) {\n\t\t\t\tjoinedWithPrevNote = true;\n\t\t\t\tconst newIntervalOffset: number = prevNote.pins[prevNote.pins.length - 1].interval;\n\t\t\t\tconst newTimeOffset: number = prevNote.end - prevNote.start;\n\t\t\t\tfor (let pinIndex: number = 1; pinIndex < newNote.pins.length; pinIndex++) {\n\t\t\t\t\tconst tempPin: NotePin = newNote.pins[pinIndex];\n\t\t\t\t\tconst transformedPin: NotePin = makeNotePin(tempPin.interval + newIntervalOffset, tempPin.time + newTimeOffset, tempPin.size);\n\t\t\t\t\tprevNote.pins.push(transformedPin);\n\t\t\t\t\tprevNote.end = prevNote.start + transformedPin.time;\n\t\t\t\t}\n\t\t\t\tremoveRedundantPins(prevNote.pins);\n\t\t\t}\n\t\t}\n\t}\n\tif (!joinedWithPrevNote) {\n\t\tnewNotes.push(newNote);\n\t}\n}\n\nexport class ChangeMoveAndOverflowNotes extends ChangeGroup {\n\tconstructor(doc: SongDocument, newBeatsPerBar: number, partsToMove: number) {\n\t\tsuper();\n\t\t\n\t\tconst pitchChannels: Channel[] = [];\n\t\tconst noiseChannels: Channel[] = [];\n\t\t\n\t\tfor (let channelIndex: number = 0; channelIndex < doc.song.getChannelCount(); channelIndex++) {\n\t\t\tconst oldChannel: Channel = doc.song.channels[channelIndex];\n\t\t\tconst newChannel: Channel = new Channel();\n\t\t\tif (channelIndex < doc.song.pitchChannelCount) {\n\t\t\t\tpitchChannels.push(newChannel);\n\t\t\t} else {\n\t\t\t\tnoiseChannels.push(newChannel);\n\t\t\t}\n\t\t\t\n\t\t\tnewChannel.muted = oldChannel.muted;\n\t\t\tnewChannel.octave = oldChannel.octave;\n\t\t\tfor (const instrument of oldChannel.instruments) {\n\t\t\t\tnewChannel.instruments.push(instrument);\n\t\t\t}\n\t\t\t\n\t\t\tconst oldPartsPerBar: number = Config.partsPerBeat * doc.song.beatsPerBar;\n\t\t\tconst newPartsPerBar: number = Config.partsPerBeat * newBeatsPerBar;\n\t\t\tlet currentBar: number = -1;\n\t\t\tlet pattern: Pattern | null = null;\n\t\t\t\n\t\t\tfor (let oldBar: number = 0; oldBar < doc.song.barCount; oldBar++) {\n\t\t\t\tconst oldPattern: Pattern | null = doc.song.getPattern(channelIndex, oldBar);\n\t\t\t\tif (oldPattern != null) {\n\t\t\t\t\tconst oldBarStart: number = oldBar * oldPartsPerBar;\n\t\t\t\t\tfor (const oldNote of oldPattern.notes) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst absoluteNoteStart: number = oldNote.start + oldBarStart + partsToMove;\n\t\t\t\t\t\tconst absoluteNoteEnd: number = oldNote.end + oldBarStart + partsToMove;\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst startBar: number = Math.floor(absoluteNoteStart / newPartsPerBar);\n\t\t\t\t\t\tconst endBar: number = Math.ceil(absoluteNoteEnd / newPartsPerBar);\n\t\t\t\t\t\tfor (let bar: number = startBar; bar < endBar; bar++) {\n\t\t\t\t\t\t\tconst barStartPart: number = bar * newPartsPerBar;\n\t\t\t\t\t\t\tconst noteStartPart: number = Math.max(0, absoluteNoteStart - barStartPart);\n\t\t\t\t\t\t\tconst noteEndPart: number = Math.min(newPartsPerBar, absoluteNoteEnd - barStartPart);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (noteStartPart < noteEndPart) {\n\t\t\t\t\t\t\t\t// Ensure a pattern exists for the current bar before inserting notes into it.\n\t\t\t\t\t\t\t\tif (currentBar != bar || pattern == null) {\n\t\t\t\t\t\t\t\t\tcurrentBar++;\n\t\t\t\t\t\t\t\t\twhile (currentBar < bar) {\n\t\t\t\t\t\t\t\t\t\tnewChannel.bars[currentBar] = 0;\n\t\t\t\t\t\t\t\t\t\tcurrentBar++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tpattern = new Pattern();\n\t\t\t\t\t\t\t\t\tnewChannel.patterns.push(pattern);\n\t\t\t\t\t\t\t\t\tnewChannel.bars[currentBar] = newChannel.patterns.length;\n\t\t\t\t\t\t\t\t\tpattern.instruments.length = 0;\n\t\t\t\t\t\t\t\t\tpattern.instruments.push(...oldPattern.instruments);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tprojectNoteIntoBar(oldNote, absoluteNoteStart - barStartPart - noteStartPart, noteStartPart, noteEndPart, pattern.notes);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\tremoveDuplicatePatterns(pitchChannels);\n\t\tremoveDuplicatePatterns(noiseChannels);\n\t\tthis.append(new ChangeReplacePatterns(doc, pitchChannels, noiseChannels));\n\t}\n}\n\nclass ChangePins extends UndoableChange {\n\tprotected _oldStart: number;\n\tprotected _newStart: number;\n\tprotected _oldEnd: number;\n\tprotected _newEnd: number;\n\tprotected _oldPins: NotePin[];\n\tprotected _newPins: NotePin[];\n\tprotected _oldPitches: number[];\n\tprotected _newPitches: number[];\n\tprotected _oldContinuesLastPattern: boolean;\n\tprotected _newContinuesLastPattern: boolean;\n\tconstructor(protected _doc: SongDocument | null, protected _note: Note) {\n\t\tsuper(false);\n\t\tthis._oldStart = this._note.start;\n\t\tthis._oldEnd   = this._note.end;\n\t\tthis._newStart = this._note.start;\n\t\tthis._newEnd   = this._note.end;\n\t\tthis._oldPins = this._note.pins;\n\t\tthis._newPins = [];\n\t\tthis._oldPitches = this._note.pitches;\n\t\tthis._newPitches = [];\n\t\tthis._oldContinuesLastPattern = this._note.continuesLastPattern;\n\t\tthis._newContinuesLastPattern = this._note.continuesLastPattern;\n\t}\n\t\n\tprotected _finishSetup(continuesLastPattern?: boolean): void {\n\t\tfor (let i: number = 0; i < this._newPins.length - 1; ) {\n\t\t\tif (this._newPins[i].time >= this._newPins[i+1].time) {\n\t\t\t\tthis._newPins.splice(i, 1);\n\t\t\t} else {\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\t\n\t\tremoveRedundantPins(this._newPins);\n\t\t\n\t\tconst firstInterval: number = this._newPins[0].interval;\n\t\tconst firstTime: number = this._newPins[0].time;\n\t\tfor (let i: number = 0; i < this._oldPitches.length; i++) {\n\t\t\tthis._newPitches[i] = this._oldPitches[i] + firstInterval;\n\t\t}\n\t\tfor (let i: number = 0; i < this._newPins.length; i++) {\n\t\t\tthis._newPins[i].interval -= firstInterval;\n\t\t\tthis._newPins[i].time -= firstTime;\n\t\t}\n\t\tthis._newStart = this._oldStart + firstTime;\n\t\tthis._newEnd   = this._newStart + this._newPins[this._newPins.length-1].time;\n\t\t\n\t\tif (continuesLastPattern != undefined) {\n\t\t\tthis._newContinuesLastPattern = continuesLastPattern;\n\t\t}\n\t\tif (this._newStart != 0) {\n\t\t\tthis._newContinuesLastPattern = false;\n\t\t}\n\t\t\n\t\tthis._doForwards();\n\t\tthis._didSomething();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._note.pins = this._newPins;\n\t\tthis._note.pitches = this._newPitches;\n\t\tthis._note.start = this._newStart;\n\t\tthis._note.end = this._newEnd;\n\t\tthis._note.continuesLastPattern = this._newContinuesLastPattern;\n\t\tif (this._doc != null) this._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._note.pins = this._oldPins;\n\t\tthis._note.pitches = this._oldPitches;\n\t\tthis._note.start = this._oldStart;\n\t\tthis._note.end = this._oldEnd;\n\t\tthis._note.continuesLastPattern = this._oldContinuesLastPattern;\n\t\tif (this._doc != null) this._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeCustomizeInstrument extends Change {\n\tconstructor(doc: SongDocument) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tif (instrument.preset != instrument.type) {\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangePreset extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.preset;\n\t\tif (oldValue != newValue) {\n\t\t\tconst preset: Preset | null = EditorConfig.valueToPreset(newValue);\n\t\t\tif (preset != null) {\n\t\t\t\tif (preset.customType != undefined) {\n\t\t\t\t\tinstrument.type = preset.customType;\n\t\t\t\t\tif (!Config.instrumentTypeHasSpecialInterval[instrument.type] && Config.chords[instrument.chord].customInterval) {\n\t\t\t\t\t\tinstrument.chord = 0;\n\t\t\t\t\t}\n\t\t\t\t\tinstrument.clearInvalidEnvelopeTargets();\n\t\t\t\t} else if (preset.settings != undefined) {\n\t\t\t\t\tconst tempVolume: number = instrument.volume;\n\t\t\t\t\tconst tempPan: number = instrument.pan;\n\t\t\t\t\tconst usesPanning: boolean = effectsIncludePanning(instrument.effects);\n\t\t\t\t\tinstrument.fromJsonObject(preset.settings, doc.song.getChannelIsNoise(doc.channel), 1);\n\t\t\t\t\t// Reset the volume and panning effect to be whatever they were before loading a preset. The presets shouldn't override these.\n\t\t\t\t\tinstrument.volume = tempVolume;\n\t\t\t\t\tinstrument.pan = tempPan;\n\t\t\t\t\tif (usesPanning && instrument.pan != Config.panCenter) {\n\t\t\t\t\t\tinstrument.effects = (instrument.effects | (1 << EffectType.panning));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tinstrument.preset = newValue;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeRandomGeneratedInstrument extends Change {\n\tconstructor(doc: SongDocument) {\n\t\tsuper();\n\t\t\n\t\tinterface ItemWeight<T> {\n\t\t\treadonly item: T;\n\t\t\treadonly weight: number;\n\t\t}\n\t\tfunction selectWeightedRandom<T>(entries: ReadonlyArray<ItemWeight<T>>): T {\n\t\t\tlet total: number = 0;\n\t\t\tfor (const entry of entries) {\n\t\t\t\ttotal += entry.weight;\n\t\t\t}\n\t\t\tlet random: number = Math.random() * total;\n\t\t\tfor (const entry of entries) {\n\t\t\t\trandom -= entry.weight;\n\t\t\t\tif (random <= 0.0) return entry.item;\n\t\t\t}\n\t\t\treturn entries[(Math.random() * entries.length)|0].item;\n\t\t}\n\t\tfunction selectCurvedDistribution(min: number, max: number, peak: number, width: number): number {\n\t\t\tconst entries: Array<ItemWeight<number>> = [];\n\t\t\tfor (let i: number = min; i <= max; i++) {\n\t\t\t\tentries.push({item: i, weight: 1.0 / (Math.pow((i - peak) / width, 2.0) + 1.0)});\n\t\t\t}\n\t\t\treturn selectWeightedRandom(entries);\n\t\t}\n\t\t\n\t\tclass PotentialFilterPoint {\n\t\t\tconstructor(\n\t\t\t\tpublic readonly chance: number,\n\t\t\t\tpublic readonly type: FilterType,\n\t\t\t\tpublic readonly minFreq: number,\n\t\t\t\tpublic readonly maxFreq: number,\n\t\t\t\tpublic readonly centerHz: number,\n\t\t\t\tpublic readonly centerGain: number,\n\t\t\t) {};\n\t\t}\n\t\tfunction applyFilterPoints(filter: FilterSettings, potentialPoints: ReadonlyArray<PotentialFilterPoint>): void {\n\t\t\tfilter.reset();\n\t\t\tconst usedFreqs: number[] = [];\n\t\t\tfor (const potentialPoint of potentialPoints) {\n\t\t\t\tif (Math.random() > potentialPoint.chance) continue;\n\t\t\t\tconst point: FilterControlPoint = new FilterControlPoint();\n\t\t\t\tpoint.type = potentialPoint.type;\n\t\t\t\tpoint.freq = selectCurvedDistribution(potentialPoint.minFreq, potentialPoint.maxFreq, FilterControlPoint.getRoundedSettingValueFromHz(potentialPoint.centerHz), 1.0 / Config.filterFreqStep);\n\t\t\t\tpoint.gain = selectCurvedDistribution(0, Config.filterGainRange - 1, Config.filterGainCenter + potentialPoint.centerGain, 2.0 / Config.filterGainStep);\n\t\t\t\tif (point.type == FilterType.peak && point.gain == Config.filterGainCenter) continue; // skip pointless points. :P\n\t\t\t\tif (usedFreqs.includes(point.freq)) continue;\n\t\t\t\tusedFreqs.push(point.freq);\n\t\t\t\tfilter.controlPoints[filter.controlPointCount] = point;\n\t\t\t\tfilter.controlPointCount++;\n\t\t\t}\n\t\t}\n\t\t\n\t\tconst isNoise: boolean = doc.song.getChannelIsNoise(doc.channel);\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tinstrument.effects &= 1 << EffectType.panning; // disable all existing effects except panning.\n\t\tinstrument.envelopeCount = 0;\n\t\t\n\t\tconst midFreq: number = FilterControlPoint.getRoundedSettingValueFromHz(700.0);\n\t\tconst maxFreq: number = Config.filterFreqRange - 1;\n\t\tapplyFilterPoints(instrument.eqFilter, [\n\t\t\tnew PotentialFilterPoint(0.8, FilterType.lowPass,  midFreq, maxFreq,     4000.0, -1),\n\t\t\tnew PotentialFilterPoint(0.4, FilterType.highPass, 0,       midFreq - 1,  250.0, -1),\n\t\t\tnew PotentialFilterPoint(0.5, FilterType.peak,     0,       maxFreq,     2000.0,  0),\n\t\t\tnew PotentialFilterPoint(0.4, FilterType.peak,     0,       maxFreq,     1400.0,  0),\n\t\t\tnew PotentialFilterPoint(0.3, FilterType.peak,     0,       maxFreq,     1000.0,  0),\n\t\t\tnew PotentialFilterPoint(0.2, FilterType.peak,     0,       maxFreq,      500.0,  0),\n\t\t]);\n\t\t\n\t\tif (isNoise) {\n\t\t\tconst type: InstrumentType = selectWeightedRandom([\n\t\t\t\t{item: InstrumentType.noise,    weight: 1},\n\t\t\t\t{item: InstrumentType.spectrum, weight: 3},\n\t\t\t]);\n\t\t\tinstrument.preset = instrument.type = type;\n\t\t\t\n\t\t\tinstrument.fadeIn = (Math.random() < 0.8) ? 0 : selectCurvedDistribution(0, Config.fadeInRange - 1, 0, 2);\n\t\t\tinstrument.fadeOut = selectCurvedDistribution(0, Config.fadeOutTicks.length - 1, Config.fadeOutNeutral, 2);\n\t\t\t\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.transition;\n\t\t\t\tinstrument.transition = Config.transitions.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"normal\"     , weight: 30},\n\t\t\t\t\t{item: \"interrupt\"  , weight: 1},\n\t\t\t\t\t{item: \"slide\"      , weight: 2},\n\t\t\t\t])].index;\n\t\t\t}\n\t\t\tif (Math.random() < 0.2) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.chord;\n\t\t\t\tinstrument.chord = Config.chords.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"strum\"   , weight: 2},\n\t\t\t\t\t{item: \"arpeggio\", weight: 1},\n\t\t\t\t])].index;\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.pitchShift = selectCurvedDistribution(0, Config.pitchShiftRange - 1, Config.pitchShiftCenter, 2);\n\t\t\t\tif (instrument.pitchShift != Config.pitchShiftCenter) {\n\t\t\t\t\tinstrument.effects |= 1 << EffectType.pitchShift;\n\t\t\t\t\tinstrument.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"pitchShift\"].index, 0, Config.envelopes.dictionary[selectWeightedRandom([\n\t\t\t\t\t\t{item: \"flare 1\" , weight: 2},\n\t\t\t\t\t\t{item: \"flare 2\" , weight: 1},\n\t\t\t\t\t\t{item: \"flare 3\" , weight: 1},\n\t\t\t\t\t\t{item: \"twang 1\" , weight: 16},\n\t\t\t\t\t\t{item: \"twang 2\" , weight: 8},\n\t\t\t\t\t\t{item: \"twang 3\" , weight: 4},\n\t\t\t\t\t\t{item: \"tremolo1\", weight: 1},\n\t\t\t\t\t\t{item: \"tremolo2\", weight: 1},\n\t\t\t\t\t\t{item: \"tremolo3\", weight: 1},\n\t\t\t\t\t\t{item: \"decay 1\" , weight: 4},\n\t\t\t\t\t\t{item: \"decay 2\" , weight: 2},\n\t\t\t\t\t\t{item: \"decay 3\" , weight: 1},\n\t\t\t\t\t])].index);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.vibrato;\n\t\t\t\tinstrument.vibrato = selectCurvedDistribution(0, Config.echoSustainRange - 1, Config.echoSustainRange >> 1, 2);\n\t\t\t\tinstrument.vibrato = Config.vibratos.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"light\"  , weight: 2},\n\t\t\t\t\t{item: \"delayed\", weight: 2},\n\t\t\t\t\t{item: \"heavy\"  , weight: 1},\n\t\t\t\t\t{item: \"shaky\"  , weight: 2},\n\t\t\t\t])].index;\n\t\t\t}\n\t\t\tif (Math.random() < 0.8) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.noteFilter;\n\t\t\t\tapplyFilterPoints(instrument.noteFilter, [\n\t\t\t\t\tnew PotentialFilterPoint(1.0, FilterType.lowPass,  midFreq, maxFreq, 8000.0, -1),\n\t\t\t\t]);\n\t\t\t\tinstrument.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"noteFilterAllFreqs\"].index, 0, Config.envelopes.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"punch\"   , weight: 4},\n\t\t\t\t\t{item: \"flare 1\" , weight: 2},\n\t\t\t\t\t{item: \"flare 2\" , weight: 2},\n\t\t\t\t\t{item: \"flare 3\" , weight: 2},\n\t\t\t\t\t{item: \"twang 1\" , weight: 8},\n\t\t\t\t\t{item: \"twang 2\" , weight: 8},\n\t\t\t\t\t{item: \"twang 3\" , weight: 8},\n\t\t\t\t\t{item: \"swell 1\" , weight: 2},\n\t\t\t\t\t{item: \"swell 2\" , weight: 2},\n\t\t\t\t\t{item: \"swell 3\" , weight: 1},\n\t\t\t\t\t{item: \"tremolo1\", weight: 1},\n\t\t\t\t\t{item: \"tremolo2\", weight: 1},\n\t\t\t\t\t{item: \"tremolo3\", weight: 1},\n\t\t\t\t\t{item: \"tremolo4\", weight: 1},\n\t\t\t\t\t{item: \"tremolo5\", weight: 1},\n\t\t\t\t\t{item: \"tremolo6\", weight: 1},\n\t\t\t\t\t{item: \"decay 1\" , weight: 4},\n\t\t\t\t\t{item: \"decay 2\" , weight: 4},\n\t\t\t\t\t{item: \"decay 3\" , weight: 4},\n\t\t\t\t])].index);\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.distortion;\n\t\t\t\tinstrument.distortion = selectCurvedDistribution(1, Config.distortionRange - 1, Config.distortionRange - 1, 2);\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.bitcrusher;\n\t\t\t\tinstrument.bitcrusherFreq = selectCurvedDistribution(0, Config.bitcrusherFreqRange - 1, Config.bitcrusherFreqRange >> 1, 2);\n\t\t\t\tinstrument.bitcrusherQuantization = selectCurvedDistribution(0, Config.bitcrusherQuantizationRange - 1, Config.bitcrusherQuantizationRange >> 1, 2);\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.chorus;\n\t\t\t\tinstrument.chorus = selectCurvedDistribution(1, Config.chorusRange - 1, Config.chorusRange - 1, 1);\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.echoSustain = selectCurvedDistribution(0, Config.echoSustainRange - 1, Config.echoSustainRange >> 1, 2);\n\t\t\t\tinstrument.echoDelay = selectCurvedDistribution(0, Config.echoDelayRange - 1, Config.echoDelayRange >> 1, 2);\n\t\t\t\tif (instrument.echoSustain != 0 || instrument.echoDelay != 0) {\n\t\t\t\t\tinstrument.effects |= 1 << EffectType.echo;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Math.random() < 0.5) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.reverb;\n\t\t\t\tinstrument.reverb = selectCurvedDistribution(1, Config.reverbRange - 1, 1, 1);\n\t\t\t}\n\t\t\t\n\t\t\tfunction normalize(harmonics: number[]): void {\n\t\t\t\tlet max: number = 0;\n\t\t\t\tfor (const value of harmonics) {\n\t\t\t\t\tif (value > max) max = value;\n\t\t\t\t}\n\t\t\t\tfor (let i: number = 0; i < harmonics.length; i++) {\n\t\t\t\t\tharmonics[i] = Config.harmonicsMax * harmonics[i] / max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch (type) {\n\t\t\t\tcase InstrumentType.noise: {\n\t\t\t\t\tinstrument.chipNoise = (Math.random() * Config.chipNoises.length)|0;\n\t\t\t\t} break;\n\t\t\t\tcase InstrumentType.spectrum: {\n\t\t\t\t\tconst spectrumGenerators: Function[] = [\n\t\t\t\t\t\t(): number[] => {\n\t\t\t\t\t\t\tconst spectrum: number[] = [];\n\t\t\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\t\t\tspectrum[i] = (Math.random() < 0.5) ? Math.random() : 0.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn spectrum;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(): number[] => {\n\t\t\t\t\t\t\tlet current: number = 1.0;\n\t\t\t\t\t\t\tconst spectrum: number[] = [current];\n\t\t\t\t\t\t\tfor (let i = 1; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\t\t\tcurrent *= Math.pow(2, Math.random() - 0.52);\n\t\t\t\t\t\t\t\tspectrum[i] = current;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn spectrum;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(): number[] => {\n\t\t\t\t\t\t\tlet current: number = 1.0;\n\t\t\t\t\t\t\tconst spectrum: number[] = [current];\n\t\t\t\t\t\t\tfor (let i = 1; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\t\t\tcurrent *= Math.pow(2, Math.random() - 0.52);\n\t\t\t\t\t\t\t\tspectrum[i] = current * Math.random();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn spectrum;\n\t\t\t\t\t\t},\n\t\t\t\t\t];\n\t\t\t\t\tconst generator = spectrumGenerators[(Math.random() * spectrumGenerators.length)|0];\n\t\t\t\t\tconst spectrum: number[] = generator();\n\t\t\t\t\tnormalize(spectrum);\n\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\tinstrument.spectrumWave.spectrum[i] = Math.round(spectrum[i]);\n\t\t\t\t\t}\n\t\t\t\t\tinstrument.spectrumWave.markCustomWaveDirty();\n\t\t\t\t} break;\n\t\t\t\tdefault: throw new Error(\"Unhandled noise instrument type in random generator.\");\n\t\t\t}\n\t\t} else {\n\t\t\tconst type: InstrumentType = selectWeightedRandom([\n\t\t\t\t{item: InstrumentType.chip,         weight: 4},\n\t\t\t\t{item: InstrumentType.pwm,          weight: 4},\n\t\t\t\t{item: InstrumentType.harmonics,    weight: 5},\n\t\t\t\t{item: InstrumentType.pickedString, weight: 5},\n\t\t\t\t{item: InstrumentType.spectrum,     weight: 1},\n\t\t\t\t{item: InstrumentType.fm,           weight: 5},\n\t\t\t]);\n\t\t\tinstrument.preset = instrument.type = type;\n\t\t\t\n\t\t\tinstrument.fadeIn = (Math.random() < 0.5) ? 0 : selectCurvedDistribution(0, Config.fadeInRange - 1, 0, 2);\n\t\t\tinstrument.fadeOut = selectCurvedDistribution(0, Config.fadeOutTicks.length - 1, Config.fadeOutNeutral, 2);\n\t\t\tif (type == InstrumentType.chip || type == InstrumentType.harmonics || type == InstrumentType.pickedString) {\n\t\t\t\tinstrument.unison = Config.unisons.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"none\"      , weight: 10},\n\t\t\t\t\t{item: \"shimmer\"   , weight: 5},\n\t\t\t\t\t{item: \"hum\"       , weight: 4},\n\t\t\t\t\t{item: \"honky tonk\", weight: 3},\n\t\t\t\t\t{item: \"dissonant\" , weight: 1},\n\t\t\t\t\t{item: \"fifth\"     , weight: 1},\n\t\t\t\t\t{item: \"octave\"    , weight: 2},\n\t\t\t\t\t{item: \"bowed\"     , weight: 2},\n\t\t\t\t\t{item: \"piano\"     , weight: 5},\n\t\t\t\t])].index;\n\t\t\t}\n\t\t\t\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.transition;\n\t\t\t\tinstrument.transition = Config.transitions.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"interrupt\"  , weight: 1},\n\t\t\t\t\t{item: \"slide\"      , weight: 2},\n\t\t\t\t])].index;\n\t\t\t}\n\t\t\tif (Math.random() < 0.2) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.chord;\n\t\t\t\tinstrument.chord = Config.chords.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"strum\"   ,     weight: 2},\n\t\t\t\t\t{item: \"arpeggio\",     weight: 1},\n\t\t\t\t])].index;\n\t\t\t}\n\t\t\tif (Math.random() < 0.05) {\n\t\t\t\tinstrument.pitchShift = selectCurvedDistribution(0, Config.pitchShiftRange - 1, Config.pitchShiftCenter, 1);\n\t\t\t\tif (instrument.pitchShift != Config.pitchShiftCenter) {\n\t\t\t\t\tinstrument.effects |= 1 << EffectType.pitchShift;\n\t\t\t\t\tinstrument.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"pitchShift\"].index, 0, Config.envelopes.dictionary[selectWeightedRandom([\n\t\t\t\t\t\t{item: \"flare 1\" , weight: 2},\n\t\t\t\t\t\t{item: \"flare 2\" , weight: 1},\n\t\t\t\t\t\t{item: \"flare 3\" , weight: 1},\n\t\t\t\t\t\t{item: \"twang 1\" , weight: 16},\n\t\t\t\t\t\t{item: \"twang 2\" , weight: 8},\n\t\t\t\t\t\t{item: \"twang 3\" , weight: 4},\n\t\t\t\t\t\t{item: \"decay 1\" , weight: 4},\n\t\t\t\t\t\t{item: \"decay 2\" , weight: 2},\n\t\t\t\t\t\t{item: \"decay 3\" , weight: 1},\n\t\t\t\t\t])].index);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Math.random() < 0.25) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.vibrato;\n\t\t\t\tinstrument.vibrato = selectCurvedDistribution(0, Config.echoSustainRange - 1, Config.echoSustainRange >> 1, 2);\n\t\t\t\tinstrument.vibrato = Config.vibratos.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"light\"  , weight: 2},\n\t\t\t\t\t{item: \"delayed\", weight: 2},\n\t\t\t\t\t{item: \"heavy\"  , weight: 1},\n\t\t\t\t\t{item: \"shaky\"  , weight: 2},\n\t\t\t\t])].index;\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.distortion;\n\t\t\t\tinstrument.distortion = selectCurvedDistribution(1, Config.distortionRange - 1, Config.distortionRange - 1, 2);\n\t\t\t}\n\t\t\tif (effectsIncludeDistortion(instrument.effects) && Math.random() < 0.8) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.noteFilter;\n\t\t\t\tapplyFilterPoints(instrument.noteFilter, [\n\t\t\t\t\tnew PotentialFilterPoint(1.0, FilterType.lowPass,  midFreq, maxFreq,     2000.0, -1),\n\t\t\t\t\tnew PotentialFilterPoint(0.9, FilterType.highPass, 0,       midFreq - 1,  500.0, -1),\n\t\t\t\t\tnew PotentialFilterPoint(0.4, FilterType.peak,     0,       maxFreq,     1400.0,  0),\n\t\t\t\t]);\n\t\t\t} else if (Math.random() < 0.5) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.noteFilter;\n\t\t\t\tapplyFilterPoints(instrument.noteFilter, [\n\t\t\t\t\tnew PotentialFilterPoint(1.0, FilterType.lowPass,  midFreq, maxFreq, 8000.0, -1),\n\t\t\t\t]);\n\t\t\t\tinstrument.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"noteFilterAllFreqs\"].index, 0, Config.envelopes.dictionary[selectWeightedRandom([\n\t\t\t\t\t{item: \"punch\"   , weight: 6},\n\t\t\t\t\t{item: \"flare 1\" , weight: 2},\n\t\t\t\t\t{item: \"flare 2\" , weight: 4},\n\t\t\t\t\t{item: \"flare 3\" , weight: 2},\n\t\t\t\t\t{item: \"twang 1\" , weight: 2},\n\t\t\t\t\t{item: \"twang 2\" , weight: 4},\n\t\t\t\t\t{item: \"twang 3\" , weight: 4},\n\t\t\t\t\t{item: \"swell 1\" , weight: 4},\n\t\t\t\t\t{item: \"swell 2\" , weight: 2},\n\t\t\t\t\t{item: \"swell 3\" , weight: 1},\n\t\t\t\t\t{item: \"tremolo1\", weight: 1},\n\t\t\t\t\t{item: \"tremolo2\", weight: 1},\n\t\t\t\t\t{item: \"tremolo3\", weight: 1},\n\t\t\t\t\t{item: \"tremolo4\", weight: 1},\n\t\t\t\t\t{item: \"tremolo5\", weight: 1},\n\t\t\t\t\t{item: \"tremolo6\", weight: 1},\n\t\t\t\t\t{item: \"decay 1\" , weight: 1},\n\t\t\t\t\t{item: \"decay 2\" , weight: 2},\n\t\t\t\t\t{item: \"decay 3\" , weight: 2},\n\t\t\t\t])].index);\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.bitcrusher;\n\t\t\t\tinstrument.bitcrusherFreq = selectCurvedDistribution(0, Config.bitcrusherFreqRange - 1, 0, 2);\n\t\t\t\tinstrument.bitcrusherQuantization = selectCurvedDistribution(0, Config.bitcrusherQuantizationRange - 1, Config.bitcrusherQuantizationRange >> 1, 2);\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.chorus;\n\t\t\t\tinstrument.chorus = selectCurvedDistribution(1, Config.chorusRange - 1, Config.chorusRange - 1, 1);\n\t\t\t}\n\t\t\tif (Math.random() < 0.1) {\n\t\t\t\tinstrument.echoSustain = selectCurvedDistribution(0, Config.echoSustainRange - 1, Config.echoSustainRange >> 1, 2);\n\t\t\t\tinstrument.echoDelay = selectCurvedDistribution(0, Config.echoDelayRange - 1, Config.echoDelayRange >> 1, 2);\n\t\t\t\tif (instrument.echoSustain != 0 || instrument.echoDelay != 0) {\n\t\t\t\t\tinstrument.effects |= 1 << EffectType.echo;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Math.random() < 0.5) {\n\t\t\t\tinstrument.effects |= 1 << EffectType.reverb;\n\t\t\t\tinstrument.reverb = selectCurvedDistribution(1, Config.reverbRange - 1, 1, 1);\n\t\t\t}\n\t\t\t\n\t\t\tfunction normalize(harmonics: number[]): void {\n\t\t\t\tlet max: number = 0;\n\t\t\t\tfor (const value of harmonics) {\n\t\t\t\t\tif (value > max) max = value;\n\t\t\t\t}\n\t\t\t\tfor (let i: number = 0; i < harmonics.length; i++) {\n\t\t\t\t\tharmonics[i] = Config.harmonicsMax * harmonics[i] / max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch (type) {\n\t\t\t\tcase InstrumentType.chip: {\n\t\t\t\t\tinstrument.chipWave = (Math.random() * Config.chipWaves.length)|0;\n\t\t\t\t} break;\n\t\t\t\tcase InstrumentType.pwm: {\n\t\t\t\t\tinstrument.pulseWidth = selectCurvedDistribution(0, Config.pulseWidthRange - 1, Config.pulseWidthRange - 1, 2);\n\t\t\t\t\t\n\t\t\t\t\tif (Math.random() < 0.6) {\n\t\t\t\t\t\tinstrument.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"pulseWidth\"].index, 0, Config.envelopes.dictionary[selectWeightedRandom([\n\t\t\t\t\t\t\t{item: \"punch\"   , weight: 6},\n\t\t\t\t\t\t\t{item: \"flare 1\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"flare 2\" , weight: 4},\n\t\t\t\t\t\t\t{item: \"flare 3\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"twang 1\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"twang 2\" , weight: 4},\n\t\t\t\t\t\t\t{item: \"twang 3\" , weight: 4},\n\t\t\t\t\t\t\t{item: \"swell 1\" , weight: 4},\n\t\t\t\t\t\t\t{item: \"swell 2\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"swell 3\" , weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo1\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo2\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo3\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo4\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo5\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo6\", weight: 1},\n\t\t\t\t\t\t\t{item: \"decay 1\" , weight: 1},\n\t\t\t\t\t\t\t{item: \"decay 2\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"decay 3\" , weight: 2},\n\t\t\t\t\t\t])].index);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase InstrumentType.pickedString:\n\t\t\t\tcase InstrumentType.harmonics: {\n\t\t\t\t\tif (type == InstrumentType.pickedString) {\n\t\t\t\t\t\tinstrument.stringSustain = (Math.random() * Config.stringSustainRange)|0;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst harmonicGenerators: Function[] = [\n\t\t\t\t\t\t(): number[] => {\n\t\t\t\t\t\t\tconst harmonics: number[] = [];\n\t\t\t\t\t\t\tfor (let i: number = 0; i < Config.harmonicsControlPoints; i++) {\n\t\t\t\t\t\t\t\tharmonics[i] = (Math.random() < 0.4) ? Math.random() : 0.0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tharmonics[(Math.random() * 8)|0] = Math.pow(Math.random(), 0.25);\n\t\t\t\t\t\t\treturn harmonics;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(): number[] => {\n\t\t\t\t\t\t\tlet current: number = 1.0;\n\t\t\t\t\t\t\tconst harmonics: number[] = [current];\n\t\t\t\t\t\t\tfor (let i = 1; i < Config.harmonicsControlPoints; i++) {\n\t\t\t\t\t\t\t\tcurrent *= Math.pow(2, Math.random() - 0.55);\n\t\t\t\t\t\t\t\tharmonics[i] = current;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn harmonics;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(): number[] => {\n\t\t\t\t\t\t\tlet current: number = 1.0;\n\t\t\t\t\t\t\tconst harmonics: number[] = [current];\n\t\t\t\t\t\t\tfor (let i = 1; i < Config.harmonicsControlPoints; i++) {\n\t\t\t\t\t\t\t\tcurrent *= Math.pow(2, Math.random() - 0.55);\n\t\t\t\t\t\t\t\tharmonics[i] = current * Math.random();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn harmonics;\n\t\t\t\t\t\t},\n\t\t\t\t\t];\n\t\t\t\t\tconst generator = harmonicGenerators[(Math.random() * harmonicGenerators.length)|0];\n\t\t\t\t\tconst harmonics: number[] = generator();\n\t\t\t\t\tnormalize(harmonics);\n\t\t\t\t\tfor (let i: number = 0; i < Config.harmonicsControlPoints; i++) {\n\t\t\t\t\t\tinstrument.harmonicsWave.harmonics[i] = Math.round(harmonics[i]);\n\t\t\t\t\t}\n\t\t\t\t\tinstrument.harmonicsWave.markCustomWaveDirty();\n\t\t\t\t} break;\n\t\t\t\tcase InstrumentType.spectrum: {\n\t\t\t\t\tconst spectrum: number[] = [];\n\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\tconst isHarmonic: boolean = i==0 || i==7 || i==11 || i==14 || i==16 || i==18 || i==21;\n\t\t\t\t\t\tif (isHarmonic) {\n\t\t\t\t\t\t\tspectrum[i] = Math.pow(Math.random(), 0.25);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tspectrum[i] = Math.pow(Math.random(), 3) * 0.5;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnormalize(spectrum);\n\t\t\t\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\t\t\t\tinstrument.spectrumWave.spectrum[i] = Math.round(spectrum[i]);\n\t\t\t\t\t}\n\t\t\t\t\tinstrument.spectrumWave.markCustomWaveDirty();\n\t\t\t\t} break;\n\t\t\t\tcase InstrumentType.fm: {\n\t\t\t\t\tinstrument.algorithm = (Math.random() * Config.algorithms.length)|0;\n\t\t\t\t\tinstrument.feedbackType = (Math.random() * Config.feedbacks.length)|0;\n\t\t\t\t\tconst algorithm: Algorithm = Config.algorithms[instrument.algorithm];\n\t\t\t\t\tfor (let i: number = 0; i < algorithm.carrierCount; i++) {\n\t\t\t\t\t\tinstrument.operators[i].frequency = selectCurvedDistribution(0, Config.operatorFrequencies.length - 1, 0, 3);\n\t\t\t\t\t\tinstrument.operators[i].amplitude = selectCurvedDistribution(0, Config.operatorAmplitudeMax, Config.operatorAmplitudeMax - 1, 2);\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i: number = algorithm.carrierCount; i < Config.operatorCount; i++) {\n\t\t\t\t\t\tinstrument.operators[i].frequency = selectCurvedDistribution(3, Config.operatorFrequencies.length - 1, 0, 3);\n\t\t\t\t\t\tinstrument.operators[i].amplitude = (Math.pow(Math.random(), 2) * Config.operatorAmplitudeMax)|0;\n\t\t\t\t\t\tif (instrument.envelopeCount < Config.maxEnvelopeCount && Math.random() < 0.4) {\n\t\t\t\t\t\t\tinstrument.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"operatorAmplitude\"].index, i, Config.envelopes.dictionary[selectWeightedRandom([\n\t\t\t\t\t\t\t\t{item: \"punch\"   , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"flare 1\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"flare 2\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"flare 3\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"twang 1\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"twang 2\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"twang 3\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"swell 1\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"swell 2\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"swell 3\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"tremolo1\", weight: 1},\n\t\t\t\t\t\t\t\t{item: \"tremolo2\", weight: 1},\n\t\t\t\t\t\t\t\t{item: \"tremolo3\", weight: 1},\n\t\t\t\t\t\t\t\t{item: \"tremolo4\", weight: 1},\n\t\t\t\t\t\t\t\t{item: \"tremolo5\", weight: 1},\n\t\t\t\t\t\t\t\t{item: \"tremolo6\", weight: 1},\n\t\t\t\t\t\t\t\t{item: \"decay 1\" , weight: 1},\n\t\t\t\t\t\t\t\t{item: \"decay 2\" , weight: 1},\n\t\t\t\t\t\t\t\t{item: \"decay 3\" , weight: 1},\n\t\t\t\t\t\t\t])].index);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (instrument.envelopeCount < Config.maxEnvelopeCount && Math.random() < 0.05) {\n\t\t\t\t\t\t\tinstrument.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"operatorFrequency\"].index, i, Config.envelopes.dictionary[selectWeightedRandom([\n\t\t\t\t\t\t\t\t{item: \"punch\"   , weight: 4},\n\t\t\t\t\t\t\t\t{item: \"flare 1\" , weight: 4},\n\t\t\t\t\t\t\t\t{item: \"flare 2\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"flare 3\" , weight: 1},\n\t\t\t\t\t\t\t\t{item: \"twang 1\" , weight: 16},\n\t\t\t\t\t\t\t\t{item: \"twang 2\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"twang 3\" , weight: 1},\n\t\t\t\t\t\t\t\t{item: \"swell 1\" , weight: 4},\n\t\t\t\t\t\t\t\t{item: \"swell 2\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"swell 3\" , weight: 1},\n\t\t\t\t\t\t\t\t{item: \"decay 1\" , weight: 2},\n\t\t\t\t\t\t\t\t{item: \"decay 2\" , weight: 1},\n\t\t\t\t\t\t\t\t{item: \"decay 3\" , weight: 1},\n\t\t\t\t\t\t\t])].index);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tinstrument.feedbackAmplitude = (Math.pow(Math.random(), 3) * Config.operatorAmplitudeMax)|0;\n\t\t\t\t\tif (instrument.envelopeCount < Config.maxEnvelopeCount && Math.random() < 0.4) {\n\t\t\t\t\t\tinstrument.addEnvelope(Config.instrumentAutomationTargets.dictionary[\"feedbackAmplitude\"].index, 0, Config.envelopes.dictionary[selectWeightedRandom([\n\t\t\t\t\t\t\t{item: \"punch\"   , weight: 2},\n\t\t\t\t\t\t\t{item: \"flare 1\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"flare 2\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"flare 3\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"twang 1\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"twang 2\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"twang 3\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"swell 1\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"swell 2\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"swell 3\" , weight: 2},\n\t\t\t\t\t\t\t{item: \"tremolo1\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo2\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo3\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo4\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo5\", weight: 1},\n\t\t\t\t\t\t\t{item: \"tremolo6\", weight: 1},\n\t\t\t\t\t\t\t{item: \"decay 1\" , weight: 1},\n\t\t\t\t\t\t\t{item: \"decay 2\" , weight: 1},\n\t\t\t\t\t\t\t{item: \"decay 3\" , weight: 1},\n\t\t\t\t\t\t])].index);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tdefault: throw new Error(\"Unhandled pitched instrument type in random generator.\");\n\t\t\t}\n\t\t}\n\t\t\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeTransition extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.transition;\n\t\tif (oldValue != newValue) {\n\t\t\tthis._didSomething();\n\t\t\tinstrument.transition = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t}\n\t}\n}\n\nexport class ChangeToggleEffects extends Change {\n\tconstructor(doc: SongDocument, toggleFlag: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.effects;\n\t\tconst wasSelected: boolean = ((oldValue & (1 << toggleFlag)) != 0);\n\t\tconst newValue: number = wasSelected ? (oldValue & (~(1 << toggleFlag))) : (oldValue | (1 << toggleFlag));\n\t\tinstrument.effects = newValue;\n\t\t// As a special case, toggling the panning effect doesn't remove the preset.\n\t\tif (toggleFlag != EffectType.panning) instrument.preset = instrument.type;\n\t\tif (wasSelected) instrument.clearInvalidEnvelopeTargets();\n\t\tthis._didSomething();\n\t\tdoc.notifier.changed();\n\t}\n}\n\nexport class ChangePatternNumbers extends Change {\n\tconstructor(doc: SongDocument, value: number, startBar: number, startChannel: number, width: number, height: number) {\n\t\tsuper();\n\t\tif (value > doc.song.patternsPerChannel) throw new Error(\"invalid pattern\");\n\t\t\n\t\tfor (let bar: number = startBar; bar < startBar + width; bar++) {\n\t\t\tfor (let channelIndex: number = startChannel; channelIndex < startChannel + height; channelIndex++) {\n\t\t\t\tif (doc.song.channels[channelIndex].bars[bar] != value) {\n\t\t\t\t\tdoc.song.channels[channelIndex].bars[bar] = value;\n\t\t\t\t\tthis._didSomething();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tdoc.notifier.changed();\n\t}\n}\n\nexport class ChangeBarCount extends Change {\n\tconstructor(doc: SongDocument, newValue: number, atBeginning: boolean) {\n\t\tsuper();\n\t\tif (doc.song.barCount != newValue) {\n\t\t\tfor (const channel of doc.song.channels) {\n\t\t\t\tif (atBeginning) {\n\t\t\t\t\twhile (channel.bars.length < newValue) {\n\t\t\t\t\t\tchannel.bars.unshift(0);\n\t\t\t\t\t}\n\t\t\t\t\tif (doc.song.barCount > newValue) {\n\t\t\t\t\t\tchannel.bars.splice(0, doc.song.barCount - newValue);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\twhile (channel.bars.length < newValue) {\n\t\t\t\t\t\tchannel.bars.push(0);\n\t\t\t\t\t}\n\t\t\t\t\tchannel.bars.length = newValue;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (atBeginning) {\n\t\t\t\tconst diff: number = newValue - doc.song.barCount;\n\t\t\t\tdoc.bar = Math.max(0, doc.bar + diff);\n\t\t\t\tif (diff < 0 || doc.barScrollPos > 0) {\n\t\t\t\t\tdoc.barScrollPos = Math.max(0, doc.barScrollPos + diff);\n\t\t\t\t}\n\t\t\t\tdoc.song.loopStart = Math.max(0, doc.song.loopStart + diff);\n\t\t\t}\n\t\t\tdoc.bar = Math.min(doc.bar, newValue - 1);\n\t\t\tdoc.barScrollPos = Math.max(0, Math.min(newValue - doc.trackVisibleBars, doc.barScrollPos));\n\t\t\tdoc.song.loopLength = Math.min(newValue, doc.song.loopLength);\n\t\t\tdoc.song.loopStart = Math.min(newValue - doc.song.loopLength, doc.song.loopStart);\n\t\t\tdoc.song.barCount = newValue;\n\t\t\tdoc.notifier.changed();\n\t\t\t\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeInsertBars extends Change {\n\tconstructor(doc: SongDocument, start: number, count: number) {\n\t\tsuper();\n\t\t\n\t\tconst newLength: number = Math.min(Config.barCountMax, doc.song.barCount + count);\n\t\tcount = newLength - doc.song.barCount;\n\t\tif (count == 0) return;\n\t\t\n\t\tfor (const channel of doc.song.channels) {\n\t\t\twhile (channel.bars.length < newLength) {\n\t\t\t\tchannel.bars.splice(start, 0, 0);\n\t\t\t}\n\t\t}\n\t\tdoc.song.barCount = newLength;\n\t\t\n\t\tdoc.bar += count;\n\t\tdoc.barScrollPos = Math.min(newLength - doc.trackVisibleBars, doc.barScrollPos + count);\n\t\tif (doc.song.loopStart >= start) {\n\t\t\tdoc.song.loopStart += count;\n\t\t} else if (doc.song.loopStart + doc.song.loopLength >= start) {\n\t\t\tdoc.song.loopLength += count;\n\t\t}\n\t\t\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeDeleteBars extends Change {\n\tconstructor(doc: SongDocument, start: number, count: number) {\n\t\tsuper();\n\t\t\n\t\tfor (const channel of doc.song.channels) {\n\t\t\tchannel.bars.splice(start, count);\n\t\t\tif (channel.bars.length == 0) channel.bars.push(0);\n\t\t}\n\t\tdoc.song.barCount = Math.max(1, doc.song.barCount - count);\n\t\t\n\t\tdoc.bar = Math.max(0, doc.bar - count);\n\t\tdoc.barScrollPos = Math.max(0, doc.barScrollPos - count);\n\t\tif (doc.song.loopStart >= start) {\n\t\t\tdoc.song.loopStart = Math.max(0, doc.song.loopStart - count);\n\t\t} else if (doc.song.loopStart + doc.song.loopLength > start) {\n\t\t\tdoc.song.loopLength -= count;\n\t\t}\n\t\tdoc.song.loopLength = Math.max(1, Math.min(doc.song.barCount - doc.song.loopStart, doc.song.loopLength));\n\t\t\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeChannelOrder extends Change {\n\tconstructor(doc: SongDocument, selectionMin: number, selectionMax: number, offset: number) {\n\t\tsuper();\n\t\tdoc.song.channels.splice(selectionMin + offset, 0, ...doc.song.channels.splice(selectionMin, selectionMax - selectionMin + 1));\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeChannelCount extends Change {\n\tconstructor(doc: SongDocument, newPitchChannelCount: number, newNoiseChannelCount: number) {\n\t\tsuper();\n\t\tif (doc.song.pitchChannelCount != newPitchChannelCount || doc.song.noiseChannelCount != newNoiseChannelCount) {\n\t\t\tconst newChannels: Channel[] = [];\n\t\t\t\n\t\t\tfunction changeGroup(newCount: number, oldCount: number, newStart: number, oldStart: number, octave: number, isNoise: boolean): void {\n\t\t\t\tfor (let i: number = 0; i < newCount; i++) {\n\t\t\t\t\tconst channelIndex = i + newStart;\n\t\t\t\t\tconst oldChannel = i + oldStart;\n\t\t\t\t\tif (i < oldCount) {\n\t\t\t\t\t\tnewChannels[channelIndex] = doc.song.channels[oldChannel]\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewChannels[channelIndex] = new Channel();\n\t\t\t\t\t\tnewChannels[channelIndex].octave = octave;\n\t\t\t\t\t\tfor (let j: number = 0; j < Config.instrumentCountMin; j++) {\n\t\t\t\t\t\t\tconst instrument: Instrument = new Instrument(isNoise);\n\t\t\t\t\t\t\tconst presetValue: number = pickRandomPresetValue(isNoise);\n\t\t\t\t\t\t\tconst preset: Preset = EditorConfig.valueToPreset(presetValue)!;\n\t\t\t\t\t\t\tinstrument.fromJsonObject(preset.settings, isNoise);\n\t\t\t\t\t\t\tinstrument.preset = presetValue;\n\t\t\t\t\t\t\tinstrument.volume = 1;\n\t\t\t\t\t\t\tnewChannels[channelIndex].instruments[j] = instrument;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.patternsPerChannel; j++) {\n\t\t\t\t\t\t\tnewChannels[channelIndex].patterns[j] = new Pattern();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.barCount; j++) {\n\t\t\t\t\t\t\tnewChannels[channelIndex].bars[j] = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tchangeGroup(newPitchChannelCount, doc.song.pitchChannelCount, 0, 0, 3, false);\n\t\t\tchangeGroup(newNoiseChannelCount, doc.song.noiseChannelCount, newPitchChannelCount, doc.song.pitchChannelCount, 0, true);\n\t\t\t\n\t\t\tdoc.song.pitchChannelCount = newPitchChannelCount;\n\t\t\tdoc.song.noiseChannelCount = newNoiseChannelCount;\n\t\t\tfor (let channelIndex: number = 0; channelIndex < doc.song.getChannelCount(); channelIndex++) {\n\t\t\t\tdoc.song.channels[channelIndex] = newChannels[channelIndex];\n\t\t\t}\n\t\t\tdoc.song.channels.length = doc.song.getChannelCount();\n\t\t\t\n\t\t\tdoc.channel = Math.min(doc.channel, newPitchChannelCount + newNoiseChannelCount - 1);\n\t\t\tdoc.channelScrollPos = Math.max(0, Math.min(doc.song.getChannelCount() - doc.trackVisibleChannels, doc.channelScrollPos));\n\t\t\tdoc.notifier.changed();\n\t\t\t\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeAddChannel extends ChangeGroup {\n\tconstructor(doc: SongDocument, index: number, isNoise: boolean) {\n\t\tsuper();\n\t\tconst newPitchChannelCount: number = doc.song.pitchChannelCount + (isNoise ? 0 : 1);\n\t\tconst newNoiseChannelCount: number = doc.song.noiseChannelCount + (isNoise ? 1 : 0);\n\t\tif (newPitchChannelCount <= Config.pitchChannelCountMax && newNoiseChannelCount <= Config.noiseChannelCountMax) {\n\t\t\tconst addedChannelIndex: number = isNoise ? doc.song.pitchChannelCount + doc.song.noiseChannelCount : doc.song.pitchChannelCount;\n\t\t\tthis.append(new ChangeChannelCount(doc, newPitchChannelCount, newNoiseChannelCount));\n\t\t\tthis.append(new ChangeChannelOrder(doc, index, addedChannelIndex - 1, 1));\n\t\t}\n\t}\n}\n\nexport class ChangeRemoveChannel extends ChangeGroup {\n\tconstructor(doc: SongDocument, minIndex: number, maxIndex: number) {\n\t\tsuper();\n\t\t\n\t\twhile (maxIndex >= minIndex) {\n\t\t\tconst isNoise: boolean = doc.song.getChannelIsNoise(maxIndex);\n\t\t\tdoc.song.channels.splice(maxIndex, 1);\n\t\t\tif (isNoise) {\n\t\t\t\tdoc.song.noiseChannelCount--;\n\t\t\t} else {\n\t\t\t\tdoc.song.pitchChannelCount--;\n\t\t\t}\n\t\t\tmaxIndex--;\n\t\t}\n\t\t\n\t\tif (doc.song.pitchChannelCount < Config.pitchChannelCountMin) {\n\t\t\tthis.append(new ChangeChannelCount(doc, Config.pitchChannelCountMin, doc.song.noiseChannelCount));\n\t\t}\n\t\t\n\t\tthis.append(new ChangeChannelBar(doc, Math.max(0, minIndex - 1), doc.bar));\n\t\t\n\t\tthis._didSomething();\n\t\tdoc.notifier.changed();\n\t}\n}\n\nexport class ChangeChannelBar extends Change {\n\tconstructor(doc: SongDocument, newChannel: number, newBar: number, silently: boolean = false) {\n\t\tsuper();\n\t\tconst oldChannel: number = doc.channel;\n\t\tconst oldBar: number = doc.bar;\n\t\tdoc.channel = newChannel;\n\t\tdoc.bar = newBar;\n\t\tif (!silently) {\n\t\t\tdoc.barScrollPos = Math.min(doc.bar, Math.max(doc.bar - (doc.trackVisibleBars - 1), doc.barScrollPos));\n\t\t\tdoc.channelScrollPos = Math.min(doc.channel, Math.max(doc.channel - (doc.trackVisibleChannels - 1), doc.channelScrollPos));\n\t\t}\n\t\tdoc.notifier.changed();\n\t\tif (oldChannel != newChannel || oldBar != newBar) {\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeUnison extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.unison;\n\t\tif (oldValue != newValue) {\n\t\t\tthis._didSomething();\n\t\t\tinstrument.unison = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t}\n\t}\n}\n\nexport class ChangeChord extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.chord;\n\t\tif (oldValue != newValue) {\n\t\t\tthis._didSomething();\n\t\t\tinstrument.chord = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t}\n\t}\n}\n\nexport class ChangeVibrato extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.vibrato;\n\t\tif (oldValue != newValue) {\n\t\t\tinstrument.vibrato = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeSpectrum extends Change {\n\tconstructor(doc: SongDocument, instrument: Instrument, spectrumWave: SpectrumWave) {\n\t\tsuper();\n\t\tspectrumWave.markCustomWaveDirty();\n\t\tinstrument.preset = instrument.type;\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeHarmonics extends Change {\n\tconstructor(doc: SongDocument, instrument: Instrument, harmonicsWave: HarmonicsWave) {\n\t\tsuper();\n\t\tharmonicsWave.markCustomWaveDirty();\n\t\tinstrument.preset = instrument.type;\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeDrumsetEnvelope extends Change {\n\tconstructor(doc: SongDocument, drumIndex: number, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.drumsetEnvelopes[drumIndex];\n\t\tif (oldValue != newValue) {\n\t\t\tinstrument.drumsetEnvelopes[drumIndex] = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nclass ChangeInstrumentSlider extends Change {\n\tprotected _instrument: Instrument;\n\tconstructor(private _doc: SongDocument) {\n\t\tsuper();\n\t\tthis._instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t}\n\t\n\tpublic commit(): void {\n\t\tif (!this.isNoop()) {\n\t\t\tthis._instrument.preset = this._instrument.type;\n\t\t\tthis._doc.notifier.changed();\n\t\t}\n\t}\n}\n\nexport class ChangePulseWidth extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.pulseWidth = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangePitchShift extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.pitchShift = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeDetune extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.detune = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeDistortion extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.distortion = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeBitcrusherFreq extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.bitcrusherFreq = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeBitcrusherQuantization extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.bitcrusherQuantization = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeStringSustain extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.stringSustain = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeFilterAddPoint extends UndoableChange {\n\tprivate _doc: SongDocument;\n\tprivate _instrument: Instrument;\n\tprivate _instrumentPrevPreset: number;\n\tprivate _instrumentNextPreset: number;\n\tprivate _filterSettings: FilterSettings;\n\tprivate _point: FilterControlPoint;\n\tprivate _index: number;\n\tprivate _envelopeTargetsAdd: number[] = [];\n\tprivate _envelopeIndicesAdd: number[] = [];\n\tprivate _envelopeTargetsRemove: number[] = [];\n\tprivate _envelopeIndicesRemove: number[] = [];\n\tconstructor(doc: SongDocument, filterSettings: FilterSettings, point: FilterControlPoint, index: number, isNoteFilter: boolean, deletion: boolean = false) {\n\t\tsuper(deletion);\n\t\tthis._doc = doc;\n\t\tthis._instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tthis._instrumentNextPreset = deletion ? this._instrument.preset : this._instrument.type;\n\t\tthis._instrumentPrevPreset = deletion ? this._instrument.type : this._instrument.preset;\n\t\tthis._filterSettings = filterSettings;\n\t\tthis._point = point;\n\t\tthis._index = index;\n\t\t\n\t\tfor (let envelopeIndex: number = 0; envelopeIndex < this._instrument.envelopeCount; envelopeIndex++) {\n\t\t\tlet target: number = this._instrument.envelopes[envelopeIndex].target;\n\t\t\tlet targetIndex: number = this._instrument.envelopes[envelopeIndex].index;\n\t\t\tthis._envelopeTargetsAdd.push(target);\n\t\t\tthis._envelopeIndicesAdd.push(targetIndex);\n\t\t\tif (deletion) {\n\t\t\t\t// When deleting a filter control point, find all envelopes that targeted that\n\t\t\t\t// point and clear them, and all envelopes that targeted later points and\n\t\t\t\t// decrement those to keep them in sync with the new list of points.\n\t\t\t\tconst automationTarget: AutomationTarget = Config.instrumentAutomationTargets[target];\n\t\t\t\tif (automationTarget.isFilter && (automationTarget.effect == EffectType.noteFilter) == isNoteFilter) {\n\t\t\t\t\tif (automationTarget.maxCount == Config.filterMaxPoints) {\n\t\t\t\t\t\tif (targetIndex == index) {\n\t\t\t\t\t\t\ttarget = Config.instrumentAutomationTargets.dictionary[\"none\"].index;\n\t\t\t\t\t\t\ttargetIndex = 0;\n\t\t\t\t\t\t} else if (targetIndex > index) {\n\t\t\t\t\t\t\ttargetIndex--;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (filterSettings.controlPointCount <= 1) {\n\t\t\t\t\t\t\ttarget = Config.instrumentAutomationTargets.dictionary[\"none\"].index;\n\t\t\t\t\t\t\ttargetIndex = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._envelopeTargetsRemove.push(target);\n\t\t\tthis._envelopeIndicesRemove.push(targetIndex);\n\t\t}\n\t\t\n\t\tthis._didSomething();\n\t\tthis.redo();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._filterSettings.controlPoints.splice(this._index, 0, this._point);\n\t\tthis._filterSettings.controlPointCount++;\n\t\tthis._filterSettings.controlPoints.length = this._filterSettings.controlPointCount;\n\t\tthis._instrument.preset = this._instrumentNextPreset;\n\t\tfor (let envelopeIndex: number = 0; envelopeIndex < this._instrument.envelopeCount; envelopeIndex++) {\n\t\t\tthis._instrument.envelopes[envelopeIndex].target = this._envelopeTargetsAdd[envelopeIndex];\n\t\t\tthis._instrument.envelopes[envelopeIndex].index  = this._envelopeIndicesAdd[envelopeIndex];\n\t\t}\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._filterSettings.controlPoints.splice(this._index, 1);\n\t\tthis._filterSettings.controlPointCount--;\n\t\tthis._filterSettings.controlPoints.length = this._filterSettings.controlPointCount;\n\t\tthis._instrument.preset = this._instrumentPrevPreset;\n\t\tfor (let envelopeIndex: number = 0; envelopeIndex < this._instrument.envelopeCount; envelopeIndex++) {\n\t\t\tthis._instrument.envelopes[envelopeIndex].target = this._envelopeTargetsRemove[envelopeIndex];\n\t\t\tthis._instrument.envelopes[envelopeIndex].index  = this._envelopeIndicesRemove[envelopeIndex];\n\t\t}\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeFilterMovePoint extends UndoableChange {\n\tprivate _doc: SongDocument;\n\tprivate _instrument: Instrument;\n\tprivate _instrumentPrevPreset: number;\n\tprivate _instrumentNextPreset: number;\n\tprivate _point: FilterControlPoint;\n\tprivate _oldFreq: number;\n\tprivate _newFreq: number;\n\tprivate _oldGain: number;\n\tprivate _newGain: number;\n\tconstructor(doc: SongDocument, point: FilterControlPoint, oldFreq: number, newFreq: number, oldGain: number, newGain: number) {\n\t\tsuper(false);\n\t\tthis._doc = doc;\n\t\tthis._instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tthis._instrumentNextPreset = this._instrument.type;\n\t\tthis._instrumentPrevPreset = this._instrument.preset;\n\t\tthis._point = point;\n\t\tthis._oldFreq = oldFreq;\n\t\tthis._newFreq = newFreq;\n\t\tthis._oldGain = oldGain;\n\t\tthis._newGain = newGain;\n\t\tthis._didSomething();\n\t\tthis.redo();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._point.freq = this._newFreq;\n\t\tthis._point.gain = this._newGain;\n\t\tthis._instrument.preset = this._instrumentNextPreset;\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._point.freq = this._oldFreq;\n\t\tthis._point.gain = this._oldGain;\n\t\tthis._instrument.preset = this._instrumentPrevPreset;\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeFadeInOut extends UndoableChange {\n\tprivate _doc: SongDocument;\n\tprivate _instrument: Instrument;\n\tprivate _instrumentPrevPreset: number;\n\tprivate _instrumentNextPreset: number;\n\tprivate _oldFadeIn: number;\n\tprivate _oldFadeOut: number;\n\tprivate _newFadeIn: number;\n\tprivate _newFadeOut: number;\n\tconstructor(doc: SongDocument, fadeIn: number, fadeOut: number) {\n\t\tsuper(false);\n\t\tthis._doc = doc;\n\t\tthis._instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tthis._instrumentNextPreset = this._instrument.type;\n\t\tthis._instrumentPrevPreset = this._instrument.preset;\n\t\tthis._oldFadeIn = this._instrument.fadeIn;\n\t\tthis._oldFadeOut = this._instrument.fadeOut;\n\t\tthis._newFadeIn = fadeIn;\n\t\tthis._newFadeOut = fadeOut;\n\t\tthis._didSomething();\n\t\tthis.redo();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._instrument.fadeIn = this._newFadeIn;\n\t\tthis._instrument.fadeOut = this._newFadeOut;\n\t\tthis._instrument.preset = this._instrumentNextPreset;\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._instrument.fadeIn = this._oldFadeIn;\n\t\tthis._instrument.fadeOut = this._oldFadeOut;\n\t\tthis._instrument.preset = this._instrumentPrevPreset;\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeAlgorithm extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.algorithm;\n\t\tif (oldValue != newValue) {\n\t\t\tinstrument.algorithm = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeFeedbackType extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.feedbackType;\n\t\tif (oldValue != newValue) {\n\t\t\tinstrument.feedbackType = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeOperatorFrequency extends Change {\n\tconstructor(doc: SongDocument, operatorIndex: number, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.operators[operatorIndex].frequency;\n\t\tif (oldValue != newValue) {\n\t\t\tinstrument.operators[operatorIndex].frequency = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeOperatorAmplitude extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, operatorIndex: number, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.operators[operatorIndex].amplitude = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeFeedbackAmplitude extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.feedbackAmplitude = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeAddChannelInstrument extends Change {\n\tconstructor(doc: SongDocument) {\n\t\tsuper();\n\t\tconst channel: Channel = doc.song.channels[doc.channel];\n\t\tconst isNoise: boolean = doc.song.getChannelIsNoise(doc.channel);\n\t\tconst maxInstruments: number = doc.song.getMaxInstrumentsPerChannel();\n\t\tif (channel.instruments.length >= maxInstruments) return;\n\t\tconst presetValue: number = pickRandomPresetValue(isNoise);\n\t\tconst preset: Preset = EditorConfig.valueToPreset(presetValue)!;\n\t\tconst instrument: Instrument = new Instrument(isNoise);\n\t\tinstrument.fromJsonObject(preset.settings, isNoise, 1);\n\t\tinstrument.preset = presetValue;\n\t\tinstrument.volume = 1;\n\t\tchannel.instruments.push(instrument);\n\t\tdoc.viewedInstrument[doc.channel] = channel.instruments.length - 1;\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeRemoveChannelInstrument extends Change {\n\tconstructor(doc: SongDocument) {\n\t\tsuper();\n\t\tconst channel: Channel = doc.song.channels[doc.channel];\n\t\tif (channel.instruments.length <= Config.instrumentCountMin) return;\n\t\tconst removedIndex: number = doc.viewedInstrument[doc.channel];\n\t\tchannel.instruments.splice(removedIndex, 1);\n\t\tif (doc.song.patternInstruments) {\n\t\t\tfor (const pattern of channel.patterns) {\n\t\t\t\tfor (let i: number = 0; i < pattern.instruments.length; i++) {\n\t\t\t\t\tif (pattern.instruments[i] == removedIndex) {\n\t\t\t\t\t\tpattern.instruments.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t} else if (pattern.instruments[i] > removedIndex) {\n\t\t\t\t\t\tpattern.instruments[i]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pattern.instruments.length <= 0) {\n\t\t\t\t\tpattern.instruments[0] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeViewInstrument extends Change {\n\tconstructor(doc: SongDocument, index: number) {\n\t\tsuper();\n\t\tif (doc.viewedInstrument[doc.channel] != index) {\n\t\t\tdoc.viewedInstrument[doc.channel] = index;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeInstrumentsFlags extends Change {\n\tconstructor(doc: SongDocument, newLayeredInstruments: boolean, newPatternInstruments: boolean) {\n\t\tsuper();\n\t\tconst oldLayeredInstruments: boolean = doc.song.layeredInstruments;\n\t\tconst oldPatternInstruments: boolean = doc.song.patternInstruments;\n\t\tif (oldLayeredInstruments == newLayeredInstruments && oldPatternInstruments == newPatternInstruments) return;\n\t\tdoc.song.layeredInstruments = newLayeredInstruments;\n\t\tdoc.song.patternInstruments = newPatternInstruments;\n\t\t\n\t\tfor (let channelIndex: number = 0; channelIndex < doc.song.getChannelCount(); channelIndex++) {\n\t\t\tconst channel: Channel = doc.song.channels[channelIndex];\n\t\t\tif (channel.instruments.length > doc.song.getMaxInstrumentsPerChannel()) {\n\t\t\t\tchannel.instruments.length = doc.song.getMaxInstrumentsPerChannel();\n\t\t\t}\n\t\t\tfor (let j: number = 0; j < doc.song.patternsPerChannel; j++) {\n\t\t\t\tconst pattern: Pattern = channel.patterns[j];\n\t\t\t\tif (!oldPatternInstruments && newPatternInstruments) {\n\t\t\t\t\t// patternInstruments was enabled, set up pattern instruments as appropriate.\n\t\t\t\t\tfor (let i: number = 0; i < channel.instruments.length; i++) {\n\t\t\t\t\t\tpattern.instruments[i] = i;\n\t\t\t\t\t}\n\t\t\t\t\tpattern.instruments.length = channel.instruments.length;\n\t\t\t\t}\n\t\t\t\tdiscardInvalidPatternInstruments(pattern.instruments, doc.song, channelIndex);\n\t\t\t}\n\t\t}\n\t\t\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeKey extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tif (doc.song.key != newValue) {\n\t\t\tdoc.song.key = newValue;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeLoop extends Change {\n\tconstructor(private _doc: SongDocument, public oldStart: number, public oldLength: number, public newStart: number, public newLength: number) {\n\t\tsuper();\n\t\tthis._doc.song.loopStart = this.newStart;\n\t\tthis._doc.song.loopLength = this.newLength;\n\t\tthis._doc.notifier.changed();\n\t\tif (this.oldStart != this.newStart || this.oldLength != this.newLength) {\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangePitchAdded extends UndoableChange {\n\tprivate _doc: SongDocument;\n\tprivate _note: Note;\n\tprivate _pitch: number;\n\tprivate _index: number;\n\tconstructor(doc: SongDocument, note: Note, pitch: number, index: number, deletion: boolean = false) {\n\t\tsuper(deletion);\n\t\tthis._doc = doc;\n\t\tthis._note = note;\n\t\tthis._pitch = pitch;\n\t\tthis._index = index;\n\t\tthis._didSomething();\n\t\tthis.redo();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._note.pitches.splice(this._index, 0, this._pitch);\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._note.pitches.splice(this._index, 1);\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeOctave extends Change {\n\tconstructor(doc: SongDocument, public oldValue: number, newValue: number) {\n\t\tsuper();\n\t\tdoc.song.channels[doc.channel].octave = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeRhythm extends ChangeGroup {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\t\n\t\tif (doc.song.rhythm != newValue) {\n\t\t\tdoc.song.rhythm = newValue;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangePaste extends ChangeGroup {\n\tconstructor(doc: SongDocument, pattern: Pattern, notes: any[], selectionStart: number, selectionEnd: number, oldPartDuration: number) {\n\t\tsuper();\n\t\t\n\t\t// Erase the current contents of the selection:\n\t\tthis.append(new ChangeNoteTruncate(doc, pattern, selectionStart, selectionEnd));\n\t\t\n\t\tlet noteInsertionIndex: number = 0;\n\t\tfor (let i: number = 0; i < pattern.notes.length; i++) {\n\t\t\tif (pattern.notes[i].start < selectionStart) {\n\t\t\t\tif (pattern.notes[i].end > selectionStart) throw new Error();\n\t\t\t\t\n\t\t\t\tnoteInsertionIndex = i + 1;\n\t\t\t} else if (pattern.notes[i].start < selectionEnd) {\n\t\t\t\tthrow new Error();\n\t\t\t}\n\t\t}\n\t\t\n\t\twhile (selectionStart < selectionEnd) {\n\t\t\tfor (const noteObject of notes) {\n\t\t\t\tconst noteStart: number = noteObject[\"start\"] + selectionStart;\n\t\t\t\tconst noteEnd: number = noteObject[\"end\"] + selectionStart;\n\t\t\t\tif (noteStart >= selectionEnd) break;\n\t\t\t\tconst note: Note = new Note(noteObject[\"pitches\"][0], noteStart, noteEnd, noteObject[\"pins\"][0][\"size\"], false);\n\t\t\t\tnote.pitches.length = 0;\n\t\t\t\tfor (const pitch of noteObject[\"pitches\"]) {\n\t\t\t\t\tnote.pitches.push(pitch);\n\t\t\t\t}\n\t\t\t\tnote.pins.length = 0;\n\t\t\t\tfor (const pin of noteObject[\"pins\"]) {\n\t\t\t\t\tnote.pins.push(makeNotePin(pin.interval, pin.time, pin.size));\n\t\t\t\t}\n\t\t\t\tnote.continuesLastPattern = (noteObject[\"continuesLastPattern\"] === true) && (note.start == 0);\n\t\t\t\tpattern.notes.splice(noteInsertionIndex++, 0, note);\n\t\t\t\tif (note.end > selectionEnd) {\n\t\t\t\t\tthis.append(new ChangeNoteLength(doc, note, note.start, selectionEnd));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tselectionStart += oldPartDuration;\n\t\t}\n\t\t\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangePasteInstrument extends ChangeGroup {\n\tconstructor(doc: SongDocument, instrument: Instrument, instrumentCopy: any) {\n\t\tsuper();\n\t\tinstrument.fromJsonObject(instrumentCopy, instrumentCopy[\"isDrum\"]);\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeSetPatternInstruments extends Change {\n\tconstructor(doc: SongDocument, channelIndex: number, instruments: number[], pattern: Pattern) {\n\t\tsuper();\n\t\tif (!patternsContainSameInstruments(instruments, pattern.instruments)) {\n\t\t\tpattern.instruments.length = 0;\n\t\t\tpattern.instruments.push(...instruments);\n\t\t\tdiscardInvalidPatternInstruments(pattern.instruments, doc.song, channelIndex);\n\t\t\tthis._didSomething();\n\t\t\tdoc.notifier.changed();\n\t\t}\n\t}\n}\n\nexport class ChangePatternsPerChannel extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tif (doc.song.patternsPerChannel != newValue) {\n\t\t\tfor (let i: number = 0; i < doc.song.getChannelCount(); i++) {\n\t\t\t\tconst channelBars: number[] = doc.song.channels[i].bars;\n\t\t\t\tconst channelPatterns: Pattern[] = doc.song.channels[i].patterns;\n\t\t\t\tfor (let j: number = 0; j < channelBars.length; j++) {\n\t\t\t\t\tif (channelBars[j] > newValue) channelBars[j] = 0;\n\t\t\t\t}\n\t\t\t\tfor (let j: number = channelPatterns.length; j < newValue; j++) {\n\t\t\t\t\tchannelPatterns[j] = new Pattern();\n\t\t\t\t}\n\t\t\t\tchannelPatterns.length = newValue;\n\t\t\t}\n\t\t\tdoc.song.patternsPerChannel = newValue;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeEnsurePatternExists extends UndoableChange {\n\tprivate _doc: SongDocument;\n\tprivate _bar: number;\n\tprivate _channelIndex: number;\n\tprivate _patternIndex: number;\n\tprivate _patternOldNotes: Note[] | null = null;\n\tprivate _oldPatternCount: number;\n\tprivate _newPatternCount: number;\n\tprivate _oldPatternInstruments: number[] | null = null;\n\tprivate _newPatternInstruments: number[];\n\t\n\tconstructor(doc: SongDocument, channelIndex: number, bar: number) {\n\t\tsuper(false);\n\t\tconst song: Song = doc.song;\n\t\tif (song.channels[channelIndex].bars[bar] != 0) return;\n\t\t\n\t\tthis._doc = doc;\n\t\tthis._bar = bar;\n\t\tthis._channelIndex = channelIndex;\n\t\tthis._oldPatternCount = song.patternsPerChannel;\n\t\tthis._newPatternCount = song.patternsPerChannel;\n\t\tthis._newPatternInstruments = doc.recentPatternInstruments[channelIndex].concat();\n\t\t\n\t\tlet firstEmptyUnusedIndex: number | null = null;\n\t\tlet firstUnusedIndex: number | null = null;\n\t\tfor (let patternIndex: number = 1; patternIndex <= song.patternsPerChannel; patternIndex++) {\n\t\t\tlet used = false;\n\t\t\tfor (let barIndex: number = 0; barIndex < song.barCount; barIndex++) {\n\t\t\t\tif (song.channels[channelIndex].bars[barIndex] == patternIndex) {\n\t\t\t\t\tused = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (used) continue;\n\t\t\tif (firstUnusedIndex == null) {\n\t\t\t\tfirstUnusedIndex = patternIndex;\n\t\t\t}\n\t\t\tconst pattern: Pattern = song.channels[channelIndex].patterns[patternIndex - 1];\n\t\t\tif (pattern.notes.length == 0) {\n\t\t\t\tfirstEmptyUnusedIndex = patternIndex;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (firstEmptyUnusedIndex != null) {\n\t\t\tthis._patternIndex = firstEmptyUnusedIndex;\n\t\t\tthis._oldPatternInstruments = song.channels[channelIndex].patterns[firstEmptyUnusedIndex - 1].instruments.concat();\n\t\t} else if (song.patternsPerChannel < song.barCount) {\n\t\t\tthis._newPatternCount = song.patternsPerChannel + 1;\n\t\t\tthis._patternIndex = song.patternsPerChannel + 1;\n\t\t} else if (firstUnusedIndex != null) {\n\t\t\tthis._patternIndex = firstUnusedIndex;\n\t\t\tthis._patternOldNotes = song.channels[channelIndex].patterns[firstUnusedIndex - 1].notes;\n\t\t\tthis._oldPatternInstruments = song.channels[channelIndex].patterns[firstUnusedIndex - 1].instruments.concat();\n\t\t} else {\n\t\t\tthrow new Error();\n\t\t}\n\t\t\n\t\tthis._didSomething();\n\t\tthis._doForwards();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tconst song: Song = this._doc.song;\n\t\tfor (let j: number = song.patternsPerChannel; j < this._newPatternCount; j++) {\n\t\t\tfor (let i: number = 0; i < song.getChannelCount(); i++) {\n\t\t\t\tsong.channels[i].patterns[j] = new Pattern();\n\t\t\t}\n\t\t}\n\t\tsong.patternsPerChannel = this._newPatternCount;\n\t\tconst pattern: Pattern = song.channels[this._channelIndex].patterns[this._patternIndex - 1];\n\t\tpattern.notes = [];\n\t\tpattern.instruments.length = 0;\n\t\tpattern.instruments.push(...this._newPatternInstruments);\n\t\tsong.channels[this._channelIndex].bars[this._bar] = this._patternIndex;\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tconst song: Song = this._doc.song;\n\t\tconst pattern: Pattern = song.channels[this._channelIndex].patterns[this._patternIndex - 1];\n\t\tif (this._patternOldNotes != null) pattern.notes = this._patternOldNotes;\n\t\tif (this._oldPatternInstruments != null) {\n\t\t\tpattern.instruments.length = 0;\n\t\t\tpattern.instruments.push(...this._oldPatternInstruments);\n\t\t}\n\t\tsong.channels[this._channelIndex].bars[this._bar] = 0;\n\t\tfor (let i: number = 0; i < song.getChannelCount(); i++) {\n\t\t\tsong.channels[i].patterns.length = this._oldPatternCount;\n\t\t}\n\t\tsong.patternsPerChannel = this._oldPatternCount;\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangePinTime extends ChangePins {\n\tconstructor(doc: SongDocument | null, note: Note, pinIndex: number, shiftedTime: number, continuesLastPattern: boolean) {\n\t\tsuper(doc, note);\n\t\t\n\t\tshiftedTime -= this._oldStart;\n\t\tconst originalTime: number = this._oldPins[pinIndex].time;\n\t\tconst skipStart: number = Math.min(originalTime, shiftedTime);\n\t\tconst skipEnd: number = Math.max(originalTime, shiftedTime);\n\t\tlet setPin: boolean = false;\n\t\tfor (let i: number = 0; i < this._oldPins.length; i++) {\n\t\t\tconst oldPin: NotePin = note.pins[i];\n\t\t\tconst time: number = oldPin.time;\n\t\t\tif (time < skipStart) {\n\t\t\t\tthis._newPins.push(makeNotePin(oldPin.interval, time, oldPin.size));\n\t\t\t} else if (time > skipEnd) {\n\t\t\t\tif (!setPin) {\n\t\t\t\t\tif (this._newPins.length > 0) continuesLastPattern = note.continuesLastPattern;\n\t\t\t\t\tthis._newPins.push(makeNotePin(this._oldPins[pinIndex].interval, shiftedTime, this._oldPins[pinIndex].size));\n\t\t\t\t\tsetPin = true;\n\t\t\t\t}\n\t\t\t\tthis._newPins.push(makeNotePin(oldPin.interval, time, oldPin.size));\n\t\t\t}\n\t\t}\n\t\tif (!setPin) {\n\t\t\tcontinuesLastPattern = note.continuesLastPattern;\n\t\t\tthis._newPins.push(makeNotePin(this._oldPins[pinIndex].interval, shiftedTime, this._oldPins[pinIndex].size));\n\t\t}\n\t\t\n\t\tthis._finishSetup(continuesLastPattern);\n\t}\n}\n\nexport class ChangePitchBend extends ChangePins {\n\tconstructor(doc: SongDocument | null, note: Note, bendStart: number, bendEnd: number, bendTo: number, pitchIndex: number) {\n\t\tsuper(doc, note);\n\t\t\n\t\tbendStart -= this._oldStart;\n\t\tbendEnd   -= this._oldStart;\n\t\tbendTo    -= note.pitches[pitchIndex];\n\t\t\n\t\tlet setStart: boolean = false;\n\t\tlet setEnd: boolean   = false;\n\t\tlet prevInterval: number = 0;\n\t\tlet prevSize: number = Config.noteSizeMax;\n\t\tlet persist: boolean = true;\n\t\tlet i: number;\n\t\tlet direction: number;\n\t\tlet stop: number;\n\t\tlet push: (item: NotePin)=>void;\n\t\tif (bendEnd > bendStart) {\n\t\t\ti = 0;\n\t\t\tdirection = 1;\n\t\t\tstop = note.pins.length;\n\t\t\tpush = (item: NotePin)=>{ this._newPins.push(item); };\n\t\t} else {\n\t\t\ti = note.pins.length - 1;\n\t\t\tdirection = -1;\n\t\t\tstop = -1;\n\t\t\tpush = (item: NotePin)=>{ this._newPins.unshift(item); };\n\t\t}\n\t\tfor (; i != stop; i += direction) {\n\t\t\tconst oldPin: NotePin = note.pins[i];\n\t\t\tconst time: number = oldPin.time;\n\t\t\tfor (;;) {\n\t\t\t\tif (!setStart) {\n\t\t\t\t\tif (time * direction <= bendStart * direction) {\n\t\t\t\t\t\tprevInterval = oldPin.interval;\n\t\t\t\t\t\tprevSize = oldPin.size;\n\t\t\t\t\t}\n\t\t\t\t\tif (time * direction < bendStart * direction) {\n\t\t\t\t\t\tpush(makeNotePin(oldPin.interval, time, oldPin.size));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpush(makeNotePin(prevInterval, bendStart, prevSize));\n\t\t\t\t\t\tsetStart = true;\n\t\t\t\t\t}\n\t\t\t\t} else if (!setEnd) {\n\t\t\t\t\tif (time * direction <= bendEnd * direction) {\n\t\t\t\t\t\tprevInterval = oldPin.interval;\n\t\t\t\t\t\tprevSize = oldPin.size;\n\t\t\t\t\t}\n\t\t\t\t\tif (time * direction < bendEnd * direction) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpush(makeNotePin(bendTo, bendEnd, prevSize));\n\t\t\t\t\t\tsetEnd = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (time * direction == bendEnd * direction) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (oldPin.interval != prevInterval) persist = false;\n\t\t\t\t\t\tpush(makeNotePin(persist ? bendTo : oldPin.interval, time, oldPin.size));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!setEnd) {\n\t\t\tpush(makeNotePin(bendTo, bendEnd, prevSize));\n\t\t}\n\t\t\n\t\tthis._finishSetup();\n\t}\n}\n\nexport class ChangePatternRhythm extends ChangeSequence {\n\tconstructor(doc: SongDocument, pattern: Pattern) {\n\t\tsuper();\n\t\tconst minDivision: number = Config.partsPerBeat / Config.rhythms[doc.song.rhythm].stepsPerBeat;\n\t\t\n\t\tconst changeRhythm: (oldTime:number)=>number = function(oldTime: number): number {\n\t\t\tlet thresholds: number[] | null = Config.rhythms[doc.song.rhythm].roundUpThresholds;\n\t\t\tif (thresholds != null) {\n\t\t\t\tconst beatStart: number = Math.floor(oldTime / Config.partsPerBeat) * Config.partsPerBeat;\n\t\t\t\tconst remainder: number = oldTime - beatStart;\n\t\t\t\tlet newTime: number = beatStart;\n\t\t\t\tfor (const threshold of thresholds) {\n\t\t\t\t\tif (remainder >= threshold) {\n\t\t\t\t\t\tnewTime += minDivision;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn newTime;\n\t\t\t} else {\n\t\t\t\treturn Math.round(oldTime / minDivision) * minDivision;\n\t\t\t}\n\t\t};\n\t\t\n\t\tlet i: number = 0;\n\t\twhile (i < pattern.notes.length) {\n\t\t\tconst note: Note = pattern.notes[i];\n\t\t\tif (changeRhythm(note.start) >= changeRhythm(note.end)) {\n\t\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, note, i, true));\n\t\t\t} else {\n\t\t\t\tthis.append(new ChangeRhythmNote(doc, note, changeRhythm));\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ChangeRhythmNote extends ChangePins {\n\tconstructor(doc: SongDocument | null, note: Note, changeRhythm: (oldTime:number)=>number) {\n\t\tsuper(doc, note);\n\t\t\n\t\tfor (const oldPin of this._oldPins) {\n\t\t\tthis._newPins.push(makeNotePin(oldPin.interval, changeRhythm(oldPin.time + this._oldStart) - this._oldStart, oldPin.size));\n\t\t}\n\t\t\n\t\tthis._finishSetup();\n\t}\n}\n\nexport class ChangeMoveNotesSideways extends ChangeGroup {\n\tconstructor(doc: SongDocument, beatsToMove: number, strategy: string) {\n\t\tsuper();\n\t\tlet partsToMove: number = Math.round((beatsToMove % doc.song.beatsPerBar) * Config.partsPerBeat);\n\t\tif (partsToMove < 0) partsToMove += doc.song.beatsPerBar * Config.partsPerBeat;\n\t\tif (partsToMove == 0.0) return;\n\t\t\n\t\tswitch (strategy) {\n\t\t\tcase \"wrapAround\": {\n\t\t\t\tconst partsPerBar: number = Config.partsPerBeat * doc.song.beatsPerBar;\n\t\t\t\tfor (const channel of doc.song.channels) {\n\t\t\t\t\tfor (const pattern of channel.patterns) {\n\t\t\t\t\t\tconst newNotes: Note[] = [];\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (let bar: number = 1; bar >= 0; bar--) {\n\t\t\t\t\t\t\tconst barStartPart: number = bar * partsPerBar;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfor (const oldNote of pattern.notes) {\n\t\t\t\t\t\t\t\tconst absoluteNoteStart: number = oldNote.start + partsToMove;\n\t\t\t\t\t\t\t\tconst absoluteNoteEnd: number = oldNote.end + partsToMove;\n\t\t\t\t\t\t\t\tconst noteStartPart: number = Math.max(0, absoluteNoteStart - barStartPart);\n\t\t\t\t\t\t\t\tconst noteEndPart: number = Math.min(partsPerBar, absoluteNoteEnd - barStartPart);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (noteStartPart < noteEndPart) {\n\t\t\t\t\t\t\t\t\tprojectNoteIntoBar(oldNote, absoluteNoteStart - barStartPart - noteStartPart, noteStartPart, noteEndPart, newNotes);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tpattern.notes = newNotes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase \"overflow\": {\n\t\t\t\tlet originalBarCount: number = doc.song.barCount;\n\t\t\t\tlet originalLoopStart: number = doc.song.loopStart;\n\t\t\t\tlet originalLoopLength: number = doc.song.loopLength;\n\t\t\t\t\n\t\t\t\tthis.append(new ChangeMoveAndOverflowNotes(doc, doc.song.beatsPerBar, partsToMove));\n\t\t\t\t\n\t\t\t\tif (beatsToMove < 0) {\n\t\t\t\t\tlet firstBarIsEmpty: boolean = true;\n\t\t\t\t\tfor (const channel of doc.song.channels) {\n\t\t\t\t\t\tif (channel.bars[0] != 0) firstBarIsEmpty = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (firstBarIsEmpty) {\n\t\t\t\t\t\tfor (const channel of doc.song.channels) {\n\t\t\t\t\t\t\tchannel.bars.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdoc.song.barCount--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toriginalBarCount++;\n\t\t\t\t\t\toriginalLoopStart++;\n\t\t\t\t\t\tdoc.bar++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\twhile (doc.song.barCount < originalBarCount) {\n\t\t\t\t\tfor (const channel of doc.song.channels) {\n\t\t\t\t\t\tchannel.bars.push(0);\n\t\t\t\t\t}\n\t\t\t\t\tdoc.song.barCount++;\n\t\t\t\t}\n\t\t\t\tdoc.song.loopStart = originalLoopStart;\n\t\t\t\tdoc.song.loopLength = originalLoopLength;\n\t\t\t} break;\n\t\t\tdefault: throw new Error(\"Unrecognized beats-per-bar conversion strategy.\");\n\t\t}\n\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeBeatsPerBar extends ChangeGroup {\n\tconstructor(doc: SongDocument, newValue: number, strategy: string) {\n\t\tsuper();\n\t\tif (doc.song.beatsPerBar != newValue) {\n\t\t\tswitch (strategy) {\n\t\t\t\tcase \"splice\": {\n\t\t\t\t\tif (doc.song.beatsPerBar > newValue) {\n\t\t\t\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\n\t\t\t\t\t\tfor (let i: number = 0; i < doc.song.getChannelCount(); i++) {\n\t\t\t\t\t\t\tfor (let j: number = 0; j < doc.song.channels[i].patterns.length; j++) {\n\t\t\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(doc, doc.song.channels[i].patterns[j], newValue * Config.partsPerBeat, doc.song.beatsPerBar * Config.partsPerBeat));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase \"stretch\": {\n\t\t\t\t\tconst changeRhythm = function(oldTime: number): number {\n\t\t\t\t\t\treturn Math.round(oldTime * newValue / doc.song.beatsPerBar);\n\t\t\t\t\t};\n\t\t\t\t\tfor (let channelIndex: number = 0; channelIndex < doc.song.getChannelCount(); channelIndex++) {\n\t\t\t\t\t\tfor (let patternIndex: number = 0; patternIndex < doc.song.channels[channelIndex].patterns.length; patternIndex++) {\n\t\t\t\t\t\t\tconst pattern: Pattern = doc.song.channels[channelIndex].patterns[patternIndex]; \n\t\t\t\t\t\t\tlet noteIndex: number = 0;\n\t\t\t\t\t\t\twhile (noteIndex < pattern.notes.length) {\n\t\t\t\t\t\t\t\tconst note: Note = pattern.notes[noteIndex];\n\t\t\t\t\t\t\t\tif (changeRhythm(note.start) >= changeRhythm(note.end)) {\n\t\t\t\t\t\t\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, note, noteIndex, true));\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.append(new ChangeRhythmNote(doc, note, changeRhythm));\n\t\t\t\t\t\t\t\t\tnoteIndex++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.append(new ChangeTempo(doc, doc.song.tempo, doc.song.tempo * newValue / doc.song.beatsPerBar));\n\t\t\t\t} break;\n\t\t\t\tcase \"overflow\": {\n\t\t\t\t\tthis.append(new ChangeMoveAndOverflowNotes(doc, newValue, 0));\n\t\t\t\t\tdoc.song.loopStart = 0;\n\t\t\t\t\tdoc.song.loopLength = doc.song.barCount;\n\t\t\t\t} break;\n\t\t\t\tdefault: throw new Error(\"Unrecognized beats-per-bar conversion strategy.\");\n\t\t\t}\n\n\t\t\tdoc.song.beatsPerBar = newValue;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeScale extends ChangeGroup {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tif (doc.song.scale != newValue) {\n\t\t\tdoc.song.scale = newValue;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeDetectKey extends ChangeGroup {\n\tconstructor(doc: SongDocument) {\n\t\tsuper();\n\t\tconst song: Song = doc.song;\n\t\tconst basePitch: number = Config.keys[song.key].basePitch;\n\t\tconst keyWeights: number[] = [0,0,0,0,0,0,0,0,0,0,0,0];\n\t\tfor (let channelIndex: number = 0; channelIndex < song.pitchChannelCount; channelIndex++) {\n\t\t\tfor (let barIndex: number = 0; barIndex < song.barCount; barIndex++) {\n\t\t\t\tconst pattern: Pattern | null = song.getPattern(channelIndex, barIndex);\n\t\t\t\tif (pattern != null) {\n\t\t\t\t\tfor (const note of pattern.notes) {\n\t\t\t\t\t\tconst prevPin: NotePin = note.pins[0];\n\t\t\t\t\t\tfor (let pinIndex: number = 1; pinIndex < note.pins.length; pinIndex++) {\n\t\t\t\t\t\t\tconst nextPin: NotePin = note.pins[pinIndex];\n\t\t\t\t\t\t\tif (prevPin.interval == nextPin.interval) {\n\t\t\t\t\t\t\t\tlet weight: number = nextPin.time - prevPin.time;\n\t\t\t\t\t\t\t\tweight += Math.max(0, Math.min(Config.partsPerBeat, nextPin.time + note.start) - (prevPin.time + note.start));\n\t\t\t\t\t\t\t\tweight *= nextPin.size + prevPin.size;\n\t\t\t\t\t\t\t\tfor (const pitch of note.pitches) {\n\t\t\t\t\t\t\t\t\tconst key = (basePitch + prevPin.interval + pitch) % 12;\n\t\t\t\t\t\t\t\t\tkeyWeights[key] += weight;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet bestKey: number = 0;\n\t\tlet bestKeyWeight: number = 0;\n\t\tfor (let key: number = 0; key < 12; key++) {\n\t\t\t// Look for the root of the most prominent major or minor chord.\n\t\t\tconst keyWeight: number = keyWeights[key] * (3 * keyWeights[(key + 7) % 12] + keyWeights[(key + 4) % 12] + keyWeights[(key + 3) % 12]);\n\t\t\tif (bestKeyWeight < keyWeight) {\n\t\t\t\tbestKeyWeight = keyWeight;\n\t\t\t\tbestKey = key;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (bestKey != song.key) {\n\t\t\tconst diff: number = song.key - bestKey;\n\t\t\tconst absoluteDiff: number = Math.abs(diff);\n\t\t\t\n\t\t\tfor (let channelIndex: number = 0; channelIndex < song.pitchChannelCount; channelIndex++) {\n\t\t\t\tfor (const pattern of song.channels[channelIndex].patterns) {\n\t\t\t\t\tfor (let i: number = 0; i < absoluteDiff; i++) {\n\t\t\t\t\t\tthis.append(new ChangeTranspose(doc, channelIndex, pattern, diff > 0, true));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tsong.key = bestKey;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport function pickRandomPresetValue(isNoise: boolean): number {\n\tconst eligiblePresetValues: number[] = [];\n\tfor (let categoryIndex: number = 0; categoryIndex < EditorConfig.presetCategories.length; categoryIndex++) {\n\t\tconst category: PresetCategory = EditorConfig.presetCategories[categoryIndex];\n\t\tif (category.name == \"Novelty Presets\") continue;\n\t\tfor (let presetIndex: number = 0; presetIndex < category.presets.length; presetIndex++) {\n\t\t\tconst preset: Preset = category.presets[presetIndex];\n\t\t\tif (preset.settings != undefined && (preset.isNoise == true) == isNoise) {\n\t\t\t\teligiblePresetValues.push((categoryIndex << 6) + presetIndex);\n\t\t\t}\n\t\t}\n\t}\n\treturn eligiblePresetValues[(Math.random() * eligiblePresetValues.length)|0];\n}\n\nexport function setDefaultInstruments(song: Song): void {\n\tfor (let channelIndex: number = 0; channelIndex < song.channels.length; channelIndex++) {\n\t\tfor (const instrument of song.channels[channelIndex].instruments) {\n\t\t\tconst isNoise: boolean = song.getChannelIsNoise(channelIndex);\n\t\t\tconst presetValue: number = (channelIndex == song.pitchChannelCount) ? EditorConfig.nameToPresetValue(Math.random() > 0.5 ? \"chip noise\" : \"standard drumset\")! : pickRandomPresetValue(isNoise);\n\t\t\tconst preset: Preset = EditorConfig.valueToPreset(presetValue)!;\n\t\t\tinstrument.fromJsonObject(preset.settings, isNoise, 1);\n\t\t\tinstrument.preset = presetValue;\n\t\t\tinstrument.volume = 1;\n\t\t}\n\t}\n}\n\nexport class ChangeSong extends ChangeGroup {\n\tconstructor(doc: SongDocument, newHash: string) {\n\t\tsuper();\n\t\tdoc.song.fromBase64String(newHash);\n\t\tif (newHash == \"\") {\n\t\t\tthis.append(new ChangePatternSelection(doc, 0, 0));\n\t\t\tdoc.selection.resetBoxSelection();\n\t\t\tsetDefaultInstruments(doc.song);\n\t\t\tdoc.song.scale = doc.defaultScale;\n\t\t\t\n\t\t\tfor (let i: number = 0; i <= doc.song.channels.length; i++) {\n\t\t\t\tdoc.viewedInstrument[i] = 0;\n\t\t\t\tdoc.recentPatternInstruments[i] = [0];\n\t\t\t}\n\t\t\tdoc.viewedInstrument.length = doc.song.channels.length;\n\t\t} else {\n\t\t\tthis.append(new ChangeValidateTrackSelection(doc));\n\t\t}\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeValidateTrackSelection extends Change {\n\tconstructor(doc: SongDocument) {\n\t\tsuper();\n\t\tconst channelIndex: number = Math.min(doc.channel, doc.song.getChannelCount() - 1);\n\t\tconst bar: number = Math.max(0, Math.min(doc.song.barCount - 1, doc.bar));\n\t\tconst barScrollPos: number = Math.min(doc.bar, Math.max(doc.bar - (doc.trackVisibleBars - 1), Math.max(0, Math.min(doc.song.barCount - doc.trackVisibleBars, doc.barScrollPos))));\n\t\tconst channelScrollPos: number = Math.min(doc.channel, Math.max(doc.channel - (doc.trackVisibleChannels - 1), Math.max(0, Math.min(doc.song.getChannelCount() - doc.trackVisibleChannels, doc.channelScrollPos))));\n\t\tif (doc.channel != channelIndex || doc.bar != bar || doc.channelScrollPos != channelScrollPos || doc.barScrollPos != barScrollPos) {\n\t\t\tdoc.channel = channelIndex;\n\t\t\tdoc.channel = channelScrollPos;\n\t\t\tdoc.bar = bar;\n\t\t\tdoc.barScrollPos = barScrollPos;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeReplacePatterns extends ChangeGroup {\n\tconstructor(doc: SongDocument, pitchChannels: Channel[], noiseChannels: Channel[]) {\n\t\tsuper();\n\t\t\n\t\tconst song: Song = doc.song;\n\t\t\n\t\tfunction removeExtraSparseChannels(channels: Channel[], maxLength: number): void {\n\t\t\twhile (channels.length > maxLength) {\n\t\t\t\tlet sparsestIndex: number = channels.length - 1;\n\t\t\t\tlet mostZeroes: number = 0;\n\t\t\t\tfor (let channelIndex: number = 0; channelIndex < channels.length - 1; channelIndex++) {\n\t\t\t\t\tlet zeroes: number = 0;\n\t\t\t\t\tfor (const bar of channels[channelIndex].bars) {\n\t\t\t\t\t\tif (bar == 0) zeroes++;\n\t\t\t\t\t}\n\t\t\t\t\tif (zeroes >= mostZeroes) {\n\t\t\t\t\t\tsparsestIndex = channelIndex;\n\t\t\t\t\t\tmostZeroes = zeroes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tchannels.splice(sparsestIndex, 1);\n\t\t\t}\n\t\t}\n\t\t\n\t\tremoveExtraSparseChannels(pitchChannels, Config.pitchChannelCountMax);\n\t\tremoveExtraSparseChannels(noiseChannels, Config.noiseChannelCountMax);\n\t\t\n\t\twhile (pitchChannels.length < Config.pitchChannelCountMin) pitchChannels.push(new Channel());\n\t\twhile (noiseChannels.length < Config.noiseChannelCountMin) noiseChannels.push(new Channel());\n\t\t\n\t\t// Set minimum counts.\n\t\tsong.barCount = 1;\n\t\tsong.patternsPerChannel = 8;\n\t\tconst combinedChannels: Channel[] = pitchChannels.concat(noiseChannels);\n\t\tfor (let channelIndex: number = 0; channelIndex < combinedChannels.length; channelIndex++) {\n\t\t\tconst channel: Channel = combinedChannels[channelIndex];\n\t\t\tsong.barCount = Math.max(song.barCount, channel.bars.length);\n\t\t\tsong.patternsPerChannel = Math.max(song.patternsPerChannel, channel.patterns.length);\n\t\t\tsong.channels[channelIndex] = channel;\n\t\t}\n\t\tsong.channels.length = combinedChannels.length;\n\t\tsong.pitchChannelCount = pitchChannels.length;\n\t\tsong.noiseChannelCount = noiseChannels.length;\n\t\t\n\t\tsong.barCount = Math.min(Config.barCountMax, song.barCount);\n\t\tsong.patternsPerChannel = Math.min(Config.barCountMax, song.patternsPerChannel);\n\t\tfor (let channelIndex: number = 0; channelIndex < song.channels.length; channelIndex++) {\n\t\t\tconst channel: Channel = song.channels[channelIndex];\n\t\t\t\n\t\t\tfor (let barIndex: number = 0; barIndex < channel.bars.length; barIndex++) {\n\t\t\t\tif (channel.bars[barIndex] > song.patternsPerChannel || channel.bars[barIndex] < 0) {\n\t\t\t\t\tchannel.bars[barIndex] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (channel.bars.length < song.barCount) {\n\t\t\t\tchannel.bars.push(0);\n\t\t\t}\n\t\t\tchannel.bars.length = song.barCount;\n\t\t\t\n\t\t\tif (channel.instruments.length > song.getMaxInstrumentsPerChannel()) {\n\t\t\t\tchannel.instruments.length = song.getMaxInstrumentsPerChannel();\n\t\t\t}\n\t\t\t\n\t\t\tfor (const pattern of channel.patterns) {\n\t\t\t\tdiscardInvalidPatternInstruments(pattern.instruments, song, channelIndex);\n\t\t\t}\n\t\t\twhile (channel.patterns.length < song.patternsPerChannel) {\n\t\t\t\tchannel.patterns.push(new Pattern());\n\t\t\t}\n\t\t\tchannel.patterns.length = song.patternsPerChannel;\n\t\t}\n\t\t\n\t\tsong.loopStart = Math.max(0, Math.min(song.barCount - 1, song.loopStart));\n\t\tsong.loopLength = Math.min(song.barCount - song.loopStart, song.loopLength);\n\t\t\n\t\tthis.append(new ChangeValidateTrackSelection(doc));\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport function comparePatternNotes(a: Note[], b: Note[]): boolean {\n\tif (a.length != b.length) return false;\n\t\n\tfor (let noteIndex: number = 0; noteIndex < a.length; noteIndex++) {\n\t\tconst oldNote: Note = a[noteIndex];\n\t\tconst newNote: Note = b[noteIndex];\n\t\tif (newNote.start != oldNote.start || newNote.end != oldNote.end || newNote.pitches.length != oldNote.pitches.length || newNote.pins.length != oldNote.pins.length) {\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tfor (let pitchIndex: number = 0; pitchIndex < oldNote.pitches.length; pitchIndex++) {\n\t\t\tif (newNote.pitches[pitchIndex] != oldNote.pitches[pitchIndex]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (let pinIndex: number = 0; pinIndex < oldNote.pins.length; pinIndex++) {\n\t\t\tif (newNote.pins[pinIndex].interval != oldNote.pins[pinIndex].interval || newNote.pins[pinIndex].time != oldNote.pins[pinIndex].time || newNote.pins[pinIndex].size != oldNote.pins[pinIndex].size) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn true;\n}\n\nexport function removeDuplicatePatterns(channels: Channel[]): void {\n\tfor (const channel of channels) {\n\t\tconst newPatterns: Pattern[] = [];\n\t\tfor (let bar: number = 0; bar < channel.bars.length; bar++) {\n\t\t\tif (channel.bars[bar] == 0) continue;\n\t\t\t\n\t\t\tconst oldPattern: Pattern = channel.patterns[channel.bars[bar] - 1];\n\t\t\t\n\t\t\tlet foundMatchingPattern: boolean = false;\n\t\t\tfor (let newPatternIndex: number = 0; newPatternIndex < newPatterns.length; newPatternIndex++) {\n\t\t\t\tconst newPattern: Pattern = newPatterns[newPatternIndex];\n\t\t\t\t\n\t\t\t\tif (!patternsContainSameInstruments(oldPattern.instruments, newPattern.instruments) || newPattern.notes.length != oldPattern.notes.length) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (comparePatternNotes(oldPattern.notes, newPattern.notes)) {\n\t\t\t\t\tfoundMatchingPattern = true;\n\t\t\t\t\tchannel.bars[bar] = newPatternIndex + 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (!foundMatchingPattern) {\n\t\t\t\tnewPatterns.push(oldPattern);\n\t\t\t\tchannel.bars[bar] = newPatterns.length;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (let patternIndex: number = 0; patternIndex < newPatterns.length; patternIndex++) {\n\t\t\tchannel.patterns[patternIndex] = newPatterns[patternIndex];\n\t\t}\n\t\tchannel.patterns.length = newPatterns.length;\n\t}\n}\n\nexport class ChangeTempo extends Change {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper();\n\t\tdoc.song.tempo = Math.max(Config.tempoMin, Math.min(Config.tempoMax, Math.round(newValue)));\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeEchoDelay extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.echoDelay = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeEchoSustain extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.echoSustain = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeChorus extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.chorus = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeReverb extends ChangeInstrumentSlider {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper(doc);\n\t\tthis._instrument.reverb = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeNoteAdded extends UndoableChange {\n\tprivate _doc: SongDocument;\n\tprivate _pattern: Pattern;\n\tprivate _note: Note;\n\tprivate _index: number;\n\tconstructor(doc: SongDocument, pattern: Pattern, note: Note, index: number, deletion: boolean = false) {\n\t\tsuper(deletion);\n\t\tthis._doc = doc;\n\t\tthis._pattern = pattern;\n\t\tthis._note = note;\n\t\tthis._index = index;\n\t\tthis._didSomething();\n\t\tthis.redo();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._pattern.notes.splice(this._index, 0, this._note);\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._pattern.notes.splice(this._index, 1);\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeNoteLength extends ChangePins {\n\tconstructor(doc: SongDocument | null, note: Note, truncStart: number, truncEnd: number) {\n\t\tsuper(doc, note);\n\t\tconst continuesLastPattern: boolean = ((this._oldStart < 0 || note.continuesLastPattern) && truncStart == 0);\n\t\t\n\t\ttruncStart -= this._oldStart;\n\t\ttruncEnd   -= this._oldStart;\n\t\tlet setStart: boolean = false;\n\t\tlet prevSize: number = this._oldPins[0].size;\n\t\tlet prevInterval: number = this._oldPins[0].interval;\n\t\tlet pushLastPin: boolean = true;\n\t\tlet i: number;\n\t\tfor (i = 0; i < this._oldPins.length; i++) {\n\t\t\tconst oldPin: NotePin = this._oldPins[i];\n\t\t\tif (oldPin.time < truncStart) {\n\t\t\t\tprevSize = oldPin.size;\n\t\t\t\tprevInterval = oldPin.interval;\n\t\t\t} else {\n\t\t\t\tif (oldPin.time > truncStart && !setStart) {\n\t\t\t\t\tthis._newPins.push(makeNotePin(prevInterval, truncStart, prevSize));\n\t\t\t\t\tsetStart = true;\n\t\t\t\t}\n\t\t\t\tif (oldPin.time <= truncEnd) {\n\t\t\t\t\tthis._newPins.push(makeNotePin(oldPin.interval, oldPin.time, oldPin.size));\n\t\t\t\t\tif (oldPin.time == truncEnd) {\n\t\t\t\t\t\tpushLastPin = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tif (pushLastPin) this._newPins.push(makeNotePin(this._oldPins[i].interval, truncEnd, this._oldPins[i].size));\n\t\t\n\t\tthis._finishSetup(continuesLastPattern);\n\t}\n}\n\nexport class ChangeNoteTruncate extends ChangeSequence {\n\tconstructor(doc: SongDocument, pattern: Pattern, start: number, end: number, skipNote?: Note) {\n\t\tsuper();\n\t\tlet i: number = 0;\n\t\twhile (i < pattern.notes.length) {\n\t\t\tconst note: Note = pattern.notes[i];\n\t\t\tif (note == skipNote && skipNote != undefined) {\n\t\t\t\ti++;\n\t\t\t} else if (note.end <= start) {\n\t\t\t\ti++;\n\t\t\t} else if (note.start >= end) {\n\t\t\t\tbreak;\n\t\t\t} else if (note.start < start && note.end > end) {\n\t\t\t\tconst copy: Note = note.clone();\n\t\t\t\tthis.append(new ChangeNoteLength(doc, note, note.start, start));\n\t\t\t\ti++;\n\t\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, copy, i, false));\n\t\t\t\tthis.append(new ChangeNoteLength(doc, copy, end, copy.end));\n\t\t\t\ti++;\n\t\t\t} else if (note.start < start) {\n\t\t\t\tthis.append(new ChangeNoteLength(doc, note, note.start, start));\n\t\t\t\ti++;\n\t\t\t} else if (note.end > end) {\n\t\t\t\tthis.append(new ChangeNoteLength(doc, note, end, note.end));\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, note, i, true));\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ChangeSplitNotesAtSelection extends ChangeSequence {\n\tconstructor(doc: SongDocument, pattern: Pattern) {\n\t\tsuper();\n\t\tlet i: number = 0;\n\t\twhile (i < pattern.notes.length) {\n\t\t\tconst note: Note = pattern.notes[i];\n\t\t\tif (note.start < doc.selection.patternSelectionStart && doc.selection.patternSelectionStart < note.end) {\n\t\t\t\tconst copy: Note = note.clone();\n\t\t\t\tthis.append(new ChangeNoteLength(doc, note, note.start, doc.selection.patternSelectionStart));\n\t\t\t\ti++;\n\t\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, copy, i, false));\n\t\t\t\tthis.append(new ChangeNoteLength(doc, copy, doc.selection.patternSelectionStart, copy.end));\n\t\t\t\t// i++; // The second note might be split again at the end of the selection. Check it again.\n\t\t\t} else if (note.start < doc.selection.patternSelectionEnd && doc.selection.patternSelectionEnd < note.end) {\n\t\t\t\tconst copy: Note = note.clone();\n\t\t\t\tthis.append(new ChangeNoteLength(doc, note, note.start, doc.selection.patternSelectionEnd));\n\t\t\t\ti++;\n\t\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, copy, i, false));\n\t\t\t\tthis.append(new ChangeNoteLength(doc, copy, doc.selection.patternSelectionEnd, copy.end));\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ChangeTransposeNote extends UndoableChange {\n\tprotected _doc: SongDocument;\n\tprotected _note: Note;\n\tprotected _oldStart: number;\n\tprotected _newStart: number;\n\tprotected _oldEnd: number;\n\tprotected _newEnd: number;\n\tprotected _oldPins: NotePin[];\n\tprotected _newPins: NotePin[];\n\tprotected _oldPitches: number[];\n\tprotected _newPitches: number[];\n\tconstructor(doc: SongDocument, channelIndex: number, note: Note, upward: boolean, ignoreScale: boolean = false, octave: boolean = false) {\n\t\tsuper(false);\n\t\tthis._doc = doc;\n\t\tthis._note = note;\n\t\tthis._oldPins = note.pins;\n\t\tthis._newPins = [];\n\t\tthis._oldPitches = note.pitches;\n\t\tthis._newPitches = [];\n\t\t\n\t\t// I'm disabling pitch transposing for noise channels to avoid\n\t\t// accidentally messing up noise channels when pitch shifting all\n\t\t// channels at once.\n\t\tconst isNoise: boolean = doc.song.getChannelIsNoise(channelIndex);\n\t\tif (isNoise != doc.song.getChannelIsNoise(doc.channel)) return;\n\t\t\n\t\tconst maxPitch: number = (isNoise ? Config.drumCount - 1 : Config.maxPitch);\n\t\t\n\t\tfor (let i: number = 0; i < this._oldPitches.length; i++) {\n\t\t\tlet pitch: number = this._oldPitches[i];\n\t\t\tif (octave && !isNoise) {\n\t\t\t\tif (upward) {\n\t\t\t\t\tpitch = Math.min(maxPitch, pitch + 12);\n\t\t\t\t} else {\n\t\t\t\t\tpitch = Math.max(0, pitch - 12);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (upward) {\n\t\t\t\t\tfor (let j: number = pitch + 1; j <= maxPitch; j++) {\n\t\t\t\t\t\tif (isNoise || ignoreScale || Config.scales[doc.song.scale].flags[j%12]) {\n\t\t\t\t\t\t\tpitch = j;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (let j: number = pitch - 1; j >= 0; j--) {\n\t\t\t\t\t\tif (isNoise || ignoreScale || Config.scales[doc.song.scale].flags[j%12]) {\n\t\t\t\t\t\t\tpitch = j;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tlet foundMatch: boolean = false;\n\t\t\tfor (let j: number = 0; j < this._newPitches.length; j++) {\n\t\t\t\tif (this._newPitches[j] == pitch) {\n\t\t\t\t\tfoundMatch = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!foundMatch) this._newPitches.push(pitch);\n\t\t}\n\t\t\n\t\tlet min: number = 0;\n\t\tlet max: number = maxPitch;\n\t\t\n\t\tfor (let i: number = 1; i < this._newPitches.length; i++) {\n\t\t\tconst diff: number = this._newPitches[0] - this._newPitches[i];\n\t\t\tif (min < diff) min = diff;\n\t\t\tif (max > diff + maxPitch) max = diff + maxPitch;\n\t\t}\n\t\t\n\t\tfor (const oldPin of this._oldPins) {\n\t\t\tlet interval: number = oldPin.interval + this._oldPitches[0];\n\t\t\t\n\t\t\tif (interval < min) interval = min;\n\t\t\tif (interval > max) interval = max;\n\t\t\tif (octave && !isNoise) {\n\t\t\t\tif (upward) {\n\t\t\t\t\tinterval = Math.min(max, interval + 12);\n\t\t\t\t} else {\n\t\t\t\t\tinterval = Math.max(min, interval - 12);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (upward) {\n\t\t\t\t\tfor (let i: number = interval + 1; i <= max; i++) {\n\t\t\t\t\t\tif (isNoise || ignoreScale || Config.scales[doc.song.scale].flags[i%12]) {\n\t\t\t\t\t\t\tinterval = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (let i: number = interval - 1; i >= min; i--) {\n\t\t\t\t\t\tif (isNoise || ignoreScale || Config.scales[doc.song.scale].flags[i%12]) {\n\t\t\t\t\t\t\tinterval = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tinterval -= this._newPitches[0];\n\t\t\tthis._newPins.push(makeNotePin(interval, oldPin.time, oldPin.size));\n\t\t}\n\t\t\n\t\tif (this._newPins[0].interval != 0) throw new Error(\"wrong pin start interval\");\n\t\t\n\t\tfor (let i: number = 1; i < this._newPins.length - 1; ) {\n\t\t\tif (this._newPins[i-1].interval == this._newPins[i].interval &&\n\t\t\t\tthis._newPins[i].interval == this._newPins[i+1].interval &&\n\t\t\t\tthis._newPins[i-1].size == this._newPins[i].size &&\n\t\t\t\tthis._newPins[i].size == this._newPins[i+1].size)\n\t\t\t{\n\t\t\t\tthis._newPins.splice(i, 1);\n\t\t\t} else {\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._doForwards();\n\t\tthis._didSomething();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._note.pins = this._newPins;\n\t\tthis._note.pitches = this._newPitches;\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._note.pins = this._oldPins;\n\t\tthis._note.pitches = this._oldPitches;\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeTranspose extends ChangeSequence {\n\tconstructor(doc: SongDocument, channelIndex: number, pattern: Pattern, upward: boolean, ignoreScale: boolean = false, octave: boolean = false) {\n\t\tsuper();\n\t\tif (doc.selection.patternSelectionActive) {\n\t\t\tthis.append(new ChangeSplitNotesAtSelection(doc, pattern));\n\t\t}\n\t\tfor (const note of pattern.notes) {\n\t\t\tif (doc.selection.patternSelectionActive && (note.end <= doc.selection.patternSelectionStart || note.start >= doc.selection.patternSelectionEnd)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.append(new ChangeTransposeNote(doc, channelIndex, note, upward, ignoreScale, octave));\n\t\t}\n\t}\n}\n\nexport class ChangeTrackSelection extends Change {\n\tconstructor(doc: SongDocument, newX0: number, newX1: number, newY0: number, newY1: number) {\n\t\tsuper();\n\t\tdoc.selection.boxSelectionX0 = newX0;\n\t\tdoc.selection.boxSelectionX1 = newX1;\n\t\tdoc.selection.boxSelectionY0 = newY0;\n\t\tdoc.selection.boxSelectionY1 = newY1;\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangePatternSelection extends UndoableChange {\n\tprivate _doc: SongDocument;\n\tprivate _oldStart: number;\n\tprivate _oldEnd: number;\n\tprivate _oldActive: boolean;\n\tprivate _newStart: number;\n\tprivate _newEnd: number;\n\tprivate _newActive: boolean;\n\t\n\tconstructor(doc: SongDocument, newStart: number, newEnd: number) {\n\t\tsuper(false);\n\t\tthis._doc = doc;\n\t\tthis._oldStart = doc.selection.patternSelectionStart;\n\t\tthis._oldEnd = doc.selection.patternSelectionEnd;\n\t\tthis._oldActive = doc.selection.patternSelectionActive;\n\t\tthis._newStart = newStart;\n\t\tthis._newEnd = newEnd;\n\t\tthis._newActive = newStart < newEnd;\n\t\tthis._doForwards();\n\t\tthis._didSomething();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._doc.selection.patternSelectionStart = this._newStart;\n\t\tthis._doc.selection.patternSelectionEnd = this._newEnd;\n\t\tthis._doc.selection.patternSelectionActive = this._newActive;\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._doc.selection.patternSelectionStart = this._oldStart;\n\t\tthis._doc.selection.patternSelectionEnd = this._oldEnd;\n\t\tthis._doc.selection.patternSelectionActive = this._oldActive;\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeDragSelectedNotes extends ChangeSequence {\n\tconstructor(doc: SongDocument, channelIndex: number, pattern: Pattern, parts: number, transpose: number) {\n\t\tsuper();\n\t\t\n\t\tif (parts == 0 && transpose == 0) return;\n\t\tif (doc.selection.patternSelectionActive) {\n\t\t\tthis.append(new ChangeSplitNotesAtSelection(doc, pattern));\n\t\t}\n\t\t\n\t\tconst oldStart: number = doc.selection.patternSelectionStart;\n\t\tconst oldEnd: number = doc.selection.patternSelectionEnd;\n\t\tconst newStart: number = Math.max(0, Math.min(doc.song.beatsPerBar * Config.partsPerBeat, oldStart + parts));\n\t\tconst newEnd: number = Math.max(0, Math.min(doc.song.beatsPerBar * Config.partsPerBeat, oldEnd + parts));\n\t\tif (newStart == newEnd) {\n\t\t\t// Just erase the current contents of the selection:\n\t\t\tthis.append(new ChangeNoteTruncate(doc, pattern, oldStart, oldEnd));\n\t\t} else if (parts < 0) {\n\t\t\t// Clear space for the dragged notes:\n\t\t\tthis.append(new ChangeNoteTruncate(doc, pattern, newStart, Math.min(oldStart, newEnd)));\n\t\t} else {\n\t\t\t// Clear space for the dragged notes:\n\t\t\tthis.append(new ChangeNoteTruncate(doc, pattern, Math.max(oldEnd, newStart), newEnd));\n\t\t}\n\t\t\n\t\tthis.append(new ChangePatternSelection(doc, newStart, newEnd));\n\t\tconst draggedNotes = [];\n\t\tlet noteInsertionIndex: number = 0;\n\t\tlet i: number = 0;\n\t\twhile (i < pattern.notes.length) {\n\t\t\tconst note: Note = pattern.notes[i];\n\t\t\tif (note.end <= oldStart || note.start >= oldEnd) {\n\t\t\t\ti++;\n\t\t\t\tif (note.end <= newStart) noteInsertionIndex = i;\n\t\t\t} else {\n\t\t\t\tdraggedNotes.push(note.clone());\n\t\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, note, i, true));\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (const note of draggedNotes) {\n\t\t\tnote.start += parts;\n\t\t\tnote.end += parts;\n\t\t\tif (note.end <= newStart) continue;\n\t\t\tif (note.start >= newEnd) continue;\n\t\t\t\n\t\t\tthis.append(new ChangeNoteAdded(doc, pattern, note, noteInsertionIndex++, false));\n\t\t\t\n\t\t\tthis.append(new ChangeNoteLength(doc, note, Math.max(note.start, newStart), Math.min(newEnd, note.end)));\n\t\t\t\n\t\t\tfor (let i: number = 0; i < Math.abs(transpose); i++) {\n\t\t\t\tthis.append(new ChangeTransposeNote(doc, channelIndex, note, transpose > 0, doc.notesOutsideScale));\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class ChangeDuplicateSelectedReusedPatterns extends ChangeGroup {\n\tconstructor(doc: SongDocument, barStart: number, barWidth: number, channelStart: number, channelHeight: number) {\n\t\tsuper();\n\t\tfor (let channelIndex: number = channelStart; channelIndex < channelStart + channelHeight; channelIndex++) {\n\t\t\tconst reusablePatterns: Dictionary<number> = {};\n\t\t\t\n\t\t\tfor (let bar: number = barStart; bar < barStart + barWidth; bar++) {\n\t\t\t\tconst currentPatternIndex: number = doc.song.channels[channelIndex].bars[bar];\n\t\t\t\tif (currentPatternIndex == 0) continue;\n\t\t\t\t\n\t\t\t\tif (reusablePatterns[String(currentPatternIndex)] == undefined) {\n\t\t\t\t\tlet isUsedElsewhere = false;\n\t\t\t\t\tfor (let bar2: number = 0; bar2 < doc.song.barCount; bar2++) {\n\t\t\t\t\t\tif (bar2 < barStart || bar2 >= barStart + barWidth) {\n\t\t\t\t\t\t\tif (doc.song.channels[channelIndex].bars[bar2] == currentPatternIndex) {\n\t\t\t\t\t\t\t\tisUsedElsewhere = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (isUsedElsewhere) {\n\t\t\t\t\t\t// Need to duplicate the pattern.\n\t\t\t\t\t\tconst copiedPattern: Pattern = doc.song.getPattern(channelIndex, bar)!;\n\t\t\t\t\t\tthis.append(new ChangePatternNumbers(doc, 0, bar, channelIndex, 1, 1));\n\t\t\t\t\t\tthis.append(new ChangeEnsurePatternExists(doc, channelIndex, bar));\n\t\t\t\t\t\tconst newPattern: Pattern | null = doc.song.getPattern(channelIndex, bar);\n\t\t\t\t\t\tif (newPattern == null) throw new Error();\n\t\t\t\t\t\tthis.append(new ChangePaste(doc, newPattern, copiedPattern.notes, 0, Config.partsPerBeat * doc.song.beatsPerBar, Config.partsPerBeat * doc.song.beatsPerBar));\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Copy the instruments into the new pattern.\n\t\t\t\t\t\tnewPattern.instruments.length = 0;\n\t\t\t\t\t\tnewPattern.instruments.push(...copiedPattern.instruments);\n\t\t\t\t\t\t\n\t\t\t\t\t\treusablePatterns[String(currentPatternIndex)] = doc.song.channels[channelIndex].bars[bar];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treusablePatterns[String(currentPatternIndex)] = currentPatternIndex;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.append(new ChangePatternNumbers(doc, reusablePatterns[String(currentPatternIndex)], bar, channelIndex, 1, 1));\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class ChangePatternScale extends Change {\n\tconstructor(doc: SongDocument, pattern: Pattern, scaleMap: number[]) {\n\t\tsuper();\n\t\tif (doc.selection.patternSelectionActive) {\n\t\t\tnew ChangeSplitNotesAtSelection(doc, pattern);\n\t\t}\n\t\tconst maxPitch: number = Config.maxPitch;\n\t\tfor (const note of pattern.notes) {\n\t\t\tif (doc.selection.patternSelectionActive && (note.end <= doc.selection.patternSelectionStart || note.start >= doc.selection.patternSelectionEnd)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tconst newPitches: number[] = [];\n\t\t\tconst newPins: NotePin[] = [];\n\t\t\tfor (let i: number = 0; i < note.pitches.length; i++) {\n\t\t\t\tconst pitch: number = note.pitches[i];\n\t\t\t\tconst transformedPitch: number = scaleMap[pitch % 12] + (pitch - (pitch % 12));\n\t\t\t\tif (newPitches.indexOf(transformedPitch) == -1) {\n\t\t\t\t\tnewPitches.push(transformedPitch);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tlet min: number = 0;\n\t\t\tlet max: number = maxPitch;\n\t\t\t\n\t\t\tfor (let i: number = 1; i < newPitches.length; i++) {\n\t\t\t\tconst diff: number = newPitches[0] - newPitches[i];\n\t\t\t\tif (min < diff) min = diff;\n\t\t\t\tif (max > diff + maxPitch) max = diff + maxPitch;\n\t\t\t}\n\t\t\n\t\t\tfor (const oldPin of note.pins) {\n\t\t\t\tlet interval: number = oldPin.interval + note.pitches[0];\n\t\t\t\tif (interval < min) interval = min;\n\t\t\t\tif (interval > max) interval = max;\n\t\t\t\tconst transformedInterval: number = scaleMap[interval % 12] + (interval - (interval % 12));\n\t\t\t\tnewPins.push(makeNotePin(transformedInterval - newPitches[0], oldPin.time, oldPin.size));\n\t\t\t}\n\t\t\n\t\t\tif (newPins[0].interval != 0) throw new Error(\"wrong pin start interval\");\n\t\t\n\t\t\tfor (let i: number = 1; i < newPins.length - 1; ) {\n\t\t\t\tif (newPins[i-1].interval == newPins[i].interval &&\n\t\t\t\t\tnewPins[i].interval == newPins[i+1].interval &&\n\t\t\t\t\tnewPins[i-1].size == newPins[i].size &&\n\t\t\t\t\tnewPins[i].size == newPins[i+1].size)\n\t\t\t\t{\n\t\t\t\t\tnewPins.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tnote.pitches = newPitches;\n\t\t\tnote.pins = newPins;\n\t\t}\n\t\tthis._didSomething();\n\t\tdoc.notifier.changed();\n\t}\n}\n\nexport class ChangeVolume extends Change {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper();\n\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].volume = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangePan extends Change {\n\tconstructor(doc: SongDocument, oldValue: number, newValue: number) {\n\t\tsuper();\n\t\tdoc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()].pan = newValue;\n\t\tdoc.notifier.changed();\n\t\tif (oldValue != newValue) this._didSomething();\n\t}\n}\n\nexport class ChangeSizeBend extends UndoableChange {\n\tprivate _doc: SongDocument;\n\tprivate _note: Note;\n\tprivate _oldPins: NotePin[];\n\tprivate _newPins: NotePin[];\n\tconstructor(doc: SongDocument, note: Note, bendPart: number, bendSize: number, bendInterval: number, uniformSize: boolean) {\n\t\tsuper(false);\n\t\tthis._doc = doc;\n\t\tthis._note = note;\n\t\tthis._oldPins = note.pins;\n\t\tthis._newPins = [];\n\t\t\n\t\tlet inserted: boolean = false;\n\t\t\n\t\tfor (const pin of note.pins) {\n\t\t\tif (pin.time < bendPart) {\n\t\t\t\tif (uniformSize) {\n\t\t\t\t\tthis._newPins.push(makeNotePin(pin.interval, pin.time, bendSize));\n\t\t\t\t} else {\n\t\t\t\t\tthis._newPins.push(pin);\n\t\t\t\t}\n\t\t\t} else if (pin.time == bendPart) {\n\t\t\t\tthis._newPins.push(makeNotePin(bendInterval, bendPart, bendSize));\n\t\t\t\tinserted = true;\n\t\t\t} else {\n\t\t\t\tif (!uniformSize && !inserted) {\n\t\t\t\t\tthis._newPins.push(makeNotePin(bendInterval, bendPart, bendSize));\n\t\t\t\t\tinserted = true;\n\t\t\t\t}\n\t\t\t\tif (uniformSize) {\n\t\t\t\t\tthis._newPins.push(makeNotePin(pin.interval, pin.time, bendSize));\n\t\t\t\t} else {\n\t\t\t\t\tthis._newPins.push(pin);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tremoveRedundantPins(this._newPins);\n\t\t\n\t\tthis._doForwards();\n\t\tthis._didSomething();\n\t}\n\t\n\tprotected _doForwards(): void {\n\t\tthis._note.pins = this._newPins;\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tprotected _doBackwards(): void {\n\t\tthis._note.pins = this._oldPins;\n\t\tthis._doc.notifier.changed();\n\t}\n}\n\nexport class ChangeChipWave extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tif (instrument.chipWave != newValue) {\n\t\t\tinstrument.chipWave = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeNoiseWave extends Change {\n\tconstructor(doc: SongDocument, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tif (instrument.chipNoise != newValue) {\n\t\t\tinstrument.chipNoise = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeAddEnvelope extends Change {\n\tconstructor(doc: SongDocument) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tinstrument.addEnvelope(0,0,0);\n\t\tinstrument.preset = instrument.type;\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeRemoveEnvelope extends Change {\n\tconstructor(doc: SongDocument, index: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tinstrument.envelopeCount--;\n\t\tfor (let i: number = index; i < instrument.envelopeCount; i++) {\n\t\t\tinstrument.envelopes[i].target   = instrument.envelopes[i+1].target;\n\t\t\tinstrument.envelopes[i].index    = instrument.envelopes[i+1].index;\n\t\t\tinstrument.envelopes[i].envelope = instrument.envelopes[i+1].envelope;\n\t\t}\n\t\t// TODO: Shift any envelopes that were targeting other envelope indices after the removed one.\n\t\tinstrument.preset = instrument.type;\n\t\tdoc.notifier.changed();\n\t\tthis._didSomething();\n\t}\n}\n\nexport class ChangeSetEnvelopeTarget extends Change {\n\tconstructor(doc: SongDocument, envelopeIndex: number, target: number, targetIndex: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldTarget: number = instrument.envelopes[envelopeIndex].target;\n\t\tconst oldIndex: number = instrument.envelopes[envelopeIndex].index;\n\t\tif (oldTarget != target || oldIndex != targetIndex) {\n\t\t\tinstrument.envelopes[envelopeIndex].target = target;\n\t\t\tinstrument.envelopes[envelopeIndex].index = targetIndex;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n\nexport class ChangeSetEnvelopeType extends Change {\n\tconstructor(doc: SongDocument, envelopeIndex: number, newValue: number) {\n\t\tsuper();\n\t\tconst instrument: Instrument = doc.song.channels[doc.channel].instruments[doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.envelopes[envelopeIndex].envelope;\n\t\tif (oldValue != newValue) {\n\t\t\tinstrument.envelopes[envelopeIndex].envelope = newValue;\n\t\t\tinstrument.preset = instrument.type;\n\t\t\tdoc.notifier.changed();\n\t\t\tthis._didSomething();\n\t\t}\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Chord, Transition, Config} from \"../synth/SynthConfig\";\nimport {NotePin, Note, makeNotePin, Pattern, Instrument} from \"../synth/synth\";\nimport {ColorConfig} from \"./ColorConfig\";\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\nimport {ChangeSequence, UndoableChange} from \"./Change\";\nimport {ChangeChannelBar, ChangeDragSelectedNotes, ChangeEnsurePatternExists, ChangeNoteTruncate, ChangeNoteAdded, ChangePatternSelection, ChangePinTime, ChangeSizeBend, ChangePitchBend, ChangePitchAdded} from \"./changes\";\nimport {prettyNumber} from \"./EditorConfig\";\n\nfunction makeEmptyReplacementElement<T extends Node>(node: T): T {\n\tconst clone: T = <T> node.cloneNode(false);\n\tnode.parentNode!.replaceChild(clone, node);\n\treturn clone;\n}\n\nclass PatternCursor {\n\tpublic valid:        boolean = false;\n\tpublic prevNote:     Note | null = null;\n\tpublic curNote:      Note | null = null;\n\tpublic nextNote:     Note | null = null;\n\tpublic pitch:        number = 0;\n\tpublic pitchIndex:   number = -1;\n\tpublic curIndex:     number = 0;\n\tpublic start:        number = 0;\n\tpublic end:          number = 0;\n\tpublic part:         number = 0;\n\tpublic exactPart:    number = 0;\n\tpublic nearPinIndex: number = 0;\n\tpublic pins:         NotePin[] = [];\n}\n\nexport class PatternEditor {\n\tprivate readonly _svgNoteBackground: SVGPatternElement = SVG.pattern({id: \"patternEditorNoteBackground\" + this._barOffset, x: \"0\", y: \"0\", patternUnits: \"userSpaceOnUse\"});\n\tprivate readonly _svgDrumBackground: SVGPatternElement = SVG.pattern({id: \"patternEditorDrumBackground\" + this._barOffset, x: \"0\", y: \"0\", patternUnits: \"userSpaceOnUse\"});\n\tprivate readonly _svgBackground: SVGRectElement = SVG.rect({x: \"0\", y: \"0\", \"pointer-events\": \"none\", fill: \"url(#patternEditorNoteBackground\" + this._barOffset + \")\"});\n\tprivate _svgNoteContainer: SVGSVGElement = SVG.svg();\n\tprivate readonly _svgPlayhead: SVGRectElement = SVG.rect({x: \"0\", y: \"0\", width: \"4\", fill: ColorConfig.playhead, \"pointer-events\": \"none\"});\n\tprivate readonly _selectionRect: SVGRectElement = SVG.rect({fill: ColorConfig.boxSelectionFill, stroke: ColorConfig.hoverPreview, \"stroke-width\": 2, \"stroke-dasharray\": \"5, 3\", \"pointer-events\": \"none\", visibility: \"hidden\"});\n\tprivate readonly _svgPreview: SVGPathElement = SVG.path({fill: \"none\", stroke: ColorConfig.hoverPreview, \"stroke-width\": \"2\", \"pointer-events\": \"none\"});\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `background-color: ${ColorConfig.editorBackground}; touch-action: none; position: absolute;`, width: \"100%\", height: \"100%\"},\n\t\tSVG.defs(\n\t\t\tthis._svgNoteBackground,\n\t\t\tthis._svgDrumBackground,\n\t\t),\n\t\tthis._svgBackground,\n\t\tthis._selectionRect,\n\t\tthis._svgNoteContainer,\n\t\tthis._svgPreview,\n\t\tthis._svgPlayhead,\n\t);\n\tpublic readonly container: HTMLDivElement = HTML.div({style: \"height: 100%; overflow:hidden; position: relative; flex-grow: 1;\"}, this._svg);\n\t\n\tprivate readonly _backgroundPitchRows: SVGRectElement[] = [];\n\tprivate readonly _backgroundDrumRow: SVGRectElement = SVG.rect();\n\t\n\tprivate _editorWidth: number;\n\tprivate _editorHeight: number;\n\tprivate _partWidth: number;\n\tprivate _pitchHeight: number = -1;\n\tprivate _pitchCount: number;\n\tprivate _mouseX: number = 0;\n\tprivate _mouseY: number = 0;\n\tprivate _mouseDown: boolean = false;\n\tprivate _mouseOver: boolean = false;\n\tprivate _mouseDragging: boolean = false;\n\tprivate _mouseHorizontal: boolean = false;\n\tprivate _usingTouch: boolean = false;\n\tprivate _copiedPinChannels: NotePin[][] = [];\n\tprivate _copiedPins: NotePin[];\n\tprivate _mouseXStart: number = 0;\n\tprivate _mouseYStart: number = 0;\n\tprivate _ctrlHeld: boolean = false;\n\tprivate _shiftHeld: boolean = false;\n\tprivate _touchTime: number = 0;\n\tprivate _draggingStartOfSelection: boolean = false;\n\tprivate _draggingEndOfSelection: boolean = false;\n\tprivate _draggingSelectionContents: boolean = false;\n\tprivate _dragTime: number = 0;\n\tprivate _dragPitch: number = 0;\n\tprivate _dragSize: number = 0;\n\tprivate _dragVisible: boolean = false;\n\tprivate _dragChange: UndoableChange | null = null;\n\tprivate _changePatternSelection: UndoableChange | null = null;\n\tprivate _lastChangeWasPatternSelection: boolean = false;\n\tprivate _cursor: PatternCursor = new PatternCursor();\n\tprivate _pattern: Pattern | null = null;\n\tprivate _playheadX: number = 0.0;\n\tprivate _octaveOffset: number = 0;\n\tprivate _renderedWidth: number = -1;\n\tprivate _renderedHeight: number = -1;\n\tprivate _renderedBeatWidth: number = -1;\n\tprivate _renderedPitchHeight: number = -1;\n\tprivate _renderedFifths: boolean = false;\n\tprivate _renderedDrums: boolean = false;\n\tprivate _renderedRhythm: number = -1;\n\tprivate _renderedPitchChannelCount: number = -1;\n\tprivate _renderedNoiseChannelCount: number = -1;\n\tprivate _followPlayheadBar: number = -1;\n\t\n\tconstructor(private _doc: SongDocument, private _interactive: boolean, private _barOffset: number) {\n\t\tfor (let i: number = 0; i < Config.pitchesPerOctave; i++) {\n\t\t\tconst rectangle: SVGRectElement = SVG.rect();\n\t\t\trectangle.setAttribute(\"x\", \"1\");\n\t\t\trectangle.setAttribute(\"fill\", (i == 0) ? ColorConfig.tonic : ColorConfig.pitchBackground);\n\t\t\tthis._svgNoteBackground.appendChild(rectangle);\n\t\t\tthis._backgroundPitchRows[i] = rectangle;\n\t\t}\n\n\t\tthis._backgroundDrumRow.setAttribute(\"x\", \"1\");\n\t\tthis._backgroundDrumRow.setAttribute(\"y\", \"1\");\n\t\tthis._backgroundDrumRow.setAttribute(\"fill\", ColorConfig.pitchBackground);\n\t\tthis._svgDrumBackground.appendChild(this._backgroundDrumRow);\n\t\t\n\t\tif (this._interactive) {\n\t\t\tthis._updateCursorStatus();\n\t\t\tthis._updatePreview();\n\t\t\twindow.requestAnimationFrame(this._animatePlayhead);\n\t\t\tthis._svg.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\n\t\t\tthis._svg.addEventListener(\"mouseover\", this._whenMouseOver);\n\t\t\tthis._svg.addEventListener(\"mouseout\", this._whenMouseOut);\n\t\t\n\t\t\tthis._svg.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\t\tthis._svg.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\t\tthis._svg.addEventListener(\"touchend\", this._whenCursorReleased);\n\t\t\tthis._svg.addEventListener(\"touchcancel\", this._whenCursorReleased);\n\t\t} else {\n\t\t\tthis._svgPlayhead.style.display = \"none\";\n\t\t\tthis._svg.appendChild(SVG.rect({x: 0, y: 0, width: 10000, height: 10000, fill: ColorConfig.editorBackground, style: \"opacity: 0.5;\"}));\n\t\t}\n\t\t\n\t\tthis.resetCopiedPins();\n\t}\n\t\n\tprivate _getMaxDivision(): number {\n\t\tconst rhythmStepsPerBeat: number = Config.rhythms[this._doc.song.rhythm].stepsPerBeat;\n\t\tif (rhythmStepsPerBeat % 4 == 0) {\n\t\t\t// Beat is divisible by 2 (and 4).\n\t\t\treturn Config.partsPerBeat / 2;\n\t\t} else if (rhythmStepsPerBeat % 3 == 0) {\n\t\t\t// Beat is divisible by 3.\n\t\t\treturn Config.partsPerBeat / 3;\n\t\t} else if (rhythmStepsPerBeat % 2 == 0) {\n\t\t\t// Beat is divisible by 2.\n\t\t\treturn Config.partsPerBeat / 2;\n\t\t}\n\t\treturn Config.partsPerBeat;\n\t}\n\t\n\tprivate _getMinDivision(): number {\n\t\treturn Config.partsPerBeat / Config.rhythms[this._doc.song.rhythm].stepsPerBeat;\n\t}\n\t\n\tprivate _snapToMinDivision(input: number): number {\n\t\tconst minDivision: number = this._getMinDivision();\n\t\treturn Math.floor(input / minDivision) * minDivision;\n\t}\n\t\n\tprivate _updateCursorStatus(): void {\n\t\tthis._cursor = new PatternCursor();\n\t\t\n\t\tif (this._mouseX < 0 || this._mouseX > this._editorWidth || this._mouseY < 0 || this._mouseY > this._editorHeight || this._pitchHeight <= 0) return;\n\t\t\n\t\tconst minDivision: number = this._getMinDivision();\n\t\tthis._cursor.exactPart = this._mouseX / this._partWidth;\n\t\tthis._cursor.part =\n\t\t\tMath.floor(\n\t\t\t\tMath.max(0,\n\t\t\t\t\tMath.min(this._doc.song.beatsPerBar * Config.partsPerBeat - minDivision, this._cursor.exactPart)\n\t\t\t\t)\n\t\t\t/ minDivision) * minDivision;\n\t\t\n\t\tif (this._pattern != null) {\n\t\t\tfor (const note of this._pattern.notes) {\n\t\t\t\tif (note.end <= this._cursor.exactPart) {\n\t\t\t\t\tthis._cursor.prevNote = note;\n\t\t\t\t\tthis._cursor.curIndex++;\n\t\t\t\t} else if (note.start <= this._cursor.exactPart && note.end > this._cursor.exactPart) {\n\t\t\t\t\tthis._cursor.curNote = note;\n\t\t\t\t} else if (note.start > this._cursor.exactPart) {\n\t\t\t\t\tthis._cursor.nextNote = note;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet mousePitch: number = this._findMousePitch(this._mouseY);\n\t\t\n\t\tif (this._cursor.curNote != null) {\n\t\t\tthis._cursor.start = this._cursor.curNote.start;\n\t\t\tthis._cursor.end   = this._cursor.curNote.end;\n\t\t\tthis._cursor.pins  = this._cursor.curNote.pins;\n\t\t\t\n\t\t\tlet interval: number = 0;\n\t\t\tlet error: number = 0;\n\t\t\tlet prevPin: NotePin;\n\t\t\tlet nextPin: NotePin = this._cursor.curNote.pins[0];\n\t\t\tfor (let j: number = 1; j < this._cursor.curNote.pins.length; j++) {\n\t\t\t\tprevPin = nextPin;\n\t\t\t\tnextPin = this._cursor.curNote.pins[j];\n\t\t\t\tconst leftSide:    number = this._partWidth * (this._cursor.curNote.start + prevPin.time);\n\t\t\t\tconst rightSide:   number = this._partWidth * (this._cursor.curNote.start + nextPin.time);\n\t\t\t\tif (this._mouseX > rightSide) continue;\n\t\t\t\tif (this._mouseX < leftSide) throw new Error();\n\t\t\t\tconst intervalRatio: number = (this._mouseX - leftSide) / (rightSide - leftSide);\n\t\t\t\tconst arc: number = Math.sqrt(1.0 / Math.sqrt(4.0) - Math.pow(intervalRatio - 0.5, 2.0)) - 0.5;\n\t\t\t\tconst bendHeight: number = Math.abs(nextPin.interval - prevPin.interval);\n\t\t\t\tinterval = prevPin.interval * (1.0 - intervalRatio) + nextPin.interval * intervalRatio;\n\t\t\t\terror = arc * bendHeight + 0.95;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tlet minInterval: number = Number.MAX_VALUE;\n\t\t\tlet maxInterval: number = -Number.MAX_VALUE;\n\t\t\tlet bestDistance: number = Number.MAX_VALUE;\n\t\t\tfor (const pin of this._cursor.curNote.pins) {\n\t\t\t\tif (minInterval > pin.interval) minInterval = pin.interval;\n\t\t\t\tif (maxInterval < pin.interval) maxInterval = pin.interval;\n\t\t\t\tconst pinDistance: number = Math.abs(this._cursor.curNote.start + pin.time - this._mouseX / this._partWidth);\n\t\t\t\tif (bestDistance > pinDistance) {\n\t\t\t\t\tbestDistance = pinDistance;\n\t\t\t\t\tthis._cursor.nearPinIndex = this._cursor.curNote.pins.indexOf(pin);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tmousePitch -= interval;\n\t\t\tthis._cursor.pitch = this._snapToPitch(mousePitch, -minInterval, (this._doc.song.getChannelIsNoise(this._doc.channel) ? Config.drumCount - 1 : Config.maxPitch) - maxInterval);\n\t\t\t\n\t\t\t// Snap to nearby existing note if present.\n\t\t\tif (!this._doc.song.getChannelIsNoise(this._doc.channel)) {\n\t\t\t\tlet nearest: number = error;\n\t\t\t\tfor (let i: number = 0; i < this._cursor.curNote.pitches.length; i++) {\n\t\t\t\t\tconst distance: number = Math.abs(this._cursor.curNote.pitches[i] - mousePitch + 0.5);\n\t\t\t\t\tif (distance > nearest) continue;\n\t\t\t\t\tnearest = distance;\n\t\t\t\t\tthis._cursor.pitch = this._cursor.curNote.pitches[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor (let i: number = 0; i < this._cursor.curNote.pitches.length; i++) {\n\t\t\t\tif (this._cursor.curNote.pitches[i] == this._cursor.pitch) {\n\t\t\t\t\tthis._cursor.pitchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis._cursor.pitch = this._snapToPitch(mousePitch, 0, Config.maxPitch);\n\t\t\tconst defaultLength: number = this._copiedPins[this._copiedPins.length-1].time;\n\t\t\tconst fullBeats: number = Math.floor(this._cursor.part / Config.partsPerBeat);\n\t\t\tconst maxDivision: number = this._getMaxDivision();\n\t\t\tconst modMouse: number = this._cursor.part % Config.partsPerBeat;\n\t\t\tif (defaultLength == 1) {\n\t\t\t\tthis._cursor.start = this._cursor.part;\n\t\t\t} else if (defaultLength > Config.partsPerBeat) {\n\t\t\t\tthis._cursor.start = fullBeats * Config.partsPerBeat;\n\t\t\t} else if (defaultLength == Config.partsPerBeat) {\n\t\t\t\tthis._cursor.start = fullBeats * Config.partsPerBeat;\n\t\t\t\tif (maxDivision < Config.partsPerBeat && modMouse > maxDivision) {\n\t\t\t\t\tthis._cursor.start += Math.floor(modMouse / maxDivision) * maxDivision;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._cursor.start = fullBeats * Config.partsPerBeat;\n\t\t\t\tlet division = Config.partsPerBeat % defaultLength == 0 ? defaultLength : Math.min(defaultLength, maxDivision);\n\t\t\t\twhile (division < maxDivision && Config.partsPerBeat % division != 0) {\n\t\t\t\t\tdivision++;\n\t\t\t\t}\n\t\t\t\tthis._cursor.start += Math.floor(modMouse / division) * division;\n\t\t\t}\n\t\t\tthis._cursor.end = this._cursor.start + defaultLength;\n\t\t\tlet forceStart: number = 0;\n\t\t\tlet forceEnd: number = this._doc.song.beatsPerBar * Config.partsPerBeat;\n\t\t\tif (this._cursor.prevNote != null) {\n\t\t\t\tforceStart = this._cursor.prevNote.end;\n\t\t\t}\n\t\t\tif (this._cursor.nextNote != null) {\n\t\t\t\tforceEnd   = this._cursor.nextNote.start;\n\t\t\t}\n\t\t\tif (this._cursor.start < forceStart) {\n\t\t\t\tthis._cursor.start = forceStart;\n\t\t\t\tthis._cursor.end = this._cursor.start + defaultLength;\n\t\t\t\tif (this._cursor.end > forceEnd) {\n\t\t\t\t\tthis._cursor.end = forceEnd;\n\t\t\t\t}\n\t\t\t} else if (this._cursor.end > forceEnd) {\n\t\t\t\tthis._cursor.end = forceEnd;\n\t\t\t\tthis._cursor.start = this._cursor.end - defaultLength;\n\t\t\t\tif (this._cursor.start < forceStart) {\n\t\t\t\t\tthis._cursor.start = forceStart;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (this._cursor.end - this._cursor.start == defaultLength) {\n\t\t\t\tthis._cursor.pins = this._copiedPins;\n\t\t\t} else {\n\t\t\t\tthis._cursor.pins = [];\n\t\t\t\tfor (const oldPin of this._copiedPins) {\n\t\t\t\t\tif (oldPin.time <= this._cursor.end - this._cursor.start) {\n\t\t\t\t\t\tthis._cursor.pins.push(makeNotePin(0, oldPin.time, oldPin.size));\n\t\t\t\t\t\tif (oldPin.time == this._cursor.end - this._cursor.start) break;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._cursor.pins.push(makeNotePin(0, this._cursor.end - this._cursor.start, oldPin.size));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._cursor.valid = true;\n\t}\n\t\n\tprivate _cursorIsInSelection(): boolean {\n\t\treturn this._cursor.valid && this._doc.selection.patternSelectionActive && this._doc.selection.patternSelectionStart <= this._cursor.exactPart && this._cursor.exactPart <= this._doc.selection.patternSelectionEnd;\n\t}\n\t\n\tprivate _cursorAtStartOfSelection(): boolean {\n\t\treturn this._cursor.valid && this._doc.selection.patternSelectionActive && this._cursor.pitchIndex == -1 && this._doc.selection.patternSelectionStart - 3 <= this._cursor.exactPart && this._cursor.exactPart <= this._doc.selection.patternSelectionStart + 1.25;\n\t}\n\t\n\tprivate _cursorAtEndOfSelection(): boolean {\n\t\treturn this._cursor.valid && this._doc.selection.patternSelectionActive && this._cursor.pitchIndex == -1 && this._doc.selection.patternSelectionEnd - 1.25 <= this._cursor.exactPart && this._cursor.exactPart <= this._doc.selection.patternSelectionEnd + 3;\n\t}\n\t\n\tprivate _findMousePitch(pixelY: number): number {\n\t\treturn Math.max(0, Math.min(this._pitchCount - 1, this._pitchCount - (pixelY / this._pitchHeight))) + this._octaveOffset;\n\t}\n\t\n\tprivate _snapToPitch(guess: number, min: number, max: number): number {\n\t\tif (guess < min) guess = min;\n\t\tif (guess > max) guess = max;\n\t\tconst scale: ReadonlyArray<boolean> = this._doc.notesOutsideScale ? Config.scales.dictionary[\"expert\"].flags : Config.scales[this._doc.song.scale].flags;\n\t\tif (scale[Math.floor(guess) % Config.pitchesPerOctave] || this._doc.song.getChannelIsNoise(this._doc.channel)) {\n\t\t\treturn Math.floor(guess);\n\t\t} else {\n\t\t\tlet topPitch: number = Math.floor(guess) + 1;\n\t\t\tlet bottomPitch: number = Math.floor(guess) - 1;\n\t\t\twhile (!scale[topPitch % Config.pitchesPerOctave]) {\n\t\t\t\ttopPitch++;\n\t\t\t}\n\t\t\twhile (!scale[(bottomPitch) % Config.pitchesPerOctave]) {\n\t\t\t\tbottomPitch--;\n\t\t\t}\n\t\t\tif (topPitch > max) {\n\t\t\t\tif (bottomPitch < min) {\n\t\t\t\t\treturn min;\n\t\t\t\t} else {\n\t\t\t\t\treturn bottomPitch;\n\t\t\t\t}\n\t\t\t} else if (bottomPitch < min) {\n\t\t\t\treturn topPitch;\n\t\t\t}\n\t\t\tlet topRange: number = topPitch;\n\t\t\tlet bottomRange: number = bottomPitch + 1;\n\t\t\tif (topPitch % Config.pitchesPerOctave == 0 || topPitch % Config.pitchesPerOctave == 7) {\n\t\t\t\ttopRange -= 0.5;\n\t\t\t}\n\t\t\tif (bottomPitch % Config.pitchesPerOctave == 0 || bottomPitch % Config.pitchesPerOctave == 7) {\n\t\t\t\tbottomRange += 0.5;\n\t\t\t}\n\t\t\treturn guess - bottomRange > topRange - guess ? topPitch : bottomPitch;\n\t\t}\n\t}\n\t\n\tprivate _copyPins(note: Note): void {\n\t\tthis._copiedPins = [];\n\t\tfor (const oldPin of note.pins) {\n\t\t\tthis._copiedPins.push(makeNotePin(0, oldPin.time, oldPin.size));\n\t\t}\n\t\tfor (let i: number = 1; i < this._copiedPins.length - 1; ) {\n\t\t\tif (this._copiedPins[i-1].size == this._copiedPins[i].size && \n\t\t\t\tthis._copiedPins[i].size == this._copiedPins[i+1].size)\n\t\t\t{\n\t\t\t\tthis._copiedPins.splice(i, 1);\n\t\t\t} else {\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\tthis._copiedPinChannels[this._doc.channel] = this._copiedPins;\n\t}\n\t\n\tpublic movePlayheadToMouse(): boolean {\n\t\tif (this._mouseOver) {\n\t\t\tthis._doc.synth.playhead = this._doc.bar + this._barOffset + (this._mouseX / this._editorWidth);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tpublic resetCopiedPins = (): void => {\n\t\tconst maxDivision: number = this._getMaxDivision();\n\t\tthis._copiedPinChannels.length = this._doc.song.getChannelCount();\n\t\tfor (let i: number = 0; i < this._doc.song.pitchChannelCount; i++) {\n\t\t\tthis._copiedPinChannels[i] = [makeNotePin(0, 0, Config.noteSizeMax), makeNotePin(0, maxDivision, Config.noteSizeMax)];\n\t\t}\n\t\tfor (let i: number = this._doc.song.pitchChannelCount; i < this._doc.song.getChannelCount(); i++) {\n\t\t\tthis._copiedPinChannels[i] = [makeNotePin(0, 0, Config.noteSizeMax), makeNotePin(0, maxDivision, 0)];\n\t\t}\n\t}\n\t\n\tprivate _animatePlayhead = (timestamp: number): void => {\n\t\t\n\t\tif (this._usingTouch && !this._shiftHeld && !this._mouseDragging && this._mouseDown && performance.now() > this._touchTime + 1000 && this._cursor.valid && this._doc.lastChangeWas(this._dragChange)) {\n\t\t\tthis._dragChange!.undo();\n\t\t\tthis._shiftHeld = true;\n\t\t\tthis._whenCursorPressed();\n\t\t\tthis._doc.notifier.notifyWatchers();\n\t\t}\n\t\t\n\t\tconst playheadBar: number = Math.floor(this._doc.synth.playhead);\n\t\t\n\t\tif (this._doc.synth.playing && ((this._pattern != null && this._doc.song.getPattern(this._doc.channel, Math.floor(this._doc.synth.playhead)) == this._pattern) || Math.floor(this._doc.synth.playhead) == this._doc.bar + this._barOffset)) {\n\t\t\tthis._svgPlayhead.setAttribute(\"visibility\", \"visible\");\n\t\t\tconst modPlayhead: number = this._doc.synth.playhead - playheadBar;\n\t\t\tif (Math.abs(modPlayhead - this._playheadX) > 0.1) {\n\t\t\t\tthis._playheadX = modPlayhead;\n\t\t\t} else {\n\t\t\t\tthis._playheadX += (modPlayhead - this._playheadX) * 0.2;\n\t\t\t}\n\t\t\tthis._svgPlayhead.setAttribute(\"x\", \"\" + prettyNumber(this._playheadX * this._editorWidth - 2));\n\t\t} else {\n\t\t\tthis._svgPlayhead.setAttribute(\"visibility\", \"hidden\");\n\t\t}\n\t\t\n\t\tif (this._doc.synth.playing && this._doc.autoFollow && this._followPlayheadBar != playheadBar) {\n\t\t\tnew ChangeChannelBar(this._doc, this._doc.channel, playheadBar);\n\t\t\tthis._doc.notifier.notifyWatchers();\n\t\t}\n\t\tthis._followPlayheadBar = playheadBar;\n\t\twindow.requestAnimationFrame(this._animatePlayhead);\n\t}\n\t\n\tprivate _whenMouseOver = (event: MouseEvent): void => {\n\t\tif (this._mouseOver) return;\n\t\tthis._mouseOver = true;\n\t\tthis._usingTouch = false;\n\t}\n\t\n\tprivate _whenMouseOut = (event: MouseEvent): void => {\n\t\tif (!this._mouseOver) return;\n\t\tthis._mouseOver = false;\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._usingTouch = false;\n\t\tthis._ctrlHeld = event.ctrlKey || event.metaKey;\n\t\tthis._shiftHeld = event.shiftKey;\n\t\tthis._whenCursorPressed();\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._usingTouch = true;\n\t\tthis._ctrlHeld = event.ctrlKey || event.metaKey;\n\t\tthis._shiftHeld = event.shiftKey;\n\t\tthis._touchTime = performance.now();\n\t\tthis._whenCursorPressed();\n\t}\n\t\n\tprivate _whenCursorPressed(): void {\n\t\tif (this._doc.enableNotePreview) this._doc.synth.maintainLiveInput();\n\t\tthis._mouseDown = true;\n\t\tthis._mouseXStart = this._mouseX;\n\t\tthis._mouseYStart = this._mouseY;\n\t\tthis._updateCursorStatus();\n\t\tthis._updatePreview();\n\t\tconst sequence: ChangeSequence = new ChangeSequence();\n\t\tthis._dragChange = sequence;\n\t\tthis._lastChangeWasPatternSelection = this._doc.lastChangeWas(this._changePatternSelection);\n\t\tthis._doc.setProspectiveChange(this._dragChange);\n\t\t\n\t\tif (this._cursorAtStartOfSelection()) {\n\t\t\tthis._draggingStartOfSelection = true;\n\t\t} else if (this._cursorAtEndOfSelection()) {\n\t\t\tthis._draggingEndOfSelection = true;\n\t\t} else if (this._shiftHeld) {\n\t\t\tif ((this._doc.selection.patternSelectionActive && this._cursor.pitchIndex == -1) || this._cursorIsInSelection()) {\n\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, 0, 0));\n\t\t\t} else {\n\t\t\t\tif (this._cursor.curNote != null) {\n\t\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, this._cursor.curNote.start, this._cursor.curNote.end));\n\t\t\t\t} else {\n\t\t\t\t\tconst start: number = Math.max(0, Math.min((this._doc.song.beatsPerBar - 1) * Config.partsPerBeat, Math.floor(this._cursor.exactPart / Config.partsPerBeat) * Config.partsPerBeat));\n\t\t\t\t\tconst end: number = start + Config.partsPerBeat;\n\t\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, start, end));\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (this._cursorIsInSelection()) {\n\t\t\tthis._draggingSelectionContents = true;\n\t\t} else if (this._cursor.valid && this._cursor.curNote == null) {\n\t\t\tsequence.append(new ChangePatternSelection(this._doc, 0, 0));\n\t\t\t\n\t\t\t// If clicking in empty space, the result will be adding a note,\n\t\t\t// so we can safely add it immediately. Note that if clicking on\n\t\t\t// or near an existing note, the result will depend on whether\n\t\t\t// a drag follows, so we couldn't add the note yet without being\n\t\t\t// confusing.\n\t\t\t\n\t\t\tconst note: Note = new Note(this._cursor.pitch, this._cursor.start, this._cursor.end, Config.noteSizeMax, this._doc.song.getChannelIsNoise(this._doc.channel));\n\t\t\tnote.pins = [];\n\t\t\tfor (const oldPin of this._cursor.pins) {\n\t\t\t\tnote.pins.push(makeNotePin(0, oldPin.time, oldPin.size));\n\t\t\t}\n\t\t\tsequence.append(new ChangeEnsurePatternExists(this._doc, this._doc.channel, this._doc.bar));\n\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern(this._barOffset);\n\t\t\tif (pattern == null) throw new Error();\n\t\t\tsequence.append(new ChangeNoteAdded(this._doc, pattern, note, this._cursor.curIndex));\n\t\t\t\n\t\t\tif (this._doc.enableNotePreview && !this._doc.synth.playing) {\n\t\t\t\t// Play the new note out loud if enabled.\n\t\t\t\tconst duration: number = Math.min(Config.partsPerBeat, this._cursor.end - this._cursor.start);\n\t\t\t\tthis._doc.synth.liveInputDuration = duration;\n\t\t\t\tthis._doc.synth.liveInputPitches = [this._cursor.pitch];\n\t\t\t\tthis._doc.synth.liveInputStarted = true;\n\t\t\t}\n\t\t}\n\t\tthis._updateSelection();\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._usingTouch = false;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tif (!this._mouseDown) return;\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenCursorMoved(): void {\n\t\tif (this._doc.enableNotePreview && this._mouseOver) this._doc.synth.maintainLiveInput();\n\t\t\n\t\t// HACK: Undoable pattern changes rely on persistent instance\n\t\t// references. Loading song from hash via undo/redo breaks that,\n\t\t// so changes are no longer undoable and the cursor status may be\n\t\t// invalid. Abort further drag changes until the mouse is released.\n\t\tconst continuousState: boolean = this._doc.lastChangeWas(this._dragChange);\n\t\t\n\t\tif (!this._mouseDragging && this._mouseDown && this._cursor.valid && continuousState) {\n\t\t\tconst dx: number = this._mouseX - this._mouseXStart;\n\t\t\tconst dy: number = this._mouseY - this._mouseYStart;\n\t\t\tif (Math.sqrt(dx * dx + dy * dy) > 5) {\n\t\t\t\tthis._mouseDragging = true;\n\t\t\t\tthis._mouseHorizontal = Math.abs(dx) >= Math.abs(dy);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._mouseDragging && this._mouseDown && this._cursor.valid && continuousState) {\n\t\t\tthis._dragChange!.undo();\n\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\n\t\t\tthis._dragChange = sequence;\n\t\t\tthis._doc.setProspectiveChange(this._dragChange);\n\t\t\t\n\t\t\tconst minDivision: number = this._getMinDivision();\n\t\t\tconst currentPart: number = this._snapToMinDivision(this._mouseX / this._partWidth);\n\t\t\tif (this._draggingStartOfSelection) {\n\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, Math.max(0, Math.min(this._doc.song.beatsPerBar * Config.partsPerBeat, currentPart)), this._doc.selection.patternSelectionEnd));\n\t\t\t\tthis._updateSelection();\n\t\t\t} else if (this._draggingEndOfSelection) {\n\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, this._doc.selection.patternSelectionStart, Math.max(0, Math.min(this._doc.song.beatsPerBar * Config.partsPerBeat, currentPart))));\n\t\t\t\tthis._updateSelection();\n\t\t\t} else if (this._draggingSelectionContents) {\n\t\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern(this._barOffset);\n\t\t\t\tif (this._mouseDragging && pattern != null) {\n\t\t\t\t\tthis._dragChange!.undo();\n\t\t\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\n\t\t\t\t\tthis._dragChange = sequence;\n\t\t\t\t\tthis._doc.setProspectiveChange(this._dragChange);\n\t\t\t\t\t\n\t\t\t\t\tconst notesInScale: number = Config.scales[this._doc.song.scale].flags.filter(x=>x).length;\n\t\t\t\t\tconst pitchRatio: number = this._doc.song.getChannelIsNoise(this._doc.channel) ? 1 : 12 / notesInScale;\n\t\t\t\t\tconst draggedParts: number = Math.round((this._mouseX - this._mouseXStart) / (this._partWidth * minDivision)) * minDivision;\n\t\t\t\t\tconst draggedTranspose: number = Math.round((this._mouseYStart - this._mouseY) / (this._pitchHeight * pitchRatio));\n\t\t\t\t\tsequence.append(new ChangeDragSelectedNotes(this._doc, this._doc.channel, pattern, draggedParts, draggedTranspose));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else if (this._shiftHeld) {\n\t\t\t\t\n\t\t\t\tif (this._mouseDragging) {\n\t\t\t\t\tlet start: number = Math.max(0, Math.min((this._doc.song.beatsPerBar - 1) * Config.partsPerBeat, Math.floor(this._cursor.exactPart / Config.partsPerBeat) * Config.partsPerBeat));\n\t\t\t\t\tlet end: number = start + Config.partsPerBeat;\n\t\t\t\t\tif (this._cursor.curNote != null) {\n\t\t\t\t\t\tstart = Math.max(start, this._cursor.curNote.start);\n\t\t\t\t\t\tend = Math.min(end, this._cursor.curNote.end);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// Todo: The following two conditional blocks could maybe be refactored.\n\t\t\t\t\tif (currentPart < start) {\n\t\t\t\t\t\tstart = 0;\n\t\t\t\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern(this._barOffset);\n\t\t\t\t\t\tif (pattern != null) {\n\t\t\t\t\t\t\tfor (let i: number = 0; i < pattern.notes.length; i++) {\n\t\t\t\t\t\t\t\tif (pattern.notes[i].start <= currentPart) {\n\t\t\t\t\t\t\t\t\tstart = pattern.notes[i].start;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (pattern.notes[i].end <= currentPart) {\n\t\t\t\t\t\t\t\t\tstart = pattern.notes[i].end;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (let beat: number = 0; beat <= this._doc.song.beatsPerBar; beat++) {\n\t\t\t\t\t\t\tconst part: number = beat * Config.partsPerBeat;\n\t\t\t\t\t\t\tif (start <= part && part <= currentPart) {\n\t\t\t\t\t\t\t\tstart = part;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (currentPart > end) {\n\t\t\t\t\t\tend = Config.partsPerBeat * this._doc.song.beatsPerBar;\n\t\t\t\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern(this._barOffset);\n\t\t\t\t\t\tif (pattern != null) {\n\t\t\t\t\t\t\tfor (let i: number = 0; i < pattern.notes.length; i++) {\n\t\t\t\t\t\t\t\tif (pattern.notes[i].start >= currentPart) {\n\t\t\t\t\t\t\t\t\tend = pattern.notes[i].start;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (pattern.notes[i].end >= currentPart) {\n\t\t\t\t\t\t\t\t\tend = pattern.notes[i].end;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (let beat: number = 0; beat <= this._doc.song.beatsPerBar; beat++) {\n\t\t\t\t\t\t\tconst part: number = beat * Config.partsPerBeat;\n\t\t\t\t\t\t\tif (currentPart < part && part < end) {\n\t\t\t\t\t\t\t\tend = part;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, start, end));\n\t\t\t\t\tthis._updateSelection();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tif (this._cursor.curNote == null) {\n\t\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, 0, 0));\n\t\t\t\t\t\n\t\t\t\t\tlet backwards: boolean;\n\t\t\t\t\tlet directLength: number;\n\t\t\t\t\tif (currentPart < this._cursor.start) {\n\t\t\t\t\t\tbackwards = true;\n\t\t\t\t\t\tdirectLength = this._cursor.start - currentPart;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbackwards = false;\n\t\t\t\t\t\tdirectLength = currentPart - this._cursor.start + minDivision;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlet defaultLength: number = minDivision;\n\t\t\t\t\tfor (let i: number = minDivision; i <= this._doc.song.beatsPerBar * Config.partsPerBeat; i += minDivision) {\n\t\t\t\t\t\tif (minDivision == 1) {\n\t\t\t\t\t\t\tif (i < 5) {\n\t\t\t\t\t\t\t\t// Allow small lengths.\n\t\t\t\t\t\t\t} else if (i <= Config.partsPerBeat / 2.0) {\n\t\t\t\t\t\t\t\tif (i % 3 != 0 && i % 4 != 0) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (i <= Config.partsPerBeat * 1.5) {\n\t\t\t\t\t\t\t\tif (i % 6 != 0 && i % 8 != 0) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (i % Config.partsPerBeat != 0) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (i >= 5 * minDivision &&\n\t\t\t\t\t\t\t\ti % Config.partsPerBeat != 0 &&\n\t\t\t\t\t\t\t\ti != Config.partsPerBeat * 3.0 / 4.0 &&\n\t\t\t\t\t\t\t\ti != Config.partsPerBeat * 3.0 / 2.0 &&\n\t\t\t\t\t\t\t\ti != Config.partsPerBeat * 4.0 / 3.0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst blessedLength: number = i;\n\t\t\t\t\t\tif (blessedLength == directLength) {\n\t\t\t\t\t\t\tdefaultLength = blessedLength;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (blessedLength < directLength) {\n\t\t\t\t\t\t\tdefaultLength = blessedLength;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (blessedLength > directLength) {\n\t\t\t\t\t\t\tif (defaultLength < directLength - minDivision) {\n\t\t\t\t\t\t\t\tdefaultLength = blessedLength;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlet start: number;\n\t\t\t\t\tlet end: number;\n\t\t\t\t\tif (backwards) {\n\t\t\t\t\t\tend = this._cursor.start;\n\t\t\t\t\t\tstart = end - defaultLength;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart = this._cursor.start;\n\t\t\t\t\t\tend = start + defaultLength;\n\t\t\t\t\t}\n\t\t\t\t\tconst continuesLastPattern: boolean = (start < 0);\n\t\t\t\t\tif (start < 0) start = 0;\n\t\t\t\t\tif (end > this._doc.song.beatsPerBar * Config.partsPerBeat) end = this._doc.song.beatsPerBar * Config.partsPerBeat;\n\t\t\t\t\t\n\t\t\t\t\tif (start < end) {\n\t\t\t\t\t\tsequence.append(new ChangeEnsurePatternExists(this._doc, this._doc.channel, this._doc.bar));\n\t\t\t\t\t\tconst pattern: Pattern | null = this._doc.getCurrentPattern(this._barOffset);\n\t\t\t\t\t\tif (pattern == null) throw new Error();\n\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(this._doc, pattern, start, end));\n\t\t\t\t\t\tlet i: number;\n\t\t\t\t\t\tfor (i = 0; i < pattern.notes.length; i++) {\n\t\t\t\t\t\t\tif (pattern.notes[i].start >= end) break;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst theNote: Note = new Note(this._cursor.pitch, start, end, Config.noteSizeMax, this._doc.song.getChannelIsNoise(this._doc.channel));\n\t\t\t\t\t\ttheNote.continuesLastPattern = continuesLastPattern;\n\t\t\t\t\t\tsequence.append(new ChangeNoteAdded(this._doc, pattern, theNote, i));\n\t\t\t\t\t\tthis._copyPins(theNote);\n\t\t\t\t\t\n\t\t\t\t\t\tthis._dragTime = backwards ? start : end;\n\t\t\t\t\t\tthis._dragPitch = this._cursor.pitch;\n\t\t\t\t\t\tthis._dragSize = theNote.pins[backwards ? 0 : 1].size;\n\t\t\t\t\t\tthis._dragVisible = true;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis._pattern = this._doc.getCurrentPattern(this._barOffset);\n\t\t\t\t} else if (this._mouseHorizontal) {\n\t\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, 0, 0));\n\t\t\t\t\t\n\t\t\t\t\tconst shift: number = (this._mouseX - this._mouseXStart) / this._partWidth;\n\t\t\t\t\t\n\t\t\t\t\tconst shiftedPin: NotePin = this._cursor.curNote.pins[this._cursor.nearPinIndex];\n\t\t\t\t\tlet shiftedTime: number = Math.round((this._cursor.curNote.start + shiftedPin.time + shift) / minDivision) * minDivision;\n\t\t\t\t\tconst continuesLastPattern: boolean = (shiftedTime < 0.0);\n\t\t\t\t\tif (shiftedTime < 0) shiftedTime = 0;\n\t\t\t\t\tif (shiftedTime > this._doc.song.beatsPerBar * Config.partsPerBeat) shiftedTime = this._doc.song.beatsPerBar * Config.partsPerBeat;\n\t\t\t\t\t\n\t\t\t\t\tif (this._pattern == null) throw new Error();\n\t\t\t\t\t\n\t\t\t\t\tif (shiftedTime <= this._cursor.curNote.start && this._cursor.nearPinIndex == this._cursor.curNote.pins.length - 1 ||\n\t\t\t\t\t\tshiftedTime >= this._cursor.curNote.end   && this._cursor.nearPinIndex == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tsequence.append(new ChangeNoteAdded(this._doc, this._pattern, this._cursor.curNote, this._cursor.curIndex, true));\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis._dragVisible = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst start: number = Math.min(this._cursor.curNote.start, shiftedTime);\n\t\t\t\t\t\tconst   end: number = Math.max(this._cursor.curNote.end,   shiftedTime);\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis._dragTime = shiftedTime;\n\t\t\t\t\t\tthis._dragPitch = this._cursor.curNote.pitches[this._cursor.pitchIndex == -1 ? 0 : this._cursor.pitchIndex] + this._cursor.curNote.pins[this._cursor.nearPinIndex].interval;\n\t\t\t\t\t\tthis._dragSize = this._cursor.curNote.pins[this._cursor.nearPinIndex].size;\n\t\t\t\t\t\tthis._dragVisible = true;\n\t\t\t\t\t\t\n\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(this._doc, this._pattern, start, end, this._cursor.curNote));\n\t\t\t\t\t\tsequence.append(new ChangePinTime(this._doc, this._cursor.curNote, this._cursor.nearPinIndex, shiftedTime, continuesLastPattern));\n\t\t\t\t\t\tthis._copyPins(this._cursor.curNote);\n\t\t\t\t\t}\n\t\t\t\t} else if (this._cursor.pitchIndex == -1) {\n\t\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, 0, 0));\n\t\t\t\t\t\n\t\t\t\t\tconst bendPart: number = \n\t\t\t\t\t\tMath.max(this._cursor.curNote.start,\n\t\t\t\t\t\t\tMath.min(this._cursor.curNote.end,\n\t\t\t\t\t\t\t\tMath.round(this._mouseX / (this._partWidth * minDivision)) * minDivision\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) - this._cursor.curNote.start;\n\t\t\t\t\t\n\t\t\t\t\tlet prevPin: NotePin;\n\t\t\t\t\tlet nextPin: NotePin = this._cursor.curNote.pins[0];\n\t\t\t\t\tlet bendSize: number = 0;\n\t\t\t\t\tlet bendInterval: number = 0;\n\t\t\t\t\tfor (let i: number = 1; i < this._cursor.curNote.pins.length; i++) {\n\t\t\t\t\t\tprevPin = nextPin;\n\t\t\t\t\t\tnextPin = this._cursor.curNote.pins[i];\n\t\t\t\t\t\tif (bendPart > nextPin.time) continue;\n\t\t\t\t\t\tif (bendPart < prevPin.time) throw new Error();\n\t\t\t\t\t\tconst sizeRatio: number = (bendPart - prevPin.time) / (nextPin.time - prevPin.time);\n\t\t\t\t\t\tbendSize = Math.round(prevPin.size * (1.0 - sizeRatio) + nextPin.size * sizeRatio + ((this._mouseYStart - this._mouseY) / (75.0 / Config.noteSizeMax)));\n\t\t\t\t\t\tif (bendSize < 0) bendSize = 0;\n\t\t\t\t\t\tif (bendSize > Config.noteSizeMax) bendSize = Config.noteSizeMax;\n\t\t\t\t\t\tbendInterval = this._snapToPitch(prevPin.interval * (1.0 - sizeRatio) + nextPin.interval * sizeRatio + this._cursor.curNote.pitches[0], 0, Config.maxPitch) - this._cursor.curNote.pitches[0];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis._dragTime = this._cursor.curNote.start + bendPart;\n\t\t\t\t\tthis._dragPitch = this._cursor.curNote.pitches[this._cursor.pitchIndex == -1 ? 0 : this._cursor.pitchIndex] + bendInterval;\n\t\t\t\t\tthis._dragSize = bendSize;\n\t\t\t\t\tthis._dragVisible = true;\n\t\t\t\t\t\n\t\t\t\t\tsequence.append(new ChangeSizeBend(this._doc, this._cursor.curNote, bendPart, bendSize, bendInterval, this._ctrlHeld));\n\t\t\t\t\tthis._copyPins(this._cursor.curNote);\n\t\t\t\t} else {\n\t\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, 0, 0));\n\t\t\t\t\t\n\t\t\t\t\tthis._dragSize = this._cursor.curNote.pins[this._cursor.nearPinIndex].size;\n\t\t\t\t\t\n\t\t\t\t\tif (this._pattern == null) throw new Error();\n\t\t\t\t\t\n\t\t\t\t\tlet bendStart: number;\n\t\t\t\t\tlet bendEnd: number;\n\t\t\t\t\tif (this._mouseX >= this._mouseXStart) {\n\t\t\t\t\t\tbendStart = Math.max(this._cursor.curNote.start, this._cursor.part);\n\t\t\t\t\t\tbendEnd   = currentPart + minDivision;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbendStart = Math.min(this._cursor.curNote.end, this._cursor.part + minDivision);\n\t\t\t\t\t\tbendEnd   = currentPart;\n\t\t\t\t\t}\n\t\t\t\t\tif (bendEnd < 0) bendEnd = 0;\n\t\t\t\t\tif (bendEnd > this._doc.song.beatsPerBar * Config.partsPerBeat) bendEnd = this._doc.song.beatsPerBar * Config.partsPerBeat;\n\t\t\t\t\tif (bendEnd > this._cursor.curNote.end) {\n\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(this._doc, this._pattern, this._cursor.curNote.start, bendEnd, this._cursor.curNote));\n\t\t\t\t\t}\n\t\t\t\t\tif (bendEnd < this._cursor.curNote.start) {\n\t\t\t\t\t\tsequence.append(new ChangeNoteTruncate(this._doc, this._pattern, bendEnd, this._cursor.curNote.end, this._cursor.curNote));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlet minPitch: number = Number.MAX_VALUE;\n\t\t\t\t\tlet maxPitch: number = -Number.MAX_VALUE;\n\t\t\t\t\tfor (const pitch of this._cursor.curNote.pitches) {\n\t\t\t\t\t\tif (minPitch > pitch) minPitch = pitch;\n\t\t\t\t\t\tif (maxPitch < pitch) maxPitch = pitch;\n\t\t\t\t\t}\n\t\t\t\t\tminPitch -= this._cursor.curNote.pitches[this._cursor.pitchIndex];\n\t\t\t\t\tmaxPitch -= this._cursor.curNote.pitches[this._cursor.pitchIndex];\n\t\t\t\t\tconst bendTo: number = this._snapToPitch(this._findMousePitch(this._mouseY), -minPitch, (this._doc.song.getChannelIsNoise(this._doc.channel) ? Config.drumCount-1 : Config.maxPitch) - maxPitch);\n\t\t\t\t\tsequence.append(new ChangePitchBend(this._doc, this._cursor.curNote, bendStart, bendEnd, bendTo, this._cursor.pitchIndex));\n\t\t\t\t\tthis._copyPins(this._cursor.curNote);\n\t\t\t\t\t\n\t\t\t\t\tthis._dragTime = bendEnd;\n\t\t\t\t\tthis._dragPitch = bendTo;\n\t\t\t\t\tthis._dragVisible = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (!(this._mouseDown && this._cursor.valid && continuousState)) {\n\t\t\tthis._updateCursorStatus();\n\t\t\tthis._updatePreview();\n\t\t}\n\t}\n\t\n\tprivate _whenCursorReleased = (event: Event | null): void => {\n\t\tif (!this._cursor.valid) return;\n\t\t\n\t\tconst continuousState: boolean = this._doc.lastChangeWas(this._dragChange);\n\t\tif (this._mouseDown && continuousState && this._dragChange != null) {\n\t\t\t\n\t\t\tif (this._draggingSelectionContents) {\n\t\t\t\tthis._doc.record(this._dragChange);\n\t\t\t\tthis._dragChange = null;\n\t\t\t} else if (this._draggingStartOfSelection || this._draggingEndOfSelection || this._shiftHeld) {\n\t\t\t\tthis._setPatternSelection(this._dragChange);\n\t\t\t\tthis._dragChange = null;\n\t\t\t} else if (this._mouseDragging || this._cursor.curNote == null || !this._dragChange.isNoop() || this._draggingStartOfSelection || this._draggingEndOfSelection || this._draggingSelectionContents || this._shiftHeld) {\n\t\t\t\tthis._doc.record(this._dragChange);\n\t\t\t\tthis._dragChange = null;\n\t\t\t} else {\n\t\t\t\tif (this._pattern == null) throw new Error();\n\t\t\t\t\n\t\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\n\t\t\t\tsequence.append(new ChangePatternSelection(this._doc, 0, 0));\n\t\t\t\t\n\t\t\t\tif (this._cursor.pitchIndex == -1) {\n\t\t\t\t\tif (this._cursor.curNote.pitches.length == Config.maxChordSize) {\n\t\t\t\t\t\tsequence.append(new ChangePitchAdded(this._doc, this._cursor.curNote, this._cursor.curNote.pitches[0], 0, true));\n\t\t\t\t\t}\n\t\t\t\t\tsequence.append(new ChangePitchAdded(this._doc, this._cursor.curNote, this._cursor.pitch, this._cursor.curNote.pitches.length));\n\t\t\t\t\tthis._copyPins(this._cursor.curNote);\n\t\t\t\t\t\n\t\t\t\t\tif (this._doc.enableNotePreview && !this._doc.synth.playing) {\n\t\t\t\t\t\tconst duration: number = Math.min(Config.partsPerBeat, this._cursor.end - this._cursor.start);\n\t\t\t\t\t\tthis._doc.synth.liveInputDuration = duration;\n\t\t\t\t\t\tthis._doc.synth.liveInputPitches = this._cursor.curNote.pitches.concat();\n\t\t\t\t\t\tthis._doc.synth.liveInputStarted = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (this._cursor.curNote.pitches.length == 1) {\n\t\t\t\t\t\tsequence.append(new ChangeNoteAdded(this._doc, this._pattern, this._cursor.curNote, this._cursor.curIndex, true));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsequence.append(new ChangePitchAdded(this._doc, this._cursor.curNote, this._cursor.pitch, this._cursor.curNote.pitches.indexOf(this._cursor.pitch), true));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis._doc.record(sequence);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._mouseDown = false;\n\t\tthis._mouseDragging = false;\n\t\tthis._draggingStartOfSelection = false;\n\t\tthis._draggingEndOfSelection = false;\n\t\tthis._draggingSelectionContents = false;\n\t\tthis._lastChangeWasPatternSelection = false;\n\t\tthis._updateCursorStatus();\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _setPatternSelection(change: UndoableChange): void {\n\t\tthis._changePatternSelection = change;\n\t\t// Don't erase existing redo history just to change pattern selection.\n\t\tif (!this._doc.hasRedoHistory()) {\n\t\t\tthis._doc.record(this._changePatternSelection, this._lastChangeWasPatternSelection);\n\t\t}\n\t}\n\t\n\tprivate _updatePreview(): void {\n\t\tif (this._usingTouch) {\n\t\t\tif (!this._mouseDown || !this._cursor.valid  || !this._mouseDragging || !this._dragVisible || this._shiftHeld || this._draggingStartOfSelection || this._draggingEndOfSelection || this._draggingSelectionContents) {\n\t\t\t\tthis._svgPreview.setAttribute(\"visibility\", \"hidden\");\n\t\t\t} else {\n\t\t\t\tthis._svgPreview.setAttribute(\"visibility\", \"visible\");\n\t\t\t\t\n\t\t\t\tconst x: number = this._partWidth * this._dragTime;\n\t\t\t\tconst y: number = this._pitchToPixelHeight(this._dragPitch - this._octaveOffset);\n\t\t\t\tconst radius: number = this._pitchHeight / 2;\n\t\t\t\tconst width: number = 80;\n\t\t\t\tconst height: number = 60;\n\t\t\t\t//this._drawNote(this._svgPreview, this._cursor.pitch, this._cursor.start, this._cursor.pins, this._pitchHeight / 2 + 1, true, this._octaveOffset);\n\t\t\t\t\n\t\t\t\tlet pathString: string = \"\";\n\t\t\t\t\n\t\t\t\tconst sizeMax: number = Config.noteSizeMax;\n\t\t\t\tpathString += \"M \" + prettyNumber(x)         + \" \" + prettyNumber(y - radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"L \" + prettyNumber(x)         + \" \" + prettyNumber(y - radius * (this._dragSize / sizeMax) - height) + \" \";\n\t\t\t\tpathString += \"M \" + prettyNumber(x)         + \" \" + prettyNumber(y + radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"L \" + prettyNumber(x)         + \" \" + prettyNumber(y + radius * (this._dragSize / sizeMax) + height) + \" \";\n\t\t\t\tpathString += \"M \" + prettyNumber(x)         + \" \" + prettyNumber(y - radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"L \" + prettyNumber(x + width) + \" \" + prettyNumber(y - radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"M \" + prettyNumber(x)         + \" \" + prettyNumber(y + radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"L \" + prettyNumber(x + width) + \" \" + prettyNumber(y + radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"M \" + prettyNumber(x)         + \" \" + prettyNumber(y - radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"L \" + prettyNumber(x - width) + \" \" + prettyNumber(y - radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"M \" + prettyNumber(x)         + \" \" + prettyNumber(y + radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\tpathString += \"L \" + prettyNumber(x - width) + \" \" + prettyNumber(y + radius * (this._dragSize / sizeMax)) + \" \";\n\t\t\t\t\n\t\t\t\tthis._svgPreview.setAttribute(\"d\", pathString);\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this._mouseOver || this._mouseDown || !this._cursor.valid) {\n\t\t\t\tthis._svgPreview.setAttribute(\"visibility\", \"hidden\");\n\t\t\t} else {\n\t\t\t\tthis._svgPreview.setAttribute(\"visibility\", \"visible\");\n\t\t\t\t\n\t\t\t\tif (this._cursorAtStartOfSelection()) {\n\t\t\t\t\tconst center: number = this._partWidth * this._doc.selection.patternSelectionStart;\n\t\t\t\t\tconst left: string = prettyNumber(center - 4);\n\t\t\t\t\tconst right: string = prettyNumber(center + 4);\n\t\t\t\t\tconst bottom: number = this._pitchToPixelHeight(-0.5);\n\t\t\t\t\tthis._svgPreview.setAttribute(\"d\", \"M \" + left + \" 0 L \" + left + \" \" + bottom + \" L \" + right + \" \" + bottom + \" L \" + right + \" 0 z\");\n\t\t\t\t} else if (this._cursorAtEndOfSelection()) {\n\t\t\t\t\tconst center: number = this._partWidth * this._doc.selection.patternSelectionEnd;\n\t\t\t\t\tconst left: string = prettyNumber(center - 4);\n\t\t\t\t\tconst right: string = prettyNumber(center + 4);\n\t\t\t\t\tconst bottom: number = this._pitchToPixelHeight(-0.5);\n\t\t\t\t\tthis._svgPreview.setAttribute(\"d\", \"M \" + left + \" 0 L \" + left + \" \" + bottom + \" L \" + right + \" \" + bottom + \" L \" + right + \" 0 z\");\n\t\t\t\t} else if (this._cursorIsInSelection()) {\n\t\t\t\t\tconst left: string = prettyNumber(this._partWidth * this._doc.selection.patternSelectionStart - 2);\n\t\t\t\t\tconst right: string = prettyNumber(this._partWidth * this._doc.selection.patternSelectionEnd + 2);\n\t\t\t\t\tconst bottom: number = this._pitchToPixelHeight(-0.5);\n\t\t\t\t\tthis._svgPreview.setAttribute(\"d\", \"M \" + left + \" 0 L \" + left + \" \" + bottom + \" L \" + right + \" \" + bottom + \" L \" + right + \" 0 z\");\n\t\t\t\t} else {\n\t\t\t\t\tthis._drawNote(this._svgPreview, this._cursor.pitch, this._cursor.start, this._cursor.pins, this._pitchHeight / 2 + 1, true, this._octaveOffset);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate _updateSelection(): void {\n\t\tif (this._doc.selection.patternSelectionActive) {\n\t\t\tthis._selectionRect.setAttribute(\"visibility\", \"visible\");\n\t\t\tthis._selectionRect.setAttribute(\"x\", String(this._partWidth * this._doc.selection.patternSelectionStart));\n\t\t\tthis._selectionRect.setAttribute(\"width\", String(this._partWidth * (this._doc.selection.patternSelectionEnd - this._doc.selection.patternSelectionStart)));\n\t\t} else {\n\t\t\tthis._selectionRect.setAttribute(\"visibility\", \"hidden\");\n\t\t}\n\t}\n\t\n\tpublic render(): void {\n\t\tconst nextPattern: Pattern | null = this._doc.getCurrentPattern(this._barOffset);\n\t\tif (this._pattern != nextPattern && this._pattern != null) {\n\t\t\tthis._dragChange = null;\n\t\t\tthis._whenCursorReleased(null);\n\t\t}\n\t\tthis._pattern = nextPattern;\n\t\t\n\t\tthis._editorWidth = this.container.clientWidth;\n\t\tthis._editorHeight = this.container.clientHeight;\n\t\tthis._partWidth = this._editorWidth / (this._doc.song.beatsPerBar * Config.partsPerBeat);\n\t\tthis._pitchCount = this._doc.song.getChannelIsNoise(this._doc.channel) ? Config.drumCount : this._doc.getVisiblePitchCount();\n\t\tthis._pitchHeight = this._editorHeight / this._pitchCount;\n\t\tthis._octaveOffset = this._doc.getBaseVisibleOctave(this._doc.channel) * Config.pitchesPerOctave;\n\t\t\n\t\tif (this._renderedRhythm != this._doc.song.rhythm || \n\t\t\tthis._renderedPitchChannelCount != this._doc.song.pitchChannelCount || \n\t\t\tthis._renderedNoiseChannelCount != this._doc.song.noiseChannelCount)\n\t\t{\n\t\t\tthis._renderedRhythm = this._doc.song.rhythm;\n\t\t\tthis._renderedPitchChannelCount = this._doc.song.pitchChannelCount;\n\t\t\tthis._renderedNoiseChannelCount = this._doc.song.noiseChannelCount;\n\t\t\tthis.resetCopiedPins();\n\t\t}\n\t\t\n\t\tthis._copiedPins = this._copiedPinChannels[this._doc.channel];\n\t\t\n\t\tif (this._renderedWidth != this._editorWidth || this._renderedHeight != this._editorHeight) {\n\t\t\tthis._renderedWidth = this._editorWidth;\n\t\t\tthis._renderedHeight = this._editorHeight;\n\t\t\tthis._svgBackground.setAttribute(\"width\", \"\" + this._editorWidth);\n\t\t\tthis._svgBackground.setAttribute(\"height\", \"\" + this._editorHeight);\n\t\t\tthis._svgPlayhead.setAttribute(\"height\", \"\" + this._editorHeight);\n\t\t\tthis._selectionRect.setAttribute(\"y\", \"0\");\n\t\t\tthis._selectionRect.setAttribute(\"height\", \"\" + this._editorHeight);\n\t\t}\n\t\t\n\t\tconst beatWidth = this._editorWidth / this._doc.song.beatsPerBar;\n\t\tif (this._renderedBeatWidth != beatWidth || this._renderedPitchHeight != this._pitchHeight) {\n\t\t\tthis._renderedBeatWidth = beatWidth;\n\t\t\tthis._renderedPitchHeight = this._pitchHeight;\n\t\t\tthis._svgNoteBackground.setAttribute(\"width\", \"\" + beatWidth);\n\t\t\tthis._svgNoteBackground.setAttribute(\"height\", \"\" + (this._pitchHeight * Config.pitchesPerOctave));\n\t\t\tthis._svgDrumBackground.setAttribute(\"width\", \"\" + beatWidth);\n\t\t\tthis._svgDrumBackground.setAttribute(\"height\", \"\" + this._pitchHeight);\n\t\t\tthis._backgroundDrumRow.setAttribute(\"width\", \"\" + (beatWidth - 2));\n\t\t\tthis._backgroundDrumRow.setAttribute(\"height\", \"\" + (this._pitchHeight - 2));\n\t\t\tfor (let j: number = 0; j < Config.pitchesPerOctave; j++) {\n\t\t\t\tconst rectangle: SVGRectElement = this._backgroundPitchRows[j];\n\t\t\t\tconst y: number = (Config.pitchesPerOctave - j) % Config.pitchesPerOctave;\n\t\t\t\trectangle.setAttribute(\"width\", \"\" + (beatWidth - 2));\n\t\t\t\trectangle.setAttribute(\"y\", \"\" + (y * this._pitchHeight + 1));\n\t\t\t\trectangle.setAttribute(\"height\", \"\" + (this._pitchHeight - 2));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._svgNoteContainer = makeEmptyReplacementElement(this._svgNoteContainer);\n\t\t\n\t\tif (this._interactive) {\n\t\t\tif (!this._mouseDown) this._updateCursorStatus();\n\t\t\tthis._updatePreview();\n\t\t\tthis._updateSelection();\n\t\t}\n\t\t\n\t\tif (this._renderedFifths != this._doc.showFifth) {\n\t\t\tthis._renderedFifths = this._doc.showFifth;\n\t\t\tthis._backgroundPitchRows[7].setAttribute(\"fill\", this._doc.showFifth ? ColorConfig.fifthNote : ColorConfig.pitchBackground);\n\t\t}\n\t\t\n\t\tfor (let j: number = 0; j < Config.pitchesPerOctave; j++) {\n\t\t\tthis._backgroundPitchRows[j].style.visibility = Config.scales[this._doc.song.scale].flags[j] ? \"visible\" : \"hidden\";\n\t\t}\n\t\t\n\t\tif (this._doc.song.getChannelIsNoise(this._doc.channel)) {\n\t\t\tif (!this._renderedDrums) {\n\t\t\t\tthis._renderedDrums = true;\n\t\t\t\tthis._svgBackground.setAttribute(\"fill\", \"url(#patternEditorDrumBackground\" + this._barOffset + \")\");\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._renderedDrums) {\n\t\t\t\tthis._renderedDrums = false;\n\t\t\t\tthis._svgBackground.setAttribute(\"fill\", \"url(#patternEditorNoteBackground\" + this._barOffset + \")\");\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._doc.showChannels) {\n\t\t\tfor (let channel: number = this._doc.song.getChannelCount() - 1; channel >= 0; channel--) {\n\t\t\t\tif (channel == this._doc.channel) continue;\n\t\t\t\tif (this._doc.song.getChannelIsNoise(channel) != this._doc.song.getChannelIsNoise(this._doc.channel)) continue;\n\t\t\t\t\n\t\t\t\tconst pattern2: Pattern | null = this._doc.song.getPattern(channel, this._doc.bar + this._barOffset);\n\t\t\t\tif (pattern2 == null) continue;\n\t\t\t\t\n\t\t\t\tconst octaveOffset: number = this._doc.getBaseVisibleOctave(channel) * Config.pitchesPerOctave;\n\t\t\t\tfor (const note of pattern2.notes) {\n\t\t\t\t\tfor (const pitch of note.pitches) {\n\t\t\t\t\t\tconst notePath: SVGPathElement = SVG.path();\n\t\t\t\t\t\tnotePath.setAttribute(\"fill\", ColorConfig.getChannelColor(this._doc.song, channel).secondaryNote);\n\t\t\t\t\t\tnotePath.setAttribute(\"pointer-events\", \"none\");\n\t\t\t\t\t\tthis._drawNote(notePath, pitch, note.start, note.pins, this._pitchHeight * 0.19, false, octaveOffset);\n\t\t\t\t\t\tthis._svgNoteContainer.appendChild(notePath);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._pattern != null) {\n\t\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\t\tconst chord: Chord = instrument.getChord();\n\t\t\tconst transition: Transition = instrument.getTransition();\n\t\t\tconst displayNumberedChords: boolean = chord.customInterval || chord.arpeggiates || chord.strumParts > 0 || transition.slides;\n\t\t\tfor (const note of this._pattern.notes) {\n\t\t\t\tfor (let i: number = 0; i < note.pitches.length; i++) {\n\t\t\t\t\tconst pitch: number = note.pitches[i];\n\t\t\t\t\tlet notePath: SVGPathElement = SVG.path();\n\t\t\t\t\tnotePath.setAttribute(\"fill\", ColorConfig.getChannelColor(this._doc.song, this._doc.channel).secondaryNote);\n\t\t\t\t\tnotePath.setAttribute(\"pointer-events\", \"none\");\n\t\t\t\t\tthis._drawNote(notePath, pitch, note.start, note.pins, this._pitchHeight / 2 + 1, false, this._octaveOffset);\n\t\t\t\t\tthis._svgNoteContainer.appendChild(notePath);\n\t\t\t\t\tnotePath = SVG.path();\n\t\t\t\t\tnotePath.setAttribute(\"fill\", ColorConfig.getChannelColor(this._doc.song, this._doc.channel).primaryNote);\n\t\t\t\t\tnotePath.setAttribute(\"pointer-events\", \"none\");\n\t\t\t\t\tthis._drawNote(notePath, pitch, note.start, note.pins, this._pitchHeight / 2 + 1, true, this._octaveOffset);\n\t\t\t\t\tthis._svgNoteContainer.appendChild(notePath);\n\t\t\t\t\t\n\t\t\t\t\tlet indicatorOffset: number = 2;\n\t\t\t\t\tif (note.continuesLastPattern) {\n\t\t\t\t\t\tconst arrowHeight: number = Math.min(this._pitchHeight, 20);\n\t\t\t\t\t\tlet arrowPath: string;\n\t\t\t\t\t\tarrowPath  = \"M \" + prettyNumber(this._partWidth * note.start + indicatorOffset)      + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset) - 0.1 * arrowHeight);\n\t\t\t\t\t\tarrowPath += \"L \" + prettyNumber(this._partWidth * note.start + indicatorOffset)      + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset) + 0.1 * arrowHeight);\n\t\t\t\t\t\tarrowPath += \"L \" + prettyNumber(this._partWidth * note.start + indicatorOffset + 4)  + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset) + 0.1 * arrowHeight);\n\t\t\t\t\t\tarrowPath += \"L \" + prettyNumber(this._partWidth * note.start + indicatorOffset + 4)  + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset) + 0.3 * arrowHeight);\n\t\t\t\t\t\tarrowPath += \"L \" + prettyNumber(this._partWidth * note.start + indicatorOffset + 12) + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset));\n\t\t\t\t\t\tarrowPath += \"L \" + prettyNumber(this._partWidth * note.start + indicatorOffset + 4)  + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset) - 0.3 * arrowHeight);\n\t\t\t\t\t\tarrowPath += \"L \" + prettyNumber(this._partWidth * note.start + indicatorOffset + 4)  + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset) - 0.1 * arrowHeight);\n\t\t\t\t\t\tconst arrow: SVGPathElement = SVG.path();\n\t\t\t\t\t\tarrow.setAttribute(\"d\", arrowPath);\n\t\t\t\t\t\tarrow.setAttribute(\"fill\", ColorConfig.invertedText);\n\t\t\t\t\t\tthis._svgNoteContainer.appendChild(arrow);\n\t\t\t\t\t\tindicatorOffset += 12;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (note.pitches.length > 1) {\n\t\t\t\t\t\tif (displayNumberedChords) {\n\t\t\t\t\t\t\tconst oscillatorLabel: SVGTextElement = SVG.text();\n\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"x\", \"\" + prettyNumber(this._partWidth * note.start + indicatorOffset));\n\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"y\", \"\" + prettyNumber(this._pitchToPixelHeight(pitch - this._octaveOffset)));\n\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"width\", \"30\");\n\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"fill\", ColorConfig.invertedText);\n\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"text-anchor\", \"start\");\n\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"dominant-baseline\", \"central\");\n\t\t\t\t\t\t\toscillatorLabel.setAttribute(\"pointer-events\", \"none\");\n\t\t\t\t\t\t\toscillatorLabel.textContent = \"\" + (i + 1);\n\t\t\t\t\t\t\tthis._svgNoteContainer.appendChild(oscillatorLabel);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate _drawNote(svgElement: SVGPathElement, pitch: number, start: number, pins: NotePin[], radius: number, showSize: boolean, offset: number): void {\n\t\tconst totalWidth: number = this._partWidth * (pins[pins.length - 1].time + pins[0].time);\n\t\tconst endOffset: number = 0.5 * Math.min(2, totalWidth - 1);\n\t\t\n\t\tlet nextPin: NotePin = pins[0];\n\t\t\n\t\tlet pathString: string = \"M \" + prettyNumber(this._partWidth * (start + nextPin.time) + endOffset) + \" \" + prettyNumber(this._pitchToPixelHeight(pitch - offset) + radius * (showSize ? nextPin.size / Config.noteSizeMax : 1.0)) + \" \";\n\t\tfor (let i: number = 1; i < pins.length; i++) {\n\t\t\tlet prevPin: NotePin = nextPin;\n\t\t\tnextPin = pins[i];\n\t\t\tlet prevSide: number = this._partWidth * (start + prevPin.time) + (i == 1 ? endOffset : 0);\n\t\t\tlet nextSide: number = this._partWidth * (start + nextPin.time) - (i == pins.length - 1 ? endOffset : 0);\n\t\t\tlet prevHeight: number = this._pitchToPixelHeight(pitch + prevPin.interval - offset);\n\t\t\tlet nextHeight: number = this._pitchToPixelHeight(pitch + nextPin.interval - offset);\n\t\t\tlet prevSize: number = showSize ? prevPin.size / Config.noteSizeMax : 1.0;\n\t\t\tlet nextSize: number = showSize ? nextPin.size / Config.noteSizeMax : 1.0;\n\t\t\tpathString += \"L \" + prettyNumber(prevSide) + \" \" + prettyNumber(prevHeight - radius * prevSize) + \" \";\n\t\t\tif (prevPin.interval > nextPin.interval) pathString += \"L \" + prettyNumber(prevSide + 1) + \" \" + prettyNumber(prevHeight - radius * prevSize) + \" \";\n\t\t\tif (prevPin.interval < nextPin.interval) pathString += \"L \" + prettyNumber(nextSide - 1) + \" \" + prettyNumber(nextHeight - radius * nextSize) + \" \";\n\t\t\tpathString += \"L \" + prettyNumber(nextSide) + \" \" + prettyNumber(nextHeight - radius * nextSize) + \" \";\n\t\t}\n\t\tfor (let i: number = pins.length - 2; i >= 0; i--) {\n\t\t\tlet prevPin: NotePin = nextPin;\n\t\t\tnextPin = pins[i];\n\t\t\tlet prevSide: number = this._partWidth * (start + prevPin.time) - (i == pins.length - 2 ? endOffset : 0);\n\t\t\tlet nextSide: number = this._partWidth * (start + nextPin.time) + (i == 0 ? endOffset : 0);\n\t\t\tlet prevHeight: number = this._pitchToPixelHeight(pitch + prevPin.interval - offset);\n\t\t\tlet nextHeight: number = this._pitchToPixelHeight(pitch + nextPin.interval - offset);\n\t\t\tlet prevSize: number = showSize ? prevPin.size / Config.noteSizeMax : 1.0;\n\t\t\tlet nextSize: number = showSize ? nextPin.size / Config.noteSizeMax : 1.0;\n\t\t\tpathString += \"L \" + prettyNumber(prevSide) + \" \" + prettyNumber(prevHeight + radius * prevSize) + \" \";\n\t\t\tif (prevPin.interval < nextPin.interval) pathString += \"L \" + prettyNumber(prevSide - 1) + \" \" + prettyNumber(prevHeight + radius * prevSize) + \" \";\n\t\t\tif (prevPin.interval > nextPin.interval) pathString += \"L \" + prettyNumber(nextSide + 1) + \" \" + prettyNumber(nextHeight + radius * nextSize) + \" \";\n\t\t\tpathString += \"L \" + prettyNumber(nextSide) + \" \" + prettyNumber(nextHeight + radius * nextSize) + \" \";\n\t\t}\n\t\tpathString += \"z\";\n\t\t\n\t\tsvgElement.setAttribute(\"d\", pathString);\n\t}\n\t\n\tprivate _pitchToPixelHeight(pitch: number): number {\n\t\treturn this._pitchHeight * (this._pitchCount - (pitch) - 0.5);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {InstrumentType, Config} from \"../synth/SynthConfig\";\nimport {Instrument} from \"../synth/synth\";\nimport {SongDocument} from \"./SongDocument\";\nimport {ChangeSetEnvelopeTarget, ChangeSetEnvelopeType, ChangeRemoveEnvelope} from \"./changes\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\n\nexport class EnvelopeEditor {\n\tpublic readonly container: HTMLElement = HTML.div({class: \"envelopeEditor\"});\n\t\n\tprivate readonly _rows: HTMLDivElement[] = [];\n\tprivate readonly _targetSelects: HTMLSelectElement[] = [];\n\tprivate readonly _envelopeSelects: HTMLSelectElement[] = [];\n\tprivate readonly _deleteButtons: HTMLButtonElement[] = [];\n\tprivate _renderedEnvelopeCount: number = 0;\n\tprivate _renderedEqFilterCount: number = -1;\n\tprivate _renderedNoteFilterCount: number = -1;\n\tprivate _renderedInstrumentType: InstrumentType;\n\tprivate _renderedEffects: number = 0;\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis.container.addEventListener(\"change\", this._onChange);\n\t\tthis.container.addEventListener(\"click\", this._onClick);\n\t}\n\t\n\tprivate _onChange = (event: Event): void => {\n\t\tconst targetSelectIndex: number = this._targetSelects.indexOf(<any> event.target);\n\t\tconst envelopeSelectIndex: number = this._envelopeSelects.indexOf(<any> event.target);\n\t\tif (targetSelectIndex != -1) {\n\t\t\tconst combinedValue: number = parseInt(this._targetSelects[targetSelectIndex].value);\n\t\t\tconst target: number = combinedValue % Config.instrumentAutomationTargets.length;\n\t\t\tconst index: number = (combinedValue / Config.instrumentAutomationTargets.length) >>> 0;\n\t\t\tthis._doc.record(new ChangeSetEnvelopeTarget(this._doc, targetSelectIndex, target, index));\n\t\t} else if (envelopeSelectIndex != -1) {\n\t\t\tthis._doc.record(new ChangeSetEnvelopeType(this._doc, envelopeSelectIndex, this._envelopeSelects[envelopeSelectIndex].selectedIndex));\n\t\t}\n\t}\n\t\n\tprivate _onClick = (event: MouseEvent): void => {\n\t\tconst index: number = this._deleteButtons.indexOf(<any> event.target);\n\t\tif (index != -1) {\n\t\t\tthis._doc.record(new ChangeRemoveEnvelope(this._doc, index));\n\t\t}\n\t}\n\t\n\tprivate _makeOption(target: number, index: number): HTMLOptionElement {\n\t\tlet displayName = Config.instrumentAutomationTargets[target].displayName;\n\t\tif (Config.instrumentAutomationTargets[target].maxCount > 1) {\n\t\t\tif (displayName.indexOf(\"#\") != -1) {\n\t\t\t\tdisplayName = displayName.replace(\"#\", String(index+1));\n\t\t\t} else {\n\t\t\t\tdisplayName += \" \" + (index+1);\n\t\t\t}\n\t\t}\n\t\treturn HTML.option({value: target + index * Config.instrumentAutomationTargets.length}, displayName);\n\t}\n\t\n\tprivate _updateTargetOptionVisibility(menu: HTMLSelectElement, instrument: Instrument): void {\n\t\tfor (let optionIndex: number = 0; optionIndex < menu.childElementCount; optionIndex++) {\n\t\t\tconst option: HTMLOptionElement = <HTMLOptionElement> menu.children[optionIndex];\n\t\t\tconst combinedValue: number = parseInt(option.value);\n\t\t\tconst target: number = combinedValue % Config.instrumentAutomationTargets.length;\n\t\t\tconst index: number = (combinedValue / Config.instrumentAutomationTargets.length) >>> 0;\n\t\t\toption.hidden = !instrument.supportsEnvelopeTarget(target, index);\n\t\t}\n\t}\n\t\n\tpublic render(): void {\n\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tif (!this._doc.alwaysShowSettings && instrument.preset != instrument.type) return;\n\t\t\n\t\tfor (let envelopeIndex: number = this._rows.length; envelopeIndex < instrument.envelopeCount; envelopeIndex++) {\n\t\t\tconst targetSelect: HTMLSelectElement = HTML.select();\n\t\t\tfor (let target: number = 0; target < Config.instrumentAutomationTargets.length; target++) {\n\t\t\t\tconst interleaved: boolean = (Config.instrumentAutomationTargets[target].interleave);\n\t\t\t\tfor (let index: number = 0; index < Config.instrumentAutomationTargets[target].maxCount; index++) {\n\t\t\t\t\ttargetSelect.appendChild(this._makeOption(target, index));\n\t\t\t\t\tif (interleaved) {\n\t\t\t\t\t\ttargetSelect.appendChild(this._makeOption(target + 1, index));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (interleaved) target++;\n\t\t\t}\n\t\t\t\n\t\t\tconst envelopeSelect: HTMLSelectElement = HTML.select();\n\t\t\tfor (let envelope: number = 0; envelope < Config.envelopes.length; envelope++) {\n\t\t\t\tenvelopeSelect.appendChild(HTML.option({value: envelope}, Config.envelopes[envelope].name));\n\t\t\t} \n\t\t\t\n\t\t\tconst deleteButton: HTMLButtonElement = HTML.button({type: \"button\", class: \"delete-envelope\"});\n\t\t\t\n\t\t\tconst row: HTMLDivElement = HTML.div({class: \"envelope-row\"},\n\t\t\t\tHTML.div({class: \"selectContainer\", style: \"width: 0; flex: 1;\"}, targetSelect),\n\t\t\t\tHTML.div({class: \"selectContainer\", style: \"width: 0; flex: 0.7;\"}, envelopeSelect),\n\t\t\t\tdeleteButton,\n\t\t\t);\n\t\t\t\n\t\t\tthis.container.appendChild(row);\n\t\t\tthis._rows[envelopeIndex] = row;\n\t\t\tthis._targetSelects[envelopeIndex] = targetSelect;\n\t\t\tthis._envelopeSelects[envelopeIndex] = envelopeSelect;\n\t\t\tthis._deleteButtons[envelopeIndex] = deleteButton;\n\t\t}\n\t\t\n\t\tfor (let envelopeIndex: number = this._renderedEnvelopeCount; envelopeIndex < instrument.envelopeCount; envelopeIndex++) {\n\t\t\tthis._rows[envelopeIndex].style.display = \"\";\n\t\t\t// For newly visible rows, update target option visibiliy.\n\t\t\tthis._updateTargetOptionVisibility(this._targetSelects[envelopeIndex], instrument);\n\t\t}\n\t\t\n\t\tfor (let envelopeIndex: number = instrument.envelopeCount; envelopeIndex < this._renderedEnvelopeCount; envelopeIndex++) {\n\t\t\tthis._rows[envelopeIndex].style.display = \"none\";\n\t\t}\n\t\t\n\t\tif (this._renderedEqFilterCount != instrument.eqFilter.controlPointCount ||\n\t\t\tthis._renderedNoteFilterCount != instrument.noteFilter.controlPointCount ||\n\t\t\tthis._renderedInstrumentType != instrument.type ||\n\t\t\tthis._renderedEffects != instrument.effects)\n\t\t{\n\t\t\t// Update target option visibility for previously visible rows.\n\t\t\tfor (let envelopeIndex: number = 0; envelopeIndex < this._renderedEnvelopeCount; envelopeIndex++) {\n\t\t\t\tthis._updateTargetOptionVisibility(this._targetSelects[envelopeIndex], instrument);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (let envelopeIndex: number = 0; envelopeIndex < instrument.envelopeCount; envelopeIndex++) {\n\t\t\tthis._targetSelects[envelopeIndex].value = String(instrument.envelopes[envelopeIndex].target + instrument.envelopes[envelopeIndex].index * Config.instrumentAutomationTargets.length);\n\t\t\tthis._envelopeSelects[envelopeIndex].selectedIndex = instrument.envelopes[envelopeIndex].envelope;\n\t\t}\n\t\t\n\t\tthis._renderedEnvelopeCount = instrument.envelopeCount;\n\t\tthis._renderedEqFilterCount = instrument.eqFilter.controlPointCount;\n\t\tthis._renderedNoteFilterCount = instrument.noteFilter.controlPointCount;\n\t\tthis._renderedInstrumentType = instrument.type;\n\t\tthis._renderedEffects = instrument.effects;\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {clamp, Instrument, Synth} from \"../synth/synth\";\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\nimport {ColorConfig} from \"./ColorConfig\";\nimport {ChangeSequence, UndoableChange} from \"./Change\";\nimport {ChangeFadeInOut} from \"./changes\";\n\nexport class FadeInOutEditor {\n\tprivate readonly _editorWidth: number = 120;\n\tprivate readonly _editorHeight: number = 26;\n\tprivate readonly _fadeCurve: SVGPathElement = SVG.path({fill: ColorConfig.uiWidgetBackground, \"pointer-events\": \"none\"});\n\tprivate readonly _dottedLinePath: SVGPathElement = SVG.path({fill: \"none\", stroke: \"currentColor\", \"stroke-width\": 1, \"stroke-dasharray\": \"3, 2\", \"pointer-events\": \"none\"});\n\tprivate readonly _controlCurve: SVGPathElement = SVG.path({fill: \"none\", stroke: \"currentColor\", \"stroke-width\": 2, \"pointer-events\": \"none\"});\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `background-color: ${ColorConfig.editorBackground}; touch-action: none; cursor: crosshair;`, width: \"100%\", height: \"100%\", viewBox: \"0 0 \"+this._editorWidth+\" \"+this._editorHeight, preserveAspectRatio: \"none\"},\n\t\tthis._fadeCurve,\n\t\tthis._dottedLinePath,\n\t\tthis._controlCurve,\n\t);\n\tpublic readonly container: HTMLElement = HTML.div({class: \"fadeInOut\", style: \"height: 100%;\"}, this._svg);\n\t\n\tprivate _mouseX: number = 0;\n\tprivate _mouseXStart: number = 0;\n\tprivate _mouseDown: boolean = false;\n\tprivate _mouseDragging: boolean = false;\n\tprivate _draggingFadeIn: boolean = false;\n\tprivate _dragChange: UndoableChange | null = null;\n\tprivate _renderedFadeIn: number = -1;\n\tprivate _renderedFadeOut: number = -1;\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tconst dottedLineX: number = this._fadeOutToX(Config.fadeOutNeutral);\n\t\tthis._dottedLinePath.setAttribute(\"d\", `M ${dottedLineX} 0 L ${dottedLineX} ${this._editorHeight}`);\n\t\t\n\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\tthis.container.addEventListener(\"touchend\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"touchcancel\", this._whenCursorReleased);\n\t}\n\t\n\tprivate _fadeInToX(fadeIn: number) {\n\t\treturn 1.0 + (this._editorWidth - 2.0) * 0.4 * fadeIn / (Config.fadeInRange - 1);\n\t}\n\tprivate _xToFadeIn(x: number) {\n\t\treturn clamp(0, Config.fadeInRange, Math.round((x - 1.0) * (Config.fadeInRange - 1) / (0.4 * this._editorWidth - 2.0)));\n\t}\n\tprivate _fadeOutToX(fadeOut: number) {\n\t\treturn 1.0 + (this._editorWidth - 2.0) * (0.5 + 0.5 * fadeOut / (Config.fadeOutTicks.length - 1));\n\t}\n\tprivate _xToFadeOut(x: number) {\n\t\treturn clamp(0, Config.fadeOutTicks.length, Math.round((Config.fadeOutTicks.length - 1) * ((x - 1.0) / (this._editorWidth - 2.0) - 0.5) / 0.5));\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left);\n\t\tthis._whenCursorPressed();\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left);\n\t\tthis._whenCursorPressed();\n\t}\n\t\n\tprivate _whenCursorPressed(): void {\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tthis._mouseXStart = this._mouseX;\n\t\tthis._mouseDown = true;\n\t\tthis._mouseDragging = false;\n\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tconst fadeInX: number = this._fadeInToX(instrument.fadeIn);\n\t\tconst fadeOutX: number = this._fadeOutToX(instrument.fadeOut);\n\t\tthis._draggingFadeIn = this._mouseXStart < (fadeInX + fadeOutX) / 2.0;\n\t\tthis._dragChange = new ChangeSequence();\n\t\tthis._doc.setProspectiveChange(this._dragChange);\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tif (!this._mouseDown) return;\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenCursorMoved(): void {\n\t\tif (this._dragChange != null && this._doc.lastChangeWas(this._dragChange)) {\n\t\t\tthis._dragChange.undo();\n\t\t} else {\n\t\t\tthis._mouseDown = false;\n\t\t}\n\t\tthis._dragChange = null;\n\t\t\n\t\tif (this._mouseDown) {\n\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\n\t\t\tthis._dragChange = sequence;\n\t\t\tthis._doc.setProspectiveChange(this._dragChange);\n\t\t\t\n\t\t\tif (Math.abs(this._mouseX - this._mouseXStart) > 4.0) {\n\t\t\t\tthis._mouseDragging = true;\n\t\t\t}\n\t\t\t\n\t\t\tif (this._mouseDragging) {\n\t\t\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\t\t\tif (this._draggingFadeIn) {\n\t\t\t\t\tsequence.append(new ChangeFadeInOut(this._doc, this._xToFadeIn(this._fadeInToX(instrument.fadeIn) + this._mouseX - this._mouseXStart), instrument.fadeOut));\n\t\t\t\t} else {\n\t\t\t\t\tsequence.append(new ChangeFadeInOut(this._doc, instrument.fadeIn, this._xToFadeOut(this._fadeOutToX(instrument.fadeOut) + this._mouseX - this._mouseXStart)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate _whenCursorReleased = (event: Event): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tif (this._mouseDown && this._doc.lastChangeWas(this._dragChange) && this._dragChange != null) {\n\t\t\tif (!this._mouseDragging) {\n\t\t\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\t\t\tif (this._draggingFadeIn) {\n\t\t\t\t\tthis._doc.record(new ChangeFadeInOut(this._doc, this._xToFadeIn(this._mouseX), instrument.fadeOut));\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.record(new ChangeFadeInOut(this._doc, instrument.fadeIn, this._xToFadeOut(this._mouseX)));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._doc.record(this._dragChange);\n\t\t\t}\n\t\t}\n\t\tthis._dragChange = null;\n\t\tthis._mouseDragging = false;\n\t\tthis._mouseDown = false;\n\t}\n\t\n\tpublic render(): void {\n\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\t\n\t\tif (this._renderedFadeIn == instrument.fadeIn && this._renderedFadeOut == instrument.fadeOut) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tconst fadeInX: number = this._fadeInToX(instrument.fadeIn);\n\t\tconst fadeOutX: number = this._fadeOutToX(instrument.fadeOut);\n\t\tthis._controlCurve.setAttribute(\"d\", `M ${fadeInX} 0 L ${fadeInX} ${this._editorHeight} M ${fadeOutX} 0 L ${fadeOutX} ${this._editorHeight}`);\n\t\t\n\t\tconst dottedLineX: number = this._fadeOutToX(Config.fadeOutNeutral);\n\t\tlet fadePath: string = \"\";\n\t\tfadePath += `M 0 ${this._editorHeight} `;\n\t\tfadePath += `L ${fadeInX} 0 `;\n\t\tif (Synth.fadeOutSettingToTicks(instrument.fadeOut) > 0) {\n\t\t\tfadePath += `L ${dottedLineX} 0 `;\n\t\t\tfadePath += `L ${fadeOutX} ${this._editorHeight} `;\n\t\t} else {\n\t\t\tfadePath += `L ${fadeOutX} 0 `;\n\t\t\tfadePath += `L ${dottedLineX} ${this._editorHeight} `;\n\t\t}\n\t\tfadePath += \"z\";\n\t\tthis._fadeCurve.setAttribute(\"d\", fadePath);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {FilterCoefficients, FrequencyResponse} from \"../synth/filtering\";\nimport {FilterType, Config} from \"../synth/SynthConfig\";\nimport {FilterSettings, FilterControlPoint, Instrument} from \"../synth/synth\";\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\nimport {ColorConfig} from \"./ColorConfig\";\nimport {ChangeSequence, UndoableChange} from \"./Change\";\nimport {ChangeFilterAddPoint, ChangeFilterMovePoint} from \"./changes\";\nimport {prettyNumber} from \"./EditorConfig\";\n\nexport class FilterEditor {\n\tprivate readonly _editorWidth: number = 120;\n\tprivate readonly _editorHeight: number = 26;\n\tprivate readonly _responsePath: SVGPathElement = SVG.path({fill: ColorConfig.uiWidgetBackground, \"pointer-events\": \"none\"});\n\t//private readonly _octaves: SVGSVGElement = SVG.svg({\"pointer-events\": \"none\", overflow: \"visible\"});\n\tprivate readonly _controlPointPath: SVGPathElement = SVG.path({fill: \"currentColor\", \"pointer-events\": \"none\"});\n\tprivate readonly _dottedLinePath: SVGPathElement = SVG.path({fill: \"none\", stroke: \"currentColor\", \"stroke-width\": 1, \"stroke-dasharray\": \"3, 2\", \"pointer-events\": \"none\"});\n\tprivate readonly _highlight: SVGCircleElement = SVG.circle({fill: \"white\", stroke: \"none\", \"pointer-events\": \"none\", r: 4});\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `background-color: ${ColorConfig.editorBackground}; touch-action: none;`, width: \"100%\", height: \"100%\", viewBox: \"0 0 \"+this._editorWidth+\" \"+this._editorHeight, preserveAspectRatio: \"none\"},\n\t\tthis._responsePath,\n\t\t//this._octaves,\n\t\tthis._dottedLinePath,\n\t\tthis._highlight,\n\t\tthis._controlPointPath,\n\t);\n\tprivate readonly _label: HTMLDivElement = HTML.div({style: \"position: absolute; bottom: 0; left: 2px; font-size: 8px; line-height: 1; pointer-events: none;\"});\n\t\n\tpublic readonly container: HTMLElement = HTML.div({class: \"filterEditor\", style: \"height: 100%; position: relative;\"},\n\t\tthis._svg,\n\t\tthis._label,\n\t);\n\tprivate readonly _pointRadius: number = 2;\n\t\n\tprivate _useNoteFilter: boolean = false;\n\tprivate _touchMode: boolean = false;\n\tprivate _mouseX: number = 0;\n\tprivate _mouseY: number = 0;\n\tprivate _mouseOver: boolean = false;\n\tprivate _mouseDown: boolean = false;\n\tprivate _mouseDragging: boolean = false;\n\tprivate _addingPoint: boolean = false;\n\tprivate _deletingPoint: boolean = false;\n\tprivate _addedType: FilterType = FilterType.peak;\n\tprivate _selectedIndex: number = 0;\n\tprivate _freqStart: number = 0;\n\tprivate _gainStart: number = 0;\n\tprivate _dragChange: UndoableChange | null = null;\n\t\n\tprivate _filterSettings: FilterSettings;\n\tprivate _renderedSelectedIndex: number = -1;\n\tprivate _renderedPointCount: number = -1;\n\tprivate _renderedPointTypes: number = -1;\n\tprivate _renderedPointFreqs: number = -1;\n\tprivate _renderedPointGains: number = -1;\n\t//private _renderedKey: number = -1;\n\t\n\tconstructor(private _doc: SongDocument, useNoteFilter: boolean = false) {\n\t\tthis._useNoteFilter = useNoteFilter;\n\t\t/*\n\t\tfor (let i: number = 0; i < Config.filterFreqRange * Config.filterFreqStep; i++) {\n\t\t\tthis._octaves.appendChild(SVG.rect({fill: ColorConfig.tonic, x: i * this._editorWidth / (Config.filterFreqRange * Config.filterFreqStep) - 0.5, y: 0, width: 1, height: this._editorHeight}));\n\t\t}\n\t\t*/\n\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\n\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\n\t\t\n\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\tthis.container.addEventListener(\"touchend\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"touchcancel\", this._whenCursorReleased);\n\t}\n\t\n\tprivate _xToFreq(x: number): number {\n\t\treturn Config.filterFreqRange * x / this._editorWidth - 0.5;\n\t}\n\tprivate _freqToX(freq: number): number {\n\t\treturn this._editorWidth * (freq + 0.5) / Config.filterFreqRange;\n\t}\n\tprivate _yToGain(y: number): number {\n\t\treturn (Config.filterGainRange - 1) * (1 - (y - .5) / (this._editorHeight - 1));\n\t}\n\tprivate _gainToY(gain: number): number {\n\t\treturn (this._editorHeight - 1) * (1 - gain / (Config.filterGainRange - 1)) + .5;\n\t}\n\t\n\tprivate _whenMouseOver = (event: MouseEvent): void => {\n\t\tthis._mouseOver = true;\n\t}\n\t\n\tprivate _whenMouseOut = (event: MouseEvent): void => {\n\t\tthis._mouseOver = false;\n\t\tthis._updatePath();\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._touchMode = false;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorPressed();\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._touchMode = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorPressed();\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tif (!this._mouseDown) this._updateCursor();\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tif (this._mouseDown) event.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tif (!this._mouseDown) this._updateCursor();\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenCursorPressed(): void {\n\t\tthis._mouseDown = true;\n\t\tconst sequence: ChangeSequence = new ChangeSequence();\n\t\tthis._dragChange = sequence;\n\t\tthis._doc.setProspectiveChange(this._dragChange);\n\t\tthis._updateCursor();\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _updateCursor(): void {\n\t\tthis._freqStart = this._xToFreq(this._mouseX);\n\t\tthis._gainStart = this._yToGain(this._mouseY);\n\t\t\n\t\tthis._addingPoint = true;\n\t\tthis._selectedIndex = -1;\n\t\tlet nearestDistance: number = Number.POSITIVE_INFINITY;\n\t\tfor (let i: number = 0; i < this._filterSettings.controlPointCount; i++) {\n\t\t\tconst point: FilterControlPoint = this._filterSettings.controlPoints[i];\n\t\t\tconst distance: number = Math.sqrt(Math.pow(this._freqToX(point.freq) - this._mouseX, 2) + Math.pow(this._gainToY(point.gain) - this._mouseY, 2));\n\t\t\tif ((distance <= 13 || this._filterSettings.controlPointCount >= Config.filterMaxPoints) && distance < nearestDistance) {\n\t\t\t\tnearestDistance = distance;\n\t\t\t\tthis._selectedIndex = i;\n\t\t\t\tthis._addingPoint = false;\n\t\t\t}\n\t\t}\n\t\tif (this._addingPoint) {\n\t\t\tconst ratio: number = this._mouseX / this._editorWidth;\n\t\t\tif (ratio < 0.2) {\n\t\t\t\tthis._addedType = FilterType.highPass;\n\t\t\t} else if (ratio < 0.8) {\n\t\t\t\tthis._addedType = FilterType.peak;\n\t\t\t} else {\n\t\t\t\tthis._addedType = FilterType.lowPass;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate _whenCursorMoved(): void {\n\t\tif (this._dragChange != null && this._doc.lastChangeWas(this._dragChange)) {\n\t\t\tthis._dragChange.undo();\n\t\t} else {\n\t\t\tthis._mouseDown = false;\n\t\t}\n\t\tthis._dragChange = null;\n\t\tthis._deletingPoint = false;\n\t\t\n\t\tif (this._mouseDown) {\n\t\t\tconst sequence: ChangeSequence = new ChangeSequence();\n\t\t\tthis._dragChange = sequence;\n\t\t\tthis._doc.setProspectiveChange(this._dragChange);\n\t\t\t\n\t\t\tif (this._addingPoint) {\n\t\t\t\tconst gain: number = Math.max(0, Math.min(Config.filterGainRange - 1, Math.round(this._yToGain(this._mouseY))));\n\t\t\t\tconst freq: number = this._findNearestFreqSlot(this._filterSettings, this._xToFreq(this._mouseX), -1);\n\t\t\t\tif (freq >= 0 && freq < Config.filterFreqRange) {\n\t\t\t\t\tconst point: FilterControlPoint = new FilterControlPoint();\n\t\t\t\t\tpoint.type = this._addedType;\n\t\t\t\t\tpoint.freq = freq;\n\t\t\t\t\tpoint.gain = gain;\n\t\t\t\t\tsequence.append(new ChangeFilterAddPoint(this._doc, this._filterSettings, point, this._filterSettings.controlPointCount, this._useNoteFilter));\n\t\t\t\t} else {\n\t\t\t\t\tthis._deletingPoint = true;\n\t\t\t\t}\n\t\t\t} else if (this._selectedIndex >= this._filterSettings.controlPointCount || this._selectedIndex == -1) {\n\t\t\t\tthis._dragChange = null;\n\t\t\t\tthis._mouseDown = false;\n\t\t\t} else {\n\t\t\t\tconst freqDelta: number = this._xToFreq(this._mouseX) - this._freqStart;\n\t\t\t\tconst gainDelta: number = this._yToGain(this._mouseY) - this._gainStart;\n\t\t\t\tconst point: FilterControlPoint = this._filterSettings.controlPoints[this._selectedIndex];\n\t\t\t\tconst gain: number = Math.max(0, Math.min(Config.filterGainRange - 1, Math.round(point.gain + gainDelta)));\n\t\t\t\tconst freq: number = this._findNearestFreqSlot(this._filterSettings, point.freq + freqDelta, this._selectedIndex);\n\t\t\t\t\n\t\t\t\tif (Math.round(freqDelta) != 0.0 || Math.round(gainDelta) != 0.0 || freq != point.freq || gain != point.gain) {\n\t\t\t\t\tthis._mouseDragging = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (freq >= 0 && freq < Config.filterFreqRange) {\n\t\t\t\t\tsequence.append(new ChangeFilterMovePoint(this._doc, point, point.freq, freq, point.gain, gain));\n\t\t\t\t} else {\n\t\t\t\t\tsequence.append(new ChangeFilterAddPoint(this._doc, this._filterSettings, point, this._selectedIndex, this._useNoteFilter, true));\n\t\t\t\t\tthis._deletingPoint = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this._mouseDown || this._mouseOver) {\n\t\t\tthis._updatePath();\n\t\t}\n\t}\n\t\n\tprivate _whenCursorReleased = (event: Event): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tif (this._mouseDown && this._doc.lastChangeWas(this._dragChange) && this._dragChange != null) {\n\t\t\tif (!this._addingPoint && !this._mouseDragging && !this._touchMode) {\n\t\t\t\tif (this._selectedIndex < this._filterSettings.controlPointCount && this._selectedIndex != -1) {\n\t\t\t\t\tconst point: FilterControlPoint = this._filterSettings.controlPoints[this._selectedIndex];\n\t\t\t\t\tthis._doc.record(new ChangeFilterAddPoint(this._doc, this._filterSettings, point, this._selectedIndex, this._useNoteFilter, true));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._doc.record(this._dragChange);\n\t\t\t}\n\t\t\tthis._updatePath();\n\t\t}\n\t\tthis._dragChange = null;\n\t\tthis._mouseDragging = false;\n\t\tthis._deletingPoint = false;\n\t\tthis._mouseDown = false;\n\t\tthis._updateCursor();\n\t}\n\t\n\tprivate _findNearestFreqSlot(filterSettings: FilterSettings, targetFreq: number, ignoreIndex: number): number {\n\t\tconst roundedFreq: number = Math.round(targetFreq);\n\t\tlet lowerFreq: number = roundedFreq;\n\t\tlet upperFreq: number = roundedFreq;\n\t\tlet tryingLower: boolean = (roundedFreq <= targetFreq);\n\t\twhile (true) {\n\t\t\tlet foundConflict: boolean = false;\n\t\t\tconst currentFreq: number = tryingLower ? lowerFreq : upperFreq;\n\t\t\tfor (let i: number = 0; i < filterSettings.controlPointCount; i++) {\n\t\t\t\tif (i == ignoreIndex) continue;\n\t\t\t\tif (filterSettings.controlPoints[i].freq == currentFreq) {\n\t\t\t\t\tfoundConflict = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!foundConflict) return currentFreq;\n\t\t\ttryingLower = !tryingLower;\n\t\t\tif (tryingLower) lowerFreq--;\n\t\t\tif (!tryingLower) upperFreq++;\n\t\t}\n\t}\n\t\n\tprivate static _circlePath(cx: number, cy: number, radius: number, reverse: boolean = false): string {\n\t\treturn `M ${cx - radius} ${cy} ` +\n\t\t\t`a ${radius} ${radius} 0 1 ${reverse?1:0} ${ radius * 2} 0 ` +\n\t\t\t`a ${radius} ${radius} 0 1 ${reverse?1:0} ${-radius * 2} 0 `;\n\t}\n\t\n\tprivate _updatePath(): void {\n\t\tthis._highlight.style.display = \"none\";\n\t\tthis._label.textContent = \"\";\n\t\t\n\t\tlet controlPointPath: string = \"\";\n\t\tlet dottedLinePath: string = \"\";\n\t\tfor (let i: number = 0; i < this._filterSettings.controlPointCount; i++) {\n\t\t\tconst point: FilterControlPoint = this._filterSettings.controlPoints[i];\n\t\t\tconst pointX: number = this._freqToX(point.freq);\n\t\t\tconst pointY: number = this._gainToY(point.gain);\n\t\t\t\n\t\t\tcontrolPointPath += FilterEditor._circlePath(pointX, pointY, this._pointRadius);\n\t\t\t\n\t\t\tif (point.type == FilterType.highPass) {\n\t\t\t\tdottedLinePath += \"M \" + 0 + \" \" + pointY + \" L \" + pointX + \" \" + pointY + \" \";\n\t\t\t} else if (point.type == FilterType.lowPass) {\n\t\t\t\tdottedLinePath += \"M \" + this._editorWidth + \" \" + pointY + \" L \" + pointX + \" \" + pointY + \" \";\n\t\t\t}\n\t\t\t\n\t\t\tif (this._selectedIndex == i && this._mouseOver && !this._mouseDown) {\n\t\t\t\tthis._highlight.setAttribute(\"cx\", String(pointX));\n\t\t\t\tthis._highlight.setAttribute(\"cy\", String(pointY));\n\t\t\t\tthis._highlight.style.display = \"\";\n\t\t\t}\n\t\t\tif ((this._selectedIndex == i || (this._addingPoint && this._mouseDown && i == this._filterSettings.controlPointCount - 1)) && (this._mouseOver || this._mouseDown) && !this._deletingPoint) {\n\t\t\t\tthis._label.textContent = (i + 1) + \": \" + Config.filterTypeNames[point.type];// + \" \" + prettyNumber(point.getHz()) + \"Hz\";\n\t\t\t}\n\t\t}\n\t\tthis._controlPointPath.setAttribute(\"d\", controlPointPath);\n\t\tthis._dottedLinePath.setAttribute(\"d\", dottedLinePath);\n\t\tif (this._addingPoint && !this._mouseDown && this._mouseOver) {\n\t\t\tthis._label.textContent = \"+ \" + Config.filterTypeNames[this._addedType];\n\t\t}\n\t\t\n\t\t//let volumeCompensation: number = 1.0;\n\t\tconst standardSampleRate: number = 44800;\n\t\tconst filters: FilterCoefficients[] = [];\n\t\tfor (let i: number = 0; i < this._filterSettings.controlPointCount; i++) {\n\t\t\tconst point: FilterControlPoint = this._filterSettings.controlPoints[i];\n\t\t\tconst filter: FilterCoefficients = new FilterCoefficients();\n\t\t\tpoint.toCoefficients(filter, standardSampleRate);\n\t\t\tfilters.push(filter);\n\t\t\t//volumeCompensation *= point.getVolumeCompensationMult();\n\t\t}\n\t\t\n\t\tconst response: FrequencyResponse = new FrequencyResponse();\n\t\tlet responsePath: string = \"M 0 \" + this._editorHeight + \" \";\n\t\tfor (let i: number = -1; i <= Config.filterFreqRange; i++) {\n\t\t\tconst hz: number = FilterControlPoint.getHzFromSettingValue(i);\n\t\t\tconst cornerRadiansPerSample: number = 2.0 * Math.PI * hz / standardSampleRate;\n\t\t\tconst real: number = Math.cos(cornerRadiansPerSample);\n\t\t\tconst imag: number = Math.sin(cornerRadiansPerSample);\n\t\t\t\n\t\t\tlet linearGain: number = 1.0; //volumeCompensation;\n\t\t\tfor (const filter of filters) {\n\t\t\t\tresponse.analyzeComplex(filter, real, imag);\n\t\t\t\tlinearGain *= response.magnitude();\n\t\t\t}\n\t\t\t\n\t\t\tconst gainSetting: number = Math.log2(linearGain) / Config.filterGainStep + Config.filterGainCenter;\n\t\t\tconst y: number = this._gainToY(gainSetting);\n\t\t\tconst x: number = this._freqToX(i);\n\t\t\tresponsePath += \"L \" + prettyNumber(x) + \" \" + prettyNumber(y) + \" \";\n\t\t}\n\t\t\n\t\tresponsePath += \"L \" + this._editorWidth + \" \" + this._editorHeight + \" L 0 \" + this._editorHeight + \" z \";\n\t\tthis._responsePath.setAttribute(\"d\", responsePath);\n\t}\n\t\n\tpublic render(): void {\n\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tconst filterSettings: FilterSettings = this._useNoteFilter ? instrument.noteFilter : instrument.eqFilter;\n\t\tif (this._filterSettings != filterSettings) {\n\t\t\tthis._dragChange = null;\n\t\t\tthis._mouseDown = false;\n\t\t}\n\t\tthis._filterSettings = filterSettings;\n\t\tif (!this._mouseDown) this._updateCursor();\n\t\t\n\t\tlet pointTypes: number = 0;\n\t\tlet pointFreqs: number = 0;\n\t\tlet pointGains: number = 0;\n\t\tfor (let i: number = 0; i < filterSettings.controlPointCount; i++) {\n\t\t\tconst point: FilterControlPoint = filterSettings.controlPoints[i];\n\t\t\tpointTypes = pointTypes * FilterType.length      + point.type;\n\t\t\tpointFreqs = pointFreqs * Config.filterFreqRange + point.freq;\n\t\t\tpointGains = pointGains * Config.filterGainRange + point.gain;\n\t\t}\n\t\tif (this._renderedSelectedIndex != this._selectedIndex ||\n\t\t\tthis._renderedPointCount != filterSettings.controlPointCount ||\n\t\t\tthis._renderedPointTypes != pointTypes ||\n\t\t\tthis._renderedPointFreqs != pointFreqs ||\n\t\t\tthis._renderedPointGains != pointGains)\n\t\t{\n\t\t\tthis._renderedSelectedIndex = this._selectedIndex;\n\t\t\tthis._renderedPointCount = filterSettings.controlPointCount;\n\t\t\tthis._renderedPointTypes = pointTypes;\n\t\t\tthis._renderedPointFreqs = pointFreqs;\n\t\t\tthis._renderedPointGains = pointGains;\n\t\t\tthis._updatePath();\n\t\t}\n\t\t\n\t\t/*\n\t\tif (this._renderedKey != this._doc.song.key) {\n\t\t\tthis._renderedKey = this._doc.song.key;\n\t\t\tconst tonicHz: number = Instrument.frequencyFromPitch(Config.keys[this._doc.song.key].basePitch);\n\t\t\tconst x: number = this._freqToX(FilterControlPoint.getSettingValueFromHz(tonicHz));\n\t\t\tthis._octaves.setAttribute(\"x\", String(x));\n\t\t}\n\t\t*/\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {ColorConfig} from \"./ColorConfig\";\n\nexport class MuteEditor {\n\tprivate _cornerFiller: HTMLDivElement = HTML.div({style: `background: ${ColorConfig.editorBackground}; position: sticky; bottom: 0; left: 0; width: 32px; height: 30px;`});\n\t\n\tpublic readonly container: HTMLElement = HTML.div({class: \"muteEditor\"},\n\t);\n\t\n\tprivate readonly _buttons: HTMLButtonElement[] = [];\n\tprivate _renderedChannelCount: number = 0;\n\tprivate _renderedChannelHeight: number = -1;\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis.container.addEventListener(\"click\", this._onClick);\n\t}\n\t\n\tprivate _onClick = (event: MouseEvent): void => {\n\t\tconst index = this._buttons.indexOf(<HTMLButtonElement> event.target);\n\t\tif (index == -1) return;\n\t\tthis._doc.song.channels[index].muted = !this._doc.song.channels[index].muted;\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tpublic render(): void {\n\t\tif (!this._doc.enableChannelMuting) return;\n\t\t\n\t\tconst channelHeight = this._doc.getChannelHeight();\n\t\t\n\t\tif (this._renderedChannelCount != this._doc.song.getChannelCount()) {\n\t\t\tfor (let y: number = this._renderedChannelCount; y < this._doc.song.getChannelCount(); y++) {\n\t\t\t\tconst muteButton: HTMLButtonElement = HTML.button({class: \"mute-button\", title: \"Mute (M), Mute All (⇧M), Solo (S), Exclude (⇧S)\", style: `height: ${channelHeight - 4}px; margin: 2px;`});\n\t\t\t\tthis.container.appendChild(muteButton);\n\t\t\t\tthis._buttons[y] = muteButton;\n\t\t\t}\n\t\t\t\n\t\t\tfor (let y: number = this._doc.song.getChannelCount(); y < this._renderedChannelCount; y++) {\n\t\t\t\tthis.container.removeChild(this._buttons[y]);\n\t\t\t}\n\t\t\t\n\t\t\tthis._buttons.length = this._doc.song.getChannelCount();\n\t\t\t\n\t\t\tthis.container.appendChild(this._cornerFiller);\n\t\t}\n\t\t\n\t\tfor (let y: number = 0; y < this._doc.song.getChannelCount(); y++) {\n\t\t\tif (this._doc.song.channels[y].muted) {\n\t\t\t\tthis._buttons[y].classList.add(\"muted\");\n\t\t\t} else {\n\t\t\t\tthis._buttons[y].classList.remove(\"muted\");\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._renderedChannelHeight != channelHeight) {\n\t\t\tfor (let y: number = 0; y < this._doc.song.getChannelCount(); y++) {\n\t\t\t\tthis._buttons[y].style.height = (channelHeight - 4) + \"px\";\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._renderedChannelHeight != channelHeight || this._renderedChannelCount != this._doc.song.getChannelCount()) {\n\t\t\tthis._renderedChannelHeight = channelHeight;\n\t\t\tthis._renderedChannelCount = this._doc.song.getChannelCount();\n\t\t}\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Pattern} from \"../synth/synth\";\nimport {ColorConfig, ChannelColors} from \"./ColorConfig\";\nimport {isMobile} from \"./EditorConfig\";\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\n\nclass Box {\n\tprivate readonly _text: Text = document.createTextNode(\"1\");\n\tprivate readonly _label: SVGTextElement = SVG.text({\"font-family\": \"sans-serif\", \"font-size\": 20, \"text-anchor\": \"middle\", \"font-weight\": \"bold\", fill: \"red\"}, this._text);\n\tprivate readonly _rect: SVGRectElement = SVG.rect({x: 1, y: 1});\n\tpublic readonly container: SVGSVGElement = SVG.svg(this._rect, this._label);\n\tprivate _renderedIndex: number = 1;\n\tprivate _renderedDim: boolean = true;\n\tprivate _renderedSelected: boolean = false;\n\tprivate _renderedColor: string = \"\";\n\tconstructor(channel: number, private readonly _x: number, private readonly _y: number, color: string) {\n\t\tthis._rect.setAttribute(\"fill\", ColorConfig.uiWidgetBackground);\n\t\tthis._label.setAttribute(\"fill\", color);\n\t}\n\t\n\tpublic setSize(width: number, height: number): void {\n\t\tthis.container.setAttribute(\"x\", \"\" + (this._x * width));\n\t\tthis.container.setAttribute(\"y\", \"\" + (this._y * height));\n\t\tthis._rect.setAttribute(\"width\", \"\" + (width - 2));\n\t\tthis._rect.setAttribute(\"height\", \"\" + (height - 2));\n\t\tthis._label.setAttribute(\"x\", \"\" + (width / 2));\n\t\tthis._label.setAttribute(\"y\", \"\" + Math.round(height / 2 + 7));\n\t}\n\t\n\tpublic setIndex(index: number, dim: boolean, selected: boolean, color: string): void {\n\t\tif (this._renderedIndex != index) {\n\t\t\tif (!this._renderedSelected && ((index == 0) != (this._renderedIndex == 0))) {\n\t\t\t\tthis._rect.setAttribute(\"fill\", (index == 0) ? \"none\" : ColorConfig.uiWidgetBackground);\n\t\t\t}\n\t\t\n\t\t\tthis._renderedIndex = index;\n\t\t\tthis._text.data = \"\"+index;\n\t\t}\n\t\t\n\t\tif (this._renderedDim != dim || this._renderedColor != color) {\n\t\t\tthis._renderedDim = dim;\n\t\t\tif (selected) {\n\t\t\t\tthis._label.setAttribute(\"fill\", ColorConfig.invertedText);\n\t\t\t} else {\n\t\t\t\tthis._label.setAttribute(\"fill\", color);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._renderedSelected != selected || this._renderedColor != color) {\n\t\t\tthis._renderedSelected = selected;\n\t\t\tif (selected) {\n\t\t\t\tthis._rect.setAttribute(\"fill\", color);\n\t\t\t\tthis._label.setAttribute(\"fill\", ColorConfig.invertedText);\n\t\t\t} else {\n\t\t\t\tthis._rect.setAttribute(\"fill\", (this._renderedIndex == 0) ? ColorConfig.editorBackground : ColorConfig.uiWidgetBackground);\n\t\t\t\tthis._label.setAttribute(\"fill\", color);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._renderedColor = color;\n\t}\n}\n\nexport class TrackEditor {\n\tprivate readonly _boxContainer: SVGGElement = SVG.g();\n\tprivate readonly _playhead: SVGRectElement = SVG.rect({fill: ColorConfig.playhead, x: 0, y: 0, width: 4, height: 128});\n\tprivate readonly _boxHighlight: SVGRectElement = SVG.rect({fill: \"none\", stroke: ColorConfig.hoverPreview, \"stroke-width\": 2, \"pointer-events\": \"none\", x: 1, y: 1, width: 30, height: 30});\n\tprivate readonly _upHighlight: SVGPathElement = SVG.path({fill: ColorConfig.invertedText, stroke: ColorConfig.invertedText, \"stroke-width\": 1, \"pointer-events\": \"none\"});\n\tprivate readonly _downHighlight: SVGPathElement = SVG.path({fill: ColorConfig.invertedText, stroke: ColorConfig.invertedText, \"stroke-width\": 1, \"pointer-events\": \"none\"});\n\tprivate readonly _selectionRect: SVGRectElement = SVG.rect({fill: ColorConfig.boxSelectionFill, stroke: ColorConfig.hoverPreview, \"stroke-width\": 2, \"stroke-dasharray\": \"5, 3\", \"pointer-events\": \"none\", visibility: \"hidden\", x: 1, y: 1, width: 62, height: 62});\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `background-color: ${ColorConfig.editorBackground}; position: absolute;`, height: 128},\n\t\tthis._boxContainer,\n\t\tthis._selectionRect,\n\t\tthis._boxHighlight,\n\t\tthis._upHighlight,\n\t\tthis._downHighlight,\n\t\tthis._playhead,\n\t);\n\tprivate readonly _select: HTMLSelectElement = HTML.select({class: \"trackSelectBox\", style: \"background: none; border: none; appearance: none; border-radius: initial; box-shadow: none; color: transparent; position: absolute; touch-action: none;\"});\n\tpublic readonly container: HTMLElement = HTML.div({class: \"noSelection\", style: \"height: 128px; position: relative; overflow:hidden;\"}, this._svg, this._select);\n\t\n\tprivate readonly _grid: Box[][] = [];\n\tprivate _mouseX: number = 0;\n\tprivate _mouseY: number = 0;\n\tprivate _mouseStartBar: number = 0;\n\tprivate _mouseStartChannel: number = 0;\n\tprivate _mouseBar: number = 0;\n\tprivate _mouseChannel: number = 0;\n\tprivate _mouseOver: boolean = false;\n\tprivate _mousePressed: boolean = false;\n\tprivate _mouseDragging = false;\n\tprivate _barWidth: number = 32;\n\tprivate _channelHeight: number = 32;\n\tprivate _renderedChannelCount: number = 0;\n\tprivate _renderedBarCount: number = 0;\n\tprivate _renderedPatternCount: number = 0;\n\tprivate _renderedPlayhead: number = -1;\n\tprivate _renderedBarWidth: number = -1;\n\tprivate _renderedChannelHeight: number = -1;\n\tprivate _touchMode: boolean = isMobile;\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\twindow.requestAnimationFrame(this._animatePlayhead);\n\t\tthis._svg.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenMouseReleased);\n\t\tthis._svg.addEventListener(\"mouseover\", this._whenMouseOver);\n\t\tthis._svg.addEventListener(\"mouseout\", this._whenMouseOut);\n\t\t\n\t\tthis._select.addEventListener(\"change\", this._whenSelectChanged);\n\t\tthis._select.addEventListener(\"touchstart\", this._whenSelectPressed);\n\t\tthis._select.addEventListener(\"touchmove\", this._whenSelectMoved);\n\t\tthis._select.addEventListener(\"touchend\", this._whenSelectReleased);\n\t\tthis._select.addEventListener(\"touchcancel\", this._whenSelectReleased);\n\t\t\n\t\tlet determinedCursorType: boolean = false;\n\t\tdocument.addEventListener(\"mousedown\", () => {\n\t\t\tif (!determinedCursorType) {\n\t\t\t\tthis._touchMode = false;\n\t\t\t\tthis._updatePreview();\n\t\t\t}\n\t\t\tdeterminedCursorType = true;\n\t\t}, true);\n\t\tdocument.addEventListener(\"touchstart\", () => {\n\t\t\tif (!determinedCursorType) {\n\t\t\t\tthis._touchMode = true;\n\t\t\t\tthis._updatePreview();\n\t\t\t}\n\t\t\tdeterminedCursorType = true;\n\t\t}, true);\n\t}\n\t\n\tprivate _whenSelectChanged = (): void => {\n\t\tthis._doc.selection.setPattern(this._select.selectedIndex);\n\t}\n\t\n\tprivate _animatePlayhead = (timestamp: number): void => {\n\t\tconst playhead = (this._barWidth * this._doc.synth.playhead - 2);\n\t\tif (this._renderedPlayhead != playhead) {\n\t\t\tthis._renderedPlayhead = playhead;\n\t\t\tthis._playhead.setAttribute(\"x\", \"\" + playhead);\n\t\t}\n\t\twindow.requestAnimationFrame(this._animatePlayhead);\n\t}\n\t\n\tpublic movePlayheadToMouse(): boolean {\n\t\tif (this._mouseOver) {\n\t\t\tthis._doc.synth.playhead = this._mouseBar + (this._mouseX % this._barWidth) / this._barWidth;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tprivate _dragBoxSelection(): void {\n\t\tthis._doc.selection.setTrackSelection(this._doc.selection.boxSelectionX0, this._mouseBar, this._doc.selection.boxSelectionY0, this._mouseChannel);\n\t\tthis._doc.selection.selectionUpdated();\n\t}\n\t\n\tprivate _updateSelectPos(event: TouchEvent): void {\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\tthis._mouseY = event.touches[0].clientY - boundingRect.top;\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._mouseBar = Math.floor(Math.min(this._doc.song.barCount - 1, Math.max(0, this._mouseX / this._barWidth)));\n\t\tthis._mouseChannel = Math.floor(Math.min(this._doc.song.getChannelCount() - 1, Math.max(0, this._mouseY / this._channelHeight)));\n\t}\n\t\n\tprivate _whenSelectPressed = (event: TouchEvent): void => {\n\t\tthis._mousePressed = true;\n\t\tthis._mouseDragging = true;\n\t\tthis._updateSelectPos(event);\n\t\tthis._mouseStartBar = this._mouseBar;\n\t\tthis._mouseStartChannel = this._mouseChannel;\n\t}\n\t\n\tprivate _whenSelectMoved = (event: TouchEvent): void => {\n\t\tthis._updateSelectPos(event);\n\t\tif (this._mouseStartBar != this._mouseBar || this._mouseStartChannel != this._mouseChannel) {\n\t\t\t// if the touch has started dragging, cancel opening the select menu.\n\t\t\tevent.preventDefault();\n\t\t}\n\t\tif (this._mousePressed) this._dragBoxSelection();\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenSelectReleased = (event: TouchEvent): void => {\n\t\tthis._mousePressed = false;\n\t\tthis._mouseDragging = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMouseOver = (event: MouseEvent): void => {\n\t\tif (this._mouseOver) return;\n\t\tthis._mouseOver = true;\n\t}\n\t\n\tprivate _whenMouseOut = (event: MouseEvent): void => {\n\t\tif (!this._mouseOver) return;\n\t\tthis._mouseOver = false;\n\t}\n\t\n\tprivate _updateMousePos(event: MouseEvent): void {\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\tthis._mouseY = (event.clientY || event.pageY) - boundingRect.top;\n\t\tthis._mouseBar = Math.floor(Math.min(this._doc.song.barCount - 1, Math.max(0, this._mouseX / this._barWidth)));\n\t\tthis._mouseChannel = Math.floor(Math.min(this._doc.song.getChannelCount() - 1, Math.max(0, this._mouseY / this._channelHeight)));\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mousePressed = true;\n\t\tthis._updateMousePos(event);\n\t\tthis._mouseStartBar = this._mouseBar;\n\t\tthis._mouseStartChannel = this._mouseChannel;\n\t\tif (event.shiftKey) {\n\t\t\tthis._mouseDragging = true;\n\t\t\tthis._doc.selection.setTrackSelection(this._doc.selection.boxSelectionX0, this._mouseBar, this._doc.selection.boxSelectionY0, this._mouseChannel);\n\t\t\tthis._doc.selection.selectionUpdated();\n\t\t} else {\n\t\t\tthis._mouseDragging = false;\n\t\t\tif (this._doc.channel != this._mouseChannel || this._doc.bar != this._mouseBar) {\n\t\t\t\tthis._doc.selection.setChannelBar(this._mouseChannel, this._mouseBar);\n\t\t\t\tthis._mouseDragging = true;\n\t\t\t}\n\t\t\tthis._doc.selection.resetBoxSelection();\n\t\t}\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tthis._updateMousePos(event);\n\t\tif (this._mousePressed) {\n\t\t\tif (this._mouseStartBar != this._mouseBar || this._mouseStartChannel != this._mouseChannel) {\n\t\t\t\tthis._mouseDragging = true;\n\t\t\t}\n\t\t\tthis._dragBoxSelection();\n\t\t}\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMouseReleased = (event: MouseEvent): void => {\n\t\tif (this._mousePressed && !this._mouseDragging) {\n\t\t\tif (this._doc.channel == this._mouseChannel && this._doc.bar == this._mouseBar) {\n\t\t\t\tconst up: boolean = (this._mouseY % this._channelHeight) < this._channelHeight / 2;\n\t\t\t\tconst patternCount: number = this._doc.song.patternsPerChannel;\n\t\t\t\tthis._doc.selection.setPattern((this._doc.song.channels[this._mouseChannel].bars[this._mouseBar] + (up ? 1 : patternCount)) % (patternCount + 1));\n\t\t\t}\n\t\t}\n\t\tthis._mousePressed = false;\n\t\tthis._mouseDragging = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _updatePreview(): void {\n\t\tlet channel: number = this._mouseChannel;\n\t\tlet bar: number = this._mouseBar;\n\t\t\n\t\tif (this._touchMode) {\n\t\t\tbar = this._doc.bar;\n\t\t\tchannel = this._doc.channel;\n\t\t}\n\t\t\n\t\tconst selected: boolean = (bar == this._doc.bar && channel == this._doc.channel);\n\t\t\n\t\tif (this._mouseOver && !this._mousePressed && !selected) {\n\t\t\tthis._boxHighlight.setAttribute(\"x\", \"\" + (1 + this._barWidth * bar));\n\t\t\tthis._boxHighlight.setAttribute(\"y\", \"\" + (1 + (this._channelHeight * channel)));\n\t\t\tthis._boxHighlight.setAttribute(\"height\", \"\" + (this._channelHeight - 2));\n\t\t\tthis._boxHighlight.setAttribute(\"width\", \"\" + (this._barWidth - 2));\n\t\t\tthis._boxHighlight.style.visibility = \"visible\";\n\t\t} else {\n\t\t\tthis._boxHighlight.style.visibility = \"hidden\";\n\t\t}\n\t\t\n\t\tif ((this._mouseOver || this._touchMode) && selected) {\n\t\t\tconst up: boolean = (this._mouseY % this._channelHeight) < this._channelHeight / 2;\n\t\t\tconst center: number = this._barWidth * (bar + 0.8);\n\t\t\tconst middle: number = this._channelHeight * (channel + 0.5);\n\t\t\tconst base: number = this._channelHeight * 0.1;\n\t\t\tconst tip: number = this._channelHeight * 0.4;\n\t\t\tconst width: number = this._channelHeight * 0.175;\n\t\t\t\n\t\t\tthis._upHighlight.setAttribute(\"fill\", up && !this._touchMode ? ColorConfig.hoverPreview : ColorConfig.invertedText);\n\t\t\tthis._downHighlight.setAttribute(\"fill\", !up && !this._touchMode ? ColorConfig.hoverPreview : ColorConfig.invertedText);\n\t\t\t\n\t\t\tthis._upHighlight.setAttribute(\"d\", `M ${center} ${middle - tip} L ${center + width} ${middle - base} L ${center - width} ${middle - base} z`);\n\t\t\tthis._downHighlight.setAttribute(\"d\", `M ${center} ${middle + tip} L ${center + width} ${middle + base} L ${center - width} ${middle + base} z`);\n\t\t\t\n\t\t\tthis._upHighlight.style.visibility = \"visible\";\n\t\t\tthis._downHighlight.style.visibility = \"visible\";\n\t\t} else {\n\t\t\tthis._upHighlight.style.visibility = \"hidden\";\n\t\t\tthis._downHighlight.style.visibility = \"hidden\";\n\t\t}\n\t\t\n\t\tthis._select.style.left = (this._barWidth * this._doc.bar) + \"px\";\n\t\tthis._select.style.width = this._barWidth + \"px\";\n\t\tthis._select.style.top = (this._channelHeight * this._doc.channel) + \"px\";\n\t\tthis._select.style.height = this._channelHeight + \"px\";\n\t\t\n\t\tconst patternCount: number = this._doc.song.patternsPerChannel + 1;\n\t\tfor (let i: number = this._renderedPatternCount; i < patternCount; i++) {\n\t\t\tthis._select.appendChild(HTML.option({value: i}, i));\n\t\t}\n\t\tfor (let i: number = patternCount; i < this._renderedPatternCount; i++) {\n\t\t\tthis._select.removeChild(<Node> this._select.lastChild);\n\t\t}\n\t\tthis._renderedPatternCount = patternCount;\n\t\tconst selectedPattern: number = this._doc.song.channels[this._doc.channel].bars[this._doc.bar];\n\t\tif (this._select.selectedIndex != selectedPattern) this._select.selectedIndex = selectedPattern;\n\t}\n\t\n\tpublic render(): void {\n\t\tthis._barWidth = this._doc.getBarWidth();\n\t\tthis._channelHeight = this._doc.getChannelHeight();\n\t\t\n\t\tif (this._renderedChannelCount != this._doc.song.getChannelCount()) {\n\t\t\tfor (let y: number = this._renderedChannelCount; y < this._doc.song.getChannelCount(); y++) {\n\t\t\t\tthis._grid[y] = [];\n\t\t\t\tfor (let x: number = 0; x < this._renderedBarCount; x++) {\n\t\t\t\t\tconst box: Box = new Box(y, x, y, ColorConfig.getChannelColor(this._doc.song, y).secondaryChannel);\n\t\t\t\t\tbox.setSize(this._barWidth, this._channelHeight);\n\t\t\t\t\tthis._boxContainer.appendChild(box.container);\n\t\t\t\t\tthis._grid[y][x] = box;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor (let y: number = this._doc.song.getChannelCount(); y < this._renderedChannelCount; y++) {\n\t\t\t\tfor (let x: number = 0; x < this._renderedBarCount; x++) {\n\t\t\t\t\tthis._boxContainer.removeChild(this._grid[y][x].container);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis._grid.length = this._doc.song.getChannelCount();\n\t\t\tthis._mousePressed = false;\n\t\t}\n\t\t\n\t\tif (this._renderedBarCount != this._doc.song.barCount) {\n\t\t\tfor (let y: number = 0; y < this._doc.song.getChannelCount(); y++) {\n\t\t\t\tfor (let x: number = this._renderedBarCount; x < this._doc.song.barCount; x++) {\n\t\t\t\t\tconst box: Box = new Box(y, x, y, ColorConfig.getChannelColor(this._doc.song, y).secondaryChannel);\n\t\t\t\t\tbox.setSize(this._barWidth, this._channelHeight);\n\t\t\t\t\tthis._boxContainer.appendChild(box.container);\n\t\t\t\t\tthis._grid[y][x] = box;\n\t\t\t\t}\n\t\t\t\tfor (let x: number = this._doc.song.barCount; x < this._renderedBarCount; x++) {\n\t\t\t\t\tthis._boxContainer.removeChild(this._grid[y][x].container);\n\t\t\t\t}\n\t\t\t\tthis._grid[y].length = this._doc.song.barCount;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._renderedBarCount != this._doc.song.barCount || this._renderedBarWidth != this._barWidth) {\n\t\t\tthis._renderedBarCount = this._doc.song.barCount;\n\t\t\tconst editorWidth = this._barWidth * this._doc.song.barCount;\n\t\t\tthis.container.style.width = editorWidth + \"px\";\n\t\t\tthis._svg.setAttribute(\"width\", editorWidth + \"\");\n\t\t\tthis._mousePressed = false;\n\t\t}\n\t\t\n\t\tif (this._renderedChannelHeight != this._channelHeight || this._renderedBarWidth != this._barWidth) {\n\t\t\tthis._renderedBarWidth = this._barWidth;\n\t\t\tfor (let y: number = 0; y < this._doc.song.getChannelCount(); y++) {\n\t\t\t\tfor (let x: number = 0; x < this._renderedBarCount; x++) {\n\t\t\t\t\tthis._grid[y][x].setSize(this._barWidth, this._channelHeight);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._mousePressed = false;\n\t\t}\n\t\t\n\t\tif (this._renderedChannelHeight != this._channelHeight || this._renderedChannelCount != this._doc.song.getChannelCount()) {\n\t\t\tthis._renderedChannelHeight = this._channelHeight;\n\t\t\tthis._renderedChannelCount = this._doc.song.getChannelCount();\n\t\t\tconst editorHeight: number = this._doc.song.getChannelCount() * this._channelHeight;\n\t\t\tthis._svg.setAttribute(\"height\", \"\" + editorHeight);\n\t\t\tthis._playhead.setAttribute(\"height\", \"\" + editorHeight);\n\t\t\tthis.container.style.height = editorHeight + \"px\";\n\t\t}\n\t\t\n\t\tfor (let j: number = 0; j < this._doc.song.getChannelCount(); j++) {\n\t\t\tfor (let i: number = 0; i < this._renderedBarCount; i++) {\n\t\t\t\tconst pattern: Pattern | null = this._doc.song.getPattern(j, i);\n\t\t\t\tconst selected: boolean = (i == this._doc.bar && j == this._doc.channel);\n\t\t\t\tconst dim: boolean = (pattern == null || pattern.notes.length == 0);\n\t\t\t\t\n\t\t\t\tconst box: Box = this._grid[j][i];\n\t\t\t\tif (i < this._doc.song.barCount) {\n\t\t\t\t\tconst colors: ChannelColors = ColorConfig.getChannelColor(this._doc.song, j);\n\t\t\t\t\tbox.setIndex(this._doc.song.channels[j].bars[i], dim, selected, dim && !selected ? colors.secondaryChannel : colors.primaryChannel);\n\t\t\t\t\tbox.container.style.visibility = \"visible\";\n\t\t\t\t} else {\n\t\t\t\t\tbox.container.style.visibility = \"hidden\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._select.style.display = this._touchMode ? \"\" : \"none\";\n\t\t\n\t\tif (this._doc.selection.boxSelectionWidth > 1 || this._doc.selection.boxSelectionHeight > 1) {\n\t\t\t// TODO: This causes the selection rectangle to repaint every time the\n\t\t\t// editor renders and the selection is visible. Check if anything changed\n\t\t\t// before overwriting the attributes?\n\t\t\tthis._selectionRect.setAttribute(\"x\", String(this._barWidth * this._doc.selection.boxSelectionBar + 1));\n\t\t\tthis._selectionRect.setAttribute(\"y\", String(this._channelHeight * this._doc.selection.boxSelectionChannel + 1));\n\t\t\tthis._selectionRect.setAttribute(\"width\", String(this._barWidth * this._doc.selection.boxSelectionWidth - 2));\n\t\t\tthis._selectionRect.setAttribute(\"height\", String(this._channelHeight * this._doc.selection.boxSelectionHeight - 2));\n\t\t\tthis._selectionRect.setAttribute(\"visibility\", \"visible\");\n\t\t} else {\n\t\t\tthis._selectionRect.setAttribute(\"visibility\", \"hidden\");\n\t\t}\n\t\t\n\t\tthis._updatePreview();\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {SongDocument} from \"./SongDocument\";\nimport {Layout} from \"./Layout\";\nimport {Prompt} from \"./Prompt\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\n\nconst {button, label, div, form, h2, input} = HTML;\n\nexport class LayoutPrompt implements Prompt {\n\tprivate readonly _fileInput: HTMLInputElement = input({type: \"file\", accept: \".json,application/json,.mid,.midi,audio/midi,audio/x-midi\"});\n\tprivate readonly _okayButton: HTMLButtonElement = button({class: \"okayButton\", style: \"width:45%;\"}, \"Okay\");\n\tprivate readonly _cancelButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\tprivate readonly _form: HTMLFormElement = form({style: \"display: flex; gap: 10px;\"},\n\t\t\tlabel({class: \"layout-option\"},\n\t\t\t\tinput({type: \"radio\", name: \"layout\", value: \"small\"}),\n\t\t\t\tSVG(`\\\n\t\t\t\t\t<svg viewBox=\"-4 -1 28 22\">\n\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1\"/>\n\t\t\t\t\t\t<rect x=\"2\" y=\"2\" width=\"11\" height=\"10\" fill=\"currentColor\"/>\n\t\t\t\t\t\t<rect x=\"14\" y=\"2\" width=\"4\" height=\"16\" fill=\"currentColor\"/>\n\t\t\t\t\t\t<rect x=\"2\" y=\"13\" width=\"11\" height=\"5\" fill=\"currentColor\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t`),\n\t\t\t\tdiv(\"Small\"),\n\t\t\t),\n\t\t\tlabel({class: \"layout-option\"},\n\t\t\t\tinput({type: \"radio\", name: \"layout\", value: \"long\"}),\n\t\t\t\tSVG(`\\\n\t\t\t\t\t<svg viewBox=\"-1 -1 28 22\">\n\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"26\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1\"/>\n\t\t\t\t\t\t<rect x=\"2\" y=\"2\" width=\"12\" height=\"10\" fill=\"currentColor\"/>\n\t\t\t\t\t\t<rect x=\"15\" y=\"2\" width=\"4\" height=\"10\" fill=\"currentColor\"/>\n\t\t\t\t\t\t<rect x=\"20\" y=\"2\" width=\"4\" height=\"10\" fill=\"currentColor\"/>\n\t\t\t\t\t\t<rect x=\"2\" y=\"13\" width=\"22\" height=\"5\" fill=\"currentColor\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t`),\n\t\t\t\tdiv(\"Long\"),\n\t\t\t),\n\t\t\tlabel({class: \"layout-option\"},\n\t\t\t\tinput({type: \"radio\", name: \"layout\", value: \"tall\"}),\n\t\t\t\tSVG(`\\\n\t\t\t\t\t<svg viewBox=\"-1 -1 28 22\">\n\t\t\t\t\t\t<rect x=\"0\" y=\"0\" width=\"26\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1\"/>\n\t\t\t\t\t\t<rect x=\"11\" y=\"2\" width=\"8\" height=\"16\" fill=\"currentColor\"/>\n\t\t\t\t\t\t<rect x=\"20\" y=\"2\" width=\"4\" height=\"16\" fill=\"currentColor\"/>\n\t\t\t\t\t\t<rect x=\"2\" y=\"2\" width=\"8\" height=\"16\" fill=\"currentColor\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t`),\n\t\t\t\tdiv(\"Tall\"),\n\t\t\t),\n\t\t);\n\t\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt noSelection\", style: \"width: 300px;\"},\n\t\th2(\"Layout\"),\n\t\tthis._form,\n\t\tdiv({style: \"display: flex; flex-direction: row-reverse; justify-content: space-between;\"},\n\t\t\tthis._okayButton,\n\t\t),\n\t\tthis._cancelButton,\n\t);\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._fileInput.select();\n\t\tsetTimeout(()=>this._fileInput.focus());\n\t\t\n\t\tthis._okayButton.addEventListener(\"click\", this._confirm);\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\n\t\tthis.container.addEventListener(\"keydown\", this._whenKeyPressed);\n\t\t\n\t\t(<any> this._form.elements)[\"layout\"].value = this._doc.layout;\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => { \n\t\tthis._okayButton.removeEventListener(\"click\", this._confirm);\n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\n\t\tthis.container.removeEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\n\t\tif ((<Element> event.target).tagName != \"BUTTON\" && event.keyCode == 13) { // Enter key\n\t\t\tthis._confirm();\n\t\t}\n\t}\n\t\n\tprivate _confirm = (): void => { \n\t\tthis._doc.layout = (<any> this._form.elements)[\"layout\"].value;\n\t\tthis._doc.savePreferences();\n\t\tLayout.setLayout(this._doc.layout);\n\t\tthis._close();\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\nimport {ChangeLoop, ChangeChannelBar} from \"./changes\";\nimport {ColorConfig} from \"./ColorConfig\";\n\ninterface Cursor {\n\tstartBar: number;\n\tmode: number;\n}\n\ninterface Endpoints {\n\tstart: number;\n\tlength: number;\n}\n\nexport class LoopEditor {\n\tprivate readonly _editorHeight: number = 20;\n\tprivate readonly _startMode:   number = 0;\n\tprivate readonly _endMode:     number = 1;\n\tprivate readonly _bothMode:    number = 2;\n\t\n\tprivate readonly _loop: SVGPathElement = SVG.path({fill: \"none\", stroke: ColorConfig.loopAccent, \"stroke-width\": 4});\n\tprivate readonly _highlight: SVGPathElement = SVG.path({fill: ColorConfig.hoverPreview, \"pointer-events\": \"none\"});\n\t\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `touch-action: pan-y; position: absolute;`, height: this._editorHeight},\n\t\tthis._loop,\n\t\tthis._highlight,\n\t);\n\t\n\tpublic readonly container: HTMLElement = HTML.div({class: \"loopEditor\"}, this._svg);\n\t\n\tprivate _barWidth: number = 32;\n\tprivate _change: ChangeLoop | null = null;\n\tprivate _cursor: Cursor = {startBar: -1, mode: -1};\n\tprivate _mouseX: number = 0;\n\t//private _mouseY: number = 0;\n\tprivate _clientStartX: number = 0;\n\tprivate _clientStartY: number = 0;\n\tprivate _startedScrolling: boolean = false;\n\tprivate _draggingHorizontally: boolean = false;\n\tprivate _mouseDown: boolean = false;\n\tprivate _mouseOver: boolean = false;\n\tprivate _renderedLoopStart: number = -1;\n\tprivate _renderedLoopStop: number = -1;\n\tprivate _renderedBarCount: number = 0;\n\tprivate _renderedBarWidth: number = -1;\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._updateCursorStatus();\n\t\tthis._render();\n\t\tthis._doc.notifier.watch(this._documentChanged);\n\t\t\n\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\n\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\n\t\t\n\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\tthis.container.addEventListener(\"touchend\", this._whenTouchReleased);\n\t\tthis.container.addEventListener(\"touchcancel\", this._whenTouchReleased);\n\t}\n\t\n\tprivate _updateCursorStatus(): void {\n\t\tconst bar: number = this._mouseX / this._barWidth;\n\t\tthis._cursor.startBar = bar;\n\t\t\n\t\tif (bar > this._doc.song.loopStart - 0.25 && bar < this._doc.song.loopStart + this._doc.song.loopLength + 0.25) {\n\t\t\tif (bar - this._doc.song.loopStart < this._doc.song.loopLength * 0.5) {\n\t\t\t\tthis._cursor.mode = this._startMode;\n\t\t\t} else {\n\t\t\t\tthis._cursor.mode = this._endMode;\n\t\t\t}\n\t\t} else {\n\t\t\tthis._cursor.mode = this._bothMode;\n\t\t}\n\t}\n\t\n\tprivate _findEndPoints(middle: number): Endpoints {\n\t\tlet start: number = Math.round(middle - this._doc.song.loopLength / 2);\n\t\tlet end: number = start + this._doc.song.loopLength;\n\t\tif (start < 0) {\n\t\t\tend -= start;\n\t\t\tstart = 0;\n\t\t}\n\t\tif (end > this._doc.song.barCount) {\n\t\t\tstart -= end - this._doc.song.barCount;\n\t\t\tend = this._doc.song.barCount;\n\t\t}\n\t\treturn {start: start, length: end - start};\n\t}\n\t\n\tprivate _whenMouseOver = (event: MouseEvent): void => {\n\t\tif (this._mouseOver) return;\n\t\tthis._mouseOver = true;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMouseOut = (event: MouseEvent): void => {\n\t\tif (!this._mouseOver) return;\n\t\tthis._mouseOver = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\t//this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\n\t\tthis._updateCursorStatus();\n\t\tthis._updatePreview();\n\t\tthis._whenMouseMoved(event);\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\t//event.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\t//this._mouseY = event.touches[0].clientY - boundingRect.top;\n\t\tthis._updateCursorStatus();\n\t\tthis._updatePreview();\n\t\t//this._whenTouchMoved(event);\n\t\tthis._clientStartX = event.touches[0].clientX;\n\t\tthis._clientStartY = event.touches[0].clientY;\n\t\tthis._draggingHorizontally = false;\n\t\tthis._startedScrolling = false;\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\t//this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tif (!this._mouseDown) return;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\t//this._mouseY = event.touches[0].clientY - boundingRect.top;\n\t\t\n\t\tif (!this._draggingHorizontally && !this._startedScrolling) {\n\t\t\tif (Math.abs(event.touches[0].clientY - this._clientStartY) > 10) {\n\t\t\t\tthis._startedScrolling = true;\n\t\t\t} else if (Math.abs(event.touches[0].clientX - this._clientStartX) > 10) {\n\t\t\t\tthis._draggingHorizontally = true;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._draggingHorizontally) {\n\t\t\tthis._whenCursorMoved();\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\t\n\tprivate _whenCursorMoved(): void {\n\t\tif (this._mouseDown) {\n\t\t\tlet oldStart: number = this._doc.song.loopStart;\n\t\t\tlet oldEnd: number = this._doc.song.loopStart + this._doc.song.loopLength;\n\t\t\tif (this._change != null && this._doc.lastChangeWas(this._change)) {\n\t\t\t\toldStart = this._change.oldStart;\n\t\t\t\toldEnd = oldStart + this._change.oldLength;\n\t\t\t}\n\t\t\t\n\t\t\tconst bar: number = this._mouseX / this._barWidth;\n\t\t\tlet start: number;\n\t\t\tlet end: number;\n\t\t\tlet temp: number;\n\t\t\tif (this._cursor.mode == this._startMode) {\n\t\t\t\tstart = oldStart + Math.round(bar - this._cursor.startBar);\n\t\t\t\tend = oldEnd;\n\t\t\t\tif (start < 0) start = 0;\n\t\t\t\tif (start >= this._doc.song.barCount) start = this._doc.song.barCount;\n\t\t\t\tif (start == end) {\n\t\t\t\t\tstart = end - 1;\n\t\t\t\t} else if (start > end) {\n\t\t\t\t\ttemp = start;\n\t\t\t\t\tstart = end;\n\t\t\t\t\tend = temp;\n\t\t\t\t}\n\t\t\t\tthis._change = new ChangeLoop(this._doc, oldStart, oldEnd - oldStart, start, end - start);\n\t\t\t} else if (this._cursor.mode == this._endMode) {\n\t\t\t\tstart = oldStart;\n\t\t\t\tend = oldEnd + Math.round(bar - this._cursor.startBar);\n\t\t\t\tif (end < 0) end = 0;\n\t\t\t\tif (end >= this._doc.song.barCount) end = this._doc.song.barCount;\n\t\t\t\tif (end == start) {\n\t\t\t\t\tend = start + 1;\n\t\t\t\t} else if (end < start) {\n\t\t\t\t\ttemp = start;\n\t\t\t\t\tstart = end;\n\t\t\t\t\tend = temp;\n\t\t\t\t}\n\t\t\t\tthis._change = new ChangeLoop(this._doc, oldStart, oldEnd - oldStart, start, end - start);\n\t\t\t} else if (this._cursor.mode == this._bothMode) {\n\t\t\t\tconst endPoints: Endpoints = this._findEndPoints(bar);\n\t\t\t\tthis._change = new ChangeLoop(this._doc, oldStart, oldEnd - oldStart, endPoints.start, endPoints.length);\n\t\t\t}\n\t\t\tthis._doc.synth.jumpIntoLoop();\n\t\t\tif (this._doc.autoFollow) {\n\t\t\t\tnew ChangeChannelBar(this._doc, this._doc.channel, Math.floor(this._doc.synth.playhead), true);\n\t\t\t}\n\t\t\tthis._doc.setProspectiveChange(this._change);\n\t\t} else {\n\t\t\tthis._updateCursorStatus();\n\t\t\tthis._updatePreview();\n\t\t}\n\t}\n\t\n\tprivate _whenTouchReleased = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tif (!this._startedScrolling) {\n\t\t\tthis._whenCursorMoved();\n\t\t\tthis._mouseOver = false;\n\t\t\tthis._whenCursorReleased(event);\n\t\t\tthis._updatePreview();\n\t\t}\n\t\tthis._mouseDown = false;\n\t}\n\t\n\tprivate _whenCursorReleased = (event: Event): void => {\n\t\tif (this._change != null) this._doc.record(this._change);\n\t\tthis._change = null;\n\t\tthis._mouseDown = false;\n\t\tthis._updateCursorStatus();\n\t\tthis._render();\n\t}\n\t\n\tprivate _updatePreview(): void {\n\t\tconst showHighlight: boolean = this._mouseOver && !this._mouseDown;\n\t\tthis._highlight.style.visibility = showHighlight ? \"visible\" : \"hidden\";\n\t\t\n\t\tif (showHighlight) {\n\t\t\tconst radius: number = this._editorHeight / 2;\n\t\t\t\n\t\t\tlet highlightStart: number = (this._doc.song.loopStart) * this._barWidth;\n\t\t\tlet highlightStop: number = (this._doc.song.loopStart + this._doc.song.loopLength) * this._barWidth;\n\t\t\tif (this._cursor.mode == this._startMode) {\n\t\t\t\thighlightStop = (this._doc.song.loopStart) * this._barWidth + radius * 2;\n\t\t\t} else if (this._cursor.mode == this._endMode) {\n\t\t\t\thighlightStart = (this._doc.song.loopStart + this._doc.song.loopLength) * this._barWidth - radius * 2;\n\t\t\t} else {\n\t\t\t\tconst endPoints: Endpoints = this._findEndPoints(this._cursor.startBar);\n\t\t\t\thighlightStart = (endPoints.start) * this._barWidth;\n\t\t\t\thighlightStop = (endPoints.start + endPoints.length) * this._barWidth;\n\t\t\t}\n\t\t\t\n\t\t\tthis._highlight.setAttribute(\"d\",\n\t\t\t\t`M ${highlightStart + radius} ${4} ` +\n\t\t\t\t`L ${highlightStop - radius} ${4} ` +\n\t\t\t\t`A ${radius - 4} ${radius - 4} ${0} ${0} ${1} ${highlightStop - radius} ${this._editorHeight - 4} ` +\n\t\t\t\t`L ${highlightStart + radius} ${this._editorHeight - 4} ` +\n\t\t\t\t`A ${radius - 4} ${radius - 4} ${0} ${0} ${1} ${highlightStart + radius} ${4} ` +\n\t\t\t\t`z`\n\t\t\t);\n\t\t}\n\t}\n\t\n\tprivate _documentChanged = (): void => {\n\t\tthis._render();\n\t}\n\t\n\tprivate _render(): void {\n\t\tthis._barWidth = this._doc.getBarWidth();\n\t\t\n\t\tconst radius: number = this._editorHeight / 2;\n\t\tconst loopStart: number = (this._doc.song.loopStart) * this._barWidth;\n\t\tconst loopStop: number = (this._doc.song.loopStart + this._doc.song.loopLength) * this._barWidth;\n\t\t\n\t\tif (this._renderedBarCount != this._doc.song.barCount || this._renderedBarWidth != this._barWidth) {\n\t\t\tthis._renderedBarCount = this._doc.song.barCount;\n\t\t\tthis._renderedBarWidth = this._barWidth;\n\t\t\tconst editorWidth = this._barWidth * this._doc.song.barCount;\n\t\t\tthis.container.style.width = editorWidth + \"px\";\n\t\t\tthis._svg.setAttribute(\"width\", editorWidth + \"\");\n\t\t}\n\n\t\tif (this._renderedLoopStart != loopStart || this._renderedLoopStop != loopStop) {\n\t\t\tthis._renderedLoopStart = loopStart;\n\t\t\tthis._renderedLoopStop = loopStop;\n\t\t\tthis._loop.setAttribute(\"d\",\n\t\t\t\t`M ${loopStart + radius} ${2} ` +\n\t\t\t\t`L ${loopStop - radius} ${2} ` +\n\t\t\t\t`A ${radius - 2} ${radius - 2} ${0} ${0} ${1} ${loopStop - radius} ${this._editorHeight - 2} ` +\n\t\t\t\t`L ${loopStart + radius} ${this._editorHeight - 2} ` +\n\t\t\t\t`A ${radius - 2} ${radius - 2} ${0} ${0} ${1} ${loopStart + radius} ${2} ` +\n\t\t\t\t`z`\n\t\t\t);\n\t\t}\n\t\t\n\t\tthis._updatePreview();\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {SpectrumWave, Instrument} from \"../synth/synth\";\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\nimport {ColorConfig} from \"./ColorConfig\";\nimport {ChangeSpectrum} from \"./changes\";\nimport {prettyNumber} from \"./EditorConfig\";\n\nexport class SpectrumEditor {\n\tprivate readonly _editorWidth: number = 120;\n\tprivate readonly _editorHeight: number = 26;\n\tprivate readonly _fill: SVGPathElement = SVG.path({fill: ColorConfig.uiWidgetBackground, \"pointer-events\": \"none\"});\n\tprivate readonly _octaves: SVGSVGElement = SVG.svg({\"pointer-events\": \"none\"});\n\tprivate readonly _fifths: SVGSVGElement = SVG.svg({\"pointer-events\": \"none\"});\n\tprivate readonly _curve: SVGPathElement = SVG.path({fill: \"none\", stroke: \"currentColor\", \"stroke-width\": 2, \"pointer-events\": \"none\"});\n\tprivate readonly _arrow: SVGPathElement = SVG.path({fill: \"currentColor\", \"pointer-events\": \"none\"});\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `background-color: ${ColorConfig.editorBackground}; touch-action: none; cursor: crosshair;`, width: \"100%\", height: \"100%\", viewBox: \"0 0 \"+this._editorWidth+\" \"+this._editorHeight, preserveAspectRatio: \"none\"},\n\t\tthis._fill,\n\t\tthis._octaves,\n\t\tthis._fifths,\n\t\tthis._curve,\n\t\tthis._arrow,\n\t);\n\t\n\tpublic readonly container: HTMLElement = HTML.div({class: \"spectrum\", style: \"height: 100%;\"}, this._svg);\n\t\n\tprivate _mouseX: number = 0;\n\tprivate _mouseY: number = 0;\n\tprivate _freqPrev: number = 0;\n\tprivate _ampPrev: number = 0;\n\tprivate _mouseDown: boolean = false;\n\tprivate _change: ChangeSpectrum | null = null;\n\tprivate _renderedPath: String = \"\";\n\tprivate _renderedFifths: boolean = true;\n\t\n\tconstructor(private _doc: SongDocument, private _spectrumIndex: number | null) {\n\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i += Config.spectrumControlPointsPerOctave) {\n\t\t\tthis._octaves.appendChild(SVG.rect({fill: ColorConfig.tonic, x: (i+1) * this._editorWidth / (Config.spectrumControlPoints + 2) - 1, y: 0, width: 2, height: this._editorHeight}));\n\t\t}\n\t\tfor (let i: number = 4; i <= Config.spectrumControlPoints; i += Config.spectrumControlPointsPerOctave) {\n\t\t\tthis._fifths.appendChild(SVG.rect({fill: ColorConfig.fifthNote, x: (i+1) * this._editorWidth / (Config.spectrumControlPoints + 2) - 1, y: 0, width: 2, height: this._editorHeight}));\n\t\t}\n\t\t\n\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\n\t\t\n\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\tthis.container.addEventListener(\"touchend\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"touchcancel\", this._whenCursorReleased);\n\t}\n\t\n\tprivate _xToFreq(x: number): number {\n\t\treturn (Config.spectrumControlPoints + 2) * x / this._editorWidth - 1;\n\t}\n\t\n\tprivate _yToAmp(y: number): number {\n\t\treturn Config.spectrumMax * (1 - (y - 1) / (this._editorHeight - 2));\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\t\n\t\tthis._freqPrev = this._xToFreq(this._mouseX);\n\t\tthis._ampPrev = this._yToAmp(this._mouseY);\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\t\n\t\tthis._freqPrev = this._xToFreq(this._mouseX);\n\t\tthis._ampPrev = this._yToAmp(this._mouseY);\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tif (!this._mouseDown) return;\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenCursorMoved(): void {\n\t\tif (this._mouseDown) {\n\t\t\tconst freq: number = this._xToFreq(this._mouseX);\n\t\t\tconst amp: number = this._yToAmp(this._mouseY);\n\t\t\t\n\t\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\t\tconst spectrumWave: SpectrumWave = (this._spectrumIndex == null) ? instrument.spectrumWave : instrument.drumsetSpectrumWaves[this._spectrumIndex];\n\t\t\t\n\t\t\tif (freq != this._freqPrev) {\n\t\t\t\tconst slope: number = (amp - this._ampPrev) / (freq - this._freqPrev);\n\t\t\t\tconst offset: number = this._ampPrev - this._freqPrev * slope;\n\t\t\t\tconst lowerFreq: number = Math.ceil(Math.min(this._freqPrev, freq));\n\t\t\t\tconst upperFreq: number = Math.floor(Math.max(this._freqPrev, freq));\n\t\t\t\tfor (let i: number = lowerFreq; i <= upperFreq; i++) {\n\t\t\t\t\tif (i < 0 || i >= Config.spectrumControlPoints) continue;\n\t\t\t\t\tspectrumWave.spectrum[i] = Math.max(0, Math.min(Config.spectrumMax, Math.round(i * slope + offset)));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tspectrumWave.spectrum[Math.max(0, Math.min(Config.spectrumControlPoints - 1, Math.round(freq)))] = Math.max(0, Math.min(Config.spectrumMax, Math.round(amp)));\n\t\t\t\n\t\t\tthis._freqPrev = freq;\n\t\t\tthis._ampPrev = amp;\n\t\t\t\n\t\t\tthis._change = new ChangeSpectrum(this._doc, instrument, spectrumWave);\n\t\t\tthis._doc.setProspectiveChange(this._change);\n\t\t}\n\t}\n\t\n\tprivate _whenCursorReleased = (event: Event): void => {\n\t\tif (this._mouseDown) {\n\t\t\tthis._doc.record(this._change!);\n\t\t\tthis._change = null;\n\t\t}\n\t\tthis._mouseDown = false;\n\t}\n\t\n\tpublic render(): void {\n\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tconst spectrumWave: SpectrumWave = (this._spectrumIndex == null) ? instrument.spectrumWave : instrument.drumsetSpectrumWaves[this._spectrumIndex];\n\t\tconst controlPointToHeight = (point: number): number => {\n\t\t\treturn (1 - (point / Config.spectrumMax)) * (this._editorHeight - 1) + 1;\n\t\t}\n\t\t\n\t\tlet lastValue: number = 0;\n\t\tlet path: string = \"M 0 \" + prettyNumber(this._editorHeight) + \" \";\n\t\tfor (let i: number = 0; i < Config.spectrumControlPoints; i++) {\n\t\t\tlet nextValue: number = spectrumWave.spectrum[i];\n\t\t\tif (lastValue != 0 || nextValue != 0) {\n\t\t\t\tpath += \"L \";\n\t\t\t} else {\n\t\t\t\tpath += \"M \";\n\t\t\t}\n\t\t\tpath += prettyNumber((i + 1) * this._editorWidth / (Config.spectrumControlPoints + 2)) + \" \" + prettyNumber(controlPointToHeight(nextValue)) + \" \";\n\t\t\tlastValue = nextValue;\n\t\t}\n\t\t\n\t\tconst lastHeight: number = controlPointToHeight(lastValue);\n\t\tif (lastValue > 0) {\n\t\t\tpath += \"L \" + (this._editorWidth - 1) + \" \" + prettyNumber(lastHeight) + \" \";\n\t\t}\n\t\t\n\t\tif (this._renderedPath != path) {\n\t\t\tthis._renderedPath = path;\n\t\t\tthis._curve.setAttribute(\"d\", path);\n\t\t\tthis._fill.setAttribute(\"d\", path + \"L \" + this._editorWidth + \" \" + prettyNumber(lastHeight) + \" L \" + this._editorWidth + \" \" + prettyNumber(this._editorHeight) + \" L 0 \" + prettyNumber(this._editorHeight) + \" z \");\n\t\t\t\n\t\t\tthis._arrow.setAttribute(\"d\", \"M \" + this._editorWidth + \" \" + prettyNumber(lastHeight) + \" L \" + (this._editorWidth - 4) + \" \" + prettyNumber(lastHeight - 4) + \" L \" + (this._editorWidth - 4) + \" \" + prettyNumber(lastHeight + 4) + \" z\");\n\t\t\tthis._arrow.style.display = (lastValue > 0) ? \"\" : \"none\";\n\t\t}\n\t\tif (this._renderedFifths != this._doc.showFifth) {\n\t\t\tthis._renderedFifths = this._doc.showFifth;\n\t\t\tthis._fifths.style.display = this._doc.showFifth ? \"\" : \"none\";\n\t\t}\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {HarmonicsWave, Instrument} from \"../synth/synth\";\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\nimport {ColorConfig} from \"./ColorConfig\";\nimport {ChangeHarmonics} from \"./changes\";\nimport {prettyNumber} from \"./EditorConfig\";\n\nexport class HarmonicsEditor {\n\tprivate readonly _editorWidth: number = 120;\n\tprivate readonly _editorHeight: number = 26;\n\tprivate readonly _octaves: SVGSVGElement = SVG.svg({\"pointer-events\": \"none\"});\n\tprivate readonly _fifths: SVGSVGElement = SVG.svg({\"pointer-events\": \"none\"});\n\tprivate readonly _curve: SVGPathElement = SVG.path({fill: \"none\", stroke: \"currentColor\", \"stroke-width\": 2, \"pointer-events\": \"none\"});\n\tprivate readonly _lastControlPoints: SVGRectElement[] = [];\n\tprivate readonly _lastControlPointContainer: SVGSVGElement = SVG.svg({\"pointer-events\": \"none\"});\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `background-color: ${ColorConfig.editorBackground}; touch-action: none; cursor: crosshair;`, width: \"100%\", height: \"100%\", viewBox: \"0 0 \"+this._editorWidth+\" \"+this._editorHeight, preserveAspectRatio: \"none\"},\n\t\tthis._octaves,\n\t\tthis._fifths,\n\t\tthis._curve,\n\t\tthis._lastControlPointContainer,\n\t);\n\t\n\tpublic readonly container: HTMLElement = HTML.div({class: \"harmonics\", style: \"height: 100%;\"}, this._svg);\n\t\n\tprivate _mouseX: number = 0;\n\tprivate _mouseY: number = 0;\n\tprivate _freqPrev: number = 0;\n\tprivate _ampPrev: number = 0;\n\tprivate _mouseDown: boolean = false;\n\tprivate _change: ChangeHarmonics | null = null;\n\tprivate _renderedPath: String = \"\";\n\tprivate _renderedFifths: boolean = true;\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tfor (let i: number = 1; i <= Config.harmonicsControlPoints; i = i * 2) {\n\t\t\tthis._octaves.appendChild(SVG.rect({fill: ColorConfig.tonic, x: (i-0.5) * (this._editorWidth - 8) / (Config.harmonicsControlPoints - 1) - 1, y: 0, width: 2, height: this._editorHeight}));\n\t\t}\n\t\tfor (let i: number = 3; i <= Config.harmonicsControlPoints; i = i * 2) {\n\t\t\tthis._fifths.appendChild(SVG.rect({fill: ColorConfig.fifthNote, x: (i-0.5) * (this._editorWidth - 8) / (Config.harmonicsControlPoints - 1) - 1, y: 0, width: 2, height: this._editorHeight}));\n\t\t}\n\t\tfor (let i: number = 0; i < 4; i++) {\n\t\t\tconst rect: SVGRectElement = SVG.rect({fill: \"currentColor\", x: (this._editorWidth - i * 2 - 1), y: 0, width: 1, height: this._editorHeight});\n\t\t\tthis._lastControlPoints.push(rect);\n\t\t\tthis._lastControlPointContainer.appendChild(rect);\n\t\t}\n\t\t\n\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\n\t\t\n\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\tthis.container.addEventListener(\"touchend\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"touchcancel\", this._whenCursorReleased);\n\t}\n\t\n\tprivate _xToFreq(x: number): number {\n\t\treturn (Config.harmonicsControlPoints - 1) * x / (this._editorWidth - 8) - 0.5;\n\t}\n\t\n\tprivate _yToAmp(y: number): number {\n\t\treturn Config.harmonicsMax * (1 - y / this._editorHeight);\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\t\n\t\tthis._freqPrev = this._xToFreq(this._mouseX);\n\t\tthis._ampPrev = this._yToAmp(this._mouseY);\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\t\n\t\tthis._freqPrev = this._xToFreq(this._mouseX);\n\t\tthis._ampPrev = this._yToAmp(this._mouseY);\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = ((event.clientX || event.pageX) - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tif (this.container.offsetParent == null) return;\n\t\tif (!this._mouseDown) return;\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.touches[0].clientX - boundingRect.left) * this._editorWidth / (boundingRect.right - boundingRect.left);\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseX)) this._mouseX = 0;\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenCursorMoved(): void {\n\t\tif (this._mouseDown) {\n\t\t\tconst freq: number = this._xToFreq(this._mouseX);\n\t\t\tconst amp: number = this._yToAmp(this._mouseY);\n\t\t\t\n\t\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\t\tconst harmonicsWave: HarmonicsWave = instrument.harmonicsWave; //(this._harmonicsIndex == null) ? instrument.harmonicsWave : instrument.drumsetSpectrumWaves[this._harmonicsIndex];\n\t\t\t\n\t\t\tif (freq != this._freqPrev) {\n\t\t\t\tconst slope: number = (amp - this._ampPrev) / (freq - this._freqPrev);\n\t\t\t\tconst offset: number = this._ampPrev - this._freqPrev * slope;\n\t\t\t\tconst lowerFreq: number = Math.ceil(Math.min(this._freqPrev, freq));\n\t\t\t\tconst upperFreq: number = Math.floor(Math.max(this._freqPrev, freq));\n\t\t\t\tfor (let i: number = lowerFreq; i <= upperFreq; i++) {\n\t\t\t\t\tif (i < 0 || i >= Config.harmonicsControlPoints) continue;\n\t\t\t\t\tharmonicsWave.harmonics[i] = Math.max(0, Math.min(Config.harmonicsMax, Math.round(i * slope + offset)));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tharmonicsWave.harmonics[Math.max(0, Math.min(Config.harmonicsControlPoints - 1, Math.round(freq)))] = Math.max(0, Math.min(Config.harmonicsMax, Math.round(amp)));\n\t\t\t\n\t\t\tthis._freqPrev = freq;\n\t\t\tthis._ampPrev = amp;\n\t\t\t\n\t\t\tthis._change = new ChangeHarmonics(this._doc, instrument, harmonicsWave);\n\t\t\tthis._doc.setProspectiveChange(this._change);\n\t\t}\n\t}\n\t\n\tprivate _whenCursorReleased = (event: Event): void => {\n\t\tif (this._mouseDown) {\n\t\t\tthis._doc.record(this._change!);\n\t\t\tthis._change = null;\n\t\t}\n\t\tthis._mouseDown = false;\n\t}\n\t\n\tpublic render(): void {\n\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tconst harmonicsWave: HarmonicsWave = instrument.harmonicsWave; //(this._harmonicsIndex == null) ? instrument.harmonicsWave : instrument.drumsetSpectrumWaves[this._harmonicsIndex];\n\t\tconst controlPointToHeight = (point: number): number => {\n\t\t\treturn (1 - (point / Config.harmonicsMax)) * this._editorHeight;\n\t\t}\n\t\t\n\t\tlet bottom: string = prettyNumber(this._editorHeight);\n\t\tlet path: string = \"\";\n\t\tfor (let i: number = 0; i < Config.harmonicsControlPoints - 1; i++) {\n\t\t\tif (harmonicsWave.harmonics[i] == 0) continue;\n\t\t\tlet xPos: string = prettyNumber((i + 0.5) * (this._editorWidth - 8) / (Config.harmonicsControlPoints - 1));\n\t\t\tpath += \"M \" + xPos + \" \" + bottom + \" \";\n\t\t\tpath += \"L \" + xPos + \" \" + prettyNumber(controlPointToHeight(harmonicsWave.harmonics[i])) + \" \";\n\t\t}\n\t\t\n\t\tconst lastHeight: number = controlPointToHeight(harmonicsWave.harmonics[Config.harmonicsControlPoints - 1]);\n\t\tfor (let i: number = 0; i < 4; i++) {\n\t\t\tconst rect: SVGRectElement = this._lastControlPoints[i];\n\t\t\trect.setAttribute(\"y\", prettyNumber(lastHeight));\n\t\t\trect.setAttribute(\"height\", prettyNumber(this._editorHeight - lastHeight));\n\t\t}\n\t\t\n\t\tif (this._renderedPath != path) {\n\t\t\tthis._renderedPath = path;\n\t\t\tthis._curve.setAttribute(\"d\", path);\n\t\t}\n\t\tif (this._renderedFifths != this._doc.showFifth) {\n\t\t\tthis._renderedFifths = this._doc.showFifth;\n\t\t\tthis._fifths.style.display = this._doc.showFifth ? \"\" : \"none\";\n\t\t}\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\nimport {ColorConfig} from \"./ColorConfig\";\n\nexport class BarScrollBar {\n\tprivate readonly _editorWidth: number = 512;\n\tprivate readonly _editorHeight: number = 20;\n\t\n\tprivate readonly _notches: SVGSVGElement = SVG.svg({\"pointer-events\": \"none\"});\n\tprivate readonly _handle: SVGRectElement = SVG.rect({fill: ColorConfig.uiWidgetBackground, x: 0, y: 2, width: 10, height: this._editorHeight - 4});\n\tprivate readonly _handleHighlight: SVGRectElement = SVG.rect({fill: \"none\", stroke: ColorConfig.hoverPreview, \"stroke-width\": 2, \"pointer-events\": \"none\", x: 0, y: 1, width: 10, height: this._editorHeight - 2});\n\tprivate readonly _leftHighlight: SVGPathElement = SVG.path({fill: ColorConfig.hoverPreview, \"pointer-events\": \"none\"});\n\tprivate readonly _rightHighlight: SVGPathElement = SVG.path({fill: ColorConfig.hoverPreview, \"pointer-events\": \"none\"});\n\t\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `background-color: ${ColorConfig.editorBackground}; touch-action: pan-y; position: absolute;`, width: this._editorWidth, height: this._editorHeight},\n\t\tthis._notches,\n\t\tthis._handle,\n\t\tthis._handleHighlight,\n\t\tthis._leftHighlight,\n\t\tthis._rightHighlight,\n\t);\n\t\n\tpublic readonly container: HTMLElement = HTML.div({class: \"barScrollBar\", style: \"width: 512px; height: 20px; overflow: hidden; position: relative;\"}, this._svg);\n\t\n\tprivate _mouseX: number = 0;\n\t//private _mouseY: number = 0;\n\tprivate _mouseDown: boolean = false;\n\tprivate _mouseOver: boolean = false;\n\tprivate _dragging: boolean = false;\n\tprivate _dragStart: number;\n\tprivate _notchSpace: number;\n\tprivate _renderedNotchCount: number = -1;\n\tprivate _renderedBarPos: number = -1;\n\t\n\tconstructor(private _doc: SongDocument, private _trackContainer: HTMLDivElement) {\n\t\tconst center: number = this._editorHeight * 0.5;\n\t\tconst base: number = 20;\n\t\tconst tip: number = 9;\n\t\tconst arrowHeight: number = 6;\n\t\tthis._leftHighlight.setAttribute(\"d\", `M ${tip} ${center} L ${base} ${center + arrowHeight} L ${base} ${center - arrowHeight} z`);\n\t\tthis._rightHighlight.setAttribute(\"d\", `M ${this._editorWidth - tip} ${center} L ${this._editorWidth - base} ${center + arrowHeight} L ${this._editorWidth - base} ${center - arrowHeight} z`);\n\t\t\n\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\n\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\n\t\t\n\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\tthis.container.addEventListener(\"touchend\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"touchcancel\", this._whenCursorReleased);\n\t\t\n\t\t// Sorry, bypassing typescript type safety on this function because I want to use the new \"passive\" option.\n\t\t//this._trackContainer.addEventListener(\"scroll\", this._onScroll, {capture: false, passive: true});\n\t\t(<Function>this._trackContainer.addEventListener)(\"scroll\", this._onScroll, {capture: false, passive: true});\n\t}\n\t\n\tprivate _onScroll = (event: Event): void => {\n\t\tthis._doc.barScrollPos = (this._trackContainer.scrollLeft / this._doc.getBarWidth());\n\t\t//this._doc.notifier.changed();\n\t}\n\t\n\tprivate _whenMouseOver = (event: MouseEvent): void => {\n\t\tif (this._mouseOver) return;\n\t\tthis._mouseOver = true;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMouseOut = (event: MouseEvent): void => {\n\t\tif (!this._mouseOver) return;\n\t\tthis._mouseOver = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\t//this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\n\t\tthis._updatePreview();\n\t\tif (this._mouseX >= this._doc.barScrollPos * this._notchSpace && this._mouseX <= (this._doc.barScrollPos + this._doc.trackVisibleBars) * this._notchSpace) {\n\t\t\tthis._dragging = true;\n\t\t\tthis._dragStart = this._mouseX;\n\t\t}\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\t//this._mouseY = event.touches[0].clientY - boundingRect.top;\n\t\tthis._updatePreview();\n\t\tif (this._mouseX >= this._doc.barScrollPos * this._notchSpace && this._mouseX <= (this._doc.barScrollPos + this._doc.trackVisibleBars) * this._notchSpace) {\n\t\t\tthis._dragging = true;\n\t\t\tthis._dragStart = this._mouseX;\n\t\t}\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\t//this._mouseY = (event.clientY || event.pageY) - boundingRect.top;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tif (!this._mouseDown) return;\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\tthis._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\t//this._mouseY = event.touches[0].clientY - boundingRect.top;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenCursorMoved(): void {\n\t\tif (this._dragging) {\n\t\t\twhile (this._mouseX - this._dragStart < -this._notchSpace * 0.5) {\n\t\t\t\tif (this._doc.barScrollPos > 0) {\n\t\t\t\t\tthis._doc.barScrollPos--;\n\t\t\t\t\tthis._dragStart -= this._notchSpace;\n\t\t\t\t\tthis._doc.notifier.changed();\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (this._mouseX - this._dragStart > this._notchSpace * 0.5) {\n\t\t\t\tif (this._doc.barScrollPos < this._doc.song.barCount - this._doc.trackVisibleBars) {\n\t\t\t\t\tthis._doc.barScrollPos++;\n\t\t\t\t\tthis._dragStart += this._notchSpace;\n\t\t\t\t\tthis._doc.notifier.changed();\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this._mouseOver) this._updatePreview();\n\t}\n\t\n\tprivate _whenCursorReleased = (event: Event): void => {\n\t\tif (!this._dragging && this._mouseDown) {\n\t\t\tif (this._mouseX < (this._doc.barScrollPos + 8) * this._notchSpace) {\n\t\t\t\tif (this._doc.barScrollPos > 0) this._doc.barScrollPos--;\n\t\t\t\tthis._doc.notifier.changed();\n\t\t\t} else {\n\t\t\t\tif (this._doc.barScrollPos < this._doc.song.barCount - this._doc.trackVisibleBars) this._doc.barScrollPos++;\n\t\t\t\tthis._doc.notifier.changed();\n\t\t\t}\n\t\t}\n\t\tthis._mouseDown = false;\n\t\tthis._dragging = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _updatePreview(): void {\n\t\tconst showHighlight: boolean = this._mouseOver && !this._mouseDown;\n\t\tlet showleftHighlight: boolean = false;\n\t\tlet showRightHighlight: boolean = false;\n\t\tlet showHandleHighlight: boolean = false;\n\t\t\n\t\tif (showHighlight) {\n\t\t\tif (this._mouseX < this._doc.barScrollPos * this._notchSpace) {\n\t\t\t\tshowleftHighlight = true;\n\t\t\t} else if (this._mouseX > (this._doc.barScrollPos + this._doc.trackVisibleBars) * this._notchSpace) {\n\t\t\t\tshowRightHighlight = true;\n\t\t\t} else {\n\t\t\t\tshowHandleHighlight = true;\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._leftHighlight.style.visibility = showleftHighlight ? \"visible\" : \"hidden\";\n\t\tthis._rightHighlight.style.visibility = showRightHighlight ? \"visible\" : \"hidden\";\n\t\tthis._handleHighlight.style.visibility = showHandleHighlight ? \"visible\" : \"hidden\";\n\t}\n\t\n\tpublic render(): void {\n\t\tthis._notchSpace = (this._editorWidth-1) / Math.max(this._doc.trackVisibleBars, this._doc.song.barCount);\n\t\t\n\t\tconst resized: boolean = this._renderedNotchCount != this._doc.song.barCount;\n\t\tif (resized) {\n\t\t\tthis._renderedNotchCount = this._doc.song.barCount;\n\t\t\t\n\t\t\twhile (this._notches.firstChild) this._notches.removeChild(this._notches.firstChild);\n\t\t\t\n\t\t\tfor (let i: number = 0; i <= this._doc.song.barCount; i++) {\n\t\t\t\tconst lineHeight: number = (i % 16 == 0) ? 0 : ((i % 4 == 0) ? this._editorHeight / 8 : this._editorHeight / 3);\n\t\t\t\tthis._notches.appendChild(SVG.rect({fill: ColorConfig.uiWidgetBackground, x: i * this._notchSpace - 1, y: lineHeight, width: 2, height: this._editorHeight - lineHeight * 2}));\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (resized || this._renderedBarPos != this._doc.barScrollPos) {\n\t\t\tthis._renderedBarPos = this._doc.barScrollPos;\n\t\t\tthis._handle.setAttribute(\"x\", String(this._notchSpace * this._doc.barScrollPos));\n\t\t\tthis._handle.setAttribute(\"width\", String(this._notchSpace * this._doc.trackVisibleBars));\n\t\t\tthis._handleHighlight.setAttribute(\"x\", String(this._notchSpace * this._doc.barScrollPos));\n\t\t\tthis._handleHighlight.setAttribute(\"width\", String(this._notchSpace * this._doc.trackVisibleBars));\n\t\t}\n\t\t\n\t\tthis._updatePreview();\n\t\t\n\t\tthis._trackContainer.scrollLeft = this._doc.barScrollPos * this._doc.getBarWidth();\n\t\tthis._trackContainer.scrollTop = this._doc.channelScrollPos * this._doc.getChannelHeight();\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML, SVG} from \"imperative-html/dist/esm/elements-strict\";\nimport {ChangeOctave} from \"./changes\";\nimport {ColorConfig} from \"./ColorConfig\";\n\nexport class OctaveScrollBar {\n\tprivate readonly _editorWidth: number = 20;\n\tprivate readonly _editorHeight: number = 481;\n\tprivate readonly _notchHeight: number = 4.0;\n\tprivate readonly _octaveCount: number = Config.pitchOctaves;\n\tprivate readonly _octaveHeight: number = (this._editorHeight - this._notchHeight) / this._octaveCount;\n\t\n\tprivate readonly _handle: SVGRectElement = SVG.rect({fill: ColorConfig.uiWidgetBackground, x: 2, y: 0, width: this._editorWidth - 4});\n\tprivate readonly _handleHighlight: SVGRectElement = SVG.rect({fill: \"none\", stroke: ColorConfig.hoverPreview, \"stroke-width\": 2, \"pointer-events\": \"none\", x: 1, y: 0, width: this._editorWidth - 2});\n\tprivate readonly _upHighlight: SVGPathElement = SVG.path({fill: ColorConfig.hoverPreview, \"pointer-events\": \"none\"});\n\tprivate readonly _downHighlight: SVGPathElement = SVG.path({fill: ColorConfig.hoverPreview, \"pointer-events\": \"none\"});\n\t\n\tprivate readonly _svg: SVGSVGElement = SVG.svg({style: `background-color: ${ColorConfig.editorBackground}; touch-action: pan-x; position: absolute;`, width: this._editorWidth, height: \"100%\", viewBox: \"0 0 20 481\", preserveAspectRatio: \"none\"});\n\tpublic readonly container: HTMLDivElement = HTML.div({id: \"octaveScrollBarContainer\", style: \"width: 20px; height: 100%; overflow: hidden; position: relative; flex-shrink: 0;\"}, this._svg);\n\t\n\t//private _mouseX: number = 0;\n\tprivate _mouseY: number = 0;\n\tprivate _mouseDown: boolean = false;\n\tprivate _mouseOver: boolean = false;\n\tprivate _dragging: boolean = false;\n\tprivate _dragStart: number;\n\tprivate _barBottom: number;\n\tprivate _barHeight: number;\n\tprivate _renderedBarBottom: number = -1;\n\tprivate _renderedVisibleOctaveCount: number = -1;\n\tprivate _change: ChangeOctave | null = null;\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._doc.notifier.watch(this._documentChanged);\n\t\tthis._documentChanged();\n\t\t\n\t\tthis._svg.appendChild(this._handle);\n\t\t\n\t\t// notches:\n\t\tfor (let i: number = 0; i <= this._octaveCount; i++) {\n\t\t\tthis._svg.appendChild(SVG.rect({fill: ColorConfig.tonic, x: 0, y: i * this._octaveHeight, width: this._editorWidth, height: this._notchHeight}));\n\t\t}\n\t\t\n\t\tthis._svg.appendChild(this._handleHighlight);\n\t\tthis._svg.appendChild(this._upHighlight);\n\t\tthis._svg.appendChild(this._downHighlight);\n\t\t\n\t\tconst center: number = this._editorWidth * 0.5;\n\t\tconst base: number = 20;\n\t\tconst tip: number = 9;\n\t\tconst arrowWidth: number = 6;\n\t\tthis._upHighlight.setAttribute(\"d\", `M ${center} ${tip} L ${center + arrowWidth} ${base} L ${center - arrowWidth} ${base} z`);\n\t\tthis._downHighlight.setAttribute(\"d\", `M ${center} ${this._editorHeight - tip} L ${center + arrowWidth} ${this._editorHeight - base} L ${center - arrowWidth} ${this._editorHeight - base} z`);\n\t\t\n\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\n\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\n\t\t\n\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\tthis.container.addEventListener(\"touchend\", this._whenCursorReleased);\n\t\tthis.container.addEventListener(\"touchcancel\", this._whenCursorReleased);\n\t}\n\t\n\tprivate _whenMouseOver = (event: MouseEvent): void => {\n\t\tif (this._mouseOver) return;\n\t\tthis._mouseOver = true;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMouseOut = (event: MouseEvent): void => {\n\t\tif (!this._mouseOver) return;\n\t\tthis._mouseOver = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\t//this._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tif (this._doc.song.getChannelIsNoise(this._doc.channel)) return;\n\t\tthis._updatePreview();\n\t\t\n\t\tif (this._mouseY >= this._barBottom - this._barHeight && this._mouseY <= this._barBottom) {\n\t\t\tthis._dragging = true;\n\t\t\tthis._change = null;\n\t\t\tthis._dragStart = this._mouseY;\n\t\t}\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\t//this._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tif (this._doc.song.getChannelIsNoise(this._doc.channel)) return;\n\t\tthis._updatePreview();\n\t\t\n\t\tif (this._mouseY >= this._barBottom - this._barHeight && this._mouseY <= this._barBottom) {\n\t\t\tthis._dragging = true;\n\t\t\tthis._change = null;\n\t\t\tthis._dragStart = this._mouseY;\n\t\t}\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\t//this._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tif (!this._mouseDown) return;\n\t\tevent.preventDefault();\n\t\tconst boundingRect: ClientRect = this._svg.getBoundingClientRect();\n\t\t//this._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._whenCursorMoved();\n\t}\n\t\n\tprivate _whenCursorMoved(): void {\n\t\tif (this._doc.song.getChannelIsNoise(this._doc.channel)) return;\n\t\tif (this._dragging) {\n\t\t\tconst visibleOctaveCount: number = this._doc.getVisibleOctaveCount();\n\t\t\tconst scrollableOctaves: number = Config.pitchOctaves - visibleOctaveCount;\n\t\t\tconst continuingProspectiveChange: boolean = this._doc.lastChangeWas(this._change);\n\t\t\tconst oldValue: number = continuingProspectiveChange ? this._change!.oldValue : this._doc.song.channels[this._doc.channel].octave;\n\t\t\t\n\t\t\tconst currentOctave: number = this._doc.getBaseVisibleOctave(this._doc.channel);\n\t\t\tlet octave: number = currentOctave;\n\t\t\twhile (this._mouseY - this._dragStart < -this._octaveHeight * 0.5) {\n\t\t\t\tif (octave < scrollableOctaves) {\n\t\t\t\t\toctave++;\n\t\t\t\t\tthis._dragStart -= this._octaveHeight;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (this._mouseY - this._dragStart > this._octaveHeight * 0.5) {\n\t\t\t\tif (octave > 0) {\n\t\t\t\t\toctave--;\n\t\t\t\t\tthis._dragStart += this._octaveHeight;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis._change = new ChangeOctave(this._doc, oldValue, Math.floor(octave + visibleOctaveCount * 0.5));\n\t\t\tthis._doc.setProspectiveChange(this._change);\n\t\t}\n\t\t\n\t\tif (this._mouseOver) this._updatePreview();\n\t}\n\t\n\tprivate _whenCursorReleased = (event: Event): void => {\n\t\tif (!this._doc.song.getChannelIsNoise(this._doc.channel) && this._mouseDown) {\n\t\t\tif (this._dragging) {\n\t\t\t\tif (this._change != null) this._doc.record(this._change);\n\t\t\t} else {\n\t\t\t\tconst visibleOctaveCount: number = this._doc.getVisibleOctaveCount();\n\t\t\t\tconst scrollableOctaves: number = Config.pitchOctaves - visibleOctaveCount;\n\t\t\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._change);\n\t\t\t\tconst oldValue: number = canReplaceLastChange ? this._change!.oldValue : this._doc.song.channels[this._doc.channel].octave;\n\t\t\t\n\t\t\t\tconst currentOctave: number = this._doc.getBaseVisibleOctave(this._doc.channel);\n\t\t\t\tif (this._mouseY < this._barBottom - this._barHeight * 0.5) {\n\t\t\t\t\tif (currentOctave < scrollableOctaves) {\n\t\t\t\t\t\tthis._change = new ChangeOctave(this._doc, oldValue, Math.floor(currentOctave + 1 + visibleOctaveCount * 0.5));\n\t\t\t\t\t\tthis._doc.record(this._change, canReplaceLastChange);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (currentOctave > 0) {\n\t\t\t\t\t\tthis._change = new ChangeOctave(this._doc, oldValue, Math.floor(currentOctave - 1 + visibleOctaveCount * 0.5));\n\t\t\t\t\t\tthis._doc.record(this._change, canReplaceLastChange);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._mouseDown = false;\n\t\tthis._dragging = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _updatePreview(): void {\n\t\tconst showHighlight: boolean = this._mouseOver && !this._mouseDown;\n\t\tlet showUpHighlight: boolean = false;\n\t\tlet showDownHighlight: boolean = false;\n\t\tlet showHandleHighlight: boolean = false;\n\t\t\n\t\tif (showHighlight) {\n\t\t\tif (this._mouseY < this._barBottom - this._barHeight) {\n\t\t\t\tshowUpHighlight = true;\n\t\t\t} else if (this._mouseY > this._barBottom) {\n\t\t\t\tshowDownHighlight = true;\n\t\t\t} else {\n\t\t\t\tshowHandleHighlight = true;\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._upHighlight.style.visibility = showUpHighlight ? \"inherit\" : \"hidden\";\n\t\tthis._downHighlight.style.visibility = showDownHighlight ? \"inherit\" : \"hidden\";\n\t\tthis._handleHighlight.style.visibility = showHandleHighlight ? \"inherit\" : \"hidden\";\n\t}\n\t\n\tprivate _documentChanged = (): void => {\n\t\tthis._barBottom = this._editorHeight - (this._octaveHeight * this._doc.getBaseVisibleOctave(this._doc.channel));\n\t\tthis._svg.style.visibility = (this._doc.song.getChannelIsNoise(this._doc.channel)) ? \"hidden\" : \"visible\";\n\t\tconst visibleOctaveCount: number = this._doc.getVisibleOctaveCount();\n\t\tif (this._renderedBarBottom != this._barBottom || this._renderedVisibleOctaveCount != visibleOctaveCount) {\n\t\t\tthis._renderedBarBottom = this._barBottom;\n\t\t\tthis._renderedVisibleOctaveCount = visibleOctaveCount;\n\t\t\tthis._barHeight = (this._octaveHeight * visibleOctaveCount + this._notchHeight);\n\t\t\tthis._handle.setAttribute(\"height\", String(this._barHeight));\n\t\t\tthis._handleHighlight.setAttribute(\"height\", String(this._barHeight));\n\t\t\tthis._handle.setAttribute(\"y\", String(this._barBottom - this._barHeight));\n\t\t\tthis._handleHighlight.setAttribute(\"y\", String(this._barBottom - this._barHeight));\n\t\t}\n\t\tthis._updatePreview();\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {SongDocument} from \"./SongDocument\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {ColorConfig} from \"./ColorConfig\";\n\nexport class Piano {\n\tprivate readonly _pianoContainer: HTMLDivElement = HTML.div({style: \"width: 100%; height: 100%; display: flex; flex-direction: column-reverse; align-items: stretch;\"});\n\tprivate readonly _drumContainer: HTMLDivElement = HTML.div({style: \"width: 100%; height: 100%; display: flex; flex-direction: column-reverse; align-items: stretch;\"});\n\tprivate readonly _preview: HTMLDivElement = HTML.div({style: `width: 100%; height: 40px; border: 2px solid ${ColorConfig.primaryText}; position: absolute; box-sizing: border-box; pointer-events: none;`});\n\tpublic readonly container: HTMLDivElement = HTML.div({style: \"width: 32px; height: 100%; overflow: hidden; position: relative; flex-shrink: 0; touch-action: none;\"},\n\t\tthis._pianoContainer,\n\t\tthis._drumContainer,\n\t\tthis._preview,\n\t);\n\tprivate readonly _editorHeight: number = 481;\n\tprivate readonly _pianoKeys: HTMLDivElement[] = [];\n\tprivate readonly _pianoLabels: HTMLDivElement[] = [];\n\t\n\tprivate _pitchHeight: number;\n\tprivate _pitchCount: number;\n\t//private _mouseX: number = 0;\n\tprivate _mouseY: number = 0;\n\tprivate _mouseDown: boolean = false;\n\tprivate _mouseOver: boolean = false;\n\tprivate _cursorPitch: number;\n\tprivate _playedPitch: number = -1;\n\tprivate _renderedScale: number = -1;\n\tprivate _renderedDrums: boolean = false;\n\tprivate _renderedKey: number = -1;\n\tprivate _renderedPitchCount: number = -1;\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tfor (let i: number = 0; i < Config.drumCount; i++) {\n\t\t\tconst scale: number = (1.0 - (i / Config.drumCount) * 0.35) * 100;\n\t\t\tconst brightness: number = 1.0 + ((i - Config.drumCount / 2.0) / Config.drumCount) * 0.5;\n\t\t\tthis._drumContainer.appendChild(HTML.div({class: \"drum-button\", style: `background-size: ${scale}% ${scale}%; filter: brightness(${brightness})`}));\n\t\t}\n\t\t\n\t\tthis.container.addEventListener(\"mousedown\", this._whenMousePressed);\n\t\tdocument.addEventListener(\"mousemove\", this._whenMouseMoved);\n\t\tdocument.addEventListener(\"mouseup\", this._whenMouseReleased);\n\t\tthis.container.addEventListener(\"mouseover\", this._whenMouseOver);\n\t\tthis.container.addEventListener(\"mouseout\", this._whenMouseOut);\n\t\t\n\t\tthis.container.addEventListener(\"touchstart\", this._whenTouchPressed);\n\t\tthis.container.addEventListener(\"touchmove\", this._whenTouchMoved);\n\t\tthis.container.addEventListener(\"touchend\", this._whenTouchReleased);\n\t\tthis.container.addEventListener(\"touchcancel\", this._whenTouchReleased);\n\t\t\n\t\tthis._doc.notifier.watch(this._documentChanged);\n\t\tthis._documentChanged();\n\t}\n\t\n\tprivate _updateCursorPitch(): void {\n\t\tconst scale: ReadonlyArray<boolean> = Config.scales[this._doc.song.scale].flags;\n\t\tconst mousePitch: number = Math.max(0, Math.min(this._pitchCount-1, this._pitchCount - (this._mouseY / this._pitchHeight)));\n\t\tif (scale[Math.floor(mousePitch) % Config.pitchesPerOctave] || this._doc.song.getChannelIsNoise(this._doc.channel)) {\n\t\t\tthis._cursorPitch = Math.floor(mousePitch);\n\t\t} else {\n\t\t\tlet topPitch: number = Math.floor(mousePitch) + 1;\n\t\t\tlet bottomPitch: number = Math.floor(mousePitch) - 1;\n\t\t\twhile (!scale[topPitch % Config.pitchesPerOctave]) {\n\t\t\t\ttopPitch++;\n\t\t\t}\n\t\t\twhile (!scale[(bottomPitch) % Config.pitchesPerOctave]) {\n\t\t\t\tbottomPitch--;\n\t\t\t}\n\t\t\tlet topRange: number = topPitch;\n\t\t\tlet bottomRange: number = bottomPitch + 1;\n\t\t\tif (topPitch % Config.pitchesPerOctave == 0 || topPitch % Config.pitchesPerOctave == 7) {\n\t\t\t\ttopRange -= 0.5;\n\t\t\t}\n\t\t\tif (bottomPitch % Config.pitchesPerOctave == 0 || bottomPitch % Config.pitchesPerOctave == 7) {\n\t\t\t\tbottomRange += 0.5;\n\t\t\t}\n\t\t\tthis._cursorPitch = mousePitch - bottomRange > topRange - mousePitch ? topPitch : bottomPitch;\n\t\t}\n\t}\n\t\n\tprivate _playLiveInput(): void {\n\t\tconst octaveOffset: number = this._doc.getBaseVisibleOctave(this._doc.channel) * Config.pitchesPerOctave;\n\t\tconst currentPitch: number = this._cursorPitch + octaveOffset;\n\t\tif (this._playedPitch == currentPitch) return;\n\t\tthis._playedPitch = currentPitch;\n\t\tthis._doc.synth.liveInputDuration = Number.MAX_SAFE_INTEGER;\n\t\tthis._doc.synth.liveInputPitches = [this._playedPitch];\n\t\tthis._doc.synth.liveInputStarted = true;\n\t}\n\t\n\tprivate _releaseLiveInput(): void {\n\t\tthis._playedPitch = -1;\n\t\tthis._doc.synth.liveInputDuration = 0;\n\t}\n\t\n\tprivate _whenMouseOver = (event: MouseEvent): void => {\n\t\tif (this._mouseOver) return;\n\t\tthis._mouseOver = true;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMouseOut = (event: MouseEvent): void => {\n\t\tif (!this._mouseOver) return;\n\t\tthis._mouseOver = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMousePressed = (event: MouseEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._doc.synth.maintainLiveInput();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\n\t\t//this._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._playLiveInput();\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMouseMoved = (event: MouseEvent): void => {\n\t\tif (this._mouseDown || this._mouseOver) this._doc.synth.maintainLiveInput();\n\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\n\t\t//this._mouseX = (event.clientX || event.pageX) - boundingRect.left;\n\t\tthis._mouseY = ((event.clientY || event.pageY) - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._updateCursorPitch();\n\t\tif (this._mouseDown) this._playLiveInput();\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenMouseReleased = (event: MouseEvent): void => {\n\t\tif (this._mouseDown) this._releaseLiveInput();\n\t\tthis._mouseDown = false;\n\t\tthis._updatePreview();\n\t}\n\t\n\tprivate _whenTouchPressed = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._doc.synth.maintainLiveInput();\n\t\tthis._mouseDown = true;\n\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\n\t\t//this._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._updateCursorPitch();\n\t\tthis._playLiveInput();\n\t}\n\t\n\tprivate _whenTouchMoved = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._doc.synth.maintainLiveInput();\n\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\n\t\t//this._mouseX = event.touches[0].clientX - boundingRect.left;\n\t\tthis._mouseY = (event.touches[0].clientY - boundingRect.top) * this._editorHeight / (boundingRect.bottom - boundingRect.top);\n\t\tif (isNaN(this._mouseY)) this._mouseY = 0;\n\t\tthis._updateCursorPitch();\n\t\tif (this._mouseDown) this._playLiveInput();\n\t}\n\t\n\tprivate _whenTouchReleased = (event: TouchEvent): void => {\n\t\tevent.preventDefault();\n\t\tthis._releaseLiveInput();\n\t}\n\t\n\tprivate _updatePreview(): void {\n\t\tthis._preview.style.visibility = (!this._mouseOver || this._mouseDown) ? \"hidden\" : \"visible\";\n\t\tif (!this._mouseOver || this._mouseDown) return;\n\t\t\n\t\tconst boundingRect: ClientRect = this.container.getBoundingClientRect();\n\t\tconst pitchHeight: number = this._pitchHeight / (this._editorHeight / (boundingRect.bottom - boundingRect.top));\n\t\t\n\t\tthis._preview.style.left = \"0px\";\n\t\tthis._preview.style.top = pitchHeight * (this._pitchCount - this._cursorPitch - 1) + \"px\";\n\t\tthis._preview.style.height = pitchHeight + \"px\";\n\t}\n\t\n\tprivate _documentChanged = (): void => {\n\t\tconst isDrum: boolean = this._doc.song.getChannelIsNoise(this._doc.channel);\n\t\tthis._pitchCount = isDrum ? Config.drumCount : this._doc.getVisiblePitchCount();\n\t\tthis._pitchHeight = this._editorHeight / this._pitchCount;\n\t\tthis._updateCursorPitch();\n\t\tif (this._mouseDown) this._playLiveInput();\n\t\tthis._doc.synth.liveInputChannel = this._doc.channel;\n\t\tthis._doc.synth.liveInputInstruments = this._doc.recentPatternInstruments[this._doc.channel];\n\t\t\n\t\tif (!this._doc.showLetters) return;\n\t\tif (this._renderedScale == this._doc.song.scale && this._renderedKey == this._doc.song.key && this._renderedDrums == isDrum && this._renderedPitchCount == this._pitchCount) return;\n\t\t\n\t\tthis._renderedScale = this._doc.song.scale;\n\t\tthis._renderedKey = this._doc.song.key;\n\t\tthis._renderedDrums = isDrum;\n\t\t\n\t\tthis._pianoContainer.style.display = isDrum ? \"none\" : \"flex\";\n\t\tthis._drumContainer.style.display = isDrum ? \"flex\" : \"none\";\n\t\t\n\t\tif (!isDrum) {\n\t\t\tif (this._renderedPitchCount != this._pitchCount) {\n\t\t\t\tthis._pianoContainer.innerHTML = \"\";\n\t\t\t\tfor (let i: number = 0; i < this._pitchCount; i++) {\n\t\t\t\t\tconst pianoLabel: HTMLDivElement = HTML.div({class: \"piano-label\", style: \"font-weight: bold; -webkit-text-stroke-width: 0; font-size: 11px; font-family: sans-serif; position: absolute; padding-left: 15px;\"});\n\t\t\t\t\tconst pianoKey: HTMLDivElement = HTML.div({class: \"piano-button\", style: \"background: gray;\"}, pianoLabel);\n\t\t\t\t\tthis._pianoContainer.appendChild(pianoKey);\n\t\t\t\t\tthis._pianoLabels[i] = pianoLabel;\n\t\t\t\t\tthis._pianoKeys[i] = pianoKey;\n\t\t\t\t}\n\t\t\t\tthis._pianoLabels.length = this._pitchCount;\n\t\t\t\tthis._pianoKeys.length = this._pitchCount;\n\t\t\t\tthis._renderedPitchCount = this._pitchCount;\n\t\t\t}\n\t\t\t\n\t\t\tfor (let j: number = 0; j < this._pitchCount; j++) {\n\t\t\t\tconst pitchNameIndex: number = (j + Config.keys[this._doc.song.key].basePitch) % Config.pitchesPerOctave;\n\t\t\t\tconst isWhiteKey: boolean = Config.keys[pitchNameIndex].isWhiteKey;\n\t\t\t\tthis._pianoKeys[j].style.background = isWhiteKey ? ColorConfig.whitePianoKey : ColorConfig.blackPianoKey;\n\t\t\t\tif (!Config.scales[this._doc.song.scale].flags[j % Config.pitchesPerOctave]) {\n\t\t\t\t\tthis._pianoKeys[j].classList.add(\"disabled\");\n\t\t\t\t\tthis._pianoLabels[j].style.display = \"none\";\n\t\t\t\t} else {\n\t\t\t\t\tthis._pianoKeys[j].classList.remove(\"disabled\");\n\t\t\t\t\tthis._pianoLabels[j].style.display = \"\";\n\t\t\t\t\t\n\t\t\t\t\tlet text: string;\n\t\t\t\t\t\n\t\t\t\t\tif (Config.keys[pitchNameIndex].isWhiteKey) {\n\t\t\t\t\t\ttext = Config.keys[pitchNameIndex].name;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst shiftDir: number = Config.blackKeyNameParents[j % Config.pitchesPerOctave];\n\t\t\t\t\t\ttext = Config.keys[(pitchNameIndex + Config.pitchesPerOctave + shiftDir) % Config.pitchesPerOctave].name;\n\t\t\t\t\t\tif (shiftDir == 1) {\n\t\t\t\t\t\t\ttext += \"♭\";\n\t\t\t\t\t\t} else if (shiftDir == -1) {\n\t\t\t\t\t\t\ttext += \"♯\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst label: HTMLDivElement = this._pianoLabels[j];\n\t\t\t\t\tlabel.style.color = Config.keys[pitchNameIndex].isWhiteKey ? \"black\" : \"white\";\n\t\t\t\t\tlabel.textContent = text;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._updatePreview();\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {SongDocument} from \"./SongDocument\";\nimport {Prompt} from \"./Prompt\";\nimport {ChangeBeatsPerBar} from \"./changes\";\nimport {ColorConfig} from \"./ColorConfig\";\n\nconst {button, div, span, h2, input, br, select, option} = HTML;\n\nexport class BeatsPerBarPrompt implements Prompt {\n\tprivate readonly _beatsStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\n\tprivate readonly _conversionStrategySelect: HTMLSelectElement = select({style: \"width: 100%;\"},\n\t\toption({value: \"splice\"}, \"Splice beats at end of bars.\"),\n\t\toption({value: \"stretch\"}, \"Stretch notes to fit in bars.\"),\n\t\toption({value: \"overflow\"}, \"Overflow notes across bars.\"),\n\t);\n\tprivate readonly _cancelButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\tprivate readonly _okayButton: HTMLButtonElement = button({class: \"okayButton\", style: \"width:45%;\"}, \"Okay\");\n\t\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt noSelection\", style: \"width: 250px;\"},\n\t\th2(\"Beats Per Bar\"),\n\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\tdiv({style: \"text-align: right;\"},\n\t\t\t\t\"Beats per bar:\",\n\t\t\t\tbr(),\n\t\t\t\tspan({style: `font-size: smaller; color: ${ColorConfig.secondaryText};`}, \"(Multiples of 3 or 4 are recommended)\"),\n\t\t\t),\n\t\t\tthis._beatsStepper,\n\t\t),\n\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\tdiv({class: \"selectContainer\", style: \"width: 100%;\"}, this._conversionStrategySelect),\n\t\t),\n\t\tdiv({style: \"display: flex; flex-direction: row-reverse; justify-content: space-between;\"},\n\t\t\tthis._okayButton,\n\t\t),\n\t\tthis._cancelButton,\n\t);\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._beatsStepper.value = this._doc.song.beatsPerBar + \"\";\n\t\tthis._beatsStepper.min = Config.beatsPerBarMin + \"\";\n\t\tthis._beatsStepper.max = Config.beatsPerBarMax + \"\";\n\t\t\n\t\tconst lastStrategy: string | null = window.localStorage.getItem(\"beatCountStrategy\");\n\t\tif (lastStrategy != null) {\n\t\t\tthis._conversionStrategySelect.value = lastStrategy;\n\t\t}\n\t\t\n\t\tthis._beatsStepper.select();\n\t\tsetTimeout(()=>this._beatsStepper.focus());\n\t\t\n\t\tthis._okayButton.addEventListener(\"click\", this._saveChanges);\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\n\t\tthis._beatsStepper.addEventListener(\"keypress\", BeatsPerBarPrompt._validateKey);\n\t\tthis._beatsStepper.addEventListener(\"blur\", BeatsPerBarPrompt._validateNumber);\n\t\tthis.container.addEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => { \n\t\tthis._okayButton.removeEventListener(\"click\", this._saveChanges);\n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\n\t\tthis._beatsStepper.removeEventListener(\"keypress\", BeatsPerBarPrompt._validateKey);\n\t\tthis._beatsStepper.removeEventListener(\"blur\", BeatsPerBarPrompt._validateNumber);\n\t\tthis.container.removeEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\n\t\tif ((<Element> event.target).tagName != \"BUTTON\" && event.keyCode == 13) { // Enter key\n\t\t\tthis._saveChanges();\n\t\t}\n\t}\n\t\n\tprivate static _validateKey(event: KeyboardEvent): boolean {\n\t\tconst charCode = (event.which) ? event.which : event.keyCode;\n\t\tif (charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57)) {\n\t\t\tevent.preventDefault();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tprivate static _validateNumber(event: Event): void {\n\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\n\t\tinput.value = String(BeatsPerBarPrompt._validate(input));\n\t}\n\t\n\tprivate static _validate(input: HTMLInputElement): number {\n\t\treturn Math.floor(Math.max(Number(input.min), Math.min(Number(input.max), Number(input.value))));\n\t}\n\t\n\tprivate _saveChanges = (): void => {\n\t\twindow.localStorage.setItem(\"beatCountStrategy\", this._conversionStrategySelect.value);\n\t\tthis._doc.prompt = null;\n\t\tthis._doc.record(new ChangeBeatsPerBar(this._doc, BeatsPerBarPrompt._validate(this._beatsStepper), this._conversionStrategySelect.value), true);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {SongDocument} from \"./SongDocument\";\nimport {Prompt} from \"./Prompt\";\nimport {ChangeMoveNotesSideways} from \"./changes\";\nimport {ColorConfig} from \"./ColorConfig\";\n\nconst {button, div, span, h2, input, br, select, option} = HTML;\n\nexport class MoveNotesSidewaysPrompt implements Prompt {\n\tprivate readonly _beatsStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"0.01\", value: \"0\"});\n\tprivate readonly _conversionStrategySelect: HTMLSelectElement = select({style: \"width: 100%;\"},\n\t\toption({value: \"overflow\"}, \"Overflow notes across bars.\"),\n\t\toption({value: \"wrapAround\"}, \"Wrap notes around within bars.\"),\n\t);\n\tprivate readonly _cancelButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\tprivate readonly _okayButton: HTMLButtonElement = button({class: \"okayButton\", style: \"width:45%;\"}, \"Okay\");\n\t\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt noSelection\", style: \"width: 250px;\"},\n\t\th2(\"Move Notes Sideways\"),\n\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\tdiv({style: \"text-align: right;\"},\n\t\t\t\t\"Beats to move:\",\n\t\t\t\tbr(),\n\t\t\t\tspan({style: `font-size: smaller; color: ${ColorConfig.secondaryText};`}, \"(Negative is left, positive is right)\"),\n\t\t\t),\n\t\t\tthis._beatsStepper,\n\t\t),\n\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\tdiv({class: \"selectContainer\", style: \"width: 100%;\"}, this._conversionStrategySelect),\n\t\t),\n\t\tdiv({style: \"display: flex; flex-direction: row-reverse; justify-content: space-between;\"},\n\t\t\tthis._okayButton,\n\t\t),\n\t\tthis._cancelButton,\n\t);\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._beatsStepper.min = (-this._doc.song.beatsPerBar) + \"\";\n\t\tthis._beatsStepper.max = this._doc.song.beatsPerBar + \"\";\n\t\t\n\t\tconst lastStrategy: string | null = window.localStorage.getItem(\"moveNotesSidewaysStrategy\");\n\t\tif (lastStrategy != null) {\n\t\t\tthis._conversionStrategySelect.value = lastStrategy;\n\t\t}\n\t\t\n\t\tthis._beatsStepper.select();\n\t\tsetTimeout(()=>this._beatsStepper.focus());\n\t\t\n\t\tthis._okayButton.addEventListener(\"click\", this._saveChanges);\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\n\t\tthis._beatsStepper.addEventListener(\"blur\", MoveNotesSidewaysPrompt._validateNumber);\n\t\tthis.container.addEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => { \n\t\tthis._okayButton.removeEventListener(\"click\", this._saveChanges);\n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\n\t\tthis._beatsStepper.removeEventListener(\"blur\", MoveNotesSidewaysPrompt._validateNumber);\n\t\tthis.container.removeEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\n\t\tif ((<Element> event.target).tagName != \"BUTTON\" && event.keyCode == 13) { // Enter key\n\t\t\tthis._saveChanges();\n\t\t}\n\t}\n\t\n\tprivate static _validateNumber(event: Event): void {\n\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\n\t\tlet value: number = +input.value;\n\t\tvalue = Math.round(value * Config.partsPerBeat) / Config.partsPerBeat;\n\t\tvalue = Math.round(value * 100) / 100;\n\t\tinput.value = Math.max(+input.min, Math.min(+input.max, value)) + \"\";\n\t}\n\t\n\tprivate _saveChanges = (): void => {\n\t\twindow.localStorage.setItem(\"moveNotesSidewaysStrategy\", this._conversionStrategySelect.value);\n\t\tthis._doc.prompt = null;\n\t\tthis._doc.record(new ChangeMoveNotesSideways(this._doc, +this._beatsStepper.value, this._conversionStrategySelect.value), true);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {SongDocument} from \"./SongDocument\";\nimport {Prompt} from \"./Prompt\";\nimport {ChangeGroup} from \"./Change\";\nimport {ChangeBarCount} from \"./changes\";\nimport {ColorConfig} from \"./ColorConfig\";\n\nconst {button, div, span, h2, input, br, select, option} = HTML;\n\nexport class SongDurationPrompt implements Prompt {\n\tprivate readonly _barsStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\n\tprivate readonly _positionSelect: HTMLSelectElement = select({style: \"width: 100%;\"},\n\t\toption({value: \"end\"},       \"Apply change at end of song.\"),\n\t\toption({value: \"beginning\"}, \"Apply change at beginning of song.\"),\n\t);\n\tprivate readonly _cancelButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\tprivate readonly _okayButton: HTMLButtonElement = button({class: \"okayButton\", style: \"width:45%;\"}, \"Okay\");\n\t\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt noSelection\", style: \"width: 250px;\"},\n\t\th2(\"Song Length\"),\n\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\tdiv({style: \"display: inline-block; text-align: right;\"},\n\t\t\t\t\"Bars per song:\",\n\t\t\t\tbr(),\n\t\t\t\tspan({style: `font-size: smaller; color: ${ColorConfig.secondaryText};`}, \"(Multiples of 4 are recommended)\"),\n\t\t\t),\n\t\t\tthis._barsStepper,\n\t\t),\n\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\tdiv({class: \"selectContainer\", style: \"width: 100%;\"}, this._positionSelect),\n\t\t),\n\t\tdiv({style: \"display: flex; flex-direction: row-reverse; justify-content: space-between;\"},\n\t\t\tthis._okayButton,\n\t\t),\n\t\tthis._cancelButton,\n\t);\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._barsStepper.value = this._doc.song.barCount + \"\";\n\t\tthis._barsStepper.min = Config.barCountMin + \"\";\n\t\tthis._barsStepper.max = Config.barCountMax + \"\";\n\t\t\n\t\tconst lastPosition: string | null = window.localStorage.getItem(\"barCountPosition\");\n\t\tif (lastPosition != null) {\n\t\t\tthis._positionSelect.value = lastPosition;\n\t\t}\n\t\t\n\t\tthis._barsStepper.select();\n\t\tsetTimeout(()=>this._barsStepper.focus());\n\t\t\n\t\tthis._okayButton.addEventListener(\"click\", this._saveChanges);\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\n\t\tthis._barsStepper.addEventListener(\"keypress\", SongDurationPrompt._validateKey);\n\t\tthis._barsStepper.addEventListener(\"blur\", SongDurationPrompt._validateNumber);\n\t\tthis.container.addEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => {\n\t\tthis._okayButton.removeEventListener(\"click\", this._saveChanges);\n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\n\t\tthis._barsStepper.removeEventListener(\"keypress\", SongDurationPrompt._validateKey);\n\t\tthis._barsStepper.removeEventListener(\"blur\", SongDurationPrompt._validateNumber);\n\t\tthis.container.removeEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\n\t\tif ((<Element> event.target).tagName != \"BUTTON\" && event.keyCode == 13) { // Enter key\n\t\t\tthis._saveChanges();\n\t\t}\n\t}\n\t\n\tprivate static _validateKey(event: KeyboardEvent): boolean {\n\t\tconst charCode = (event.which) ? event.which : event.keyCode;\n\t\tif (charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57)) {\n\t\t\tevent.preventDefault();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tprivate static _validateNumber(event: Event): void {\n\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\n\t\tinput.value = String(SongDurationPrompt._validate(input));\n\t}\n\t\n\tprivate static _validate(input: HTMLInputElement): number {\n\t\treturn Math.floor(Math.max(Number(input.min), Math.min(Number(input.max), Number(input.value))));\n\t}\n\t\n\tprivate _saveChanges = (): void => {\n\t\twindow.localStorage.setItem(\"barCountPosition\", this._positionSelect.value);\n\t\tconst group: ChangeGroup = new ChangeGroup();\n\t\tgroup.append(new ChangeBarCount(this._doc, SongDurationPrompt._validate(this._barsStepper), this._positionSelect.value == \"beginning\"));\n\t\tthis._doc.prompt = null;\n\t\tthis._doc.record(group, true);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Config} from \"../synth/SynthConfig\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {SongDocument} from \"./SongDocument\";\nimport {Prompt} from \"./Prompt\";\nimport {ChangeGroup} from \"./Change\";\nimport {ChangePatternsPerChannel, ChangeInstrumentsFlags, ChangeChannelCount} from \"./changes\";\n\nconst {button, div, label, br, h2, input} = HTML;\n\nexport class ChannelSettingsPrompt implements Prompt {\n\tprivate readonly _patternsStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\n\tprivate readonly _pitchChannelStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\n\tprivate readonly _drumChannelStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"number\", step: \"1\"});\n\tprivate readonly _layeredInstrumentsBox: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"checkbox\"});\n\tprivate readonly _patternInstrumentsBox: HTMLInputElement = input({style: \"width: 3em; margin-left: 1em;\", type: \"checkbox\"});\n\tprivate readonly _cancelButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\tprivate readonly _okayButton: HTMLButtonElement = button({class: \"okayButton\", style: \"width:45%;\"}, \"Okay\");\n\t\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt noSelection\", style: \"width: 250px; text-align: right;\"},\n\t\th2(\"Channel Settings\"),\n\t\tlabel({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\t\"Pitch channels:\",\n\t\t\tthis._pitchChannelStepper,\n\t\t),\n\t\tlabel({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\t\"Drum channels:\",\n\t\t\tthis._drumChannelStepper,\n\t\t),\n\t\tlabel({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\t\"Available patterns per channel:\",\n\t\t\tthis._patternsStepper,\n\t\t),\n\t\tlabel({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\t\"Simultaneous instruments\",\n\t\t\tbr(),\n\t\t\t\"per channel:\",\n\t\t\tthis._layeredInstrumentsBox,\n\t\t),\n\t\tlabel({style: \"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;\"},\n\t\t\t\"Different instruments\",\n\t\t\tbr(),\n\t\t\t\"per pattern:\",\n\t\t\tthis._patternInstrumentsBox,\n\t\t),\n\t\tlabel({style: \"display: flex; flex-direction: row-reverse; justify-content: space-between;\"},\n\t\t\tthis._okayButton,\n\t\t),\n\t\tthis._cancelButton,\n\t);\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._patternsStepper.value = this._doc.song.patternsPerChannel + \"\";\n\t\tthis._patternsStepper.min = \"1\";\n\t\tthis._patternsStepper.max = Config.barCountMax + \"\";\n\t\t\n\t\tthis._pitchChannelStepper.value = this._doc.song.pitchChannelCount + \"\";\n\t\tthis._pitchChannelStepper.min = Config.pitchChannelCountMin + \"\";\n\t\tthis._pitchChannelStepper.max = Config.pitchChannelCountMax + \"\";\n\t\t\n\t\tthis._drumChannelStepper.value = this._doc.song.noiseChannelCount + \"\";\n\t\tthis._drumChannelStepper.min = Config.noiseChannelCountMin + \"\";\n\t\tthis._drumChannelStepper.max = Config.noiseChannelCountMax + \"\";\n\t\t\n\t\tthis._layeredInstrumentsBox.checked = this._doc.song.layeredInstruments;\n\t\tthis._patternInstrumentsBox.checked = this._doc.song.patternInstruments;\n\t\t\n\t\tthis._pitchChannelStepper.select();\n\t\tsetTimeout(()=>this._pitchChannelStepper.focus());\n\t\t\n\t\tthis._okayButton.addEventListener(\"click\", this._saveChanges);\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\n\t\tthis._patternsStepper.addEventListener(\"keypress\", ChannelSettingsPrompt._validateKey);\n\t\tthis._pitchChannelStepper.addEventListener(\"keypress\", ChannelSettingsPrompt._validateKey);\n\t\tthis._drumChannelStepper.addEventListener(\"keypress\", ChannelSettingsPrompt._validateKey);\n\t\tthis._patternsStepper.addEventListener(\"blur\", this._validateNumber);\n\t\tthis._pitchChannelStepper.addEventListener(\"blur\", this._validateNumber);\n\t\tthis._drumChannelStepper.addEventListener(\"blur\", this._validateNumber);\n\t\tthis.container.addEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => { \n\t\tthis._okayButton.removeEventListener(\"click\", this._saveChanges);\n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\n\t\tthis._patternsStepper.removeEventListener(\"keypress\", ChannelSettingsPrompt._validateKey);\n\t\tthis._pitchChannelStepper.removeEventListener(\"keypress\", ChannelSettingsPrompt._validateKey);\n\t\tthis._drumChannelStepper.removeEventListener(\"keypress\", ChannelSettingsPrompt._validateKey);\n\t\tthis._patternsStepper.removeEventListener(\"blur\", this._validateNumber);\n\t\tthis._pitchChannelStepper.removeEventListener(\"blur\", this._validateNumber);\n\t\tthis._drumChannelStepper.removeEventListener(\"blur\", this._validateNumber);\n\t\tthis.container.removeEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\n\t\tif ((<Element> event.target).tagName != \"BUTTON\" && event.keyCode == 13) { // Enter key\n\t\t\tthis._saveChanges();\n\t\t}\n\t}\n\t\n\tprivate static _validateKey(event: KeyboardEvent): boolean {\n\t\tconst charCode = (event.which) ? event.which : event.keyCode;\n\t\tif (charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57)) {\n\t\t\tevent.preventDefault();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tprivate _validateNumber = (event: Event): void => {\n\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\n\t\tinput.value = String(ChannelSettingsPrompt._validate(input));\n\t}\n\t\n\tprivate static _validate(input: HTMLInputElement): number {\n\t\treturn Math.floor(Math.max(Number(input.min), Math.min(Number(input.max), Number(input.value))));\n\t}\n\t\n\tprivate _saveChanges = (): void => {\n\t\tconst group: ChangeGroup = new ChangeGroup();\n\t\tgroup.append(new ChangeInstrumentsFlags(this._doc, this._layeredInstrumentsBox.checked, this._patternInstrumentsBox.checked));\n\t\tgroup.append(new ChangePatternsPerChannel(this._doc, ChannelSettingsPrompt._validate(this._patternsStepper)));\n\t\tgroup.append(new ChangeChannelCount(this._doc, ChannelSettingsPrompt._validate(this._pitchChannelStepper), ChannelSettingsPrompt._validate(this._drumChannelStepper)));\n\t\tthis._doc.prompt = null;\n\t\tthis._doc.record(group, true);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nfunction transfer(source: ArrayBuffer, length: number): ArrayBuffer {\n\tconst dest: ArrayBuffer = new ArrayBuffer(length);\n\tlet nextOffset = 0;\n\tlet leftBytes = Math.min(source.byteLength, dest.byteLength);\n\tconst wordSizes = [8, 4, 2, 1];\n\tfor (const wordSize of wordSizes) {\n\t\tif (leftBytes >= wordSize) {\n\t\t\tconst done = transferWith(wordSize, source, dest, nextOffset, leftBytes);\n\t\t\tnextOffset = done.nextOffset;\n\t\t\tleftBytes = done.leftBytes;\n\t\t}\n\t}\n\treturn dest;\n\tfunction transferWith(wordSize: number, source: ArrayBuffer, dest: ArrayBuffer, nextOffset: number, leftBytes: number) {\n\t\tlet ViewClass: any = Uint8Array;\n\t\tswitch (wordSize) {\n\t\t\tcase 8:\n\t\t\t\tViewClass = Float64Array;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tViewClass = Float32Array;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tViewClass = Uint16Array;\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tViewClass = Uint8Array;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tViewClass = Uint8Array;\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\tconst view_source = new ViewClass(source, nextOffset, (leftBytes / wordSize) | 0);\n\t\tconst view_dest = new ViewClass(dest, nextOffset, (leftBytes / wordSize) | 0);\n\t\tfor (let i: number = 0; i < view_dest.length; i++) {\n\t\t\tview_dest[i] = view_source[i];\n\t\t}\n\t\treturn {\n\t\t\tnextOffset : view_source.byteOffset + view_source.byteLength,\n\t\t\tleftBytes : leftBytes - view_dest.length * wordSize,\n\t\t}\n\t}\n}\n\n// Note: All methods are big endian.\nexport class ArrayBufferWriter {\n\tprivate _writeIndex: number = 0;\n\tprivate _fileSize: number = 0;\n\tprivate _arrayBuffer: ArrayBuffer;\n\tprivate _data: DataView;\n\t\n\tconstructor(initialCapacity: number) {\n\t\tthis._arrayBuffer = new ArrayBuffer(initialCapacity);\n\t\tthis._data = new DataView(this._arrayBuffer);\n\t}\n\t\n\tprivate _addBytes(numBytes: number): void {\n\t\tthis._fileSize += numBytes;\n\t\tif (this._fileSize > this._arrayBuffer.byteLength) {\n\t\t\tthis._arrayBuffer = transfer(this._arrayBuffer, Math.max(this._arrayBuffer.byteLength * 2, this._fileSize));\n\t\t\tthis._data = new DataView(this._arrayBuffer);\n\t\t}\n\t}\n\t\n\tpublic getWriteIndex(): number {\n\t\treturn this._writeIndex;\n\t}\n\t\n\tpublic rewriteUint32(index: number, value: number): void {\n\t\tthis._data.setUint32(index, value >>> 0, false);\n\t}\n\t\n\tpublic writeUint32(value: number): void {\n\t\tvalue = value >>> 0;\n\t\tthis._addBytes(4);\n\t\tthis._data.setUint32(this._writeIndex, value, false);\n\t\tthis._writeIndex = this._fileSize;\n\t}\n\t\n\tpublic writeUint24(value: number): void {\n\t\tvalue = value >>> 0;\n\t\tthis._addBytes(3);\n\t\tthis._data.setUint8(this._writeIndex  , (value>>16)&0xff);\n\t\tthis._data.setUint8(this._writeIndex+1, (value>> 8)&0xff);\n\t\tthis._data.setUint8(this._writeIndex+2, (value    )&0xff);\n\t\tthis._writeIndex = this._fileSize;\n\t}\n\t\n\tpublic writeUint16(value: number): void {\n\t\tvalue = value >>> 0;\n\t\tthis._addBytes(2);\n\t\tthis._data.setUint16(this._writeIndex, value, false);\n\t\tthis._writeIndex = this._fileSize;\n\t}\n\t\n\tpublic writeUint8(value: number): void {\n\t\tvalue = value >>> 0;\n\t\tthis._addBytes(1);\n\t\tthis._data.setUint8(this._writeIndex, value);\n\t\tthis._writeIndex = this._fileSize;\n\t}\n\t\n\tpublic writeInt8(value: number): void {\n\t\tvalue = value | 0;\n\t\tthis._addBytes(1);\n\t\tthis._data.setInt8(this._writeIndex, value);\n\t\tthis._writeIndex = this._fileSize;\n\t}\n\t\n\tpublic writeMidi7Bits(value: number): void {\n\t\tvalue = value >>> 0;\n\t\tif (value >= 0x80) throw new Error(\"7 bit value contained 8th bit!\");\n\t\tthis._addBytes(1);\n\t\tthis._data.setUint8(this._writeIndex, value);\n\t\tthis._writeIndex = this._fileSize;\n\t}\n\t\n\tpublic writeMidiVariableLength(value: number): void {\n\t\tvalue = value >>> 0;\n\t\tif (value > 0x0fffffff) throw new Error(\"writeVariableLength value too big.\");\n\t\tlet startWriting: boolean = false;\n\t\tfor (let i: number = 0; i < 4; i++) {\n\t\t\tconst shift: number = 21 - i * 7;\n\t\t\tconst bits: number = (value >>> shift) & 0x7f;\n\t\t\tif (bits != 0 || i == 3) startWriting = true; // skip leading zero bytes, but always write the last byte even if it's zero. \n\t\t\tif (startWriting) this.writeUint8((i == 3 ? 0x00 : 0x80) | bits);\n\t\t}\n\t}\n\t\n\tpublic writeMidiAscii(string: string): void {\n\t\tthis.writeMidiVariableLength(string.length);\n\t\tfor (let i: number = 0; i < string.length; i++) {\n\t\t\tconst charCode: number = string.charCodeAt(i);\n\t\t\tif (charCode > 0x7f) throw new Error(\"Trying to write unicode character as ascii.\");\n\t\t\tthis.writeUint8(charCode); // technically charCodeAt returns 2 byte values, but this string should contain exclusively 1 byte values.\n\t\t}\n\t}\n\t\n\tpublic toCompactArrayBuffer(): ArrayBuffer {\n\t\treturn transfer(this._arrayBuffer, this._fileSize);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nexport const defaultMidiExpression: number = 0x7F;\nexport const defaultMidiPitchBend: number = 0x2000;\n\nexport const enum MidiChunkType {\n\theader = 0x4D546864, // \"MThd\" as bytes, big endian\n\ttrack = 0x4D54726B, // \"MTrk\" as bytes, big endian\n}\n\nexport const enum MidiFileFormat {\n\tsingleTrack = 0x0000,\n\tsimultaneousTracks = 0x0001,\n\tindependentTracks = 0x0002,\n}\n\n// Lower 4 bits indicate channel, except for meta and sysex events.\nexport const enum MidiEventType {\n\t//channelMode = 0x70,\n\tnoteOff = 0x80,\n\tnoteOn = 0x90,\n\tkeyPressure = 0xA0,\n\tcontrolChange = 0xB0,\n\tprogramChange = 0xC0,\n\tchannelPressure = 0xD0,\n\tpitchBend = 0xE0,\n\tmetaAndSysex = 0xF0,\n\t\n\t// These events are identified by all 8 bits.\n\tmeta = 0xFF,\n\t// sysexStart = 0xF0,\n\t// sysexEscape = 0xF7,\n}\n\nexport const enum MidiControlEventMessage {\n\t\n\tsetParameterMSB = 0x06,\n\tvolumeMSB = 0x07,\n\tpanMSB = 0x0A,\n\texpressionMSB = 0x0B,\n\t\n\tsetParameterLSB = 0x26,\n\t//volumeLSB = 0x27,\n\t//expressionLSB = 0x2B,\n\t\n\t//nonRegisteredParameterNumberLSB = 0x62,\n\t//nonRegisteredParameterNumberMSB = 0x63,\n\tregisteredParameterNumberLSB = 0x64,\n\tregisteredParameterNumberMSB = 0x65,\n\t\n\t// Channel mode messages:\n\t/*\n\tallSoundOff = 0x78,\n\tresetControllers = 0x79,\n\tlocalControl = 0x7A,\n\tallNotesOff = 0x7B,\n\tomniModeOff = 0x7C,\n\tomniModeOn = 0x7D,\n\tmonoMode = 0x7E,\n\tpolyphonicMode = 0x7F,\n\t*/\n}\n\nexport const enum MidiRegisteredParameterNumberMSB {\n\tpitchBendRange = 0x00, // semitones\n\tfineTuning = 0x00,\n\tcoarseTuning = 0x00,\n\ttuningProgramSelect = 0x00,\n\ttuningBankSelect = 0x00,\n\treset = 0x7f,\n}\n\nexport const enum MidiRegisteredParameterNumberLSB {\n\tpitchBendRange = 0x00, // cents\n\tfineTuning = 0x01,\n\tcoarseTuning = 0x02,\n\ttuningProgramSelect = 0x03,\n\ttuningBankSelect = 0x04,\n\treset = 0x7f,\n}\n\nexport const enum MidiMetaEventMessage {\n\tsequenceNumber = 0x00,\n\ttext = 0x01,\n\tcopyrightNotice = 0x02,\n\ttrackName = 0x03,\n\tinstrumentName = 0x04,\n\tlyricText = 0x05,\n\tmarker = 0x06,\n\tcuePoint = 0x07,\n\tchannelPrefix = 0x20,\n\tendOfTrack = 0x2F,\n\ttempo = 0x51,\n\tsmpteOffset = 0x54,\n\ttimeSignature = 0x58,\n\tkeySignature = 0x59,\n\tsequencerSpecificEvent = 0x7F,\n}\n\n// BeepBox noise channels are very different from Midi drumsets, but here's my attempt at a conversion from Midi to BeepBox.\nexport interface AnalogousDrum {\n\tfrequency: number;\n\tduration: number;\n\tvolume: number;\n}\nexport const analogousDrumMap: { [K: number]: AnalogousDrum } = {\n\t35: { frequency:  0, duration: 2, volume: 3 }, // Acoustic Bass Drum\n\t36: { frequency:  0, duration: 2, volume: 3 }, // Bass Drum 1\n\t37: { frequency:  5, duration: 1, volume: 3 }, // Side Stick\n\t38: { frequency:  4, duration: 2, volume: 3 }, // Acoustic Snare\n\t39: { frequency:  5, duration: 2, volume: 3 }, // Hand Clap\n\t40: { frequency:  4, duration: 2, volume: 3 }, // Electric Snare\n\t41: { frequency:  1, duration: 2, volume: 3 }, // Low Floor Tom\n\t42: { frequency:  8, duration: 1, volume: 3 }, // Closed Hi Hat\n\t43: { frequency:  1, duration: 2, volume: 3 }, // High Floor Tom\n\t44: { frequency:  8, duration: 1, volume: 2 }, // Pedal Hi-Hat\n\t45: { frequency:  2, duration: 2, volume: 3 }, // Low Tom\n\t46: { frequency:  8, duration: 4, volume: 3 }, // Open Hi-Hat\n\t47: { frequency:  2, duration: 2, volume: 3 }, // Low-Mid Tom\n\t48: { frequency:  3, duration: 2, volume: 3 }, // Hi-Mid Tom\n\t49: { frequency:  7, duration: 4, volume: 3 }, // Crash Cymbal 1\n\t50: { frequency:  3, duration: 2, volume: 3 }, // High Tom\n\t51: { frequency:  6, duration: 4, volume: 2 }, // Ride Cymbal 1\n\t52: { frequency:  7, duration: 4, volume: 3 }, // Chinese Cymbal\n\t53: { frequency:  6, duration: 2, volume: 3 }, // Ride Bell\n\t54: { frequency: 11, duration: 2, volume: 3 }, // Tambourine\n\t55: { frequency:  9, duration: 4, volume: 3 }, // Splash Cymbal\n\t56: { frequency:  7, duration: 1, volume: 2 }, // Cowbell\n\t57: { frequency:  7, duration: 4, volume: 3 }, // Crash Cymbal 2\n\t58: { frequency: 10, duration: 2, volume: 2 }, // Vibraslap\n\t59: { frequency:  6, duration: 4, volume: 3 }, // Ride Cymbal 2\n\t//60: { frequency:  7, duration: 1, volume: 3 }, // Hi Bongo\n\t//61: { frequency:  5, duration: 1, volume: 3 }, // Low Bongo\n\t//62: { frequency:  6, duration: 1, volume: 3 }, // Mute Hi Conga\n\t//63: { frequency:  5, duration: 1, volume: 3 }, // Open Hi Conga\n\t//64: { frequency:  4, duration: 1, volume: 3 }, // Low Conga\n\t//65: { frequency:  6, duration: 2, volume: 3 }, // High Timbale\n\t//66: { frequency:  4, duration: 2, volume: 3 }, // Low Timbale\n\t//67: { frequency: 10, duration: 1, volume: 2 }, // High Agogo\n\t//68: { frequency:  9, duration: 1, volume: 2 }, // Low Agogo\n\t69: { frequency: 10, duration: 2, volume: 3 }, // Cabasa\n\t70: { frequency: 10, duration: 2, volume: 3 }, // Maracas\n\t//71: { frequency: 10, duration: 2, volume: 3 }, // Short Whistle\n\t//72: { frequency:  9, duration: 2, volume: 3 }, // Long Whistle\n\t73: { frequency: 10, duration: 1, volume: 2 }, // Short Guiro\n\t74: { frequency: 10, duration: 2, volume: 2 }, // Long Guiro\n\t//75: { frequency: 10, duration: 1, volume: 2 }, // Claves\n\t//76: { frequency:  6, duration: 1, volume: 2 }, // Hi Wood Block\n\t//77: { frequency:  5, duration: 1, volume: 2 }, // Low Wood Block\n\t//78: { frequency:  6, duration: 2, volume: 3 }, // Mute Cuica\n\t//79: { frequency:  4, duration: 2, volume: 3 }, // Open Cuica\n\t//80: { frequency:  7, duration: 1, volume: 2 }, // Mute Triangle\n\t//81: { frequency:  7, duration: 4, volume: 2 }, // Open Triangle\n};\n\nexport function midiVolumeToVolumeMult(volume: number): number {\n\t// default midi volume is 100, pow(100/127,4)≈0.384 so I'm considering that the baseline volume.\n\treturn Math.pow(volume / 127, 4.0) / 0.3844015376046128;\n}\nexport function volumeMultToMidiVolume(volumeMult: number): number {\n\treturn Math.pow(volumeMult * 0.3844015376046128, 0.25) * 127;\n}\nexport function midiExpressionToVolumeMult(expression: number): number {\n\treturn Math.pow(expression / 127, 4.0);\n}\nexport function volumeMultToMidiExpression(volumeMult: number): number {\n\treturn Math.pow(volumeMult, 0.25) * 127;\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {InstrumentType, /*EnvelopeType,*/ Config, getArpeggioPitchIndex} from \"../synth/SynthConfig\";\nimport {Instrument, Pattern, Note, Song, Synth} from \"../synth/synth\";\nimport {ColorConfig} from \"./ColorConfig\";\nimport {Preset, EditorConfig} from \"./EditorConfig\";\nimport {SongDocument} from \"./SongDocument\";\nimport {Prompt} from \"./Prompt\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {ArrayBufferWriter} from \"./ArrayBufferWriter\";\nimport {MidiChunkType, MidiFileFormat, MidiControlEventMessage, MidiEventType, MidiMetaEventMessage, MidiRegisteredParameterNumberMSB, MidiRegisteredParameterNumberLSB, volumeMultToMidiVolume, volumeMultToMidiExpression, defaultMidiPitchBend, defaultMidiExpression} from \"./Midi\";\n\nconst {button, div, h2, input, select, option} = HTML;\n\nfunction lerp(low: number, high: number, t: number): number {\n\treturn low + t * (high - low);\n}\n\nfunction save(blob: Blob, name: string): void {\n\tif ((<any>navigator).msSaveOrOpenBlob) {\n\t\t(<any>navigator).msSaveOrOpenBlob(blob, name);\n\t\treturn;\n\t}\n\n\tconst anchor: HTMLAnchorElement = document.createElement(\"a\");\n\tif (anchor.download != undefined) {\n\t\tconst url: string = URL.createObjectURL(blob);\n\t\tsetTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\tanchor.href = url;\n\t\tanchor.download = name;\n\t\t// Chrome bug regression: We need to delay dispatching the click\n\t\t// event. Seems to be related to going back in the browser history.\n\t\t// https://bugs.chromium.org/p/chromium/issues/detail?id=825100\n\t\tsetTimeout(function() { anchor.dispatchEvent(new MouseEvent(\"click\")); }, 0);\n\t} else {\n\t\tconst url: string = URL.createObjectURL(blob);\n\t\tsetTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\tif (!window.open(url, \"_blank\")) window.location.href = url;\n\t}\n}\n\nexport class ExportPrompt implements Prompt {\n\tprivate readonly _fileName: HTMLInputElement = input({type: \"text\", style: \"width: 10em;\", value: \"BeepBox-Song\", maxlength: 250, \"autofocus\": \"autofocus\"});\n\tprivate readonly _enableIntro: HTMLInputElement = input({type: \"checkbox\"});\n\tprivate readonly _loopDropDown: HTMLInputElement = input({style:\"width: 2em;\", type: \"number\", min: \"1\", max: \"4\", step: \"1\"});\n\tprivate readonly _enableOutro: HTMLInputElement = input({type: \"checkbox\"});\n\tprivate readonly _formatSelect: HTMLSelectElement = select({style: \"width: 100%;\"},\n\t\toption({value: \"wav\"}, \".wav\"),\n\t\toption({value: \"mp3\"}, \".mp3\"),\n\t\toption({value: \"midi\"}, \".mid\"),\n\t\toption({value: \"json\"}, \".json (for any BeepBox version)\"),\n\t\toption({value: \"html\"}, \".html (opens BeepBox)\"),\n\t);\n\tprivate readonly _cancelButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\tprivate readonly _exportButton: HTMLButtonElement = button({class: \"exportButton\", style: \"width:45%;\"}, \"Export\");\n\tprivate static readonly midiChipInstruments: number[] = [\n\t\t0x4A, // rounded -> recorder\n\t\t0x47, // triangle -> clarinet\n\t\t0x50, // square -> square wave\n\t\t0x46, // ¹/₄ pulse -> bassoon\n\t\t0x44, // ¹/₈ pulse -> oboe\n\t\t0x51, // sawtooth -> sawtooth wave\n\t\t0x51, // double saw -> sawtooth wave\n\t\t0x51, // double pulse -> sawtooth wave\n\t\t0x51, // spiky -> sawtooth wave\n\t];\n\t\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt noSelection\", style: \"width: 200px;\"},\n\t\th2(\"Export Options\"),\n\t\tdiv({style: \"display: flex; flex-direction: row; align-items: center; justify-content: space-between;\"},\n\t\t\t\"File name:\",\n\t\t\tthis._fileName,\n\t\t),\n\t\tdiv({style: \"display: table; width: 100%;\"},\n\t\t\tdiv({style: \"display: table-row;\"},\n\t\t\t\tdiv({style: \"display: table-cell;\"}, \"Intro:\"),\n\t\t\t\tdiv({style: \"display: table-cell;\"}, \"Loop Count:\"),\n\t\t\t\tdiv({style: \"display: table-cell;\"}, \"Outro:\"),\n\t\t\t),\n\t\t\tdiv({style: \"display: table-row;\"},\n\t\t\t\tdiv({style: \"display: table-cell; vertical-align: middle;\"}, this._enableIntro),\n\t\t\t\tdiv({style: \"display: table-cell; vertical-align: middle;\"}, this._loopDropDown),\n\t\t\t\tdiv({style: \"display: table-cell; vertical-align: middle;\"}, this._enableOutro),\n\t\t\t),\n\t\t),\n\t\tdiv({style: \"text-align: left;\"}, \"File Type:\"),\n\t\tdiv({class: \"selectContainer\", style: \"width: 100%;\"}, this._formatSelect),\n\t\tdiv({style: \"text-align: left;\"}, \"(Be patient, exporting may take some time...)\"),\n\t\tdiv({style: \"display: flex; flex-direction: row-reverse; justify-content: space-between;\"},\n\t\t\tthis._exportButton,\n\t\t),\n\t\tthis._cancelButton,\n\t);\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._loopDropDown.value = \"1\";\n\t\t\n\t\tif (this._doc.song.loopStart == 0) {\n\t\t\tthis._enableIntro.checked = false;\n\t\t\tthis._enableIntro.disabled = true;\n\t\t} else {\n\t\t\tthis._enableIntro.checked = true;\n\t\t\tthis._enableIntro.disabled = false;\n\t\t}\n\t\tif (this._doc.song.loopStart + this._doc.song.loopLength == this._doc.song.barCount) {\n\t\t\tthis._enableOutro.checked = false;\n\t\t\tthis._enableOutro.disabled = true;\n\t\t} else {\n\t\t\tthis._enableOutro.checked = true;\n\t\t\tthis._enableOutro.disabled = false;\n\t\t}\n\t\t\n\t\tconst lastExportFormat: string | null = window.localStorage.getItem(\"exportFormat\");\n\t\tif (lastExportFormat != null) {\n\t\t\tthis._formatSelect.value = lastExportFormat;\n\t\t}\n\t\t\n\t\tthis._fileName.select();\n\t\tsetTimeout(()=>this._fileName.focus());\n\t\t\n\t\tthis._fileName.addEventListener(\"input\", ExportPrompt._validateFileName);\n\t\tthis._loopDropDown.addEventListener(\"blur\", ExportPrompt._validateNumber);\n\t\tthis._exportButton.addEventListener(\"click\", this._export);\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\n\t\tthis.container.addEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => { \n\t\tthis._fileName.removeEventListener(\"input\", ExportPrompt._validateFileName);\n\t\tthis._loopDropDown.removeEventListener(\"blur\", ExportPrompt._validateNumber);\n\t\tthis._exportButton.removeEventListener(\"click\", this._export);\n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\n\t\tthis.container.removeEventListener(\"keydown\", this._whenKeyPressed);\n\t}\n\t\n\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\n\t\tif ((<Element> event.target).tagName != \"BUTTON\" && event.keyCode == 13) { // Enter key\n\t\t\tthis._export();\n\t\t}\n\t}\n\t\n\tprivate static _validateFileName(event: Event): void {\n\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\n\t\tconst deleteChars = /[\\+\\*\\$\\?\\|\\{\\}\\\\\\/<>#%!`&'\"=:@]/gi;\n\t\tif (deleteChars.test(input.value)) {\n\t\t\tlet cursorPos: number = <number>input.selectionStart;\n\t\t\tinput.value = input.value.replace(deleteChars, \"\");\n\t\t\tcursorPos--;\n\t\t\tinput.setSelectionRange(cursorPos, cursorPos);\n\t\t}\n\t}\n\t\n\tprivate static _validateNumber(event: Event): void {\n\t\tconst input: HTMLInputElement = <HTMLInputElement>event.target;\n\t\tinput.value = Math.floor(Math.max(Number(input.min), Math.min(Number(input.max), Number(input.value)))) + \"\";\n\t}\n\t\n\tprivate _export = (): void => {\n\t\twindow.localStorage.setItem(\"exportFormat\", this._formatSelect.value);\n\t\tswitch(this._formatSelect.value) {\n\t\t\tcase \"wav\":\n\t\t\t\tthis._exportToWav();\n\t\t\t\tbreak;\n\t\t\tcase \"mp3\":\n\t\t\t\tthis._exportToMp3();\n\t\t\t\tbreak;\n\t\t\tcase \"midi\":\n\t\t\t\tthis._exportToMidi();\n\t\t\t\tbreak;\n\t\t\tcase \"json\":\n\t\t\t\tthis._exportToJson();\n\t\t\t\tbreak;\n\t\t\tcase \"html\":\n\t\t\t\tthis._exportToHtml();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"Unhandled file export type.\");\n\t\t}\n\t}\n\t\n\tprivate _synthesize(sampleRate: number): {recordedSamplesL: Float32Array, recordedSamplesR: Float32Array} {\n\t\tconst synth: Synth = new Synth(this._doc.song);\n\t\tsynth.samplesPerSecond = sampleRate;\n\t\tsynth.loopRepeatCount = Number(this._loopDropDown.value) - 1;\n\t\tif (!this._enableIntro.checked) {\n\t\t\tfor (let introIter: number = 0; introIter < this._doc.song.loopStart; introIter++) {\n\t\t\t\tsynth.goToNextBar();\n\t\t\t}\n\t\t}\n\t\tconst sampleFrames: number = Math.ceil(synth.getSamplesPerBar() * synth.getTotalBars(this._enableIntro.checked, this._enableOutro.checked));\n\t\tconst recordedSamplesL: Float32Array = new Float32Array(sampleFrames);\n\t\tconst recordedSamplesR: Float32Array = new Float32Array(sampleFrames);\n\t\t//const timer: number = performance.now();\n\t\tsynth.synthesize(recordedSamplesL, recordedSamplesR, sampleFrames);\n\t\t//console.log(\"export timer\", (performance.now() - timer) / 1000.0);\n\t\t\n\t\treturn {recordedSamplesL, recordedSamplesR};\n\t}\n\t\n\tprivate _exportToWav(): void {\n\t\tconst sampleRate: number = 48000; // Use professional video editing standard sample rate for .wav file export.\n\t\tconst {recordedSamplesL, recordedSamplesR} = this._synthesize(sampleRate);\n\t\tconst sampleFrames: number = recordedSamplesL.length;\n\t\t\n\t\tconst wavChannelCount: number = 2;\n\t\tconst bytesPerSample: number = 2;\n\t\tconst bitsPerSample: number = 8 * bytesPerSample;\n\t\tconst sampleCount: number = wavChannelCount * sampleFrames;\n\t\t\n\t\tconst totalFileSize: number = 44 + sampleCount * bytesPerSample;\n\t\t\n\t\tlet index: number = 0;\n\t\tconst arrayBuffer: ArrayBuffer = new ArrayBuffer(totalFileSize);\n\t\tconst data: DataView = new DataView(arrayBuffer);\n\t\tdata.setUint32(index, 0x52494646, false); index += 4;\n\t\tdata.setUint32(index, 36 + sampleCount * bytesPerSample, true); index += 4; // size of remaining file\n\t\tdata.setUint32(index, 0x57415645, false); index += 4;\n\t\tdata.setUint32(index, 0x666D7420, false); index += 4;\n\t\tdata.setUint32(index, 0x00000010, true); index += 4; // size of following header\n\t\tdata.setUint16(index, 0x0001, true); index += 2; // not compressed\n\t\tdata.setUint16(index, wavChannelCount, true); index += 2; // channel count\n\t\tdata.setUint32(index, sampleRate, true); index += 4; // sample rate\n\t\tdata.setUint32(index, sampleRate * bytesPerSample * wavChannelCount, true); index += 4; // bytes per second\n\t\tdata.setUint16(index, bytesPerSample * wavChannelCount, true); index += 2; // block align\n\t\tdata.setUint16(index, bitsPerSample, true); index += 2; // bits per sample\n\t\tdata.setUint32(index, 0x64617461, false); index += 4;\n\t\tdata.setUint32(index, sampleCount * bytesPerSample, true); index += 4;\n\t\t\n\t\tif (bytesPerSample > 1) {\n\t\t\t// usually samples are signed. \n\t\t\tconst range: number = (1 << (bitsPerSample - 1)) - 1;\n\t\t\tfor (let i: number = 0; i < sampleFrames; i++) {\n\t\t\t\tlet valL: number = Math.floor(Math.max(-1, Math.min(1, recordedSamplesL[i])) * range);\n\t\t\t\tlet valR: number = Math.floor(Math.max(-1, Math.min(1, recordedSamplesR[i])) * range);\n\t\t\t\tif (bytesPerSample == 2) {\n\t\t\t\t\tdata.setInt16(index, valL, true); index += 2;\n\t\t\t\t\tdata.setInt16(index, valR, true); index += 2;\n\t\t\t\t} else if (bytesPerSample == 4) {\n\t\t\t\t\tdata.setInt32(index, valL, true); index += 4;\n\t\t\t\t\tdata.setInt32(index, valR, true); index += 4;\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(\"unsupported sample size\");\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// 8 bit samples are a special case: they are unsigned.\n\t\t\tfor (let i: number = 0; i < sampleFrames; i++) {\n\t\t\t\tlet valL: number = Math.floor(Math.max(-1, Math.min(1, recordedSamplesL[i])) * 127 + 128);\n\t\t\t\tlet valR: number = Math.floor(Math.max(-1, Math.min(1, recordedSamplesR[i])) * 127 + 128);\n\t\t\t\tdata.setUint8(index, valL > 255 ? 255 : (valL < 0 ? 0 : valL)); index++;\n\t\t\t\tdata.setUint8(index, valR > 255 ? 255 : (valR < 0 ? 0 : valR)); index++;\n\t\t\t}\n\t\t}\n\t\t\n\t\tconst blob: Blob = new Blob([arrayBuffer], {type: \"audio/wav\"});\n\t\tsave(blob, this._fileName.value.trim() + \".wav\");\n\t\tthis._close();\n\t}\n\t\n\tprivate _exportToMp3(): void {\n\t\tconst whenEncoderIsAvailable = (): void => {\n\t\t\tconst sampleRate: number = 44100; // Use consumer CD standard sample rate for .mp3 export.\n\t\t\tconst {recordedSamplesL, recordedSamplesR} = this._synthesize(sampleRate);\n\t\t\t\n\t\t\tconst lamejs: any = (<any> window)[\"lamejs\"];\n\t\t\tconst channelCount: number = 2;\n\t\t\tconst kbps: number = 192;\n\t\t\tconst sampleBlockSize: number = 1152;\n\t\t\tconst mp3encoder: any = new lamejs.Mp3Encoder(channelCount, sampleRate, kbps);\n\t\t\tconst mp3Data: any[] = [];\n\t\t\t\n\t\t\tconst left: Int16Array = new Int16Array(recordedSamplesL.length);\n\t\t\tconst right: Int16Array = new Int16Array(recordedSamplesR.length);\n\t\t\tconst range: number = (1 << 15) - 1;\n\t\t\tfor (let i: number = 0; i < recordedSamplesL.length; i++) {\n\t\t\t\tleft[i]  = Math.floor(Math.max(-1, Math.min(1, recordedSamplesL[i])) * range);\n\t\t\t\tright[i] = Math.floor(Math.max(-1, Math.min(1, recordedSamplesR[i])) * range);\n\t\t\t}\n\t\t\t\n\t\t\tfor (let i: number = 0; i < left.length; i += sampleBlockSize) {\n\t\t\t\tconst leftChunk: Int16Array = left.subarray(i, i + sampleBlockSize);\n\t\t\t\tconst rightChunk: Int16Array = right.subarray(i, i + sampleBlockSize);\n\t\t\t\tconst mp3buf: any = mp3encoder.encodeBuffer(leftChunk, rightChunk);\n\t\t\t\tif (mp3buf.length > 0) mp3Data.push(mp3buf);\n\t\t\t}\n\t\t\tconst mp3buf: any = mp3encoder.flush();\n\t\t\tif (mp3buf.length > 0) mp3Data.push(mp3buf);\n\t\t\t\n\t\t\tconst blob: Blob = new Blob(mp3Data, {type: \"audio/mp3\"});\n\t\t\tsave(blob, this._fileName.value.trim() + \".mp3\");\n\t\t\tthis._close();\n\t\t}\n\t\t\n\t\tif (\"lamejs\" in window) {\n\t\t\twhenEncoderIsAvailable();\n\t\t} else {\n\t\t\tvar script = document.createElement(\"script\");\n\t\t\tscript.src = \"https://cdn.jsdelivr.net/npm/lamejs@1.2.0/lame.min.js\";\n\t\t\tscript.onload = whenEncoderIsAvailable;\n\t\t\tdocument.head.appendChild(script);\n\t\t}\n\t}\n\t\n\tprivate _exportToMidi(): void {\n\t\tconst song: Song = this._doc.song;\n\t\tconst midiTicksPerBeepBoxTick: number = 2;\n\t\tconst midiTicksPerBeat: number = midiTicksPerBeepBoxTick * Config.ticksPerPart * Config.partsPerBeat;\n\t\tconst midiTicksPerPart: number = midiTicksPerBeepBoxTick * Config.ticksPerPart;\n\t\tconst secondsPerMinute: number = 60;\n\t\tconst microsecondsPerMinute: number = secondsPerMinute * 1000000;\n\t\tconst beatsPerMinute: number = song.getBeatsPerMinute();\n\t\tconst microsecondsPerBeat: number = Math.round(microsecondsPerMinute / beatsPerMinute);\n\t\t//const secondsPerMidiTick: number = secondsPerMinute / (midiTicksPerBeat * beatsPerMinute);\n\t\tconst midiTicksPerBar: number = midiTicksPerBeat * song.beatsPerBar;\n\t\tconst pitchBendRange: number = 24;\n\t\tconst defaultNoteVelocity: number = 90;\n\t\t\n\t\tconst unrolledBars: number[] = [];\n\t\tif (this._enableIntro.checked) {\n\t\t\tfor (let bar: number = 0; bar < song.loopStart; bar++) {\n\t\t\t\tunrolledBars.push(bar);\n\t\t\t}\n\t\t}\n\t\tfor (let loopIndex: number = 0; loopIndex < Number(this._loopDropDown.value); loopIndex++) {\n\t\t\tfor (let bar: number = song.loopStart; bar < song.loopStart + song.loopLength; bar++) {\n\t\t\t\tunrolledBars.push(bar);\n\t\t\t}\n\t\t}\n\t\tif (this._enableOutro.checked) {\n\t\t\tfor (let bar: number = song.loopStart + song.loopLength; bar < song.barCount; bar++) {\n\t\t\t\tunrolledBars.push(bar);\n\t\t\t}\n\t\t}\n\t\t\n\t\tconst tracks = [{isMeta:  true, channel: -1, midiChannel: -1, isNoise: false, isDrumset: false}];\n\t\tlet midiChannelCounter: number = 0;\n\t\tlet foundADrumset: boolean = false;\n\t\tfor (let channel: number = 0; channel < this._doc.song.getChannelCount(); channel++) {\n\t\t\tif (!foundADrumset && this._doc.song.channels[channel].instruments[0].type == InstrumentType.drumset) {\n\t\t\t\ttracks.push({isMeta: false, channel: channel, midiChannel: 9, isNoise: true, isDrumset: true});\n\t\t\t\tfoundADrumset = true; // There can only be one drumset channel, and it's always channel 9 (seen as 10 in most UIs). :/\n\t\t\t} else {\n\t\t\t\tif (midiChannelCounter >= 16) continue; // The MIDI standard only supports 16 channels.\n\t\t\t\ttracks.push({isMeta: false, channel: channel, midiChannel: midiChannelCounter++, isNoise: this._doc.song.getChannelIsNoise(channel), isDrumset: false});\n\t\t\t\tif (midiChannelCounter == 9) midiChannelCounter++; // skip midi drum channel.\n\t\t\t}\n\t\t}\n\t\t\n\t\tconst writer: ArrayBufferWriter = new ArrayBufferWriter(1024);\n\t\twriter.writeUint32(MidiChunkType.header);\n\t\twriter.writeUint32(6); // length of headers is 6 bytes\n\t\twriter.writeUint16(MidiFileFormat.simultaneousTracks);\n\t\twriter.writeUint16(tracks.length);\n\t\twriter.writeUint16(midiTicksPerBeat); // number of \"ticks\" per beat, independent of tempo\n\t\t\n\t\tfor (const track of tracks) {\n\t\t\twriter.writeUint32(MidiChunkType.track);\n\t\t\t\n\t\t\tconst {isMeta, channel, midiChannel, isNoise, isDrumset} = track;\n\t\t\t\n\t\t\t// We're gonna come back here and overwrite this placeholder once we know how many bytes this track is.\n\t\t\tconst trackStartIndex: number = writer.getWriteIndex();\n\t\t\twriter.writeUint32(0); // placeholder for track size\n\t\t\t\n\t\t\tlet prevTime: number = 0;\n\t\t\tlet barStartTime: number = 0;\n\t\t\tconst writeEventTime = function(time: number): void {\n\t\t\t\tif (time < prevTime) throw new Error(\"Midi event time cannot go backwards.\");\n\t\t\t\twriter.writeMidiVariableLength(time - prevTime);\n\t\t\t\tprevTime = time;\n\t\t\t}\n\t\t\t\n\t\t\tconst writeControlEvent = function(message: MidiControlEventMessage, value: number): void {\n\t\t\t\tif (!(value >= 0 && value <= 0x7F)) throw new Error(\"Midi control event value out of range: \" + value);\n\t\t\t\twriter.writeUint8(MidiEventType.controlChange | midiChannel);\n\t\t\t\twriter.writeMidi7Bits(message);\n\t\t\t\twriter.writeMidi7Bits(value | 0);\n\t\t\t}\n\t\t\t\n\t\t\tif (isMeta) {\n\t\t\t\t// for first midi track, include tempo, time signature, and key signature information.\n\t\t\t\t\n\t\t\t\twriteEventTime(0);\n\t\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.text);\n\t\t\t\twriter.writeMidiAscii(\"Composed with https://www.beepbox.co\");\n\t\t\t\t\n\t\t\t\twriteEventTime(0);\n\t\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.tempo);\n\t\t\t\twriter.writeMidiVariableLength(3); // Tempo message length is 3 bytes.\n\t\t\t\twriter.writeUint24(microsecondsPerBeat); // Tempo in microseconds per \"quarter\" note, commonly known as a \"beat\"\n\t\t\t\t\n\t\t\t\twriteEventTime(0);\n\t\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.timeSignature);\n\t\t\t\twriter.writeMidiVariableLength(4); // Time signature message length is 4 bytes.\n\t\t\t\twriter.writeUint8(song.beatsPerBar); // numerator.\n\t\t\t\twriter.writeUint8(2); // denominator exponent in 2^E. 2^2 = 4, and we will always use \"quarter\" notes.\n\t\t\t\twriter.writeUint8(24); // MIDI Clocks per metronome tick (should match beats), standard is 24\n\t\t\t\twriter.writeUint8(8); // number of 1/32 notes per 24 MIDI Clocks, standard is 8, meaning 24 clocks per \"quarter\" note.\n\t\t\t\t\n\t\t\t\tconst isMinor: boolean = Config.scales[song.scale].flags[3] && !Config.scales[song.scale].flags[4];\n\t\t\t\tconst key: number = song.key; // C=0, C#=1, counting up to B=11\n\t\t\t\tlet numSharps: number = key; // For even key values in major scale, number of sharps/flats is same...\n\t\t\t\tif ((key & 1) == 1) numSharps += 6; // For odd key values (consider circle of fifths) rotate around the circle... kinda... Look conventional key signatures are just weird, okay?\n\t\t\t\tif (isMinor) numSharps += 9; // A minor A scale has zero sharps, shift it appropriately\n\t\t\t\twhile (numSharps > 6) numSharps -= 12; // Range is (modulo 12) - 5. Midi supports -7 to +7, but I only have 12 options.\n\t\t\t\t\n\t\t\t\twriteEventTime(0);\n\t\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.keySignature);\n\t\t\t\twriter.writeMidiVariableLength(2); // Key signature message length is 2 bytes.\n\t\t\t\twriter.writeInt8(numSharps); // See above calculation. Assumes scale is diatonic. :/\n\t\t\t\twriter.writeUint8(isMinor ? 1 : 0); // 0: major, 1: minor\n\t\t\t\t\n\t\t\t\tif (this._enableIntro.checked) barStartTime += midiTicksPerBar * song.loopStart;\n\t\t\t\twriteEventTime(barStartTime);\n\t\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.marker);\n\t\t\t\twriter.writeMidiAscii(\"Loop Start\");\n\t\t\t\t\n\t\t\t\tfor (let loopIndex: number = 0; loopIndex < parseInt(this._loopDropDown.value); loopIndex++) {\n\t\t\t\t\tbarStartTime += midiTicksPerBar * song.loopLength;\n\t\t\t\t\twriteEventTime(barStartTime);\n\t\t\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.marker);\n\t\t\t\t\twriter.writeMidiAscii(loopIndex < Number(this._loopDropDown.value) - 1 ? \"Loop Repeat\" : \"Loop End\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this._enableOutro.checked) barStartTime += midiTicksPerBar * (song.barCount - song.loopStart - song.loopLength);\n\t\t\t\tif (barStartTime != midiTicksPerBar * unrolledBars.length) throw new Error(\"Miscalculated number of bars.\");\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t// For remaining tracks, set up the instruments and write the notes:\n\t\t\t\t\n\t\t\t\tlet channelName: string = ColorConfig.getChannelColor(song, channel).name + \" channel\";\n\t\t\t\twriteEventTime(0);\n\t\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.trackName);\n\t\t\t\twriter.writeMidiAscii(channelName);\n\t\t\t\t\n\t\t\t\t// This sets up pitch bend range. First we choose the pitch bend RPN (which has MSB and LSB components), then we set the value for that RPN (which also has MSB and LSB components) and finally reset the current RPN to null, which is considered best practice.\n\t\t\t\twriteEventTime(0); writeControlEvent(MidiControlEventMessage.registeredParameterNumberMSB, MidiRegisteredParameterNumberMSB.pitchBendRange);\n\t\t\t\twriteEventTime(0); writeControlEvent(MidiControlEventMessage.registeredParameterNumberLSB, MidiRegisteredParameterNumberLSB.pitchBendRange);\n\t\t\t\twriteEventTime(0); writeControlEvent(MidiControlEventMessage.setParameterMSB, pitchBendRange); // pitch bend semitone range\n\t\t\t\twriteEventTime(0); writeControlEvent(MidiControlEventMessage.setParameterLSB, 0); // pitch bend cent range\n\t\t\t\twriteEventTime(0); writeControlEvent(MidiControlEventMessage.registeredParameterNumberMSB, MidiRegisteredParameterNumberMSB.reset);\n\t\t\t\twriteEventTime(0); writeControlEvent(MidiControlEventMessage.registeredParameterNumberLSB, MidiRegisteredParameterNumberLSB.reset);\n\t\t\t\t\n\t\t\t\tlet prevInstrumentIndex: number = -1;\n\t\t\t\tfunction writeInstrumentSettings(instrumentIndex: number): void {\n\t\t\t\t\tconst instrument: Instrument = song.channels[channel].instruments[instrumentIndex];\n\t\t\t\t\tconst preset: Preset | null = EditorConfig.valueToPreset(instrument.preset);\n\t\t\t\t\t\n\t\t\t\t\tif (prevInstrumentIndex != instrumentIndex) {\n\t\t\t\t\t\tprevInstrumentIndex = instrumentIndex;\n\t\t\t\t\t\twriteEventTime(barStartTime);\n\t\t\t\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\t\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.instrumentName);\n\t\t\t\t\t\twriter.writeMidiAscii(\"Instrument \" + (instrumentIndex + 1));\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!isDrumset) {\n\t\t\t\t\t\t\tlet instrumentProgram: number = 81; // default to sawtooth wave. \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (preset != null && preset.midiProgram != undefined) {\n\t\t\t\t\t\t\t\tinstrumentProgram = preset.midiProgram;\n\t\t\t\t\t\t\t} else if (instrument.type == InstrumentType.drumset) {\n\t\t\t\t\t\t\t\t// The first BeepBox drumset channel is handled as a Midi drumset channel and doesn't need a program, but any subsequent drumsets will just be set to taiko.\n\t\t\t\t\t\t\t\tinstrumentProgram = 116; // taiko\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (instrument.type == InstrumentType.noise || instrument.type == InstrumentType.spectrum) {\n\t\t\t\t\t\t\t\t\tif (isNoise) {\n\t\t\t\t\t\t\t\t\t\tinstrumentProgram = 116; // taiko\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tinstrumentProgram = 75; // pan flute\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (instrument.type == InstrumentType.chip) {\n\t\t\t\t\t\t\t\t\tif (ExportPrompt.midiChipInstruments.length > instrument.chipWave) {\n\t\t\t\t\t\t\t\t\t\tinstrumentProgram = ExportPrompt.midiChipInstruments[instrument.chipWave];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (instrument.type == InstrumentType.pwm || instrument.type == InstrumentType.fm || instrument.type == InstrumentType.harmonics) {\n\t\t\t\t\t\t\t\t\tinstrumentProgram = 81; // sawtooth\n\t\t\t\t\t\t\t\t} else if (instrument.type == InstrumentType.pickedString) {\n\t\t\t\t\t\t\t\t\tinstrumentProgram = 0x19; // steel guitar\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"Unrecognized instrument type.\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// Program (instrument) change event:\n\t\t\t\t\t\t\twriteEventTime(barStartTime);\n\t\t\t\t\t\t\twriter.writeUint8(MidiEventType.programChange | midiChannel);\n\t\t\t\t\t\t\twriter.writeMidi7Bits(instrumentProgram);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Instrument volume:\n\t\t\t\t\t\twriteEventTime(barStartTime);\n\t\t\t\t\t\tlet instrumentVolume: number = volumeMultToMidiVolume(Synth.instrumentVolumeToVolumeMult(instrument.volume));\n\t\t\t\t\t\twriteControlEvent(MidiControlEventMessage.volumeMSB, Math.min(0x7f, Math.round(instrumentVolume)));\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Instrument pan:\n\t\t\t\t\t\twriteEventTime(barStartTime);\n\t\t\t\t\t\tlet instrumentPan: number = (instrument.pan / Config.panCenter - 1) * 0x3f + 0x40;\n\t\t\t\t\t\twriteControlEvent(MidiControlEventMessage.panMSB, Math.min(0x7f, Math.round(instrumentPan)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (song.getPattern(channel, 0) == null) {\n\t\t\t\t\t// Go ahead and apply the instrument settings at the beginning of the channel\n\t\t\t\t\t// even if a bar doesn't kick in until later.\n\t\t\t\t\twriteInstrumentSettings(0);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlet prevPitchBend: number = defaultMidiPitchBend;\n\t\t\t\tlet prevExpression: number = defaultMidiExpression;\n\t\t\t\tlet shouldResetExpressionAndPitchBend: boolean = false;\n\t\t\t\t//let prevTremolo: number = -1;\n\t\t\t\tconst channelRoot: number = isNoise ? Config.spectrumBasePitch : Config.keys[song.key].basePitch;\n\t\t\t\tconst intervalScale: number = isNoise ? Config.noiseInterval : 1;\n\t\t\t\t\n\t\t\t\tfor (const bar of unrolledBars) {\n\t\t\t\t\tconst pattern: Pattern | null = song.getPattern(channel, bar);\n\t\t\t\t\t\n\t\t\t\t\tif (pattern != null) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst instrumentIndex: number = pattern.instruments[0]; // Don't bother trying to export multiple instruments per pattern to midi, just pick the first one.\n\t\t\t\t\t\tconst instrument: Instrument = song.channels[channel].instruments[instrumentIndex];\n\t\t\t\t\t\tconst preset: Preset | null = EditorConfig.valueToPreset(instrument.preset);\n\t\t\t\t\t\twriteInstrumentSettings(instrumentIndex);\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet usesArpeggio: boolean = instrument.getChord().arpeggiates;\n\t\t\t\t\t\tlet polyphony: number = usesArpeggio ? 1 : Config.maxChordSize;\n\t\t\t\t\t\tif (instrument.getChord().customInterval) {\n\t\t\t\t\t\t\tif (instrument.type == InstrumentType.chip || instrument.type == InstrumentType.harmonics) {\n\t\t\t\t\t\t\t\tpolyphony = 2;\n\t\t\t\t\t\t\t\tusesArpeggio = true;\n\t\t\t\t\t\t\t} else if (instrument.type == InstrumentType.fm) {\n\t\t\t\t\t\t\t\tpolyphony = Config.operatorCount;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.error(\"Unrecognized instrument type for harmonizing arpeggio: \" + instrument.type);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (let noteIndex: number = 0; noteIndex < pattern.notes.length; noteIndex++) {\n\t\t\t\t\t\t\tconst note: Note = pattern.notes[noteIndex];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst noteStartTime: number = barStartTime + note.start * midiTicksPerPart;\n\t\t\t\t\t\t\tlet pinTime: number = noteStartTime;\n\t\t\t\t\t\t\tlet pinSize: number = note.pins[0].size;\n\t\t\t\t\t\t\tlet pinInterval: number = note.pins[0].interval;\n\t\t\t\t\t\t\tconst prevPitches: number[] = [-1, -1, -1, -1];\n\t\t\t\t\t\t\tconst nextPitches: number[] = [-1, -1, -1, -1];\n\t\t\t\t\t\t\tconst toneCount: number = Math.min(polyphony, note.pitches.length);\n\t\t\t\t\t\t\tconst velocity: number = isDrumset ? Math.max(1, Math.round(defaultNoteVelocity * note.pins[0].size / Config.noteSizeMax)) : defaultNoteVelocity;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// The maximum midi pitch bend range is +/- 24 semitones from the base pitch. \n\t\t\t\t\t\t\t// To make the most of this, choose a base pitch that is within 24 semitones from as much of the note as possible.\n\t\t\t\t\t\t\t// This may involve offsetting this base pitch from BeepBox's note pitch.\n\t\t\t\t\t\t\tlet mainInterval: number = note.pickMainInterval();\n\t\t\t\t\t\t\tlet pitchOffset: number = mainInterval * intervalScale;\n\t\t\t\t\t\t\tif (!isDrumset) {\n\t\t\t\t\t\t\t\tlet maxPitchOffset: number = pitchBendRange;\n\t\t\t\t\t\t\t\tlet minPitchOffset: number = -pitchBendRange;\n\t\t\t\t\t\t\t\tfor (let pinIndex: number = 1; pinIndex < note.pins.length; pinIndex++) {\n\t\t\t\t\t\t\t\t\tconst interval = note.pins[pinIndex].interval * intervalScale;\n\t\t\t\t\t\t\t\t\tmaxPitchOffset = Math.min(maxPitchOffset, interval + pitchBendRange);\n\t\t\t\t\t\t\t\t\tminPitchOffset = Math.max(minPitchOffset, interval - pitchBendRange);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t\t// I'd like to be able to use pitch bend to implement arpeggio, but the \"custom inverval\" setting in chip instruments combines arpeggio in one tone with another flat tone, and midi can't selectively apply arpeggio to one out of two simultaneous tones. Also it would be hard to reimport. :/\n\t\t\t\t\t\t\t\tif (usesArpeggio && note.pitches.length > polyphony) {\n\t\t\t\t\t\t\t\t\tlet lowestArpeggioOffset: number = 0;\n\t\t\t\t\t\t\t\t\tlet highestArpeggioOffset: number = 0;\n\t\t\t\t\t\t\t\t\tconst basePitch: number = note.pitches[toneCount - 1];\n\t\t\t\t\t\t\t\t\tfor (let pitchIndex: number = toneCount; pitchIndex < note.pitches.length; pitchIndex++) {\n\t\t\t\t\t\t\t\t\t\tlowestArpeggioOffset = Math.min(note.pitches[pitchIndex] - basePitch);\n\t\t\t\t\t\t\t\t\t\thighestArpeggioOffset = Math.max(note.pitches[pitchIndex] - basePitch);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tmaxPitchOffset -= lowestArpeggioOffset;\n\t\t\t\t\t\t\t\t\tminPitchOffset += lowestArpeggioOffset;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t\t\tpitchOffset = Math.min(maxPitchOffset, Math.max(minPitchOffset, pitchOffset));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfor (let pinIndex: number = 1; pinIndex < note.pins.length; pinIndex++) {\n\t\t\t\t\t\t\t\tconst nextPinTime: number = noteStartTime + note.pins[pinIndex].time * midiTicksPerPart;\n\t\t\t\t\t\t\t\tconst nextPinSize: number = note.pins[pinIndex].size;\n\t\t\t\t\t\t\t\tconst nextPinInterval: number = note.pins[pinIndex].interval;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tconst length: number = nextPinTime - pinTime;\n\t\t\t\t\t\t\t\tfor (let midiTick: number = 0; midiTick < length; midiTick++) {\n\t\t\t\t\t\t\t\t\tconst midiTickTime: number = pinTime + midiTick;\n\t\t\t\t\t\t\t\t\tconst linearSize: number = lerp(pinSize, nextPinSize, midiTick / length);\n\t\t\t\t\t\t\t\t\tconst linearInterval: number = lerp(pinInterval, nextPinInterval, midiTick / length);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tconst interval: number = linearInterval * intervalScale - pitchOffset;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tconst pitchBend: number = Math.max(0, Math.min(0x3fff, Math.round(0x2000 * (1.0 + interval / pitchBendRange))));\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tconst expression: number = Math.min(0x7f, Math.round(volumeMultToMidiExpression(Synth.noteSizeToVolumeMult(linearSize))));\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (pitchBend != prevPitchBend) {\n\t\t\t\t\t\t\t\t\t\twriteEventTime(midiTickTime);\n\t\t\t\t\t\t\t\t\t\twriter.writeUint8(MidiEventType.pitchBend | midiChannel);\n\t\t\t\t\t\t\t\t\t\twriter.writeMidi7Bits(pitchBend & 0x7f); // least significant bits\n\t\t\t\t\t\t\t\t\t\twriter.writeMidi7Bits((pitchBend >> 7) & 0x7f); // most significant bits\n\t\t\t\t\t\t\t\t\t\tprevPitchBend = pitchBend;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (expression != prevExpression && !isDrumset) {\n\t\t\t\t\t\t\t\t\t\twriteEventTime(midiTickTime);\n\t\t\t\t\t\t\t\t\t\twriteControlEvent(MidiControlEventMessage.expressionMSB, expression);\n\t\t\t\t\t\t\t\t\t\tprevExpression = expression;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tconst noteStarting: boolean = midiTickTime == noteStartTime;\n\t\t\t\t\t\t\t\t\tfor (let toneIndex: number = 0; toneIndex < toneCount; toneIndex++) {\n\t\t\t\t\t\t\t\t\t\tlet nextPitch: number = note.pitches[toneIndex];\n\t\t\t\t\t\t\t\t\t\tif (isDrumset) {\n\t\t\t\t\t\t\t\t\t\t\tnextPitch += mainInterval;\n\t\t\t\t\t\t\t\t\t\t\tconst drumsetMap: number[] = [\n\t\t\t\t\t\t\t\t\t\t\t\t36, // Bass Drum 1\n\t\t\t\t\t\t\t\t\t\t\t\t41, // Low Floor Tom\n\t\t\t\t\t\t\t\t\t\t\t\t45, // Low Tom\n\t\t\t\t\t\t\t\t\t\t\t\t48, // Hi-Mid Tom\n\t\t\t\t\t\t\t\t\t\t\t\t40, // Electric Snare\n\t\t\t\t\t\t\t\t\t\t\t\t39, // Hand Clap\n\t\t\t\t\t\t\t\t\t\t\t\t59, // Ride Cymbal 2\n\t\t\t\t\t\t\t\t\t\t\t\t49, // Crash Cymbal 1\n\t\t\t\t\t\t\t\t\t\t\t\t46, // Open Hi-Hat\n\t\t\t\t\t\t\t\t\t\t\t\t55, // Splash Cymbal\n\t\t\t\t\t\t\t\t\t\t\t\t69, // Cabasa\n\t\t\t\t\t\t\t\t\t\t\t\t54, // Tambourine\n\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t\tif (nextPitch < 0 || nextPitch >= drumsetMap.length) throw new Error(\"Could not find corresponding drumset pitch. \" + nextPitch);\n\t\t\t\t\t\t\t\t\t\t\tnextPitch = drumsetMap[nextPitch];\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tif (usesArpeggio && note.pitches.length > toneIndex + 1 && toneIndex == toneCount - 1) {\n\t\t\t\t\t\t\t\t\t\t\t\tconst midiTicksSinceBeat = (midiTickTime - barStartTime) % midiTicksPerBeat;\n\t\t\t\t\t\t\t\t\t\t\t\tconst midiTicksPerArpeggio = Config.rhythms[song.rhythm].ticksPerArpeggio * midiTicksPerPart / Config.ticksPerPart;\n\t\t\t\t\t\t\t\t\t\t\t\tconst arpeggio: number = Math.floor(midiTicksSinceBeat / midiTicksPerArpeggio);\n\t\t\t\t\t\t\t\t\t\t\t\tnextPitch = note.pitches[toneIndex + getArpeggioPitchIndex(note.pitches.length - toneIndex, song.rhythm, arpeggio)];\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tnextPitch = channelRoot + nextPitch * intervalScale + pitchOffset;\n\t\t\t\t\t\t\t\t\t\t\tif (preset != null && preset.midiSubharmonicOctaves != undefined) {\n\t\t\t\t\t\t\t\t\t\t\t\tnextPitch += 12 * preset.midiSubharmonicOctaves;\n\t\t\t\t\t\t\t\t\t\t\t} else if (isNoise) {\n\t\t\t\t\t\t\t\t\t\t\t\tnextPitch += 12 * (+EditorConfig.presetCategories.dictionary[\"Drum Presets\"].presets.dictionary[\"taiko drum\"].midiSubharmonicOctaves!);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif (isNoise) nextPitch *= 2;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tnextPitch = Math.max(0, Math.min(127, nextPitch));\n\t\t\t\t\t\t\t\t\t\tnextPitches[toneIndex] = nextPitch;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif (!noteStarting && prevPitches[toneIndex] != nextPitches[toneIndex]) {\n\t\t\t\t\t\t\t\t\t\t\twriteEventTime(midiTickTime);\n\t\t\t\t\t\t\t\t\t\t\twriter.writeUint8(MidiEventType.noteOff | midiChannel);\n\t\t\t\t\t\t\t\t\t\t\twriter.writeMidi7Bits(prevPitches[toneIndex]); // old pitch\n\t\t\t\t\t\t\t\t\t\t\twriter.writeMidi7Bits(velocity); // velocity\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tfor (let toneIndex: number = 0; toneIndex < toneCount; toneIndex++) {\n\t\t\t\t\t\t\t\t\t\tif (noteStarting || prevPitches[toneIndex] != nextPitches[toneIndex]) {\n\t\t\t\t\t\t\t\t\t\t\twriteEventTime(midiTickTime);\n\t\t\t\t\t\t\t\t\t\t\twriter.writeUint8(MidiEventType.noteOn | midiChannel);\n\t\t\t\t\t\t\t\t\t\t\twriter.writeMidi7Bits(nextPitches[toneIndex]); // new pitch\n\t\t\t\t\t\t\t\t\t\t\twriter.writeMidi7Bits(velocity); // velocity\n\t\t\t\t\t\t\t\t\t\t\tprevPitches[toneIndex] = nextPitches[toneIndex];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tpinTime = nextPinTime;\n\t\t\t\t\t\t\t\tpinSize = nextPinSize;\n\t\t\t\t\t\t\t\tpinInterval = nextPinInterval;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst noteEndTime: number = barStartTime + note.end * midiTicksPerPart;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// End all tones.\n\t\t\t\t\t\t\tfor (let toneIndex: number = 0; toneIndex < toneCount; toneIndex++) {\n\t\t\t\t\t\t\t\t// TODO: If the note at the start of the next pattern has\n\t\t\t\t\t\t\t\t// continuesLastPattern and has the same chord, it ought to extend\n\t\t\t\t\t\t\t\t// this previous note.\n\t\t\t\t\t\t\t\twriteEventTime(noteEndTime);\n\t\t\t\t\t\t\t\twriter.writeUint8(MidiEventType.noteOff | midiChannel);\n\t\t\t\t\t\t\t\twriter.writeMidi7Bits(prevPitches[toneIndex]); // pitch\n\t\t\t\t\t\t\t\twriter.writeMidi7Bits(velocity); // velocity\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tshouldResetExpressionAndPitchBend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (shouldResetExpressionAndPitchBend) {\n\t\t\t\t\t\t\tshouldResetExpressionAndPitchBend = false;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (prevExpression != defaultMidiExpression) {\n\t\t\t\t\t\t\t\tprevExpression = defaultMidiExpression;\n\t\t\t\t\t\t\t\t// Reset expression\n\t\t\t\t\t\t\t\twriteEventTime(barStartTime);\n\t\t\t\t\t\t\t\twriteControlEvent(MidiControlEventMessage.expressionMSB, prevExpression);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (prevPitchBend != defaultMidiPitchBend) {\n\t\t\t\t\t\t\t\t// Reset pitch bend\n\t\t\t\t\t\t\t\tprevPitchBend = defaultMidiPitchBend;\n\t\t\t\t\t\t\t\twriteEventTime(barStartTime);\n\t\t\t\t\t\t\t\twriter.writeUint8(MidiEventType.pitchBend | midiChannel);\n\t\t\t\t\t\t\t\twriter.writeMidi7Bits(prevPitchBend & 0x7f); // least significant bits\n\t\t\t\t\t\t\t\twriter.writeMidi7Bits((prevPitchBend >> 7) & 0x7f); // most significant bits\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tbarStartTime += midiTicksPerBar;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\twriteEventTime(barStartTime);\n\t\t\twriter.writeUint8(MidiEventType.meta);\n\t\t\twriter.writeMidi7Bits(MidiMetaEventMessage.endOfTrack);\n\t\t\twriter.writeMidiVariableLength(0x00);\n\t\t\t\n\t\t\t// Finally, write the length of the track in bytes at the front of the track.\n\t\t\twriter.rewriteUint32(trackStartIndex, writer.getWriteIndex() - trackStartIndex - 4);\n\t\t}\n\t\t\n\t\tconst blob: Blob = new Blob([writer.toCompactArrayBuffer()], {type: \"audio/midi\"});\n\t\tsave(blob, this._fileName.value.trim() + \".mid\");\n\t\t\n\t\tthis._close();\n\t}\n\t\n\tprivate _exportToJson(): void {\n\t\tconst jsonObject: Object = this._doc.song.toJsonObject(this._enableIntro.checked, Number(this._loopDropDown.value), this._enableOutro.checked);\n\t\tconst jsonString: string = JSON.stringify(jsonObject, null, '\\t');\n\t\tconst blob: Blob = new Blob([jsonString], {type: \"application/json\"});\n\t\tsave(blob, this._fileName.value.trim() + \".json\");\n\t\tthis._close();\n\t}\n\t\n\tprivate _exportToHtml(): void {\n\t\tconst fileContents = `\\\n<!DOCTYPE html><meta charset=\"utf-8\">\n\nYou should be redirected to the song at:<br /><br />\n\n<a id=\"destination\" href=\"${new URL(\"#\" + this._doc.song.toBase64String(), location.href).href}\"></a>\n\n<style>\n\t:root {\n\t\tcolor: white;\n\t\tbackground: black;\n\t\tfont-family:\n\t\tsans-serif;\n\t}\n\ta {\n\t\tcolor: #98f;\n\t}\n\ta[href]::before {\n\t\tcontent: attr(href);\n\t}\n</style>\n\n<script>\n\tlocation.assign(document.querySelector(\"a#destination\").href);\n</script>\n`;\n\t\tconst blob: Blob = new Blob([fileContents], {type: \"text/html\"});\n\t\tsave(blob, this._fileName.value.trim() + \".html\");\n\t\tthis._close();\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\n// Note: All methods are big endian.\nexport class ArrayBufferReader {\n\tprivate _readIndex: number = 0;\n\tprivate _data: DataView;\n\t\n\tconstructor(data: DataView) {\n\t\tthis._data = data;\n\t}\n\t\n\tpublic getReadIndex(): number {\n\t\treturn this._readIndex;\n\t}\n\t\n\tpublic readUint32(): number {\n\t\tif (this._readIndex + 4 > this._data.byteLength) throw new Error(\"Reading past the end of the buffer.\");\n\t\tconst result: number = this._data.getUint32(this._readIndex, false);\n\t\tthis._readIndex += 4;\n\t\treturn result;\n\t}\n\t\n\tpublic readUint24(): number {\n\t\treturn (this.readUint8() << 16) | (this.readUint8() << 8) | (this.readUint8());\n\t}\n\t\n\tpublic readUint16(): number {\n\t\tif (this._readIndex + 2 > this._data.byteLength) throw new Error(\"Reading past the end of the buffer.\");\n\t\tconst result: number = this._data.getUint16(this._readIndex, false);\n\t\tthis._readIndex += 2;\n\t\treturn result;\n\t}\n\t\n\tpublic readUint8(): number {\n\t\tif (this._readIndex + 1 > this._data.byteLength) throw new Error(\"Reading past the end of the buffer.\");\n\t\tconst result: number = this._data.getUint8(this._readIndex);\n\t\tthis._readIndex++;\n\t\treturn result;\n\t}\n\t\n\tpublic readInt8(): number {\n\t\tif (this._readIndex + 1 > this._data.byteLength) throw new Error(\"Reading past the end of the buffer.\");\n\t\tconst result: number = this._data.getInt8(this._readIndex);\n\t\tthis._readIndex++;\n\t\treturn result;\n\t}\n\t\n\tpublic peakUint8(): number {\n\t\tif (this._readIndex + 1 > this._data.byteLength) throw new Error(\"Reading past the end of the buffer.\");\n\t\treturn this._data.getUint8(this._readIndex);\n\t}\n\t\n\tpublic readMidi7Bits(): number {\n\t\tconst result: number = this.readUint8();\n\t\tif (result >= 0x80) console.log(\"7 bit value contained 8th bit! value \" + result + \", index \" + this._readIndex);\n\t\treturn result & 0x7f;\n\t}\n\t\n\tpublic readMidiVariableLength(): number {\n\t\tlet result: number = 0;\n\t\tfor (let i: number = 0; i < 4; i++) {\n\t\t\tconst nextByte: number = this.readUint8();\n\t\t\tresult += nextByte & 0x7f;\n\t\t\tif (nextByte & 0x80) {\n\t\t\t\tresult = result << 7;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\t\n\tpublic skipBytes(length: number): void {\n\t\tthis._readIndex += length;\n\t}\n\t\n\tpublic hasMore(): boolean {\n\t\treturn this._data.byteLength > this._readIndex;\n\t}\n\t\n\tpublic getReaderForNextBytes(length: number): ArrayBufferReader {\n\t\tif (this._readIndex + length > this._data.byteLength) throw new Error(\"Reading past the end of the buffer.\");\n\t\tconst result: ArrayBufferReader = new ArrayBufferReader(new DataView(this._data.buffer, this._data.byteOffset + this._readIndex, length));\n\t\tthis.skipBytes(length);\n\t\treturn result;\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {InstrumentType, Config} from \"../synth/SynthConfig\";\nimport {NotePin, Note, makeNotePin, Pattern, Instrument, Channel, Song, Synth} from \"../synth/synth\";\nimport {Preset, EditorConfig} from \"./EditorConfig\";\nimport {SongDocument} from \"./SongDocument\";\nimport {Prompt} from \"./Prompt\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {ChangeGroup} from \"./Change\";\nimport {removeDuplicatePatterns, ChangeSong, ChangeReplacePatterns} from \"./changes\";\nimport {AnalogousDrum, analogousDrumMap, MidiChunkType, MidiFileFormat, MidiEventType, MidiControlEventMessage, MidiMetaEventMessage, MidiRegisteredParameterNumberMSB, MidiRegisteredParameterNumberLSB, midiVolumeToVolumeMult, midiExpressionToVolumeMult} from \"./Midi\";\nimport {ArrayBufferReader} from \"./ArrayBufferReader\";\n\nconst {button, p, div, h2, input} = HTML;\n\nexport class ImportPrompt implements Prompt {\n\tprivate readonly _fileInput: HTMLInputElement = input({type: \"file\", accept: \".json,application/json,.mid,.midi,audio/midi,audio/x-midi\"});\n\tprivate readonly _cancelButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\t\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt noSelection\", style: \"width: 300px;\"},\n\t\th2(\"Import\"),\n\t\tp({style: \"text-align: left; margin: 0.5em 0;\"},\n\t\t\t\"BeepBox songs can be exported and re-imported as .json files. You could also use other means to make .json files for BeepBox as long as they follow the same structure.\",\n\t\t),\n\t\tp({style: \"text-align: left; margin: 0.5em 0;\"},\n\t\t\t\"BeepBox can also (crudely) import .mid files. There are many tools available for creating .mid files. Shorter and simpler songs are more likely to work well.\",\n\t\t),\n\t\tthis._fileInput,\n\t\tthis._cancelButton,\n\t);\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._fileInput.select();\n\t\tsetTimeout(()=>this._fileInput.focus());\n\t\t\n\t\tthis._fileInput.addEventListener(\"change\", this._whenFileSelected);\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => { \n\t\tthis._fileInput.removeEventListener(\"change\", this._whenFileSelected);\n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\n\t}\n\t\n\tprivate _whenFileSelected = (): void => {\n\t\tconst file: File = this._fileInput.files![0];\n\t\tif (!file) return;\n\t\t\n\t\tconst extension: string = file.name.slice((file.name.lastIndexOf(\".\") - 1 >>> 0) + 2);\n\t\tif (extension == \"json\") {\n\t\t\tconst reader: FileReader = new FileReader();\n\t\t\treader.addEventListener(\"load\", (event: Event): void => {\n\t\t\t\tthis._doc.prompt = null;\n\t\t\t\tthis._doc.goBackToStart();\n\t\t\t\tthis._doc.record(new ChangeSong(this._doc, <string>reader.result), true, true);\n\t\t\t});\n\t\t\treader.readAsText(file);\n\t\t} else if (extension == \"midi\" || extension == \"mid\") {\n\t\t\tconst reader: FileReader = new FileReader();\n\t\t\treader.addEventListener(\"load\", (event: Event): void => {\n\t\t\t\tthis._doc.prompt = null;\n\t\t\t\tthis._doc.goBackToStart();\n\t\t\t\tthis._parseMidiFile(<ArrayBuffer>reader.result);\n\t\t\t});\n\t\t\treader.readAsArrayBuffer(file);\n\t\t} else {\n\t\t\tconsole.error(\"Unrecognized file extension.\");\n\t\t\tthis._close();\n\t\t}\n\t}\n\t\n\tprivate _parseMidiFile(buffer: ArrayBuffer): void {\n\t\t\n\t\t// First, split the file into separate buffer readers for each chunk. There should be one header chunk and one or more track chunks.\n\t\tconst reader = new ArrayBufferReader(new DataView(buffer));\n\t\tlet headerReader: ArrayBufferReader | null = null;\n\t\tinterface Track {\n\t\t\treader: ArrayBufferReader;\n\t\t\tnextEventMidiTick: number;\n\t\t\tended: boolean;\n\t\t\trunningStatus: number;\n\t\t}\n\t\tconst tracks: Track[] = [];\n\t\twhile(reader.hasMore()) {\n\t\t\tconst chunkType: number = reader.readUint32();\n\t\t\tconst chunkLength: number = reader.readUint32();\n\t\t\tif (chunkType == MidiChunkType.header) {\n\t\t\t\tif (headerReader == null) {\n\t\t\t\t\theaderReader = reader.getReaderForNextBytes(chunkLength);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error(\"This MIDI file has more than one header chunk.\");\n\t\t\t\t}\n\t\t\t} else if (chunkType == MidiChunkType.track) {\n\t\t\t\tconst trackReader: ArrayBufferReader = reader.getReaderForNextBytes(chunkLength);\n\t\t\t\tif (trackReader.hasMore()) {\n\t\t\t\t\ttracks.push({\n\t\t\t\t\t\treader: trackReader,\n\t\t\t\t\t\tnextEventMidiTick: trackReader.readMidiVariableLength(),\n\t\t\t\t\t\tended: false,\n\t\t\t\t\t\trunningStatus: -1,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Unknown chunk type. Skip it.\n\t\t\t\treader.skipBytes(chunkLength);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (headerReader == null) {\n\t\t\tconsole.error(\"No header chunk found in this MIDI file.\");\n\t\t\tthis._close();\n\t\t\treturn;\n\t\t}\n\t\tconst fileFormat: number = headerReader.readUint16();\n\t\t/*const trackCount: number =*/ headerReader.readUint16();\n\t\tconst midiTicksPerBeat: number = headerReader.readUint16();\n\t\t\n\t\t// Midi tracks are generally intended to be played in parallel, but in the format\n\t\t// MidiFileFormat.independentTracks, they are played in sequence. Make a list of all\n\t\t// of the track indices that should be played in parallel (one or all of the tracks).\n\t\tlet currentIndependentTrackIndex: number = 0;\n\t\tconst currentTrackIndices: number[] = [];\n\t\tconst independentTracks: boolean = (fileFormat == MidiFileFormat.independentTracks);\n\t\tif (independentTracks) {\n\t\t\tcurrentTrackIndices.push(currentIndependentTrackIndex);\n\t\t} else {\n\t\t\tfor (let trackIndex: number = 0; trackIndex < tracks.length; trackIndex++) {\n\t\t\t\tcurrentTrackIndices.push(trackIndex);\n\t\t\t}\n\t\t}\n\t\t\n\t\tinterface NoteEvent {\n\t\t\tmidiTick: number;\n\t\t\tpitch: number;\n\t\t\tvelocity: number;\n\t\t\tprogram: number;\n\t\t\tinstrumentVolume: number;\n\t\t\tinstrumentPan: number;\n\t\t\ton: boolean;\n\t\t}\n\t\tinterface PitchBendEvent {\n\t\t\tmidiTick: number;\n\t\t\tinterval: number;\n\t\t}\n\t\tinterface NoteSizeEvent {\n\t\t\tmidiTick: number;\n\t\t\tsize: number;\n\t\t}\n\t\t\n\t\t// To read a MIDI file we have to simulate state changing over time.\n\t\t// Keep a record of various parameters for each channel that may\n\t\t// change over time, initialized to default values.\n\t\t// Consider making a MidiChannel class and single array of midiChannels.\n\t\tconst channelRPNMSB: number[] = [0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff];\n\t\tconst channelRPNLSB: number[] = [0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff];\n\t\tconst pitchBendRangeMSB: number[] = [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]; // pitch bend range defaults to 2 semitones.\n\t\tconst pitchBendRangeLSB: number[] = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]; // and 0 cents.\n\t\tconst currentInstrumentProgram: number[] = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];\n\t\tconst currentInstrumentVolumes: number[] = [100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100];\n\t\tconst currentInstrumentPans: number[] = [64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];\n\t\tconst noteEvents: NoteEvent[][] = [[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];\n\t\tconst pitchBendEvents: PitchBendEvent[][] = [[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];\n\t\tconst noteSizeEvents: NoteSizeEvent[][] = [[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];\n\t\tlet microsecondsPerBeat: number = 500000; // Tempo in microseconds per \"quarter\" note, commonly known as a \"beat\", default is equivalent to 120 beats per minute.\n\t\tlet beatsPerBar: number = 8;\n\t\tlet numSharps: number = 0;\n\t\tlet isMinor: boolean = false;\n\t\t\n\t\t// Progress in time through all tracks (in parallel or in sequence) recording state changes and events until all tracks have ended.\n\t\tlet currentMidiTick: number = 0;\n\t\twhile (true) {\n\t\t\tlet nextEventMidiTick: number = Number.MAX_VALUE;\n\t\t\tlet anyTrackHasMore: boolean = false;\n\t\t\tfor (const trackIndex of currentTrackIndices) {\n\t\t\t\t\n\t\t\t\t// Parse any events in this track that occur at the currentMidiTick.\n\t\t\t\tconst track: Track = tracks[trackIndex];\n\t\t\t\twhile (!track.ended && track.nextEventMidiTick == currentMidiTick) {\n\t\t\t\t\t\n\t\t\t\t\t// If the most significant bit is set in the first byte\n\t\t\t\t\t// of the event, it's a new event status, otherwise\n\t\t\t\t\t// reuse the running status and save the next byte for\n\t\t\t\t\t// the content of the event. I'm assuming running status\n\t\t\t\t\t// is separate for each track.\n\t\t\t\t\tconst peakStatus: number = track.reader.peakUint8();\n\t\t\t\t\tconst eventStatus: number = (peakStatus & 0x80) ? track.reader.readUint8() : track.runningStatus;\n\t\t\t\t\tconst eventType: number = eventStatus & 0xF0;\n\t\t\t\t\tconst eventChannel: number = eventStatus & 0x0F;\n\t\t\t\t\tif (eventType != MidiEventType.metaAndSysex) {\n\t\t\t\t\t\ttrack.runningStatus = eventStatus;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tlet foundTrackEndEvent: boolean = false;\n\t\t\t\t\t\n\t\t\t\t\tswitch (eventType) {\n\t\t\t\t\t\tcase MidiEventType.noteOff: {\n\t\t\t\t\t\t\tconst pitch: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\t/*const velocity: number =*/ track.reader.readMidi7Bits();\n\t\t\t\t\t\t\tnoteEvents[eventChannel].push({midiTick: currentMidiTick, pitch: pitch, velocity: 0.0, program: -1, instrumentVolume: -1, instrumentPan: -1, on: false});\n\t\t\t\t\t\t} break;\n\t\t\t\t\t\tcase MidiEventType.noteOn: {\n\t\t\t\t\t\t\tconst pitch: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\tconst velocity: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\tif (velocity == 0) {\n\t\t\t\t\t\t\t\tnoteEvents[eventChannel].push({midiTick: currentMidiTick, pitch: pitch, velocity: 0.0, program: -1, instrumentVolume: -1, instrumentPan: -1, on: false});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconst volume: number = Math.max(0, Math.min(Config.volumeRange - 1, Math.round(\n\t\t\t\t\t\t\t\t\tSynth.volumeMultToInstrumentVolume(midiVolumeToVolumeMult(currentInstrumentVolumes[eventChannel]))\n\t\t\t\t\t\t\t\t)));\n\t\t\t\t\t\t\t\tconst pan: number = Math.max(0, Math.min(Config.panMax, Math.round(\n\t\t\t\t\t\t\t\t\t((currentInstrumentPans[eventChannel] - 64) / 63 + 1) * Config.panCenter\n\t\t\t\t\t\t\t\t)));\n\t\t\t\t\t\t\t\tnoteEvents[eventChannel].push({\n\t\t\t\t\t\t\t\t\tmidiTick: currentMidiTick,\n\t\t\t\t\t\t\t\t\tpitch: pitch,\n\t\t\t\t\t\t\t\t\tvelocity: Math.max(0.0, Math.min(1.0, (velocity + 14) / 90.0)),\n\t\t\t\t\t\t\t\t\tprogram: currentInstrumentProgram[eventChannel],\n\t\t\t\t\t\t\t\t\tinstrumentVolume: volume,\n\t\t\t\t\t\t\t\t\tinstrumentPan: pan,\n\t\t\t\t\t\t\t\t\ton: true,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} break;\n\t\t\t\t\t\tcase MidiEventType.keyPressure: {\n\t\t\t\t\t\t\t/*const pitch: number =*/ track.reader.readMidi7Bits();\n\t\t\t\t\t\t\t/*const pressure: number =*/ track.reader.readMidi7Bits();\n\t\t\t\t\t\t} break;\n\t\t\t\t\t\tcase MidiEventType.controlChange: {\n\t\t\t\t\t\t\tconst message: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\tconst value: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\t//console.log(\"Control change, message:\", message, \"value:\", value);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tswitch (message) {\n\t\t\t\t\t\t\t\tcase MidiControlEventMessage.setParameterMSB: {\n\t\t\t\t\t\t\t\t\tif (channelRPNMSB[eventChannel] == MidiRegisteredParameterNumberMSB.pitchBendRange && channelRPNLSB[eventChannel] == MidiRegisteredParameterNumberLSB.pitchBendRange) {\n\t\t\t\t\t\t\t\t\t\tpitchBendRangeMSB[eventChannel] = value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} break;\n\t\t\t\t\t\t\t\tcase MidiControlEventMessage.volumeMSB: {\n\t\t\t\t\t\t\t\t\tcurrentInstrumentVolumes[eventChannel] = value;\n\t\t\t\t\t\t\t\t} break;\n\t\t\t\t\t\t\t\tcase MidiControlEventMessage.panMSB: {\n\t\t\t\t\t\t\t\t\tcurrentInstrumentPans[eventChannel] = value;\n\t\t\t\t\t\t\t\t} break;\n\t\t\t\t\t\t\t\tcase MidiControlEventMessage.expressionMSB: {\n\t\t\t\t\t\t\t\t\tnoteSizeEvents[eventChannel].push({midiTick: currentMidiTick, size: Synth.volumeMultToNoteSize(midiExpressionToVolumeMult(value))});\n\t\t\t\t\t\t\t\t} break;\n\t\t\t\t\t\t\t\tcase MidiControlEventMessage.setParameterLSB: {\n\t\t\t\t\t\t\t\t\tif (channelRPNMSB[eventChannel] == MidiRegisteredParameterNumberMSB.pitchBendRange && channelRPNLSB[eventChannel] == MidiRegisteredParameterNumberLSB.pitchBendRange) {\n\t\t\t\t\t\t\t\t\t\tpitchBendRangeLSB[eventChannel] = value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} break;\n\t\t\t\t\t\t\t\tcase MidiControlEventMessage.registeredParameterNumberLSB: {\n\t\t\t\t\t\t\t\t\tchannelRPNLSB[eventChannel] = value;\n\t\t\t\t\t\t\t\t} break;\n\t\t\t\t\t\t\t\tcase MidiControlEventMessage.registeredParameterNumberMSB: {\n\t\t\t\t\t\t\t\t\tchannelRPNMSB[eventChannel] = value;\n\t\t\t\t\t\t\t\t} break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} break;\n\t\t\t\t\t\tcase MidiEventType.programChange: {\n\t\t\t\t\t\t\tconst program: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\tcurrentInstrumentProgram[eventChannel] = program;\n\t\t\t\t\t\t} break;\n\t\t\t\t\t\tcase MidiEventType.channelPressure: {\n\t\t\t\t\t\t\t/*const pressure: number =*/ track.reader.readMidi7Bits();\n\t\t\t\t\t\t} break;\n\t\t\t\t\t\tcase MidiEventType.pitchBend: {\n\t\t\t\t\t\t\tconst lsb: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\tconst msb: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst pitchBend: number = (((msb << 7) | lsb) / 0x2000) - 1.0;\n\t\t\t\t\t\t\tconst pitchBendRange: number = pitchBendRangeMSB[eventChannel] + pitchBendRangeLSB[eventChannel] * 0.01;\n\t\t\t\t\t\t\tconst interval: number = pitchBend * pitchBendRange;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tpitchBendEvents[eventChannel].push({midiTick: currentMidiTick, interval: interval});\n\t\t\t\t\t\t} break;\n\t\t\t\t\t\tcase MidiEventType.metaAndSysex: {\n\t\t\t\t\t\t\tif (eventStatus == MidiEventType.meta) {\n\t\t\t\t\t\t\t\tconst message: number = track.reader.readMidi7Bits();\n\t\t\t\t\t\t\t\tconst length: number = track.reader.readMidiVariableLength();\n\t\t\t\t\t\t\t\t//console.log(\"Meta, message:\", message, \"length:\", length);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (message == MidiMetaEventMessage.endOfTrack) {\n\t\t\t\t\t\t\t\t\tfoundTrackEndEvent = true;\n\t\t\t\t\t\t\t\t\ttrack.reader.skipBytes(length);\n\t\t\t\t\t\t\t\t} else if (message == MidiMetaEventMessage.tempo) {\n\t\t\t\t\t\t\t\t\tmicrosecondsPerBeat = track.reader.readUint24();\n\t\t\t\t\t\t\t\t\ttrack.reader.skipBytes(length - 3);\n\t\t\t\t\t\t\t\t} else if (message == MidiMetaEventMessage.timeSignature) {\n\t\t\t\t\t\t\t\t\tconst numerator: number = track.reader.readUint8();\n\t\t\t\t\t\t\t\t\tlet denominatorExponent: number = track.reader.readUint8();\n\t\t\t\t\t\t\t\t\t/*const midiClocksPerMetronome: number =*/ track.reader.readUint8();\n\t\t\t\t\t\t\t\t\t/*const thirtySecondNotesPer24MidiClocks: number =*/ track.reader.readUint8();\n\t\t\t\t\t\t\t\t\ttrack.reader.skipBytes(length - 4);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// A beat is a quarter note. \n\t\t\t\t\t\t\t\t\t// A ratio of 4/4, or 1/1, corresponds to 4 beats per bar.\n\t\t\t\t\t\t\t\t\t// Apply the numerator first.\n\t\t\t\t\t\t\t\t\tbeatsPerBar = numerator * 4;\n\t\t\t\t\t\t\t\t\t// Then apply the denominator, dividing by two until either\n\t\t\t\t\t\t\t\t\t// the denominator is satisfied or there's an odd number of\n\t\t\t\t\t\t\t\t\t// beats. BeepBox doesn't support fractional beats in a bar.\n\t\t\t\t\t\t\t\t\twhile ((beatsPerBar & 1) == 0 && (denominatorExponent > 0 || beatsPerBar > Config.beatsPerBarMax) && beatsPerBar >= Config.beatsPerBarMin * 2) {\n\t\t\t\t\t\t\t\t\t\tbeatsPerBar = beatsPerBar >> 1;\n\t\t\t\t\t\t\t\t\t\tdenominatorExponent = denominatorExponent - 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbeatsPerBar = Math.max(Config.beatsPerBarMin, Math.min(Config.beatsPerBarMax, beatsPerBar));\n\t\t\t\t\t\t\t\t} else if (message == MidiMetaEventMessage.keySignature) {\n\t\t\t\t\t\t\t\t\tnumSharps = track.reader.readInt8(); // Note: can be negative for flats.\n\t\t\t\t\t\t\t\t\tisMinor = track.reader.readUint8() == 1; // 0: major, 1: minor\n\t\t\t\t\t\t\t\t\ttrack.reader.skipBytes(length - 2);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// Ignore other meta event message types.\n\t\t\t\t\t\t\t\t\ttrack.reader.skipBytes(length);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t} else if (eventStatus == 0xF0 || eventStatus == 0xF7) {\n\t\t\t\t\t\t\t\t// Sysex events, just skip the data.\n\t\t\t\t\t\t\t\tconst length: number = track.reader.readMidiVariableLength();\n\t\t\t\t\t\t\t\ttrack.reader.skipBytes(length);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.error(\"Unrecognized event status: \" + eventStatus);\n\t\t\t\t\t\t\t\tthis._close();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} break;\n\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\tconsole.error(\"Unrecognized event type: \" + eventType);\n\t\t\t\t\t\t\tthis._close();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (!foundTrackEndEvent && track.reader.hasMore()) {\n\t\t\t\t\t\ttrack.nextEventMidiTick = currentMidiTick + track.reader.readMidiVariableLength();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttrack.ended = true;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// If the tracks are sequential, start the next track when this one ends.\n\t\t\t\t\t\tif (independentTracks) {\n\t\t\t\t\t\t\tcurrentIndependentTrackIndex++;\n\t\t\t\t\t\t\tif (currentIndependentTrackIndex < tracks.length) {\n\t\t\t\t\t\t\t\tcurrentTrackIndices[0] = currentIndependentTrackIndex;\n\t\t\t\t\t\t\t\ttracks[currentIndependentTrackIndex].nextEventMidiTick += currentMidiTick;\n\t\t\t\t\t\t\t\tnextEventMidiTick = Math.min(nextEventMidiTick, tracks[currentIndependentTrackIndex].nextEventMidiTick);\n\t\t\t\t\t\t\t\tanyTrackHasMore = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!track.ended) {\n\t\t\t\t\tanyTrackHasMore = true;\n\t\t\t\t\tnextEventMidiTick = Math.min(nextEventMidiTick, track.nextEventMidiTick);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif (anyTrackHasMore) {\n\t\t\t\tcurrentMidiTick = nextEventMidiTick;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Now the MIDI file is fully parsed. Next, constuct BeepBox channels out of the data.\n\t\tconst microsecondsPerMinute: number = 60 * 1000 * 1000;\n\t\tconst beatsPerMinute: number = Math.max(Config.tempoMin, Math.min(Config.tempoMax, Math.round(microsecondsPerMinute / microsecondsPerBeat)));\n\t\tconst midiTicksPerPart: number = midiTicksPerBeat / Config.partsPerBeat;\n\t\tconst partsPerBar: number = Config.partsPerBeat * beatsPerBar;\n\t\tconst songTotalBars: number = Math.ceil(currentMidiTick / midiTicksPerPart / partsPerBar);\n\t\t\n\t\tfunction quantizeMidiTickToPart(midiTick: number): number {\n\t\t\treturn Math.round(midiTick / midiTicksPerPart);\n\t\t}\n\n\t\tlet key: number = numSharps;\n\t\tif (isMinor) key += 3; // Diatonic C Major has the same sharps/flats as A Minor, and these keys are 3 semitones apart.\n\t\tif ((key & 1) == 1) key += 6; // If the number of sharps/flats is odd, rotate it halfway around the circle of fifths. The key of C# has little in common with the key of C.\n\t\twhile (key < 0) key += 12; // Wrap around to a range from 0 to 11.\n\t\tkey = key % 12; // Wrap around to a range from 0 to 11.\n\t\t\n\t\t// Convert each midi channel into a BeepBox channel.\n\t\tconst pitchChannels: Channel[] = [];\n\t\tconst noiseChannels: Channel[] = [];\n\t\tfor (let midiChannel: number = 0; midiChannel < 16; midiChannel++) {\n\t\t\tif (noteEvents[midiChannel].length == 0) continue;\n\t\t\t\n\t\t\tconst channel: Channel = new Channel();\n\t\t\t\n\t\t\tconst channelPresetValue: number | null = EditorConfig.midiProgramToPresetValue(noteEvents[midiChannel][0].program);\n\t\t\tconst channelPreset: Preset | null = (channelPresetValue == null) ? null : EditorConfig.valueToPreset(channelPresetValue);\n\t\t\t\n\t\t\tconst isDrumsetChannel: boolean = (midiChannel == 9);\n\t\t\tconst isNoiseChannel: boolean = isDrumsetChannel || (channelPreset != null && channelPreset.isNoise == true);\n\t\t\tconst channelBasePitch: number = isNoiseChannel ? Config.spectrumBasePitch : Config.keys[key].basePitch;\n\t\t\tconst intervalScale: number = isNoiseChannel ? Config.noiseInterval : 1;\n\t\t\tconst midiIntervalScale: number = isNoiseChannel ? 0.5 : 1;\n\t\t\tconst channelMaxPitch: number = isNoiseChannel ? Config.drumCount - 1 : Config.maxPitch;\n\t\t\t\n\t\t\tif (isNoiseChannel) {\n\t\t\t\tif (isDrumsetChannel) {\n\t\t\t\t\tnoiseChannels.unshift(channel);\n\t\t\t\t} else {\n\t\t\t\t\tnoiseChannels.push(channel);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpitchChannels.push(channel);\n\t\t\t}\n\t\t\t\n\t\t\tlet currentVelocity: number = 1.0;\n\t\t\tlet currentProgram: number = 0;\n\t\t\tlet currentInstrumentVolume: number = 0;\n\t\t\tlet currentInstrumentPan: number = Config.panCenter;\n\t\t\t\n\t\t\tif (isDrumsetChannel) {\n\t\t\t\tconst heldPitches: number[] = [];\n\t\t\t\tlet currentBar: number = -1;\n\t\t\t\tlet pattern: Pattern | null = null;\n\t\t\t\tlet prevEventPart: number = 0;\n\t\t\t\tlet setInstrumentVolume: boolean = false;\n\t\t\t\t\n\t\t\t\tconst presetValue: number = EditorConfig.nameToPresetValue(\"standard drumset\")!;\n\t\t\t\tconst preset: Preset = EditorConfig.valueToPreset(presetValue)!;\n\t\t\t\tconst instrument: Instrument = new Instrument(false);\n\t\t\t\tinstrument.fromJsonObject(preset.settings, false, 1);\n\t\t\t\tinstrument.preset = presetValue;\n\t\t\t\tchannel.instruments.push(instrument);\n\n\t\t\t\tfor (let noteEventIndex: number = 0; noteEventIndex <= noteEvents[midiChannel].length; noteEventIndex++) {\n\t\t\t\t\tconst noMoreNotes: boolean = noteEventIndex == noteEvents[midiChannel].length;\n\t\t\t\t\tconst noteEvent: NoteEvent | null = noMoreNotes ? null : noteEvents[midiChannel][noteEventIndex];\n\t\t\t\t\tconst nextEventPart: number = noteEvent == null ? Number.MAX_SAFE_INTEGER : quantizeMidiTickToPart(noteEvent.midiTick);\n\t\t\t\t\tif (heldPitches.length > 0 && nextEventPart > prevEventPart && (noteEvent == null || noteEvent.on)) {\n\t\t\t\t\t\tconst bar: number = Math.floor(prevEventPart / partsPerBar);\n\t\t\t\t\t\tconst barStartPart: number = bar * partsPerBar;\n\t\t\t\t\t\t// Ensure a pattern exists for the current bar before inserting notes into it.\n\t\t\t\t\t\tif (currentBar != bar || pattern == null) {\n\t\t\t\t\t\t\tcurrentBar++;\n\t\t\t\t\t\t\twhile (currentBar < bar) {\n\t\t\t\t\t\t\t\tchannel.bars[currentBar] = 0;\n\t\t\t\t\t\t\t\tcurrentBar++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpattern = new Pattern();\n\t\t\t\t\t\t\tchannel.patterns.push(pattern);\n\t\t\t\t\t\t\tchannel.bars[currentBar] = channel.patterns.length;\n\t\t\t\t\t\t\tpattern.instruments[0] = 0;\n\t\t\t\t\t\t\tpattern.instruments.length = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Use the loudest volume setting for the instrument, since \n\t\t\t\t\t\t// many midis unfortunately use the instrument volume control to fade\n\t\t\t\t\t\t// in at the beginning and we don't want to get stuck with the initial\n\t\t\t\t\t\t// zero volume.\n\t\t\t\t\t\tif (!setInstrumentVolume || instrument.volume > currentInstrumentVolume) {\n\t\t\t\t\t\t\tinstrument.volume = currentInstrumentVolume;\n\t\t\t\t\t\t\tinstrument.pan = currentInstrumentPan;\n\t\t\t\t\t\t\tsetInstrumentVolume = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst drumFreqs: number[] = [];\n\t\t\t\t\t\tlet minDuration: number = channelMaxPitch;\n\t\t\t\t\t\tlet maxDuration: number = 0;\n\t\t\t\t\t\tlet noteSize: number = 1; // the minimum non-zero note size.\n\t\t\t\t\t\tfor (const pitch of heldPitches) {\n\t\t\t\t\t\t\tconst drum: AnalogousDrum | undefined = analogousDrumMap[pitch];\n\t\t\t\t\t\t\tif (drumFreqs.indexOf(drum.frequency) == -1) {\n\t\t\t\t\t\t\t\tdrumFreqs.push(drum.frequency);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnoteSize = Math.max(noteSize, Math.round(drum.volume * currentVelocity));\n\t\t\t\t\t\t\tminDuration = Math.min(minDuration, drum.duration);\n\t\t\t\t\t\t\tmaxDuration = Math.max(maxDuration, drum.duration);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst duration: number = Math.min(maxDuration, Math.max(minDuration, 2));\n\t\t\t\t\t\tconst noteStartPart: number = prevEventPart - barStartPart;\n\t\t\t\t\t\tconst noteEndPart: number = Math.min(partsPerBar, Math.min(nextEventPart - barStartPart, noteStartPart + duration * 6));\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst note: Note = new Note(-1, noteStartPart, noteEndPart, noteSize, true);\n\t\t\t\t\t\t\n\t\t\t\t\t\tnote.pitches.length = 0;\n\t\t\t\t\t\tfor (let pitchIndex: number = 0; pitchIndex < Math.min(Config.maxChordSize, drumFreqs.length); pitchIndex++) {\n\t\t\t\t\t\t\tconst heldPitch: number = drumFreqs[pitchIndex + Math.max(0, drumFreqs.length - Config.maxChordSize)];\n\t\t\t\t\t\t\tif (note.pitches.indexOf(heldPitch) == -1) {\n\t\t\t\t\t\t\t\tnote.pitches.push(heldPitch);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpattern.notes.push(note);\n\t\t\t\t\t\t\n\t\t\t\t\t\theldPitches.length = 0;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// Process the next midi note event before continuing, updating the list of currently held pitches.\n\t\t\t\t\tif (noteEvent != null && noteEvent.on && analogousDrumMap[noteEvent.pitch] != undefined) {\n\t\t\t\t\t\theldPitches.push(noteEvent.pitch);\n\t\t\t\t\t\tprevEventPart = nextEventPart;\n\t\t\t\t\t\tcurrentVelocity = noteEvent.velocity;\n\t\t\t\t\t\tcurrentInstrumentVolume = noteEvent.instrumentVolume;\n\t\t\t\t\t\tcurrentInstrumentPan = noteEvent.instrumentPan;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// If not a drumset, handle as a tonal instrument.\n\t\t\t\t\n\t\t\t\t// Advance the pitch bend and note size timelines to the given midiTick, \n\t\t\t\t// changing the value of currentMidiInterval or currentMidiNoteSize.\n\t\t\t\t// IMPORTANT: These functions can't rewind!\n\t\t\t\tlet currentMidiInterval: number = 0.0;\n\t\t\t\tlet currentMidiNoteSize: number = Config.noteSizeMax;\n\t\t\t\tlet pitchBendEventIndex: number = 0;\n\t\t\t\tlet noteSizeEventIndex: number = 0;\n\t\t\t\tfunction updateCurrentMidiInterval(midiTick: number) {\n\t\t\t\t\twhile (pitchBendEventIndex < pitchBendEvents[midiChannel].length && pitchBendEvents[midiChannel][pitchBendEventIndex].midiTick <= midiTick) {\n\t\t\t\t\t\tcurrentMidiInterval = pitchBendEvents[midiChannel][pitchBendEventIndex].interval;\n\t\t\t\t\t\tpitchBendEventIndex++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfunction updateCurrentMidiNoteSize(midiTick: number) {\n\t\t\t\t\twhile (noteSizeEventIndex < noteSizeEvents[midiChannel].length && noteSizeEvents[midiChannel][noteSizeEventIndex].midiTick <= midiTick) {\n\t\t\t\t\t\tcurrentMidiNoteSize = noteSizeEvents[midiChannel][noteSizeEventIndex].size;\n\t\t\t\t\t\tnoteSizeEventIndex++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst instrumentByProgram: Instrument[] = [];\n\t\t\t\tconst heldPitches: number[] = [];\n\t\t\t\tlet currentBar: number = -1;\n\t\t\t\tlet pattern: Pattern | null = null;\n\t\t\t\tlet prevEventMidiTick: number = 0;\n\t\t\t\tlet prevEventPart: number = 0;\n\t\t\t\tlet pitchSum: number = 0;\n\t\t\t\tlet pitchCount: number = 0;\n\t\t\t\t\n\t\t\t\tfor (let noteEvent of noteEvents[midiChannel]) {\n\t\t\t\t\tconst nextEventMidiTick: number = noteEvent.midiTick;\n\t\t\t\t\tconst nextEventPart: number = quantizeMidiTickToPart(nextEventMidiTick);\n\t\t\t\t\t\n\t\t\t\t\tif (heldPitches.length > 0 && nextEventPart > prevEventPart) {\n\t\t\t\t\t\t// If there are any pitches held between the previous event and the next\n\t\t\t\t\t\t// event, iterate over all bars covered by this time period, ensure they\n\t\t\t\t\t\t// have a pattern instantiated, and insert notes for these pitches.\n\t\t\t\t\t\tconst startBar: number = Math.floor(prevEventPart / partsPerBar);\n\t\t\t\t\t\tconst endBar: number = Math.ceil(nextEventPart / partsPerBar);\n\t\t\t\t\t\tlet createdNote: boolean = false;\n\t\t\t\t\t\tfor (let bar: number = startBar; bar < endBar; bar++) {\n\t\t\t\t\t\t\tconst barStartPart: number = bar * partsPerBar;\n\t\t\t\t\t\t\tconst barStartMidiTick: number = bar * beatsPerBar * midiTicksPerBeat;\n\t\t\t\t\t\t\tconst barEndMidiTick: number = (bar + 1) * beatsPerBar * midiTicksPerBeat;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst noteStartPart: number = Math.max(0, prevEventPart - barStartPart);\n\t\t\t\t\t\t\tconst noteEndPart: number = Math.min(partsPerBar, nextEventPart - barStartPart);\n\t\t\t\t\t\t\tconst noteStartMidiTick: number = Math.max(barStartMidiTick, prevEventMidiTick);\n\t\t\t\t\t\t\tconst noteEndMidiTick: number = Math.min(barEndMidiTick, nextEventMidiTick);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (noteStartPart < noteEndPart) {\n\t\t\t\t\t\t\t\tconst presetValue: number | null = EditorConfig.midiProgramToPresetValue(currentProgram);\n\t\t\t\t\t\t\t\tconst preset: Preset | null = (presetValue == null) ? null : EditorConfig.valueToPreset(presetValue);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// Ensure a pattern exists for the current bar before inserting notes into it.\n\t\t\t\t\t\t\t\tif (currentBar != bar || pattern == null) {\n\t\t\t\t\t\t\t\t\tcurrentBar++;\n\t\t\t\t\t\t\t\t\twhile (currentBar < bar) {\n\t\t\t\t\t\t\t\t\t\tchannel.bars[currentBar] = 0;\n\t\t\t\t\t\t\t\t\t\tcurrentBar++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tpattern = new Pattern();\n\t\t\t\t\t\t\t\t\tchannel.patterns.push(pattern);\n\t\t\t\t\t\t\t\t\tchannel.bars[currentBar] = channel.patterns.length;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// If this is the first time a note is trying to use a specific instrument\n\t\t\t\t\t\t\t\t\t// program in this channel, create a new BeepBox instrument for it.\n\t\t\t\t\t\t\t\t\tif (instrumentByProgram[currentProgram] == undefined) {\n\t\t\t\t\t\t\t\t\t\tconst instrument: Instrument = new Instrument(isNoiseChannel);\n\t\t\t\t\t\t\t\t\t\tinstrumentByProgram[currentProgram] = instrument;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif (presetValue != null && preset != null && (preset.isNoise == true) == isNoiseChannel) {\n\t\t\t\t\t\t\t\t\t\t\tinstrument.fromJsonObject(preset.settings, isNoiseChannel, 1);\n\t\t\t\t\t\t\t\t\t\t\tinstrument.preset = presetValue;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tinstrument.setTypeAndReset(isNoiseChannel ? InstrumentType.noise : InstrumentType.chip, isNoiseChannel);\n\t\t\t\t\t\t\t\t\t\t\tinstrument.chord = 0; // Midi instruments use polyphonic harmony by default.\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tinstrument.volume = currentInstrumentVolume;\n\t\t\t\t\t\t\t\t\t\tinstrument.pan = currentInstrumentPan;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tchannel.instruments.push(instrument);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tpattern.instruments[0] = channel.instruments.indexOf(instrumentByProgram[currentProgram]);\n\t\t\t\t\t\t\t\t\tpattern.instruments.length = 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// Use the loudest volume setting for the instrument, since \n\t\t\t\t\t\t\t\t// many midis unfortunately use the instrument volume control to fade\n\t\t\t\t\t\t\t\t// in at the beginning and we don't want to get stuck with the initial\n\t\t\t\t\t\t\t\t// zero volume.\n\t\t\t\t\t\t\t\tif (instrumentByProgram[currentProgram] != undefined) {\n\t\t\t\t\t\t\t\t\tinstrumentByProgram[currentProgram].volume = Math.min(instrumentByProgram[currentProgram].volume, currentInstrumentVolume);\n\t\t\t\t\t\t\t\t\tinstrumentByProgram[currentProgram].pan = Math.min(instrumentByProgram[currentProgram].pan, currentInstrumentPan);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// Create a new note, and interpret the pitch bend and note size events\n\t\t\t\t\t\t\t\t// to determine where we need to insert pins to control interval and size.\n\t\t\t\t\t\t\t\tconst note: Note = new Note(-1, noteStartPart, noteEndPart, Config.noteSizeMax, false);\n\t\t\t\t\t\t\t\tnote.pins.length = 0;\n\t\t\t\t\t\t\t\tnote.continuesLastPattern = (createdNote && noteStartPart == 0);\n\t\t\t\t\t\t\t\tcreatedNote = true;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tupdateCurrentMidiInterval(noteStartMidiTick);\n\t\t\t\t\t\t\t\tupdateCurrentMidiNoteSize(noteStartMidiTick);\n\t\t\t\t\t\t\t\tconst shiftedHeldPitch: number = heldPitches[0] * midiIntervalScale - channelBasePitch;\n\t\t\t\t\t\t\t\tconst initialBeepBoxPitch: number = Math.round((shiftedHeldPitch + currentMidiInterval) / intervalScale);\n\t\t\t\t\t\t\t\tconst heldPitchOffset: number = Math.round(currentMidiInterval - channelBasePitch);\n\t\t\t\t\t\t\t\tlet firstPin: NotePin = makeNotePin(0, 0, Math.round(currentVelocity * currentMidiNoteSize));\n\t\t\t\t\t\t\t\tnote.pins.push(firstPin);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tinterface PotentialPin {\n\t\t\t\t\t\t\t\t\tpart: number;\n\t\t\t\t\t\t\t\t\tpitch: number;\n\t\t\t\t\t\t\t\t\tsize: number;\n\t\t\t\t\t\t\t\t\tkeyPitch: boolean;\n\t\t\t\t\t\t\t\t\tkeySize: boolean;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst potentialPins: PotentialPin[] = [\n\t\t\t\t\t\t\t\t\t{part: 0, pitch: initialBeepBoxPitch, size: firstPin.size, keyPitch: false, keySize: false}\n\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\tlet prevPinIndex: number = 0;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tlet prevPartPitch: number = (shiftedHeldPitch + currentMidiInterval) / intervalScale;\n\t\t\t\t\t\t\t\tlet prevPartSize: number = currentVelocity * currentMidiNoteSize;\n\t\t\t\t\t\t\t\tfor (let part: number = noteStartPart + 1; part <= noteEndPart; part++) {\n\t\t\t\t\t\t\t\t\tconst midiTick: number = Math.max(noteStartMidiTick, Math.min(noteEndMidiTick - 1, Math.round(midiTicksPerPart * (part + barStartPart))));\n\t\t\t\t\t\t\t\t\tconst noteRelativePart: number = part - noteStartPart;\n\t\t\t\t\t\t\t\t\tconst lastPart: boolean = (part == noteEndPart);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t// BeepBox can only add pins at whole number intervals and sizes. Detect places where\n\t\t\t\t\t\t\t\t\t// the interval or size are at or cross whole numbers, and add these to the list of\n\t\t\t\t\t\t\t\t\t// potential places to insert pins.\n\t\t\t\t\t\t\t\t\tupdateCurrentMidiInterval(midiTick);\n\t\t\t\t\t\t\t\t\tupdateCurrentMidiNoteSize(midiTick);\n\t\t\t\t\t\t\t\t\tconst partPitch: number = (currentMidiInterval + shiftedHeldPitch) / intervalScale;\n\t\t\t\t\t\t\t\t\tconst partSize: number = currentVelocity * currentMidiNoteSize;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tconst nearestPitch: number = Math.round(partPitch);\n\t\t\t\t\t\t\t\t\tconst pitchIsNearInteger: boolean = Math.abs(partPitch - nearestPitch) < 0.01;\n\t\t\t\t\t\t\t\t\tconst pitchCrossedInteger: boolean = (Math.abs(prevPartPitch - Math.round(prevPartPitch)) < 0.01)\n\t\t\t\t\t\t\t\t\t\t? Math.abs(partPitch - prevPartPitch) >= 1.0\n\t\t\t\t\t\t\t\t\t\t: Math.floor(partPitch) != Math.floor(prevPartPitch);\n\t\t\t\t\t\t\t\t\tconst keyPitch: boolean = pitchIsNearInteger || pitchCrossedInteger;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tconst nearestSize: number = Math.round(partSize);\n\t\t\t\t\t\t\t\t\tconst sizeIsNearInteger: boolean = Math.abs(partSize - nearestSize) < 0.01;\n\t\t\t\t\t\t\t\t\tconst sizeCrossedInteger: boolean = (Math.abs(prevPartSize - Math.round(prevPartSize)))\n\t\t\t\t\t\t\t\t\t\t? Math.abs(partSize - prevPartSize) >= 1.0\n\t\t\t\t\t\t\t\t\t\t: Math.floor(partSize) != Math.floor(prevPartSize);\n\t\t\t\t\t\t\t\t\tconst keySize: boolean = sizeIsNearInteger || sizeCrossedInteger;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tprevPartPitch = partPitch;\n\t\t\t\t\t\t\t\t\tprevPartSize = partSize;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (keyPitch || keySize || lastPart) {\n\t\t\t\t\t\t\t\t\t\tconst currentPin: PotentialPin = {part: noteRelativePart, pitch: nearestPitch, size: nearestSize, keyPitch: keyPitch || lastPart, keySize: keySize || lastPart};\n\t\t\t\t\t\t\t\t\t\tconst prevPin: PotentialPin = potentialPins[prevPinIndex];\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t// At all key points in the list of potential pins, check to see if they\n\t\t\t\t\t\t\t\t\t\t// continue the recent slope. If not, insert a pin at the corner, where\n\t\t\t\t\t\t\t\t\t\t// the recent recorded values deviate the furthest from the slope.\n\t\t\t\t\t\t\t\t\t\tlet addPin: boolean = false;\n\t\t\t\t\t\t\t\t\t\tlet addPinAtIndex: number = Number.MAX_VALUE;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif (currentPin.keyPitch) {\n\t\t\t\t\t\t\t\t\t\t\tconst slope: number = (currentPin.pitch - prevPin.pitch) / (currentPin.part - prevPin.part);\n\t\t\t\t\t\t\t\t\t\t\tlet furthestIntervalDistance: number = Math.abs(slope); // minimum distance to make a new pin.\n\t\t\t\t\t\t\t\t\t\t\tlet addIntervalPin: boolean = false;\n\t\t\t\t\t\t\t\t\t\t\tlet addIntervalPinAtIndex: number = Number.MAX_VALUE;\n\t\t\t\t\t\t\t\t\t\t\tfor (let potentialIndex: number = prevPinIndex + 1; potentialIndex < potentialPins.length; potentialIndex++) {\n\t\t\t\t\t\t\t\t\t\t\t\tconst potentialPin: PotentialPin = potentialPins[potentialIndex];\n\t\t\t\t\t\t\t\t\t\t\t\tif (potentialPin.keyPitch) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst interpolatedInterval: number = prevPin.pitch + slope * (potentialPin.part - prevPin.part);\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst distance: number = Math.abs(interpolatedInterval - potentialPin.pitch);\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (furthestIntervalDistance < distance) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfurthestIntervalDistance = distance;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddIntervalPin = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddIntervalPinAtIndex = potentialIndex;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (addIntervalPin) {\n\t\t\t\t\t\t\t\t\t\t\t\taddPin = true;\n\t\t\t\t\t\t\t\t\t\t\t\taddPinAtIndex = Math.min(addPinAtIndex, addIntervalPinAtIndex);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif (currentPin.keySize) {\n\t\t\t\t\t\t\t\t\t\t\tconst slope: number = (currentPin.size - prevPin.size) / (currentPin.part - prevPin.part);\n\t\t\t\t\t\t\t\t\t\t\tlet furthestSizeDistance: number = Math.abs(slope); // minimum distance to make a new pin.\n\t\t\t\t\t\t\t\t\t\t\tlet addSizePin: boolean = false;\n\t\t\t\t\t\t\t\t\t\t\tlet addSizePinAtIndex: number = Number.MAX_VALUE;\n\t\t\t\t\t\t\t\t\t\t\tfor (let potentialIndex: number = prevPinIndex + 1; potentialIndex < potentialPins.length; potentialIndex++) {\n\t\t\t\t\t\t\t\t\t\t\t\tconst potentialPin: PotentialPin = potentialPins[potentialIndex];\n\t\t\t\t\t\t\t\t\t\t\t\tif (potentialPin.keySize) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst interpolatedSize: number = prevPin.size + slope * (potentialPin.part - prevPin.part);\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst distance: number = Math.abs(interpolatedSize - potentialPin.size);\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (furthestSizeDistance < distance) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfurthestSizeDistance = distance;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddSizePin = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddSizePinAtIndex = potentialIndex;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tif (addSizePin) {\n\t\t\t\t\t\t\t\t\t\t\t\taddPin = true;\n\t\t\t\t\t\t\t\t\t\t\t\taddPinAtIndex = Math.min(addPinAtIndex, addSizePinAtIndex);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif (addPin) {\n\t\t\t\t\t\t\t\t\t\t\tconst toBePinned: PotentialPin = potentialPins[addPinAtIndex];\n\t\t\t\t\t\t\t\t\t\t\tnote.pins.push(makeNotePin(toBePinned.pitch - initialBeepBoxPitch, toBePinned.part, toBePinned.size));\n\t\t\t\t\t\t\t\t\t\t\tprevPinIndex = addPinAtIndex;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tpotentialPins.push(currentPin);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// And always add a pin at the end of the note.\n\t\t\t\t\t\t\t\tconst lastToBePinned: PotentialPin = potentialPins[potentialPins.length - 1];\n\t\t\t\t\t\t\t\tnote.pins.push(makeNotePin(lastToBePinned.pitch - initialBeepBoxPitch, lastToBePinned.part, lastToBePinned.size));\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// Use interval range to constrain min/max pitches so no pin is out of bounds.\n\t\t\t\t\t\t\t\tlet maxPitch: number = channelMaxPitch;\n\t\t\t\t\t\t\t\tlet minPitch: number = 0;\n\t\t\t\t\t\t\t\tfor (const notePin of note.pins) {\n\t\t\t\t\t\t\t\t\tmaxPitch = Math.min(maxPitch, channelMaxPitch - notePin.interval);\n\t\t\t\t\t\t\t\t\tminPitch = Math.min(minPitch, -notePin.interval);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// Build the note chord out of the current pitches, shifted into BeepBox channelBasePitch relative values.\n\t\t\t\t\t\t\t\tnote.pitches.length = 0;\n\t\t\t\t\t\t\t\tfor (let pitchIndex: number = 0; pitchIndex < Math.min(Config.maxChordSize, heldPitches.length); pitchIndex++) {\n\t\t\t\t\t\t\t\t\tlet heldPitch: number = heldPitches[pitchIndex + Math.max(0, heldPitches.length - Config.maxChordSize)] * midiIntervalScale;\n\t\t\t\t\t\t\t\t\tif (preset != null && preset.midiSubharmonicOctaves != undefined) {\n\t\t\t\t\t\t\t\t\t\theldPitch -= 12 * preset.midiSubharmonicOctaves;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst shiftedPitch: number = Math.max(minPitch, Math.min(maxPitch, Math.round((heldPitch + heldPitchOffset) / intervalScale)));\n\t\t\t\t\t\t\t\t\tif (note.pitches.indexOf(shiftedPitch) == -1) {\n\t\t\t\t\t\t\t\t\t\tnote.pitches.push(shiftedPitch);\n\t\t\t\t\t\t\t\t\t\tconst weight: number = note.end - note.start;\n\t\t\t\t\t\t\t\t\t\tpitchSum += shiftedPitch * weight;\n\t\t\t\t\t\t\t\t\t\tpitchCount += weight;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpattern.notes.push(note);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// Process the next midi note event before continuing, updating the list of currently held pitches.\n\t\t\t\t\tif (heldPitches.indexOf(noteEvent.pitch) != -1) {\n\t\t\t\t\t\theldPitches.splice(heldPitches.indexOf(noteEvent.pitch), 1);\n\t\t\t\t\t}\n\t\t\t\t\tif (noteEvent.on) {\n\t\t\t\t\t\theldPitches.push(noteEvent.pitch);\n\t\t\t\t\t\tcurrentVelocity = noteEvent.velocity;\n\t\t\t\t\t\tcurrentProgram = noteEvent.program;\n\t\t\t\t\t\tcurrentInstrumentVolume = noteEvent.instrumentVolume;\n\t\t\t\t\t\tcurrentInstrumentPan = noteEvent.instrumentPan;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tprevEventMidiTick = nextEventMidiTick;\n\t\t\t\t\tprevEventPart = nextEventPart;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst averagePitch: number = pitchSum / pitchCount;\n\t\t\t\tchannel.octave = isNoiseChannel ? 0 : Math.max(0, Math.min(Config.pitchOctaves - 1, Math.floor(averagePitch / 12)));\n\t\t\t}\n\t\t\t\t\n\t\t\twhile (channel.bars.length < songTotalBars) {\n\t\t\t\tchannel.bars.push(0);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// For better or for worse, BeepBox has a more limited number of channels than Midi.\n\t\t// To compensate, try to merge non-overlapping channels.\n\t\tfunction compactChannels(channels: Channel[], maxLength: number): void {\n\t\t\twhile (channels.length > maxLength) {\n\t\t\t\tlet bestChannelIndexA: number = channels.length - 2;\n\t\t\t\tlet bestChannelIndexB: number = channels.length - 1;\n\t\t\t\tlet fewestConflicts: number = Number.MAX_VALUE;\n\t\t\t\tlet fewestGaps: number = Number.MAX_VALUE;\n\t\t\t\tfor (let channelIndexA: number = 0; channelIndexA < channels.length - 1; channelIndexA++) {\n\t\t\t\t\tfor (let channelIndexB: number = channelIndexA + 1; channelIndexB < channels.length; channelIndexB++) {\n\t\t\t\t\t\tconst channelA: Channel = channels[channelIndexA];\n\t\t\t\t\t\tconst channelB: Channel = channels[channelIndexB];\n\t\t\t\t\t\tlet conflicts: number = 0;\n\t\t\t\t\t\tlet gaps: number = 0;\n\t\t\t\t\t\tfor (let barIndex: number = 0; barIndex < channelA.bars.length && barIndex < channelB.bars.length; barIndex++) {\n\t\t\t\t\t\t\tif (channelA.bars[barIndex] != 0 && channelB.bars[barIndex] != 0) conflicts++;\n\t\t\t\t\t\t\tif (channelA.bars[barIndex] == 0 && channelB.bars[barIndex] == 0) gaps++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (conflicts <= fewestConflicts) {\n\t\t\t\t\t\t\tif (conflicts < fewestConflicts || gaps < fewestGaps) {\n\t\t\t\t\t\t\t\tbestChannelIndexA = channelIndexA;\n\t\t\t\t\t\t\t\tbestChannelIndexB = channelIndexB;\n\t\t\t\t\t\t\t\tfewestConflicts = conflicts;\n\t\t\t\t\t\t\t\tfewestGaps = gaps;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Merge channelB's patterns, instruments, and bars into channelA.\n\t\t\t\tconst channelA: Channel = channels[bestChannelIndexA];\n\t\t\t\tconst channelB: Channel = channels[bestChannelIndexB];\n\t\t\t\tconst channelAInstrumentCount: number = channelA.instruments.length;\n\t\t\t\tconst channelAPatternCount: number = channelA.patterns.length;\n\t\t\t\tfor (const instrument of channelB.instruments) {\n\t\t\t\t\tchannelA.instruments.push(instrument);\n\t\t\t\t}\n\t\t\t\tfor (const pattern of channelB.patterns) {\n\t\t\t\t\tpattern.instruments[0] += channelAInstrumentCount;\n\t\t\t\t\tchannelA.patterns.push(pattern);\n\t\t\t\t}\n\t\t\t\tfor (let barIndex: number = 0; barIndex < channelA.bars.length && barIndex < channelB.bars.length; barIndex++) {\n\t\t\t\t\tif (channelA.bars[barIndex] == 0 && channelB.bars[barIndex] != 0) {\n\t\t\t\t\t\tchannelA.bars[barIndex] = channelB.bars[barIndex] + channelAPatternCount;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Remove channelB.\n\t\t\t\tchannels.splice(bestChannelIndexB, 1);\n\t\t\t}\n\t\t}\n\t\t\n\t\tcompactChannels(pitchChannels, Config.pitchChannelCountMax);\n\t\tcompactChannels(noiseChannels, Config.noiseChannelCountMax);\n\t\t\n\t\tclass ChangeImportMidi extends ChangeGroup {\n\t\t\tconstructor(doc: SongDocument) {\n\t\t\t\tsuper();\n\t\t\t\tconst song: Song = doc.song;\n\t\t\t\tsong.tempo = beatsPerMinute;\n\t\t\t\tsong.beatsPerBar = beatsPerBar;\n\t\t\t\tsong.key = key;\n\t\t\t\tsong.scale = 11;\n\t\t\t\tsong.rhythm = 1;\n\t\t\t\tsong.layeredInstruments = false;\n\t\t\t\tsong.patternInstruments = pitchChannels.some(channel => channel.instruments.length > 1) || noiseChannels.some(channel => channel.instruments.length > 1);\n\t\t\t\t\n\t\t\t\tremoveDuplicatePatterns(pitchChannels);\n\t\t\t\tremoveDuplicatePatterns(noiseChannels);\n\t\t\t\t\n\t\t\t\tthis.append(new ChangeReplacePatterns(doc, pitchChannels, noiseChannels));\n\t\t\t\tsong.loopStart = 0;\n\t\t\t\tsong.loopLength = song.barCount;\n\t\t\t\tthis._didSomething();\n\t\t\t\tdoc.notifier.changed();\n\t\t\t}\n\t\t}\n\t\tthis._doc.goBackToStart();\n\t\tfor (const channel of this._doc.song.channels) channel.muted = false;\n\t\tthis._doc.prompt = null;\n\t\tthis._doc.record(new ChangeImportMidi(this._doc), true, true);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Dictionary} from \"../synth/SynthConfig\";\nimport {Song} from \"../synth/synth\";\n\nexport interface RecoveredVersion {\n\tuid: string;\n\ttime: number;\n\twork: number;\n}\n\nexport interface RecoveredSong {\n\tversions: RecoveredVersion[];\n}\n\nconst versionPrefix = \"songVersion: \";\nconst maximumSongCount = 8;\nconst maximumWorkPerVersion = 3 * 60 * 1000; // 3 minutes\nconst minimumWorkPerSpan = 1 * 60 * 1000; // 1 minute\n\nfunction keyIsVersion(key: string): boolean {\n\treturn key.indexOf(versionPrefix) == 0;\n}\n\nfunction keyToVersion(key: string): RecoveredVersion {\n\treturn JSON.parse(key.substring(versionPrefix.length));\n}\n\nexport function versionToKey(version: RecoveredVersion): string {\n\treturn versionPrefix + JSON.stringify(version);\n}\n\nexport function generateUid(): string {\n\t// Not especially robust, but simple and effective!\n\treturn ((Math.random() * (-1 >>> 0)) >>> 0).toString(32);\n}\n\nfunction compareSongs(a: RecoveredSong, b: RecoveredSong): number {\n\treturn b.versions[0].time - a.versions[0].time;\n}\n\nfunction compareVersions(a: RecoveredVersion, b: RecoveredVersion): number {\n\treturn b.time - a.time;\n}\n\t\nexport class SongRecovery {\n\tprivate _saveVersionTimeoutHandle: ReturnType<typeof setTimeout>;\n\t\n\tprivate _song: Song = new Song();\n\t\n\tpublic static getAllRecoveredSongs(): RecoveredSong[] {\n\t\tconst songs: RecoveredSong[] = [];\n\t\tconst songsByUid: Dictionary<RecoveredSong> = {};\n\t\tfor (let i = 0; i < localStorage.length; i++) {\n\t\t\tconst itemKey: string = localStorage.key(i)!;\n\t\t\tif (keyIsVersion(itemKey)) {\n\t\t\t\tconst version: RecoveredVersion = keyToVersion(itemKey);\n\t\t\t\tlet song: RecoveredSong | undefined = songsByUid[version.uid];\n\t\t\t\tif (song == undefined) {\n\t\t\t\t\tsong = {versions: []};\n\t\t\t\t\tsongsByUid[version.uid] = song;\n\t\t\t\t\tsongs.push(song);\n\t\t\t\t}\n\t\t\t\tsong.versions.push(version);\n\t\t\t}\n\t\t}\n\t\tfor (const song of songs) {\n\t\t\tsong.versions.sort(compareVersions);\n\t\t}\n\t\tsongs.sort(compareSongs);\n\t\treturn songs;\n\t}\n\t\n\tpublic saveVersion(uid: string, songData: string): void {\n\t\tconst newTime: number = Math.round(Date.now());\n\t\t\n\t\tclearTimeout(this._saveVersionTimeoutHandle);\n\t\tthis._saveVersionTimeoutHandle = setTimeout((): void => {\n\t\t\ttry {\n\t\t\t\t// Ensure that the song is not corrupted.\n\t\t\t\tthis._song.fromBase64String(songData);\n\t\t\t} catch (error) {\n\t\t\t\twindow.alert(\"Whoops, the song data appears to have been corrupted! Please try to recover the last working version of the song from the \\\"Recover Recent Song...\\\" option in BeepBox's \\\"File\\\" menu.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tconst songs: RecoveredSong[] = SongRecovery.getAllRecoveredSongs();\n\t\t\tlet currentSong: RecoveredSong | null = null;\n\t\t\tfor (const song of songs) {\n\t\t\t\tif (song.versions[0].uid == uid) {\n\t\t\t\t\tcurrentSong = song;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (currentSong == null) {\n\t\t\t\tcurrentSong = {versions: []};\n\t\t\t\tsongs.unshift(currentSong);\n\t\t\t}\n\t\t\tlet versions: RecoveredVersion[] = currentSong.versions;\n\t\t\t\n\t\t\tlet newWork: number = 1000; // default to 1 second of work for the first change.\n\t\t\tif (versions.length > 0) {\n\t\t\t\tconst mostRecentTime: number = versions[0].time;\n\t\t\t\tconst mostRecentWork: number = versions[0].work;\n\t\t\t\tnewWork = mostRecentWork + Math.min(maximumWorkPerVersion, newTime - mostRecentTime);\n\t\t\t}\n\t\t\t\n\t\t\tconst newVersion: RecoveredVersion = {uid: uid, time: newTime, work: newWork};\n\t\t\tconst newKey: string = versionToKey(newVersion);\n\t\t\tversions.unshift(newVersion);\n\t\t\tlocalStorage.setItem(newKey, songData);\n\t\t\t\n\t\t\t// Consider deleting an old version to free up space.\n\t\t\tlet minSpan: number = minimumWorkPerSpan; // start out with a gap between versions.\n\t\t\tconst spanMult: number = Math.pow(2, 1 / 2); // Double the span every 2 versions back.\n\t\t\tfor (var i: number = 1; i < versions.length; i++) {\n\t\t\t\tconst currentWork: number = versions[i].work;\n\t\t\t\tconst olderWork: number = (i == versions.length - 1) ? 0.0 : versions[i + 1].work;\n\t\t\t\t// If not enough work happened between two versions, discard one of them.\n\t\t\t\tif (currentWork - olderWork < minSpan) {\n\t\t\t\t\tlet indexToDiscard: number = i;\n\t\t\t\t\tif (i < versions.length - 1) {\n\t\t\t\t\t\tconst currentTime: number = versions[i].time;\n\t\t\t\t\t\tconst newerTime: number = versions[i - 1].time;\n\t\t\t\t\t\tconst olderTime: number = versions[i + 1].time;\n\t\t\t\t\t\t// Weird heuristic: Between the three adjacent versions, prefer to keep\n\t\t\t\t\t\t// the newest and the oldest, discarding the middle one (i), unless\n\t\t\t\t\t\t// there is a large gap of time between the newest and middle one, in\n\t\t\t\t\t\t// which case the middle one represents the end of a span of work and is\n\t\t\t\t\t\t// thus more memorable.\n\t\t\t\t\t\tif ((currentTime - olderTime) < 0.5 * (newerTime - currentTime)) {\n\t\t\t\t\t\t\tindexToDiscard = i + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlocalStorage.removeItem(versionToKey(versions[indexToDiscard]));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tminSpan *= spanMult;\n\t\t\t}\n\t\t\t\n\t\t\t// If there are too many songs, discard the least important ones.\n\t\t\t// Songs that are older, or have less work, are less important.\n\t\t\twhile (songs.length > maximumSongCount) {\n\t\t\t\tlet leastImportantSong: RecoveredSong | null = null;\n\t\t\t\tlet leastImportance: number = Number.POSITIVE_INFINITY;\n\t\t\t\tfor (let i: number = Math.round(maximumSongCount / 2); i < songs.length; i++) {\n\t\t\t\t\tconst song: RecoveredSong = songs[i];\n\t\t\t\t\tconst timePassed: number = newTime - song.versions[0].time;\n\t\t\t\t\t// Convert the time into a factor of 12 hours, add one, then divide by the result.\n\t\t\t\t\t// This creates a curve that starts at 1, and then gradually drops off.\n\t\t\t\t\tconst timeScale: number = 1.0 / ((timePassed / (12 * 60 * 60 * 1000)) + 1.0);\n\t\t\t\t\t// Add 5 minutes of work, to balance out simple songs a little bit.\n\t\t\t\t\tconst adjustedWork: number = song.versions[0].work + 5 * 60 * 1000;\n\t\t\t\t\tconst weight: number = adjustedWork * timeScale;\n\t\t\t\t\tif (leastImportance > weight) {\n\t\t\t\t\t\tleastImportance = weight;\n\t\t\t\t\t\tleastImportantSong = song;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const version of leastImportantSong!.versions) {\n\t\t\t\t\tlocalStorage.removeItem(versionToKey(version));\n\t\t\t\t}\n\t\t\t\tsongs.splice(songs.indexOf(leastImportantSong!), 1);\n\t\t\t}\n\t\t}, 750); // Wait 3/4 of a second before saving a version.\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {SongDocument} from \"./SongDocument\";\nimport {RecoveredSong, RecoveredVersion, SongRecovery, versionToKey} from \"./SongRecovery\";\nimport {Prompt} from \"./Prompt\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\n\nconst {button, div, h2, p, select, option, iframe} = HTML;\n\nexport class SongRecoveryPrompt implements Prompt {\n\tprivate readonly _songContainer: HTMLDivElement = div();\n\tprivate readonly _cancelButton: HTMLButtonElement = button({class: \"cancelButton\"});\n\t\n\tpublic readonly container: HTMLDivElement = div({class: \"prompt\", style: \"width: 300px;\"},\n\t\th2(\"Song Recovery\"),\n\t\tdiv({style: \"max-height: 385px; overflow-y: auto;\"},\n\t\t\tp(\"This is a TEMPORARY list of songs you have recently modified. Please keep your own backups of songs you care about!\"),\n\t\t\tthis._songContainer,\n\t\t\tp(\"(If \\\"Display Song Data in URL\\\" is enabled in your preferences, then you may also be able to find song versions in your browser history. However, song recovery won't work if you were browsing in private/incognito mode.)\"),\n\t\t),\n\t\tthis._cancelButton,\n\t);\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._cancelButton.addEventListener(\"click\", this._close);\n\t\t\n\t\tconst songs: RecoveredSong[] = SongRecovery.getAllRecoveredSongs();\n\t\t\n\t\tif (songs.length == 0) {\n\t\t\tthis._songContainer.appendChild(p(\"There are no recovered songs available yet. Try making a song!\"));\n\t\t}\n\t\t\n\t\tfor (const song of songs) {\n\t\t\tconst versionMenu: HTMLSelectElement = select({style: \"width: 100%;\"});\n\t\t\t\n\t\t\tfor (const version of song.versions) {\n\t\t\t\tversionMenu.appendChild(option({value: version.time}, new Date(version.time).toLocaleString()));\n\t\t\t}\n\t\t\t\n\t\t\tconst player: HTMLIFrameElement = iframe({style: \"width: 100%; height: 60px; border: none; display: block;\"});\n\t\t\tplayer.src = \"player/#song=\" + window.localStorage.getItem(versionToKey(song.versions[0]));\n\t\t\tconst container: HTMLDivElement = div({style: \"margin: 4px 0;\"}, div({class: \"selectContainer\", style: \"width: 100%; margin: 2px 0;\"}, versionMenu), player);\n\t\t\tthis._songContainer.appendChild(container);\n\t\t\t\n\t\t\tversionMenu.addEventListener(\"change\", () => {\n\t\t\t\tconst version: RecoveredVersion = song.versions[versionMenu.selectedIndex];\n\t\t\t\tplayer.contentWindow!.location.replace(\"player/#song=\" + window.localStorage.getItem(versionToKey(version)));\n\t\t\t\tplayer.contentWindow!.dispatchEvent(new Event(\"hashchange\"));\n\t\t\t});\n\t\t}\n\t}\n\t\n\tprivate _close = (): void => { \n\t\tthis._doc.undo();\n\t}\n\t\n\tpublic cleanUp = (): void => { \n\t\tthis._cancelButton.removeEventListener(\"click\", this._close);\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {InstrumentType, EffectType, Config, getPulseWidthRatio, effectsIncludeTransition, effectsIncludeChord, effectsIncludePitchShift, effectsIncludeDetune, effectsIncludeVibrato, effectsIncludeNoteFilter, effectsIncludeDistortion, effectsIncludeBitcrusher, effectsIncludePanning, effectsIncludeChorus, effectsIncludeEcho, effectsIncludeReverb} from \"../synth/SynthConfig\";\nimport {Preset, PresetCategory, EditorConfig, isMobile, prettyNumber} from \"./EditorConfig\";\nimport {ColorConfig, ChannelColors} from \"./ColorConfig\";\nimport \"./Layout\"; // Imported here for the sake of ensuring this code is transpiled early.\nimport {Instrument, Channel, Synth} from \"../synth/synth\";\nimport {HTML} from \"imperative-html/dist/esm/elements-strict\";\nimport {SongDocument} from \"./SongDocument\";\nimport {Prompt} from \"./Prompt\";\nimport {TipPrompt} from \"./TipPrompt\";\nimport {PatternEditor} from \"./PatternEditor\";\nimport {EnvelopeEditor} from \"./EnvelopeEditor\";\nimport {FadeInOutEditor} from \"./FadeInOutEditor\";\nimport {FilterEditor} from \"./FilterEditor\";\nimport {MuteEditor} from \"./MuteEditor\";\nimport {TrackEditor} from \"./TrackEditor\";\nimport {LayoutPrompt} from \"./LayoutPrompt\";\nimport {LoopEditor} from \"./LoopEditor\";\nimport {SpectrumEditor} from \"./SpectrumEditor\";\nimport {HarmonicsEditor} from \"./HarmonicsEditor\";\nimport {BarScrollBar} from \"./BarScrollBar\";\nimport {OctaveScrollBar} from \"./OctaveScrollBar\";\nimport {Piano} from \"./Piano\";\nimport {BeatsPerBarPrompt} from \"./BeatsPerBarPrompt\";\nimport {MoveNotesSidewaysPrompt} from \"./MoveNotesSidewaysPrompt\";\nimport {SongDurationPrompt} from \"./SongDurationPrompt\";\nimport {ChannelSettingsPrompt} from \"./ChannelSettingsPrompt\";\nimport {ExportPrompt} from \"./ExportPrompt\";\nimport {ImportPrompt} from \"./ImportPrompt\";\nimport {SongRecoveryPrompt} from \"./SongRecoveryPrompt\";\nimport {Change} from \"./Change\";\nimport {ChangeTempo, ChangeChorus, ChangeEchoDelay, ChangeEchoSustain, ChangeReverb, ChangeVolume, ChangePan, ChangePatternSelection, ChangePulseWidth, ChangeFeedbackAmplitude, ChangeOperatorAmplitude, ChangeOperatorFrequency, ChangeDrumsetEnvelope, ChangePasteInstrument, ChangePreset, pickRandomPresetValue, ChangeRandomGeneratedInstrument, ChangeScale, ChangeDetectKey, ChangeKey, ChangeRhythm, ChangeFeedbackType, ChangeAlgorithm, ChangeCustomizeInstrument, ChangeChipWave, ChangeNoiseWave, ChangeTransition, ChangeToggleEffects, ChangeVibrato, ChangeUnison, ChangeChord, ChangeSong, ChangePitchShift, ChangeDetune, ChangeDistortion, ChangeStringSustain, ChangeBitcrusherFreq, ChangeBitcrusherQuantization, ChangeAddEnvelope, ChangeAddChannelInstrument, ChangeRemoveChannelInstrument} from \"./changes\";\n\nconst {a, button, div, input, select, span, optgroup, option} = HTML;\n\nfunction buildOptions(menu: HTMLSelectElement, items: ReadonlyArray<string | number>): HTMLSelectElement {\n\tfor (let index: number = 0; index < items.length; index++) {\n\t\tmenu.appendChild(option({value: index}, items[index]));\n\t} \n\treturn menu;\n}\n\nfunction buildPresetOptions(isNoise: boolean): HTMLSelectElement {\n\tconst menu: HTMLSelectElement = select();\n\t\n\tmenu.appendChild(optgroup({label: \"Edit\"},\n\t\toption({value: \"copyInstrument\"}, \"Copy Instrument (⇧C)\"),\n\t\toption({value: \"pasteInstrument\"}, \"Paste Instrument (⇧V)\"),\n\t\toption({value: \"randomPreset\"}, \"Random Preset (R)\"),\n\t\toption({value: \"randomGenerated\"}, \"Random Generated (⇧R)\"),\n\t));\n\t\n\t// Show the \"spectrum\" custom type in both pitched and noise channels.\n\tconst customTypeGroup: HTMLElement = optgroup({label: EditorConfig.presetCategories[0].name});\n\tif (isNoise) {\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.noise}, EditorConfig.valueToPreset(InstrumentType.noise)!.name));\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.spectrum}, EditorConfig.valueToPreset(InstrumentType.spectrum)!.name));\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.drumset}, EditorConfig.valueToPreset(InstrumentType.drumset)!.name));\n\t} else {\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.chip}, EditorConfig.valueToPreset(InstrumentType.chip)!.name));\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.pwm}, EditorConfig.valueToPreset(InstrumentType.pwm)!.name));\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.harmonics}, EditorConfig.valueToPreset(InstrumentType.harmonics)!.name));\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.pickedString}, EditorConfig.valueToPreset(InstrumentType.pickedString)!.name));\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.spectrum}, EditorConfig.valueToPreset(InstrumentType.spectrum)!.name));\n\t\tcustomTypeGroup.appendChild(option({value: InstrumentType.fm}, EditorConfig.valueToPreset(InstrumentType.fm)!.name));\n\t}\n\tmenu.appendChild(customTypeGroup);\n\t\n\tfor (let categoryIndex: number = 1; categoryIndex < EditorConfig.presetCategories.length; categoryIndex++) {\n\t\tconst category: PresetCategory = EditorConfig.presetCategories[categoryIndex];\n\t\tconst group: HTMLElement = optgroup({label: category.name});\n\t\tlet foundAny: boolean = false;\n\t\tfor (let presetIndex: number = 0; presetIndex < category.presets.length; presetIndex++) {\n\t\t\tconst preset: Preset = category.presets[presetIndex];\n\t\t\tif ((preset.isNoise == true) == isNoise) {\n\t\t\t\tgroup.appendChild(option({value: (categoryIndex << 6) + presetIndex}, preset.name));\n\t\t\t\tfoundAny = true;\n\t\t\t}\n\t\t}\n\t\tif (foundAny) menu.appendChild(group);\n\t}\n\treturn menu;\n}\n\nfunction setSelectedValue(menu: HTMLSelectElement, value: number): void {\n\tconst stringValue = value.toString();\n\tif (menu.value != stringValue) menu.value = stringValue;\n}\n\nclass Slider {\n\tprivate _change: Change | null = null;\n\tprivate _value: number = 0;\n\tprivate _oldValue: number = 0;\n\t\n\tconstructor(public readonly input: HTMLInputElement, private readonly _doc: SongDocument, private readonly _getChange: (oldValue: number, newValue: number)=>Change) {\n\t\tinput.addEventListener(\"input\", this._whenInput);\n\t\tinput.addEventListener(\"change\", this._whenChange);\n\t}\n\t\n\tpublic updateValue(value: number): void {\n\t\tthis._value = value;\n\t\tthis.input.value = String(value);\n\t}\n\t\n\tprivate _whenInput = (): void => {\n\t\tconst continuingProspectiveChange: boolean = this._doc.lastChangeWas(this._change);\n\t\tif (!continuingProspectiveChange) this._oldValue = this._value;\n\t\tthis._change = this._getChange(this._oldValue, parseInt(this.input.value));\n\t\tthis._doc.setProspectiveChange(this._change);\n\t};\n\t\n\tprivate _whenChange = (): void => {\n\t\tthis._doc.record(this._change!);\n\t\tthis._change = null;\n\t};\n}\n\nexport class SongEditor {\n\tpublic prompt: Prompt | null = null;\n\t\n\tprivate readonly _patternEditorPrev: PatternEditor = new PatternEditor(this._doc, false, -1);\n\tprivate readonly _patternEditor: PatternEditor = new PatternEditor(this._doc, true, 0);\n\tprivate readonly _patternEditorNext: PatternEditor = new PatternEditor(this._doc, false, 1);\n\tprivate readonly _muteEditor: MuteEditor = new MuteEditor(this._doc);\n\tprivate readonly _trackEditor: TrackEditor = new TrackEditor(this._doc);\n\tprivate readonly _loopEditor: LoopEditor = new LoopEditor(this._doc);\n\tprivate readonly _octaveScrollBar: OctaveScrollBar = new OctaveScrollBar(this._doc);\n\tprivate readonly _piano: Piano = new Piano(this._doc);\n\tprivate readonly _playButton: HTMLButtonElement = button({style: \"width: 80px;\", type: \"button\"});\n\tprivate readonly _prevBarButton: HTMLButtonElement = button({class: \"prevBarButton\", style: \"width: 40px;\", type: \"button\", title: \"Previous Bar (left bracket)\"});\n\tprivate readonly _nextBarButton: HTMLButtonElement = button({class: \"nextBarButton\", style: \"width: 40px;\", type: \"button\", title: \"Next Bar (right bracket)\"});\n\tprivate readonly _volumeSlider: HTMLInputElement = input({title: \"main volume\", style: \"width: 5em; flex-grow: 1; margin: 0;\", type: \"range\", min: \"0\", max: \"75\", value: \"50\", step: \"1\"});\n\tprivate readonly _fileMenu: HTMLSelectElement = select({style: \"width: 100%;\"},\n\t\toption({selected: true, disabled: true, hidden: false}, \"File\"), // todo: \"hidden\" should be true but looks wrong on mac chrome, adds checkmark next to first visible option even though it's not selected. :(\n\t\toption({value: \"new\"}, \"+ New Blank Song\"),\n\t\toption({value: \"import\"}, \"↑ Import Song... (\" + EditorConfig.ctrlSymbol + \"O)\"),\n\t\toption({value: \"export\"}, \"↓ Export Song... (\" + EditorConfig.ctrlSymbol + \"S)\"),\n\t\toption({value: \"copyUrl\"}, \"⎘ Copy Song URL\"),\n\t\toption({value: \"shareUrl\"}, \"⤳ Share Song URL\"),\n\t\toption({value: \"shortenUrl\"}, \"… Shorten Song URL\"),\n\t\toption({value: \"viewPlayer\"}, \"▶ View in Song Player\"),\n\t\toption({value: \"copyEmbed\"}, \"⎘ Copy HTML Embed Code\"),\n\t\toption({value: \"songRecovery\"}, \"⚠ Recover Recent Song...\"),\n\t);\n\tprivate readonly _editMenu: HTMLSelectElement = select({style: \"width: 100%;\"},\n\t\toption({selected: true, disabled: true, hidden: false}, \"Edit\"), // todo: \"hidden\" should be true but looks wrong on mac chrome, adds checkmark next to first visible option even though it's not selected. :(\n\t\toption({value: \"undo\"}, \"Undo (Z)\"),\n\t\toption({value: \"redo\"}, \"Redo (Y)\"),\n\t\toption({value: \"copy\"}, \"Copy Pattern (C)\"),\n\t\toption({value: \"pasteNotes\"}, \"Paste Pattern Notes (V)\"),\n\t\toption({value: \"pasteNumbers\"}, \"Paste Pattern Numbers (\" + EditorConfig.ctrlSymbol + \"⇧V)\"),\n\t\toption({value: \"insertBars\"}, \"Insert Bar (⏎)\"),\n\t\toption({value: \"deleteBars\"}, \"Delete Selected Bars (⌫)\"),\n\t\toption({value: \"insertChannel\"}, \"Insert Channel (\" + EditorConfig.ctrlSymbol + \"⏎)\"),\n\t\toption({value: \"deleteChannel\"}, \"Delete Selected Channels (\" + EditorConfig.ctrlSymbol + \"⌫)\"),\n\t\toption({value: \"selectAll\"}, \"Select All (A)\"),\n\t\toption({value: \"selectChannel\"}, \"Select Channel (⇧A)\"),\n\t\toption({value: \"duplicatePatterns\"}, \"Duplicate Reused Patterns (D)\"),\n\t\toption({value: \"transposeUp\"}, \"Move Notes Up (+ or ⇧+)\"),\n\t\toption({value: \"transposeDown\"}, \"Move Notes Down (- or ⇧-)\"),\n\t\toption({value: \"moveNotesSideways\"}, \"Move All Notes Sideways...\"),\n\t\toption({value: \"beatsPerBar\"}, \"Change Beats Per Bar...\"),\n\t\toption({value: \"barCount\"}, \"Change Song Length...\"),\n\t\toption({value: \"channelSettings\"}, \"Channel Settings... (Q)\"),\n\t);\n\tprivate readonly _optionsMenu: HTMLSelectElement = select({style: \"width: 100%;\"},\n\t\toption({selected: true, disabled: true, hidden: false}, \"Preferences\"), // todo: \"hidden\" should be true but looks wrong on mac chrome, adds checkmark next to first visible option even though it's not selected. :(\n\t\toption({value: \"autoPlay\"}, \"Auto Play On Load\"),\n\t\toption({value: \"autoFollow\"}, \"Auto Follow Track\"),\n\t\toption({value: \"enableNotePreview\"}, \"Preview Added Notes\"),\n\t\toption({value: \"showLetters\"}, \"Show Piano Keys\"),\n\t\toption({value: \"showFifth\"}, 'Highlight \"Fifth\" Notes'),\n\t\toption({value: \"notesOutsideScale\"}, \"Allow Notes Outside Scale\"),\n\t\toption({value: \"setDefaultScale\"}, \"Use Current Scale as Default\"),\n\t\toption({value: \"showChannels\"}, \"Show All Channels\"),\n\t\toption({value: \"showScrollBar\"}, \"Octave Scroll Bar\"),\n\t\toption({value: \"alwaysShowSettings\"}, \"Customize All Instruments\"),\n\t\toption({value: \"instrumentCopyPaste\"}, \"Instrument Copy/Paste Buttons\"),\n\t\toption({value: \"enableChannelMuting\"}, \"Enable Channel Muting\"),\n\t\toption({value: \"displayBrowserUrl\"}, \"Display Song Data in URL\"),\n\t\toption({value: \"layout\"}, \"Choose Layout...\"),\n\t\toption({value: \"colorTheme\"}, \"Light Theme\"),\n\t);\n\tprivate readonly _scaleSelect: HTMLSelectElement = buildOptions(select(), Config.scales.map(scale=>scale.name));\n\tprivate readonly _keySelect: HTMLSelectElement = buildOptions(select(), Config.keys.map(key=>key.name).reverse());\n\tprivate readonly _tempoSlider: Slider = new Slider(input({style: \"margin: 0; width: 4em; flex-grow: 1; vertical-align: middle;\", type: \"range\", min: \"0\", max: \"14\", value: \"7\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeTempo(this._doc, oldValue, Math.round(120.0 * Math.pow(2.0, (-4.0 + newValue) / 9.0))));\n\tprivate readonly _tempoStepper: HTMLInputElement = input({style: \"width: 3em; margin-left: 0.4em; vertical-align: middle;\", type: \"number\", step: \"1\"});\n\tprivate readonly _chorusSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.chorusRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeChorus(this._doc, oldValue, newValue));\n\tprivate readonly _chorusRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"chorus\")}, \"Chorus:\"), this._chorusSlider.input);\n\tprivate readonly _reverbSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.reverbRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeReverb(this._doc, oldValue, newValue));\n\tprivate readonly _reverbRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"reverb\")}, \"Reverb:\"), this._reverbSlider.input);\n\tprivate readonly _echoSustainSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.echoSustainRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeEchoSustain(this._doc, oldValue, newValue));\n\tprivate readonly _echoSustainRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"echoSustain\")}, \"Echo:\"), this._echoSustainSlider.input);\n\tprivate readonly _echoDelaySlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.echoDelayRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeEchoDelay(this._doc, oldValue, newValue));\n\tprivate readonly _echoDelayRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"echoDelay\")}, \"Echo Delay:\"), this._echoDelaySlider.input);\n\tprivate readonly _rhythmSelect: HTMLSelectElement = buildOptions(select(), Config.rhythms.map(rhythm=>rhythm.name));\n\tprivate readonly _pitchedPresetSelect: HTMLSelectElement = buildPresetOptions(false);\n\tprivate readonly _drumPresetSelect: HTMLSelectElement = buildPresetOptions(true);\n\tprivate readonly _algorithmSelect: HTMLSelectElement = buildOptions(select(), Config.algorithms.map(algorithm=>algorithm.name));\n\tprivate readonly _algorithmSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"algorithm\")}, \"Algorithm:\"), div({class: \"selectContainer\"}, this._algorithmSelect));\n\tprivate readonly _instrumentButtons: HTMLButtonElement[] = [];\n\tprivate readonly _instrumentAddButton: HTMLButtonElement = button({type: \"button\", class: \"add-instrument last-button\"});\n\tprivate readonly _instrumentRemoveButton: HTMLButtonElement = button({type: \"button\", class: \"remove-instrument\"});\n\tprivate readonly _instrumentsButtonBar: HTMLDivElement = div({class: \"instrument-bar\"}, this._instrumentRemoveButton, this._instrumentAddButton);\n\tprivate readonly _instrumentsButtonRow: HTMLDivElement = div({class: \"selectRow\", style: \"display: none;\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"instrumentIndex\")}, \"Instrument:\"), this._instrumentsButtonBar);\n\tprivate readonly _instrumentCopyButton: HTMLButtonElement = button({type: \"button\", class: \"copy-instrument\"}, \"Copy\");\n\tprivate readonly _instrumentPasteButton: HTMLButtonElement = button({type: \"button\", class: \"paste-instrument\"}, \"Paste\");\n\tprivate readonly _instrumentCopyPasteRow: HTMLDivElement = div({class: \"instrumentCopyPasteRow\", style: \"display: none;\"}, this._instrumentCopyButton, this._instrumentPasteButton);\n\tprivate readonly _instrumentVolumeSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: -(Config.volumeRange - 1), max: \"0\", value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeVolume(this._doc, oldValue, -newValue));\n\tprivate readonly _instrumentVolumeSliderRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"instrumentVolume\")}, \"Volume:\"), this._instrumentVolumeSlider.input);\n\tprivate readonly _panSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.panMax, value: Config.panCenter, step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangePan(this._doc, oldValue, newValue));\n\tprivate readonly _panSliderRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"pan\")}, \"Panning:\"), this._panSlider.input);\n\tprivate readonly _chipWaveSelect: HTMLSelectElement = buildOptions(select(), Config.chipWaves.map(wave=>wave.name));\n\tprivate readonly _chipNoiseSelect: HTMLSelectElement = buildOptions(select(), Config.chipNoises.map(wave=>wave.name));\n\tprivate readonly _chipWaveSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"chipWave\")}, \"Wave:\"), div({class: \"selectContainer\"}, this._chipWaveSelect));\n\tprivate readonly _chipNoiseSelectRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"chipNoise\")}, \"Noise:\"), div({class: \"selectContainer\"}, this._chipNoiseSelect));\n\tprivate readonly _fadeInOutEditor: FadeInOutEditor = new FadeInOutEditor(this._doc);\n\tprivate readonly _fadeInOutRow: HTMLElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"fadeInOut\")}, \"Fade In/Out:\"), this._fadeInOutEditor.container);\n\tprivate readonly _transitionSelect: HTMLSelectElement = buildOptions(select(), Config.transitions.map(transition=>transition.name));\n\tprivate readonly _transitionRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"transition\")}, \"Transition:\"), div({class: \"selectContainer\"}, this._transitionSelect));\n\tprivate readonly _effectsSelect: HTMLSelectElement = select(option({selected: true, disabled: true, hidden: false})); // todo: \"hidden\" should be true but looks wrong on mac chrome, adds checkmark next to first visible option even though it's not selected. :(\n\tprivate readonly _eqFilterEditor: FilterEditor = new FilterEditor(this._doc);\n\tprivate readonly _eqFilterRow: HTMLElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"eqFilter\")}, \"EQ Filter:\"), this._eqFilterEditor.container);\n\tprivate readonly _noteFilterEditor: FilterEditor = new FilterEditor(this._doc, true);\n\tprivate readonly _noteFilterRow: HTMLElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"noteFilter\")}, \"Note Filter:\"), this._noteFilterEditor.container);\n\tprivate readonly _pulseWidthSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.pulseWidthRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangePulseWidth(this._doc, oldValue, newValue));\n\tprivate readonly _pulseWidthRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"pulseWidth\")}, \"Pulse Width:\"), this._pulseWidthSlider.input);\n\tprivate readonly _pitchShiftSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.pitchShiftRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangePitchShift(this._doc, oldValue, newValue));\n\tprivate readonly _pitchShiftTonicMarkers: HTMLDivElement[] = [div({class: \"pitchShiftMarker\", style: {color: ColorConfig.tonic}}), div({class: \"pitchShiftMarker\", style: {color: ColorConfig.tonic, left: \"50%\"}}), div({class: \"pitchShiftMarker\", style: {color: ColorConfig.tonic, left: \"100%\"}})];\n\tprivate readonly _pitchShiftFifthMarkers: HTMLDivElement[] = [div({class: \"pitchShiftMarker\", style: {color: ColorConfig.fifthNote, left: (100*7/24)+\"%\"}}), div({class: \"pitchShiftMarker\", style: {color: ColorConfig.fifthNote, left: (100*19/24)+\"%\"}})];\n\tprivate readonly _pitchShiftMarkerContainer: HTMLDivElement = div({style: \"display: flex; position: relative;\"}, this._pitchShiftSlider.input, div({class: \"pitchShiftMarkerContainer\"}, this._pitchShiftTonicMarkers, this._pitchShiftFifthMarkers));\n\tprivate readonly _pitchShiftRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"pitchShift\")}, \"Pitch Shift:\"), this._pitchShiftMarkerContainer);\n\tprivate readonly _detuneSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.detuneMax, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeDetune(this._doc, oldValue, newValue));\n\tprivate readonly _detuneRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"detune\")}, \"Detune:\"), this._detuneSlider.input);\n\tprivate readonly _distortionSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.distortionRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeDistortion(this._doc, oldValue, newValue));\n\tprivate readonly _distortionRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"distortion\")}, \"Distortion:\"), this._distortionSlider.input);\n\tprivate readonly _bitcrusherQuantizationSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.bitcrusherQuantizationRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeBitcrusherQuantization(this._doc, oldValue, newValue));\n\tprivate readonly _bitcrusherQuantizationRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"bitcrusherQuantization\")}, \"Bit Crush:\"), this._bitcrusherQuantizationSlider.input);\n\tprivate readonly _bitcrusherFreqSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.bitcrusherFreqRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeBitcrusherFreq(this._doc, oldValue, newValue));\n\tprivate readonly _bitcrusherFreqRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"bitcrusherFreq\")}, \"Freq Crush:\"), this._bitcrusherFreqSlider.input);\n\tprivate readonly _stringSustainSlider: Slider = new Slider(input({style: \"margin: 0;\", type: \"range\", min: \"0\", max: Config.stringSustainRange - 1, value: \"0\", step: \"1\"}), this._doc, (oldValue: number, newValue: number) => new ChangeStringSustain(this._doc, oldValue, newValue));\n\tprivate readonly _stringSustainRow: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"stringSustain\")}, \"Sustain:\"), this._stringSustainSlider.input);\n\tprivate readonly _unisonSelect: HTMLSelectElement = buildOptions(select(), Config.unisons.map(unison=>unison.name));\n\tprivate readonly _unisonSelectRow: HTMLElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"unison\")}, \"Unison:\"), div({class: \"selectContainer\"}, this._unisonSelect));\n\tprivate readonly _chordSelect: HTMLSelectElement = buildOptions(select(), Config.chords.map(chord=>chord.name));\n\tprivate readonly _chordSelectRow: HTMLElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"chords\")}, \"Chords:\"), div({class: \"selectContainer\"}, this._chordSelect));\n\tprivate readonly _vibratoSelect: HTMLSelectElement = buildOptions(select(), Config.vibratos.map(vibrato=>vibrato.name));\n\tprivate readonly _vibratoSelectRow: HTMLElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"vibrato\")}, \"Vibrato:\"), div({class: \"selectContainer\"}, this._vibratoSelect));\n\tprivate readonly _phaseModGroup: HTMLElement = div({class: \"editor-controls\"});\n\tprivate readonly _feedbackTypeSelect: HTMLSelectElement = buildOptions(select(), Config.feedbacks.map(feedback=>feedback.name));\n\tprivate readonly _feedbackRow1: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"feedbackType\")}, \"Feedback:\"), div({class: \"selectContainer\"}, this._feedbackTypeSelect));\n\tprivate readonly _spectrumEditor: SpectrumEditor = new SpectrumEditor(this._doc, null);\n\tprivate readonly _spectrumRow: HTMLElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"spectrum\")}, \"Spectrum:\"), this._spectrumEditor.container);\n\tprivate readonly _harmonicsEditor: HarmonicsEditor = new HarmonicsEditor(this._doc);\n\tprivate readonly _harmonicsRow: HTMLElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"harmonics\")}, \"Harmonics:\"), this._harmonicsEditor.container);\n\tprivate readonly _envelopeEditor: EnvelopeEditor = new EnvelopeEditor(this._doc);\n\tprivate readonly _drumsetGroup: HTMLElement = div({class: \"editor-controls\"});\n\t\n\tprivate readonly _feedbackAmplitudeSlider: Slider = new Slider(input({type: \"range\", min: \"0\", max: Config.operatorAmplitudeMax, value: \"0\", step: \"1\", title: \"Feedback Amplitude\"}), this._doc, (oldValue: number, newValue: number) => new ChangeFeedbackAmplitude(this._doc, oldValue, newValue));\n\tprivate readonly _feedbackRow2: HTMLDivElement = div({class: \"selectRow\"}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"feedbackVolume\")}, \"Fdback Vol:\"), this._feedbackAmplitudeSlider.input);\n\tprivate readonly _customizeInstrumentButton: HTMLButtonElement = button({type: \"button\", class: \"customize-instrument\"},\n\t\t\"Customize Instrument\",\n\t);\n\tprivate readonly _addEnvelopeButton: HTMLButtonElement = button({type: \"button\", class: \"add-envelope\"});\n\tprivate readonly _customInstrumentSettingsGroup: HTMLDivElement = div({class: \"editor-controls\"},\n\t\tthis._eqFilterRow,\n\t\tthis._fadeInOutRow,\n\t\tthis._chipWaveSelectRow,\n\t\tthis._chipNoiseSelectRow,\n\t\tthis._algorithmSelectRow,\n\t\tthis._phaseModGroup,\n\t\tthis._feedbackRow1,\n\t\tthis._feedbackRow2,\n\t\tthis._spectrumRow,\n\t\tthis._harmonicsRow,\n\t\tthis._drumsetGroup,\n\t\tthis._pulseWidthRow,\n\t\tthis._stringSustainRow,\n\t\tthis._unisonSelectRow,\n\t\tdiv({style: `margin: 2px 0; margin-left: 2em; display: flex; align-items: center;`},\n\t\t\tspan({style: `flex-grow: 1; text-align: center;`}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"effects\")}, \"Effects\")),\n\t\t\tdiv({class: \"effects-menu\"}, this._effectsSelect),\n\t\t),\n\t\tthis._transitionRow,\n\t\tthis._chordSelectRow,\n\t\tthis._pitchShiftRow,\n\t\tthis._detuneRow,\n\t\tthis._vibratoSelectRow,\n\t\tthis._noteFilterRow,\n\t\tthis._distortionRow,\n\t\tthis._bitcrusherQuantizationRow,\n\t\tthis._bitcrusherFreqRow,\n\t\tthis._panSliderRow,\n\t\tthis._chorusRow,\n\t\tthis._echoSustainRow,\n\t\tthis._echoDelayRow,\n\t\tthis._reverbRow,\n\t\tdiv({style: `margin: 2px 0; margin-left: 2em; display: flex; align-items: center;`},\n\t\t\tspan({style: `flex-grow: 1; text-align: center;`}, span({class: \"tip\", onclick: ()=>this._openPrompt(\"envelopes\")}, \"Envelopes\")),\n\t\t\tthis._addEnvelopeButton,\n\t\t),\n\t\tthis._envelopeEditor.container,\n\t);\n\tprivate readonly _instrumentSettingsGroup: HTMLDivElement = div({class: \"editor-controls\"},\n\t\tdiv({style: `margin: 3px 0; text-align: center; color: ${ColorConfig.secondaryText};`},\n\t\t\t\"Instrument Settings\"\n\t\t),\n\t\tthis._instrumentsButtonRow,\n\t\tthis._instrumentCopyPasteRow,\n\t\tthis._instrumentVolumeSliderRow,\n\t\tdiv({class: \"selectRow\"},\n\t\t\tspan({class: \"tip\", onclick: ()=>this._openPrompt(\"instrumentType\")}, \"Type:\"),\n\t\t\tdiv({class: \"selectContainer\"}, this._pitchedPresetSelect, this._drumPresetSelect),\n\t\t),\n\t\tthis._customizeInstrumentButton,\n\t\tthis._customInstrumentSettingsGroup,\n\t);\n\tprivate readonly _promptContainer: HTMLDivElement = div({class: \"promptContainer\", style: \"display: none;\"});\n\tprivate readonly _zoomInButton: HTMLButtonElement = button({class: \"zoomInButton\", type: \"button\", title: \"Zoom In\"});\n\tprivate readonly _zoomOutButton: HTMLButtonElement = button({class: \"zoomOutButton\", type: \"button\", title: \"Zoom Out\"});\n\tprivate readonly _patternEditorRow: HTMLDivElement = div({style: \"flex: 1; height: 100%; display: flex; overflow: hidden; justify-content: center;\"},\n\t\tthis._patternEditorPrev.container,\n\t\tthis._patternEditor.container,\n\t\tthis._patternEditorNext.container,\n\t);\n\tprivate readonly _patternArea: HTMLDivElement = div({class: \"pattern-area\"},\n\t\tthis._piano.container,\n\t\tthis._patternEditorRow,\n\t\tthis._octaveScrollBar.container,\n\t\tthis._zoomInButton,\n\t\tthis._zoomOutButton,\n\t);\n\tprivate readonly _trackContainer: HTMLDivElement = div({class: \"trackContainer\"},\n\t\tthis._trackEditor.container,\n\t\tthis._loopEditor.container,\n\t);\n\tprivate readonly _trackVisibleArea: HTMLDivElement = div({style: \"position: absolute; width: 100%; height: 100%; pointer-events: none;\"});\n\tprivate readonly _trackAndMuteContainer: HTMLDivElement = div({class: \"trackAndMuteContainer\"},\n\t\tthis._muteEditor.container,\n\t\tthis._trackContainer,\n\t\tthis._trackVisibleArea,\n\t);\n\tprivate readonly _barScrollBar: BarScrollBar = new BarScrollBar(this._doc, this._trackAndMuteContainer);\n\tprivate readonly _trackArea: HTMLDivElement = div({class: \"track-area\"},\n\t\tthis._trackAndMuteContainer,\n\t\tthis._barScrollBar.container,\n\t);\n\t\n\tprivate readonly _instrumentSettingsArea: HTMLDivElement = div({class: \"instrument-settings-area\"}, this._instrumentSettingsGroup);\n\tprivate readonly _settingsArea: HTMLDivElement = div({class: \"settings-area noSelection\"},\n\t\tdiv({class: \"version-area\"},\n\t\t\tdiv({style: `text-align: center; margin: 3px 0; color: ${ColorConfig.secondaryText};`},\n\t\t\t\tEditorConfig.versionDisplayName,\n\t\t\t\t\" \",\n\t\t\t\ta({class: \"tip\", target: \"_blank\", href: EditorConfig.releaseNotesURL},\n\t\t\t\t\tEditorConfig.version,\n\t\t\t\t),\n\t\t\t),\n\t\t),\n\t\tdiv({class: \"play-pause-area\"},\n\t\t\tdiv({class: \"playback-bar-controls\"},\n\t\t\t\tthis._playButton,\n\t\t\t\tthis._prevBarButton,\n\t\t\t\tthis._nextBarButton,\n\t\t\t),\n\t\t\tdiv({class: \"playback-volume-controls\"},\n\t\t\t\tspan({class: \"volume-speaker\"}),\n\t\t\t\tthis._volumeSlider,\n\t\t\t),\n\t\t),\n\t\tdiv({class: \"menu-area\"},\n\t\t\tdiv({class: \"selectContainer menu file\"},\n\t\t\t\tthis._fileMenu,\n\t\t\t),\n\t\t\tdiv({class: \"selectContainer menu edit\"},\n\t\t\t\tthis._editMenu,\n\t\t\t),\n\t\t\tdiv({class: \"selectContainer menu preferences\"},\n\t\t\t\tthis._optionsMenu,\n\t\t\t),\n\t\t),\n\t\tdiv({class: \"song-settings-area\"},\n\t\t\tdiv({class: \"editor-controls\"},\n\t\t\t\tdiv({style: `margin: 3px 0; text-align: center; color: ${ColorConfig.secondaryText};`},\n\t\t\t\t\t\"Song Settings\",\n\t\t\t\t),\n\t\t\t\tdiv({class: \"selectRow\"},\n\t\t\t\t\tspan({class: \"tip\", onclick: ()=>this._openPrompt(\"scale\")}, \"Scale:\"),\n\t\t\t\t\tdiv({class: \"selectContainer\"}, this._scaleSelect),\n\t\t\t\t),\n\t\t\t\tdiv({class: \"selectRow\"},\n\t\t\t\t\tspan({class: \"tip\", onclick: ()=>this._openPrompt(\"key\")}, \"Key:\"),\n\t\t\t\t\tdiv({class: \"selectContainer\"}, this._keySelect),\n\t\t\t\t),\n\t\t\t\tdiv({class: \"selectRow\"},\n\t\t\t\t\tspan({class: \"tip\", onclick: ()=>this._openPrompt(\"tempo\")}, \"Tempo:\"),\n\t\t\t\t\tspan({style: \"display: flex;\"},\n\t\t\t\t\t\tthis._tempoSlider.input,\n\t\t\t\t\t\tthis._tempoStepper,\n\t\t\t\t\t),\n\t\t\t\t),\n\t\t\t\tdiv({class: \"selectRow\"},\n\t\t\t\t\tspan({class: \"tip\", onclick: ()=>this._openPrompt(\"rhythm\")}, \"Rhythm:\"),\n\t\t\t\t\tdiv({class: \"selectContainer\"}, this._rhythmSelect),\n\t\t\t\t),\n\t\t\t),\n\t\t),\n\t\tthis._instrumentSettingsArea,\n\t);\n\t\n\tpublic readonly mainLayer: HTMLDivElement = div({class: \"beepboxEditor\", tabIndex: \"0\"},\n\t\tthis._patternArea,\n\t\tthis._trackArea,\n\t\tthis._settingsArea,\n\t\tthis._promptContainer,\n\t);\n\t\n\tprivate _wasPlaying: boolean = false;\n\tprivate _currentPromptName: string | null = null;\n\tprivate _highlightedInstrumentIndex: number = -1;\n\tprivate _renderedInstrumentCount: number = 0;\n\tprivate _deactivatedInstruments: boolean = false;\n\tprivate readonly _operatorRows: HTMLDivElement[] = []\n\tprivate readonly _operatorAmplitudeSliders: Slider[] = []\n\tprivate readonly _operatorFrequencySelects: HTMLSelectElement[] = []\n\tprivate readonly _drumsetSpectrumEditors: SpectrumEditor[] = [];\n\tprivate readonly _drumsetEnvelopeSelects: HTMLSelectElement[] = [];\n\t\n\tconstructor(private _doc: SongDocument) {\n\t\tthis._doc.notifier.watch(this.whenUpdated);\n\t\twindow.addEventListener(\"resize\", this.whenUpdated);\n\t\t\n\t\tif (!(\"share\" in navigator)) {\n\t\t\tthis._fileMenu.removeChild(this._fileMenu.querySelector(\"[value='shareUrl']\")!);\n\t\t}\n\t\t\n\t\tthis._scaleSelect.appendChild(optgroup({label: \"Edit\"},\n\t\t\toption({value: \"forceScale\"}, \"Snap Notes To Scale\"),\n\t\t));\n\t\tthis._keySelect.appendChild(optgroup({label: \"Edit\"},\n\t\t\toption({value: \"detectKey\"}, \"Detect Key\"),\n\t\t));\n\t\tthis._rhythmSelect.appendChild(optgroup({label: \"Edit\"},\n\t\t\toption({value: \"forceRhythm\"}, \"Snap Notes To Rhythm\"),\n\t\t));\n\t\t\n\t\tthis._phaseModGroup.appendChild(div({class: \"selectRow\", style: `color: ${ColorConfig.secondaryText}; height: 1em; margin-top: 0.5em;`},\n\t\t\tdiv({style: \"margin-right: .1em; visibility: hidden;\"}, 1 + \".\"),\n\t\t\tdiv({style: \"width: 3em; margin-right: .3em;\", class: \"tip\", onclick: ()=>this._openPrompt(\"operatorFrequency\")}, \"Freq:\"),\n\t\t\tdiv({class: \"tip\", onclick: ()=>this._openPrompt(\"operatorVolume\")}, \"Volume:\"),\n\t\t));\n\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\n\t\t\tconst operatorIndex: number = i;\n\t\t\tconst operatorNumber: HTMLDivElement = div({style: `margin-right: .1em; color: ${ColorConfig.secondaryText};`}, i + 1 + \".\");\n\t\t\tconst frequencySelect: HTMLSelectElement = buildOptions(select({style: \"width: 100%;\", title: \"Frequency\"}), Config.operatorFrequencies.map(freq=>freq.name));\n\t\t\tconst amplitudeSlider: Slider = new Slider(input({type: \"range\", min: \"0\", max: Config.operatorAmplitudeMax, value: \"0\", step: \"1\", title: \"Volume\"}), this._doc, (oldValue: number, newValue: number) => new ChangeOperatorAmplitude(this._doc, operatorIndex, oldValue, newValue));\n\t\t\tconst row: HTMLDivElement = div({class: \"selectRow\"},\n\t\t\t\toperatorNumber,\n\t\t\t\tdiv({class: \"selectContainer\", style: \"width: 3em; margin-right: .3em;\"}, frequencySelect),\n\t\t\t\tamplitudeSlider.input,\n\t\t\t);\n\t\t\tthis._phaseModGroup.appendChild(row);\n\t\t\tthis._operatorRows[i] = row;\n\t\t\tthis._operatorAmplitudeSliders[i] = amplitudeSlider;\n\t\t\tthis._operatorFrequencySelects[i] = frequencySelect;\n\t\t\t\n\t\t\tfrequencySelect.addEventListener(\"change\", () => {\n\t\t\t\tthis._doc.record(new ChangeOperatorFrequency(this._doc, operatorIndex, frequencySelect.selectedIndex));\n\t\t\t});\n\t\t}\n\t\t\n\t\tthis._drumsetGroup.appendChild(\n\t\t\tdiv({class: \"selectRow\"},\n\t\t\t\tspan({class: \"tip\", onclick: ()=>this._openPrompt(\"drumsetEnvelope\")}, \"Envelope:\"),\n\t\t\t\tspan({class: \"tip\", onclick: ()=>this._openPrompt(\"drumsetSpectrum\")}, \"Spectrum:\"),\n\t\t\t),\n\t\t);\n\t\tfor (let i: number = Config.drumCount - 1; i >= 0; i--) {\n\t\t\tconst drumIndex: number = i;\n\t\t\tconst spectrumEditor: SpectrumEditor = new SpectrumEditor(this._doc, drumIndex);\n\t\t\tspectrumEditor.container.addEventListener(\"mousedown\", this._refocusStage);\n\t\t\tthis._drumsetSpectrumEditors[i] = spectrumEditor;\n\t\t\t\n\t\t\tconst envelopeSelect: HTMLSelectElement = buildOptions(select({style: \"width: 100%;\", title: \"Filter Envelope\"}), Config.envelopes.map(envelope=>envelope.name));\n\t\t\tthis._drumsetEnvelopeSelects[i] = envelopeSelect;\n\t\t\tenvelopeSelect.addEventListener(\"change\", () => {\n\t\t\t\tthis._doc.record(new ChangeDrumsetEnvelope(this._doc, drumIndex, envelopeSelect.selectedIndex));\n\t\t\t});\n\t\t\t\n\t\t\tconst row: HTMLDivElement = div({class: \"selectRow\"},\n\t\t\t\tdiv({class: \"selectContainer\", style: \"width: 5em; margin-right: .3em;\"}, envelopeSelect),\n\t\t\t\tthis._drumsetSpectrumEditors[i].container,\n\t\t\t);\n\t\t\tthis._drumsetGroup.appendChild(row);\n\t\t}\n\t\t\n\t\tthis._fileMenu.addEventListener(\"change\", this._fileMenuHandler);\n\t\tthis._editMenu.addEventListener(\"change\", this._editMenuHandler);\n\t\tthis._optionsMenu.addEventListener(\"change\", this._optionsMenuHandler);\n\t\tthis._tempoStepper.addEventListener(\"change\", this._whenSetTempo);\n\t\tthis._scaleSelect.addEventListener(\"change\", this._whenSetScale);\n\t\tthis._keySelect.addEventListener(\"change\", this._whenSetKey);\n\t\tthis._rhythmSelect.addEventListener(\"change\", this._whenSetRhythm);\n\t\tthis._pitchedPresetSelect.addEventListener(\"change\", this._whenSetPitchedPreset);\n\t\tthis._drumPresetSelect.addEventListener(\"change\", this._whenSetDrumPreset);\n\t\tthis._algorithmSelect.addEventListener(\"change\", this._whenSetAlgorithm);\n\t\tthis._instrumentsButtonBar.addEventListener(\"click\", this._whenSelectInstrument);\n\t\tthis._instrumentCopyButton.addEventListener(\"click\", this._copyInstrument);\n\t\tthis._instrumentPasteButton.addEventListener(\"click\", this._pasteInstrument);\n\t\tthis._customizeInstrumentButton.addEventListener(\"click\", this._whenCustomizePressed);\n\t\tthis._feedbackTypeSelect.addEventListener(\"change\", this._whenSetFeedbackType);\n\t\tthis._chipWaveSelect.addEventListener(\"change\", this._whenSetChipWave);\n\t\tthis._chipNoiseSelect.addEventListener(\"change\", this._whenSetNoiseWave);\n\t\tthis._transitionSelect.addEventListener(\"change\", this._whenSetTransition);\n\t\tthis._effectsSelect.addEventListener(\"change\", this._whenSetEffects);\n\t\tthis._unisonSelect.addEventListener(\"change\", this._whenSetUnison);\n\t\tthis._chordSelect.addEventListener(\"change\", this._whenSetChord);\n\t\tthis._vibratoSelect.addEventListener(\"change\", this._whenSetVibrato);\n\t\tthis._playButton.addEventListener(\"click\", this._togglePlay);\n\t\tthis._prevBarButton.addEventListener(\"click\", this._whenPrevBarPressed);\n\t\tthis._nextBarButton.addEventListener(\"click\", this._whenNextBarPressed);\n\t\tthis._volumeSlider.addEventListener(\"input\", this._setVolumeSlider);\n\t\tthis._zoomInButton.addEventListener(\"click\", this._zoomIn);\n\t\tthis._zoomOutButton.addEventListener(\"click\", this._zoomOut);\n\t\t\n\t\tthis._patternArea.addEventListener(\"mousedown\", this._refocusStage);\n\t\tthis._trackArea.addEventListener(\"mousedown\", this._refocusStage);\n\t\tthis._fadeInOutEditor.container.addEventListener(\"mousedown\", this._refocusStage);\n\t\tthis._spectrumEditor.container.addEventListener(\"mousedown\", this._refocusStage);\n\t\tthis._eqFilterEditor.container.addEventListener(\"mousedown\", this._refocusStage);\n\t\tthis._noteFilterEditor.container.addEventListener(\"mousedown\", this._refocusStage);\n\t\tthis._harmonicsEditor.container.addEventListener(\"mousedown\", this._refocusStage);\n\t\tthis._tempoStepper.addEventListener(\"keydown\", this._tempoStepperCaptureNumberKeys, false);\n\t\tthis._addEnvelopeButton.addEventListener(\"click\", this._addNewEnvelope);\n\t\tthis._patternArea.addEventListener(\"contextmenu\", this._disableCtrlContextMenu);\n\t\tthis._trackArea.addEventListener(\"contextmenu\", this._disableCtrlContextMenu);\n\t\tthis.mainLayer.addEventListener(\"keydown\", this._whenKeyPressed);\n\t\t\n\t\tthis._promptContainer.addEventListener(\"click\", (event) => {\n\t\t\tif (event.target == this._promptContainer) {\n\t\t\t\tthis._doc.undo();\n\t\t\t}\n\t\t});\n\t\t\n\t\tif (isMobile) {\n\t\t\tconst autoPlayOption: HTMLOptionElement = <HTMLOptionElement> this._optionsMenu.querySelector(\"[value=autoPlay]\");\n\t\t\tautoPlayOption.disabled = true;\n\t\t\tautoPlayOption.setAttribute(\"hidden\", \"\");\n\t\t}\n\t\t\n\t\tif (window.screen.availWidth < 710 || window.screen.availHeight < 710) {\n\t\t\tconst layoutOption: HTMLOptionElement = <HTMLOptionElement> this._optionsMenu.querySelector(\"[value=layout]\");\n\t\t\tlayoutOption.disabled = true;\n\t\t\tlayoutOption.setAttribute(\"hidden\", \"\");\n\t\t}\n\t}\n\t\n\tprivate _openPrompt(promptName: string): void {\n\t\tthis._doc.openPrompt(promptName);\n\t\tthis._setPrompt(promptName);\n\t}\n\t\n\tprivate _setPrompt(promptName: string | null): void {\n\t\tif (this._currentPromptName == promptName) return;\n\t\tthis._currentPromptName = promptName;\n\t\t\n\t\tif (this.prompt) {\n\t\t\tif (this._wasPlaying && !(this.prompt instanceof TipPrompt)) {\n\t\t\t\tthis._play();\n\t\t\t}\n\t\t\tthis._wasPlaying = false;\n\t\t\tthis._promptContainer.style.display = \"none\";\n\t\t\tthis._promptContainer.removeChild(this.prompt.container);\n\t\t\tthis.prompt.cleanUp();\n\t\t\tthis.prompt = null;\n\t\t\tthis._refocusStage();\n\t\t}\n\t\t\n\t\tif (promptName) {\n\t\t\tswitch (promptName) {\n\t\t\t\tcase \"export\":\n\t\t\t\t\tthis.prompt = new ExportPrompt(this._doc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"import\":\n\t\t\t\t\tthis.prompt = new ImportPrompt(this._doc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"songRecovery\":\n\t\t\t\t\tthis.prompt = new SongRecoveryPrompt(this._doc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"barCount\":\n\t\t\t\t\tthis.prompt = new SongDurationPrompt(this._doc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"beatsPerBar\":\n\t\t\t\t\tthis.prompt = new BeatsPerBarPrompt(this._doc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"moveNotesSideways\":\n\t\t\t\t\tthis.prompt = new MoveNotesSidewaysPrompt(this._doc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"channelSettings\":\n\t\t\t\t\tthis.prompt = new ChannelSettingsPrompt(this._doc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"layout\":\n\t\t\t\t\tthis.prompt = new LayoutPrompt(this._doc);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.prompt = new TipPrompt(this._doc, promptName);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tif (this.prompt) {\n\t\t\t\tif (!(this.prompt instanceof TipPrompt)) {\n\t\t\t\t\tthis._wasPlaying = this._doc.synth.playing;\n\t\t\t\t\tthis._pause();\n\t\t\t\t}\n\t\t\t\tthis._promptContainer.style.display = \"\";\n\t\t\t\tthis._promptContainer.appendChild(this.prompt.container);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate _refocusStage = (): void => {\n\t\tthis.mainLayer.focus({preventScroll: true});\n\t}\n\t\n\tpublic whenUpdated = (): void => {\n\t\tthis._muteEditor.container.style.display = this._doc.enableChannelMuting ? \"\" : \"none\";\n\t\tconst trackBounds: DOMRect = this._trackVisibleArea.getBoundingClientRect();\n\t\tthis._doc.trackVisibleBars = Math.floor((trackBounds.right - trackBounds.left - (this._doc.enableChannelMuting ? 32 : 0)) / this._doc.getBarWidth());\n\t\tthis._doc.trackVisibleChannels = Math.floor((trackBounds.bottom - trackBounds.top - 30) / this._doc.getChannelHeight());\n\t\tthis._barScrollBar.render();\n\t\tthis._muteEditor.render();\n\t\tthis._trackEditor.render();\n\t\t\n\t\tthis._piano.container.style.display = this._doc.showLetters ? \"\" : \"none\";\n\t\tthis._octaveScrollBar.container.style.display = this._doc.showScrollBar ? \"\" : \"none\";\n\t\tthis._barScrollBar.container.style.display = this._doc.song.barCount > this._doc.trackVisibleBars ? \"\" : \"none\";\n\t\t\n\t\tif (this._doc.getFullScreen()) {\n\t\t\tconst semitoneHeight: number = this._patternEditorRow.clientHeight / this._doc.getVisiblePitchCount();\n\t\t\tconst targetBeatWidth: number = semitoneHeight * 5;\n\t\t\tconst minBeatWidth: number = this._patternEditorRow.clientWidth / (this._doc.song.beatsPerBar * 3);\n\t\t\tconst maxBeatWidth: number = this._patternEditorRow.clientWidth / (this._doc.song.beatsPerBar + 2);\n\t\t\tconst beatWidth: number = Math.max(minBeatWidth, Math.min(maxBeatWidth, targetBeatWidth));\n\t\t\tconst patternEditorWidth: number = beatWidth * this._doc.song.beatsPerBar;\n\t\t\t\n\t\t\tthis._patternEditorPrev.container.style.width = patternEditorWidth + \"px\";\n\t\t\tthis._patternEditor.container.style.width = patternEditorWidth + \"px\";\n\t\t\tthis._patternEditorNext.container.style.width = patternEditorWidth + \"px\";\n\t\t\tthis._patternEditorPrev.container.style.flexShrink = \"0\";\n\t\t\tthis._patternEditor.container.style.flexShrink = \"0\";\n\t\t\tthis._patternEditorNext.container.style.flexShrink = \"0\";\n\t\t\tthis._patternEditorPrev.container.style.display = \"\";\n\t\t\tthis._patternEditorNext.container.style.display = \"\";\n\t\t\tthis._patternEditorPrev.render();\n\t\t\tthis._patternEditorNext.render();\n\t\t\tthis._zoomInButton.style.display = \"\";\n\t\t\tthis._zoomOutButton.style.display = \"\";\n\t\t\tthis._zoomInButton.style.right = this._doc.showScrollBar ? \"24px\" : \"4px\";\n\t\t\tthis._zoomOutButton.style.right = this._doc.showScrollBar ? \"24px\" : \"4px\";\n\t\t} else {\n\t\t\tthis._patternEditor.container.style.width = \"\";\n\t\t\tthis._patternEditor.container.style.flexShrink = \"\";\n\t\t\tthis._patternEditorPrev.container.style.display = \"none\";\n\t\t\tthis._patternEditorNext.container.style.display = \"none\";\n\t\t\tthis._zoomInButton.style.display = \"none\";\n\t\t\tthis._zoomOutButton.style.display = \"none\";\n\t\t}\n\t\tthis._patternEditor.render();\n\t\t\n\t\tconst optionCommands: ReadonlyArray<string> = [\n\t\t\t(this._doc.autoPlay ? \"✓ \" : \"　\") + \"Auto Play On Load\",\n\t\t\t(this._doc.autoFollow ? \"✓ \" : \"　\") + \"Auto Follow Track\",\n\t\t\t(this._doc.enableNotePreview ? \"✓ \" : \"　\") + \"Preview Added Notes\",\n\t\t\t(this._doc.showLetters ? \"✓ \" : \"　\") + \"Show Piano Keys\",\n\t\t\t(this._doc.showFifth ? \"✓ \" : \"　\") + 'Highlight \"Fifth\" Notes',\n\t\t\t(this._doc.notesOutsideScale ? \"✓ \" : \"　\") + \"Allow Notes Outside Scale\",\n\t\t\t(this._doc.defaultScale == this._doc.song.scale ? \"✓ \" : \"　\") + \"Use Current Scale as Default\",\n\t\t\t(this._doc.showChannels ? \"✓ \" : \"　\") + \"Show All Channels\",\n\t\t\t(this._doc.showScrollBar ? \"✓ \" : \"　\") + \"Octave Scroll Bar\",\n\t\t\t(this._doc.alwaysShowSettings ? \"✓ \" : \"　\") + \"Customize All Instruments\",\n\t\t\t(this._doc.instrumentCopyPaste ? \"✓ \" : \"　\") + \"Instrument Copy/Paste Buttons\",\n\t\t\t(this._doc.enableChannelMuting ? \"✓ \" : \"　\") + \"Enable Channel Muting\",\n\t\t\t(this._doc.displayBrowserUrl ? \"✓ \" : \"　\") + \"Display Song Data in URL\",\n\t\t\t\"　Choose Layout...\",\n\t\t\t(this._doc.colorTheme == \"light classic\" ? \"✓ \" : \"　\") + \"Light Theme\",\n\t\t];\n\t\tfor (let i: number = 0; i < optionCommands.length; i++) {\n\t\t\tconst option: HTMLOptionElement = <HTMLOptionElement> this._optionsMenu.children[i + 1];\n\t\t\tif (option.textContent != optionCommands[i]) option.textContent = optionCommands[i];\n\t\t}\n\t\t\n\t\tconst channel: Channel = this._doc.song.channels[this._doc.channel];\n\t\tconst instrumentIndex: number = this._doc.getCurrentInstrument();\n\t\tconst instrument: Instrument = channel.instruments[instrumentIndex];\n\t\tconst wasActive: boolean = this.mainLayer.contains(document.activeElement);\n\t\tconst activeElement: Element | null = document.activeElement;\n\t\tconst colors: ChannelColors = ColorConfig.getChannelColor(this._doc.song, this._doc.channel);\n\t\t\n\t\tfor (let i: number = this._effectsSelect.childElementCount - 1; i < Config.effectOrder.length; i++) {\n\t\t\tthis._effectsSelect.appendChild(option({value: i}));\n\t\t}\n\t\tthis._effectsSelect.selectedIndex = 0;\n\t\tfor (let i: number = 0; i < Config.effectOrder.length; i++) {\n\t\t\tlet effectFlag: number = Config.effectOrder[i];\n\t\t\tconst selected: boolean = ((instrument.effects & (1 << effectFlag)) != 0);\n\t\t\tconst label: string = (selected ? \"✓ \" : \"　\") + Config.effectNames[effectFlag];\n\t\t\tconst option: HTMLOptionElement = <HTMLOptionElement> this._effectsSelect.children[i + 1];\n\t\t\tif (option.textContent != label) option.textContent = label;\n\t\t}\n\t\t\n\t\tsetSelectedValue(this._scaleSelect, this._doc.song.scale);\n\t\tthis._scaleSelect.title = Config.scales[this._doc.song.scale].realName;\n\t\tsetSelectedValue(this._keySelect, Config.keys.length - 1 - this._doc.song.key);\n\t\tthis._tempoSlider.updateValue(Math.max(0, Math.min(28, Math.round(4.0 + 9.0 * Math.log2(this._doc.song.tempo / 120.0)))));\n\t\tthis._tempoStepper.value = this._doc.song.tempo.toString();\n\t\tsetSelectedValue(this._rhythmSelect, this._doc.song.rhythm);\n\t\t\n\t\tif (this._doc.song.getChannelIsNoise(this._doc.channel)) {\n\t\t\tthis._pitchedPresetSelect.style.display = \"none\";\n\t\t\tthis._drumPresetSelect.style.display = \"\";\n\t\t\tsetSelectedValue(this._drumPresetSelect, instrument.preset);\n\t\t} else {\n\t\t\tthis._pitchedPresetSelect.style.display = \"\";\n\t\t\tthis._drumPresetSelect.style.display = \"none\";\n\t\t\tsetSelectedValue(this._pitchedPresetSelect, instrument.preset);\n\t\t}\n\t\t\n\t\tif (this._doc.instrumentCopyPaste) {\n\t\t\tthis._instrumentCopyPasteRow.style.display = \"\";\n\t\t} else {\n\t\t\tthis._instrumentCopyPasteRow.style.display = \"none\";\n\t\t}\n\t\t\n\t\tif (!this._doc.alwaysShowSettings && instrument.preset != instrument.type) {\n\t\t\tthis._customizeInstrumentButton.style.display = \"\";\n\t\t\tthis._customInstrumentSettingsGroup.style.display = \"none\";\n\t\t} else {\n\t\t\tthis._customizeInstrumentButton.style.display = \"none\";\n\t\t\tthis._customInstrumentSettingsGroup.style.display = \"\";\n\t\t\t\n\t\t\tif (instrument.type == InstrumentType.noise) {\n\t\t\t\tthis._chipNoiseSelectRow.style.display = \"\";\n\t\t\t\tsetSelectedValue(this._chipNoiseSelect, instrument.chipNoise);\n\t\t\t} else {\n\t\t\t\tthis._chipNoiseSelectRow.style.display = \"none\";\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.spectrum) {\n\t\t\t\tthis._spectrumRow.style.display = \"\";\n\t\t\t\tthis._spectrumEditor.render();\n\t\t\t} else {\n\t\t\t\tthis._spectrumRow.style.display = \"none\";\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.harmonics || instrument.type == InstrumentType.pickedString) {\n\t\t\t\tthis._harmonicsRow.style.display = \"\";\n\t\t\t\tthis._harmonicsEditor.render();\n\t\t\t} else {\n\t\t\t\tthis._harmonicsRow.style.display = \"none\";\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.pickedString) {\n\t\t\t\tthis._stringSustainRow.style.display = \"\";\n\t\t\t\tthis._stringSustainSlider.updateValue(instrument.stringSustain);\n\t\t\t} else {\n\t\t\t\tthis._stringSustainRow.style.display = \"none\";\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.drumset) {\n\t\t\t\tthis._drumsetGroup.style.display = \"\";\n\t\t\t\tthis._fadeInOutRow.style.display = \"none\";\n\t\t\t\tfor (let i: number = 0; i < Config.drumCount; i++) {\n\t\t\t\t\tsetSelectedValue(this._drumsetEnvelopeSelects[i], instrument.drumsetEnvelopes[i]);\n\t\t\t\t\tthis._drumsetSpectrumEditors[i].render();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._drumsetGroup.style.display = \"none\";\n\t\t\t\tthis._fadeInOutRow.style.display = \"\";\n\t\t\t\tthis._fadeInOutEditor.render();\n\t\t\t}\n\t\t\t\n\t\t\tif (instrument.type == InstrumentType.chip) {\n\t\t\t\tthis._chipWaveSelectRow.style.display = \"\";\n\t\t\t\tsetSelectedValue(this._chipWaveSelect, instrument.chipWave);\n\t\t\t} else {\n\t\t\t\tthis._chipWaveSelectRow.style.display = \"none\";\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.fm) {\n\t\t\t\tthis._algorithmSelectRow.style.display = \"\";\n\t\t\t\tthis._phaseModGroup.style.display = \"\";\n\t\t\t\tthis._feedbackRow1.style.display = \"\";\n\t\t\t\tthis._feedbackRow2.style.display = \"\";\n\t\t\t\tsetSelectedValue(this._algorithmSelect, instrument.algorithm);\n\t\t\t\tsetSelectedValue(this._feedbackTypeSelect, instrument.feedbackType);\n\t\t\t\tthis._feedbackAmplitudeSlider.updateValue(instrument.feedbackAmplitude);\n\t\t\t\tfor (let i: number = 0; i < Config.operatorCount; i++) {\n\t\t\t\t\tconst isCarrier: boolean = (i < Config.algorithms[instrument.algorithm].carrierCount);\n\t\t\t\t\tthis._operatorRows[i].style.color = isCarrier ? ColorConfig.primaryText : \"\";\n\t\t\t\t\tsetSelectedValue(this._operatorFrequencySelects[i], instrument.operators[i].frequency);\n\t\t\t\t\tthis._operatorAmplitudeSliders[i].updateValue(instrument.operators[i].amplitude);\n\t\t\t\t\tconst operatorName: string = (isCarrier ? \"Voice \" : \"Modulator \") + (i + 1);\n\t\t\t\t\tthis._operatorFrequencySelects[i].title = operatorName + \" Frequency\";\n\t\t\t\t\tthis._operatorAmplitudeSliders[i].input.title = operatorName + (isCarrier ? \" Volume\" : \" Amplitude\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._algorithmSelectRow.style.display = \"none\";\n\t\t\t\tthis._phaseModGroup.style.display = \"none\";\n\t\t\t\tthis._feedbackRow1.style.display = \"none\";\n\t\t\t\tthis._feedbackRow2.style.display = \"none\";\n\t\t\t}\n\t\t\tif (instrument.type == InstrumentType.pwm) {\n\t\t\t\tthis._pulseWidthRow.style.display = \"\";\n\t\t\t\tthis._pulseWidthSlider.input.title = prettyNumber(getPulseWidthRatio(instrument.pulseWidth) * 100) + \"%\";\n\t\t\t\tthis._pulseWidthSlider.updateValue(instrument.pulseWidth);\n\t\t\t} else {\n\t\t\t\tthis._pulseWidthRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeTransition(instrument.effects)) {\n\t\t\t\tthis._transitionRow.style.display = \"\";\n\t\t\t\tsetSelectedValue(this._transitionSelect, instrument.transition);\n\t\t\t} else {\n\t\t\t\tthis._transitionRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeChord(instrument.effects)) {\n\t\t\t\tthis._chordSelectRow.style.display = \"\";\n\t\t\t\tsetSelectedValue(this._chordSelect, instrument.chord);\n\t\t\t} else {\n\t\t\t\tthis._chordSelectRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludePitchShift(instrument.effects)) {\n\t\t\t\tthis._pitchShiftRow.style.display = \"\";\n\t\t\t\tthis._pitchShiftSlider.updateValue(instrument.pitchShift);\n\t\t\t\tthis._pitchShiftSlider.input.title = (instrument.pitchShift - Config.pitchShiftCenter) + \" semitone(s)\";\n\t\t\t\tfor (const marker of this._pitchShiftFifthMarkers) {\n\t\t\t\t\tmarker.style.display = this._doc.showFifth ? \"\" : \"none\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._pitchShiftRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeDetune(instrument.effects)) {\n\t\t\t\tthis._detuneRow.style.display = \"\";\n\t\t\t\tthis._detuneSlider.updateValue(instrument.detune);\n\t\t\t\tthis._detuneSlider.input.title = (Synth.detuneToCents(instrument.detune - Config.detuneCenter)) + \" cent(s)\";\n\t\t\t} else {\n\t\t\t\tthis._detuneRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeVibrato(instrument.effects)) {\n\t\t\t\tthis._vibratoSelectRow.style.display = \"\";\n\t\t\t\tsetSelectedValue(this._vibratoSelect, instrument.vibrato);\n\t\t\t} else {\n\t\t\t\tthis._vibratoSelectRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeNoteFilter(instrument.effects)) {\n\t\t\t\tthis._noteFilterRow.style.display = \"\";\n\t\t\t\tthis._noteFilterEditor.render();\n\t\t\t} else {\n\t\t\t\tthis._noteFilterRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeDistortion(instrument.effects)) {\n\t\t\t\tthis._distortionRow.style.display = \"\";\n\t\t\t\tthis._distortionSlider.updateValue(instrument.distortion);\n\t\t\t} else {\n\t\t\t\tthis._distortionRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeBitcrusher(instrument.effects)) {\n\t\t\t\tthis._bitcrusherQuantizationRow.style.display = \"\";\n\t\t\t\tthis._bitcrusherFreqRow.style.display = \"\";\n\t\t\t\tthis._bitcrusherQuantizationSlider.updateValue(instrument.bitcrusherQuantization);\n\t\t\t\tthis._bitcrusherFreqSlider.updateValue(instrument.bitcrusherFreq);\n\t\t\t} else {\n\t\t\t\tthis._bitcrusherQuantizationRow.style.display = \"none\";\n\t\t\t\tthis._bitcrusherFreqRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludePanning(instrument.effects)) {\n\t\t\t\tthis._panSliderRow.style.display = \"\";\n\t\t\t\tthis._panSlider.updateValue(instrument.pan);\n\t\t\t} else {\n\t\t\t\tthis._panSliderRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeChorus(instrument.effects)) {\n\t\t\t\tthis._chorusRow.style.display = \"\";\n\t\t\t\tthis._chorusSlider.updateValue(instrument.chorus);\n\t\t\t} else {\n\t\t\t\tthis._chorusRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeEcho(instrument.effects)) {\n\t\t\t\tthis._echoSustainRow.style.display = \"\";\n\t\t\t\tthis._echoSustainSlider.updateValue(instrument.echoSustain);\n\t\t\t\tthis._echoDelayRow.style.display = \"\";\n\t\t\t\tthis._echoDelaySlider.updateValue(instrument.echoDelay);\n\t\t\t\tthis._echoDelaySlider.input.title = (Math.round((instrument.echoDelay + 1) * Config.echoDelayStepTicks / (Config.ticksPerPart * Config.partsPerBeat) * 1000) / 1000) + \" beat(s)\";\n\t\t\t} else {\n\t\t\t\tthis._echoSustainRow.style.display = \"none\";\n\t\t\t\tthis._echoDelayRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (effectsIncludeReverb(instrument.effects)) {\n\t\t\t\tthis._reverbRow.style.display = \"\";\n\t\t\t\tthis._reverbSlider.updateValue(instrument.reverb);\n\t\t\t} else {\n\t\t\t\tthis._reverbRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tif (instrument.type == InstrumentType.chip || instrument.type == InstrumentType.harmonics || instrument.type == InstrumentType.pickedString) {\n\t\t\t\tthis._unisonSelectRow.style.display = \"\";\n\t\t\t\tsetSelectedValue(this._unisonSelect, instrument.unison);\n\t\t\t} else {\n\t\t\t\tthis._unisonSelectRow.style.display = \"none\";\n\t\t\t}\n\t\t\t\n\t\t\tthis._envelopeEditor.render();\n\t\t}\n\t\t\n\t\tfor (let chordIndex: number = 0; chordIndex < Config.chords.length; chordIndex++) {\n\t\t\tlet hidden: boolean = (!Config.instrumentTypeHasSpecialInterval[instrument.type] && Config.chords[chordIndex].customInterval);\n\t\t\tconst option: Element = this._chordSelect.children[chordIndex];\n\t\t\tif (hidden) {\n\t\t\t\tif (!option.hasAttribute(\"hidden\")) {\n\t\t\t\t\toption.setAttribute(\"hidden\", \"\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toption.removeAttribute(\"hidden\");\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._doc.song.layeredInstruments || this._doc.song.patternInstruments) {\n\t\t\tthis._instrumentsButtonRow.style.display = \"\";\n\t\t\t\n\t\t\tthis._instrumentsButtonBar.style.setProperty(\"--text-color-lit\", colors.primaryNote);\n\t\t\tthis._instrumentsButtonBar.style.setProperty(\"--text-color-dim\", colors.secondaryNote);\n\t\t\tthis._instrumentsButtonBar.style.setProperty(\"--background-color-lit\", colors.primaryChannel);\n\t\t\tthis._instrumentsButtonBar.style.setProperty(\"--background-color-dim\", colors.secondaryChannel);\n\t\t\t\n\t\t\tconst maxInstrumentsPerChannel = this._doc.song.getMaxInstrumentsPerChannel();\n\t\t\twhile (this._instrumentButtons.length < channel.instruments.length) {\n\t\t\t\tconst instrumentButton: HTMLButtonElement = button(String(this._instrumentButtons.length + 1));\n\t\t\t\tthis._instrumentButtons.push(instrumentButton);\n\t\t\t\tthis._instrumentsButtonBar.insertBefore(instrumentButton, this._instrumentRemoveButton);\n\t\t\t}\n\t\t\tfor (let i: number = this._renderedInstrumentCount; i < channel.instruments.length; i++) {\n\t\t\t\tthis._instrumentButtons[i].style.display = \"\";\n\t\t\t}\n\t\t\tfor (let i: number = channel.instruments.length; i < this._renderedInstrumentCount; i++) {\n\t\t\t\tthis._instrumentButtons[i].style.display = \"none\";\n\t\t\t}\n\t\t\tthis._renderedInstrumentCount = channel.instruments.length;\n\t\t\twhile (this._instrumentButtons.length > maxInstrumentsPerChannel) {\n\t\t\t\tthis._instrumentsButtonBar.removeChild(this._instrumentButtons.pop()!);\n\t\t\t}\n\t\t\t\n\t\t\tthis._instrumentRemoveButton.style.display = (channel.instruments.length > Config.instrumentCountMin) ? \"\" : \"none\";\n\t\t\tthis._instrumentAddButton.style.display = (channel.instruments.length < maxInstrumentsPerChannel) ? \"\" : \"none\";\n\t\t\tif (channel.instruments.length < maxInstrumentsPerChannel) {\n\t\t\t\tthis._instrumentRemoveButton.classList.remove(\"last-button\");\n\t\t\t} else {\n\t\t\t\tthis._instrumentRemoveButton.classList.add(\"last-button\");\n\t\t\t}\n\t\t\tif (channel.instruments.length > 1) {\n\t\t\t\tif (this._highlightedInstrumentIndex != instrumentIndex) {\n\t\t\t\t\tconst oldButton: HTMLButtonElement = this._instrumentButtons[this._highlightedInstrumentIndex];\n\t\t\t\t\tif (oldButton != null) oldButton.classList.remove(\"selected-instrument\");\n\t\t\t\t\tconst newButton: HTMLButtonElement = this._instrumentButtons[instrumentIndex];\n\t\t\t\t\tnewButton.classList.add(\"selected-instrument\");\n\t\t\t\t\tthis._highlightedInstrumentIndex = instrumentIndex;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst oldButton: HTMLButtonElement = this._instrumentButtons[this._highlightedInstrumentIndex];\n\t\t\t\tif (oldButton != null) oldButton.classList.remove(\"selected-instrument\");\n\t\t\t\tthis._highlightedInstrumentIndex = -1;\n\t\t\t}\n\t\t\t\n\t\t\tif (this._doc.song.layeredInstruments && this._doc.song.patternInstruments) {\n\t\t\t\t//const pattern: Pattern | null = this._doc.getCurrentPattern();\n\t\t\t\tfor (let i: number = 0; i < channel.instruments.length; i++) {\n\t\t\t\t\tif (this._doc.recentPatternInstruments[this._doc.channel].indexOf(i) != -1) {\n\t\t\t\t\t\tthis._instrumentButtons[i].classList.remove(\"deactivated\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._instrumentButtons[i].classList.add(\"deactivated\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._deactivatedInstruments = true;\n\t\t\t} else if (this._deactivatedInstruments) {\n\t\t\t\tfor (let i: number = 0; i < channel.instruments.length; i++) {\n\t\t\t\t\tthis._instrumentButtons[i].classList.remove(\"deactivated\");\n\t\t\t\t}\n\t\t\t\tthis._deactivatedInstruments = false;\n\t\t\t}\n\t\t} else {\n\t\t\tthis._instrumentsButtonRow.style.display = \"none\";\n\t\t}\n\t\t\n\t\tthis._instrumentSettingsGroup.style.color = colors.primaryNote;\n\t\t\n\t\tthis._eqFilterEditor.render();\n\t\tthis._instrumentVolumeSlider.updateValue(-instrument.volume);\n\t\tthis._addEnvelopeButton.disabled = (instrument.envelopeCount >= Config.maxEnvelopeCount);\n\t\t\n\t\tthis._volumeSlider.value = String(this._doc.volume);\n\t\t\n\t\t// If an interface element was selected, but becomes invisible (e.g. an instrument\n\t\t// select menu) just select the editor container so keyboard commands still work.\n\t\tif (wasActive && activeElement != null && activeElement.clientWidth == 0) {\n\t\t\tthis._refocusStage();\n\t\t}\n\t\t\n\t\tthis._setPrompt(this._doc.prompt);\n\t\t\n\t\tif (this._doc.autoFollow && !this._doc.synth.playing) {\n\t\t\tthis._doc.synth.goToBar(this._doc.bar);\n\t\t}\n\t\t\n\t\t// When adding effects or envelopes to an instrument in fullscreen modes,\n\t\t// auto-scroll the settings areas to ensure the new settings are visible.\n\t\tif (this._doc.addedEffect) {\n\t\t\tconst envButtonRect: DOMRect = this._addEnvelopeButton.getBoundingClientRect();\n\t\t\tconst instSettingsRect: DOMRect = this._instrumentSettingsArea.getBoundingClientRect();\n\t\t\tconst settingsRect: DOMRect = this._settingsArea.getBoundingClientRect();\n\t\t\tthis._instrumentSettingsArea.scrollTop += Math.max(0, envButtonRect.top - (instSettingsRect.top + instSettingsRect.height));\n\t\t\tthis._settingsArea.scrollTop += Math.max(0, envButtonRect.top - (settingsRect.top + settingsRect.height));\n\t\t\tthis._doc.addedEffect = false;\n\t\t}\n\t\tif (this._doc.addedEnvelope) {\n\t\t\tthis._instrumentSettingsArea.scrollTop = this._instrumentSettingsArea.scrollHeight;\n\t\t\tthis._settingsArea.scrollTop = this._settingsArea.scrollHeight;\n\t\t\tthis._doc.addedEnvelope = false;\n\t\t}\n\t}\n\t\n\tpublic updatePlayButton(): void {\n\t\tif (this._doc.synth.playing) {\n\t\t\tthis._playButton.classList.remove(\"playButton\");\n\t\t\tthis._playButton.classList.add(\"pauseButton\");\n\t\t\tthis._playButton.title = \"Pause (Space)\";\n\t\t\tthis._playButton.textContent = \"Pause\";\n\t\t} else {\n\t\t\tthis._playButton.classList.remove(\"pauseButton\");\n\t\t\tthis._playButton.classList.add(\"playButton\");\n\t\t\tthis._playButton.title = \"Play (Space)\";\n\t\t\tthis._playButton.textContent = \"Play\";\n\t\t}\n\t}\n\t\n\tprivate _disableCtrlContextMenu = (event: MouseEvent): boolean => {\n\t\t// On a Mac, clicking while holding control opens the right-click context menu.\n\t\t// But in the pattern and track editors I'd rather prevent that and instead allow\n\t\t// custom behaviors such as setting the volume of a note.\n\t\tif (event.ctrlKey) {\n\t\t\tevent.preventDefault();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tprivate _tempoStepperCaptureNumberKeys = (event: KeyboardEvent): void => {\n\t\t// When the number input is in focus, allow some keyboard events to\n\t\t// edit the input without accidentally editing the song otherwise.\n\t\tswitch (event.keyCode) {\n\t\t\tcase 8: // backspace/delete\n\t\t\tcase 13: // enter/return\n\t\t\tcase 38: // up\n\t\t\tcase 40: // down\n\t\t\tcase 37: // left\n\t\t\tcase 39: // right\n\t\t\tcase 48: // 0\n\t\t\tcase 49: // 1\n\t\t\tcase 50: // 2\n\t\t\tcase 51: // 3\n\t\t\tcase 52: // 4\n\t\t\tcase 53: // 5\n\t\t\tcase 54: // 6\n\t\t\tcase 55: // 7\n\t\t\tcase 56: // 8\n\t\t\tcase 57: // 9\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tprivate _whenKeyPressed = (event: KeyboardEvent): void => {\n\t\tif (this.prompt) {\n\t\t\tif (event.keyCode == 27) { // ESC key\n\t\t\t\t// close prompt.\n\t\t\t\tthis._doc.undo();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tswitch (event.keyCode) {\n\t\t\tcase 27: // ESC key\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tnew ChangePatternSelection(this._doc, 0, 0);\n\t\t\t\t\tthis._doc.selection.resetBoxSelection();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 32: // space\n\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\t// Jump to mouse\n\t\t\t\t\tif (this._trackEditor.movePlayheadToMouse() || this._patternEditor.movePlayheadToMouse()) {\n\t\t\t\t\t\tif (!this._doc.synth.playing) this._play();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._togglePlay();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis._refocusStage();\n\t\t\t\tbreak;\n\t\t\tcase 90: // z\n\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\tthis._doc.redo();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.undo();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 89: // y\n\t\t\t\tthis._doc.redo();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 67: // c\n\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\tthis._copyInstrument();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.copy();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 13: // enter/return\n\t\t\t\tif (event.ctrlKey || event.metaKey) {\n\t\t\t\t\tthis._doc.selection.insertChannel();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.insertBars();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 8: // backspace/delete\n\t\t\t\tif (event.ctrlKey || event.metaKey) {\n\t\t\t\t\tthis._doc.selection.deleteChannel();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.deleteBars();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 65: // a\n\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\tthis._doc.selection.selectChannel();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.selectAll();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 68: // d\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.duplicatePatterns();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 70: // f\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.synth.snapToStart();\n\t\t\t\t\tif (this._doc.autoFollow) {\n\t\t\t\t\t\tthis._doc.selection.setChannelBar(this._doc.channel, Math.floor(this._doc.synth.playhead));\n\t\t\t\t\t}\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 72: // h\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.synth.goToBar(this._doc.bar);\n\t\t\t\t\tthis._doc.synth.snapToBar();\n\t\t\t\t\tif (this._doc.autoFollow) {\n\t\t\t\t\t\tthis._doc.selection.setChannelBar(this._doc.channel, Math.floor(this._doc.synth.playhead));\n\t\t\t\t\t}\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 77: // m\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tif (this._doc.enableChannelMuting) {\n\t\t\t\t\t\tthis._doc.selection.muteChannels(event.shiftKey);\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 81: // q\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._openPrompt(\"channelSettings\");\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 83: // s\n\t\t\t\tif (event.ctrlKey || event.metaKey) {\n\t\t\t\t\tthis._openPrompt(\"export\");\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t} else {\n\t\t\t\t\tif (this._doc.enableChannelMuting) {\n\t\t\t\t\t\tthis._doc.selection.soloChannels(event.shiftKey);\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 79: // o\n\t\t\t\tif (event.ctrlKey || event.metaKey) {\n\t\t\t\t\tthis._openPrompt(\"import\");\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 86: // v\n\t\t\t\tif ((event.ctrlKey || event.metaKey) && event.shiftKey) {\n\t\t\t\t\tthis._doc.selection.pasteNumbers();\n\t\t\t\t} else if (event.shiftKey) {\n\t\t\t\t\tthis._pasteInstrument();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.pasteNotes();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 73: // i\n\t\t\t\tif (!event.ctrlKey && !event.metaKey && event.shiftKey) {\n\t\t\t\t\t// Copy the current instrument as a preset to the clipboard.\n\t\t\t\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\t\t\t\tconst instrumentObject: any = instrument.toJsonObject();\n\t\t\t\t\tdelete instrumentObject[\"preset\"];\n\t\t\t\t\t// Volume and the panning effect are not included in presets.\n\t\t\t\t\tdelete instrumentObject[\"volume\"];\n\t\t\t\t\tdelete instrumentObject[\"pan\"];\n\t\t\t\t\tconst panningEffectIndex: number = instrumentObject[\"effects\"].indexOf(Config.effectNames[EffectType.panning]);\n\t\t\t\t\tif (panningEffectIndex != -1) instrumentObject[\"effects\"].splice(panningEffectIndex, 1);\n\t\t\t\t\tfor (let i: number = 0; i < instrumentObject[\"envelopes\"].length; i++) {\n\t\t\t\t\t\tconst envelope: any = instrumentObject[\"envelopes\"][i];\n\t\t\t\t\t\t// If there are any envelopes targeting panning or none, remove those too.\n\t\t\t\t\t\tif (envelope[\"target\"] == \"panning\" || envelope[\"target\"] == \"none\" || envelope[\"envelope\"] == \"none\") {\n\t\t\t\t\t\t\tinstrumentObject[\"envelopes\"].splice(i, 1);\n\t\t\t\t\t\t\ti--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._copyTextToClipboard(JSON.stringify(instrumentObject));\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 82: // r\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\t\tthis._randomGenerated();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._randomPreset();\n\t\t\t\t\t}\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 219: // left brace\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.synth.goToPrevBar();\n\t\t\t\t\tif (this._doc.autoFollow) {\n\t\t\t\t\t\tthis._doc.selection.setChannelBar(this._doc.channel, Math.floor(this._doc.synth.playhead));\n\t\t\t\t\t}\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 221: // right brace\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.synth.goToNextBar();\n\t\t\t\t\tif (this._doc.autoFollow) {\n\t\t\t\t\t\tthis._doc.selection.setChannelBar(this._doc.channel, Math.floor(this._doc.synth.playhead));\n\t\t\t\t\t}\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 189: // -\n\t\t\tcase 173: // Firefox -\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.transpose(false, event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 187: // +\n\t\t\tcase 61: // Firefox +\n\t\t\tcase 171: // Some users have this as +? Hmm.\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.transpose(true, event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 38: // up\n\t\t\t\tif (event.ctrlKey || event.metaKey) {\n\t\t\t\t\tthis._doc.selection.swapChannels(-1);\n\t\t\t\t} else if (event.shiftKey) {\n\t\t\t\t\tthis._doc.selection.boxSelectionY1 = Math.max(0, this._doc.selection.boxSelectionY1 - 1);\n\t\t\t\t\tthis._doc.selection.scrollToSelection();\n\t\t\t\t\tthis._doc.selection.selectionUpdated();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.setChannelBar((this._doc.channel - 1 + this._doc.song.getChannelCount()) % this._doc.song.getChannelCount(), this._doc.bar);\n\t\t\t\t\tthis._doc.selection.resetBoxSelection();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 40: // down\n\t\t\t\tif (event.ctrlKey || event.metaKey) {\n\t\t\t\t\tthis._doc.selection.swapChannels(1);\n\t\t\t\t} else if (event.shiftKey) {\n\t\t\t\t\tthis._doc.selection.boxSelectionY1 = Math.min(this._doc.song.getChannelCount() - 1, this._doc.selection.boxSelectionY1 + 1);\n\t\t\t\t\tthis._doc.selection.scrollToSelection();\n\t\t\t\t\tthis._doc.selection.selectionUpdated();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.setChannelBar((this._doc.channel + 1) % this._doc.song.getChannelCount(), this._doc.bar);\n\t\t\t\t\tthis._doc.selection.resetBoxSelection();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 37: // left\n\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\tthis._doc.selection.boxSelectionX1 = Math.max(0, this._doc.selection.boxSelectionX1 - 1);\n\t\t\t\t\tthis._doc.selection.scrollToSelection();\n\t\t\t\t\tthis._doc.selection.selectionUpdated();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.setChannelBar(this._doc.channel, (this._doc.bar + this._doc.song.barCount - 1) % this._doc.song.barCount);\n\t\t\t\t\tthis._doc.selection.resetBoxSelection();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 39: // right\n\t\t\t\tif (event.shiftKey) {\n\t\t\t\t\tthis._doc.selection.boxSelectionX1 = Math.min(this._doc.song.barCount - 1, this._doc.selection.boxSelectionX1 + 1);\n\t\t\t\t\tthis._doc.selection.scrollToSelection();\n\t\t\t\t\tthis._doc.selection.selectionUpdated();\n\t\t\t\t} else {\n\t\t\t\t\tthis._doc.selection.setChannelBar(this._doc.channel, (this._doc.bar + 1) % this._doc.song.barCount);\n\t\t\t\t\tthis._doc.selection.resetBoxSelection();\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t\tcase 48: // 0\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"0\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 49: // 1\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"1\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 50: // 2\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"2\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 51: // 3\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"3\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 52: // 4\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"4\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 53: // 5\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"5\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 54: // 6\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"6\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 55: // 7\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"7\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 56: // 8\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"8\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 57: // 9\n\t\t\t\tif (!event.ctrlKey && !event.metaKey) {\n\t\t\t\t\tthis._doc.selection.nextDigit(\"9\", event.shiftKey);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis._doc.selection.digits = \"\";\n\t\t\t\tthis._doc.selection.instrumentDigits = \"\";\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tprivate _copyTextToClipboard(text: string): void {\n\t\tif (navigator.clipboard && navigator.clipboard.writeText) {\n\t\t\tnavigator.clipboard.writeText(text).catch(()=>{\n\t\t\t\twindow.prompt(\"Copy to clipboard:\", text);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconst textField: HTMLTextAreaElement = document.createElement(\"textarea\");\n\t\ttextField.textContent = text;\n\t\tdocument.body.appendChild(textField);\n\t\ttextField.select();\n\t\tconst succeeded: boolean = document.execCommand(\"copy\");\n\t\ttextField.remove();\n\t\tthis._refocusStage();\n\t\tif (!succeeded) window.prompt(\"Copy this:\", text);\n\t}\n\t\n\tprivate _whenPrevBarPressed = (): void => {\n\t\tthis._doc.synth.goToPrevBar();\n\t}\n\t\n\tprivate _whenNextBarPressed = (): void => {\n\t\tthis._doc.synth.goToNextBar();\n\t}\n\t\n\tprivate _togglePlay = (): void => {\n\t\tif (this._doc.synth.playing) {\n\t\t\tthis._pause();\n\t\t} else {\n\t\t\tthis._doc.synth.snapToBar();\n\t\t\tthis._play();\n\t\t}\n\t}\n\t\n\tprivate _play(): void {\n\t\tthis._doc.synth.play();\n\t\tthis.updatePlayButton();\n\t}\n\t\n\tprivate _pause(): void {\n\t\tthis._doc.synth.pause();\n\t\tthis._doc.synth.resetEffects();\n\t\tif (this._doc.autoFollow) {\n\t\t\tthis._doc.synth.goToBar(this._doc.bar);\n\t\t}\n\t\tthis._doc.synth.snapToBar();\n\t\tthis.updatePlayButton();\n\t}\n\t\n\tprivate _setVolumeSlider = (): void => {\n\t\tthis._doc.setVolume(Number(this._volumeSlider.value));\n\t}\n\t\n\tprivate _copyInstrument = (): void => {\n\t\tconst channel: Channel = this._doc.song.channels[this._doc.channel];\n\t\tconst instrument: Instrument = channel.instruments[this._doc.getCurrentInstrument()];\n\t\tconst instrumentCopy: any = instrument.toJsonObject();\n\t\tinstrumentCopy[\"isDrum\"] = this._doc.song.getChannelIsNoise(this._doc.channel);\n\t\twindow.localStorage.setItem(\"instrumentCopy\", JSON.stringify(instrumentCopy));\n\t\tthis._refocusStage();\n\t}\n\t\n\tprivate _pasteInstrument = (): void => {\n\t\tconst channel: Channel = this._doc.song.channels[this._doc.channel];\n\t\tconst instrument: Instrument = channel.instruments[this._doc.getCurrentInstrument()];\n\t\tconst instrumentCopy: any = JSON.parse(String(window.localStorage.getItem(\"instrumentCopy\")));\n\t\tif (instrumentCopy != null && instrumentCopy[\"isDrum\"] == this._doc.song.getChannelIsNoise(this._doc.channel)) {\n\t\t\tthis._doc.record(new ChangePasteInstrument(this._doc, instrument, instrumentCopy));\n\t\t}\n\t\tthis._refocusStage();\n\t}\n\t\n\tprivate _randomPreset(): void {\n\t\tconst isNoise: boolean = this._doc.song.getChannelIsNoise(this._doc.channel);\n\t\tthis._doc.record(new ChangePreset(this._doc, pickRandomPresetValue(isNoise)));\n\t}\n\t\n\tprivate _randomGenerated(): void {\n\t\tthis._doc.record(new ChangeRandomGeneratedInstrument(this._doc));\n\t}\n\t\n\tprivate _whenSetTempo = (): void => {\n\t\tthis._doc.record(new ChangeTempo(this._doc, -1, parseInt(this._tempoStepper.value) | 0));\n\t}\n\t\n\tprivate _whenSetScale = (): void => {\n\t\tif (isNaN(<number> <unknown> this._scaleSelect.value)) {\n\t\t\tswitch (this._scaleSelect.value) {\n\t\t\t\tcase \"forceScale\":\n\t\t\t\t\tthis._doc.selection.forceScale();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis._doc.notifier.changed();\n\t\t} else {\n\t\t\tthis._doc.record(new ChangeScale(this._doc, this._scaleSelect.selectedIndex));\n\t\t}\n\t}\n\t\n\tprivate _whenSetKey = (): void => {\n\t\tif (isNaN(<number> <unknown> this._keySelect.value)) {\n\t\t\tswitch (this._keySelect.value) {\n\t\t\t\tcase \"detectKey\":\n\t\t\t\t\tthis._doc.record(new ChangeDetectKey(this._doc));\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis._doc.notifier.changed();\n\t\t} else {\n\t\t\tthis._doc.record(new ChangeKey(this._doc, Config.keys.length - 1 - this._keySelect.selectedIndex));\n\t\t}\n\t}\n\t\n\tprivate _whenSetRhythm = (): void => {\n\t\tif (isNaN(<number> <unknown> this._rhythmSelect.value)) {\n\t\t\tswitch (this._rhythmSelect.value) {\n\t\t\t\tcase \"forceRhythm\":\n\t\t\t\t\tthis._doc.selection.forceRhythm();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis._doc.notifier.changed();\n\t\t} else {\n\t\t\tthis._doc.record(new ChangeRhythm(this._doc, this._rhythmSelect.selectedIndex));\n\t\t}\n\t}\n\t\n\tprivate _whenSetPitchedPreset = (): void => {\n\t\tthis._setPreset(this._pitchedPresetSelect.value);\n\t}\n\t\n\tprivate _whenSetDrumPreset = (): void => {\n\t\tthis._setPreset(this._drumPresetSelect.value);\n\t}\n\t\n\tprivate _setPreset(preset: string): void {\n\t\tif (isNaN(<number> <unknown> preset)) {\n\t\t\tswitch (preset) {\n\t\t\t\tcase \"copyInstrument\":\n\t\t\t\t\tthis._copyInstrument();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"pasteInstrument\":\n\t\t\t\t\tthis._pasteInstrument();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"randomPreset\":\n\t\t\t\t\tthis._randomPreset();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"randomGenerated\":\n\t\t\t\t\tthis._randomGenerated();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis._doc.notifier.changed();\n\t\t} else {\n\t\t\tthis._doc.record(new ChangePreset(this._doc, parseInt(preset)));\n\t\t}\n\t}\n\t\n\tprivate _whenSetFeedbackType = (): void => {\n\t\tthis._doc.record(new ChangeFeedbackType(this._doc, this._feedbackTypeSelect.selectedIndex));\n\t}\n\t\n\tprivate _whenSetAlgorithm = (): void => {\n\t\tthis._doc.record(new ChangeAlgorithm(this._doc, this._algorithmSelect.selectedIndex));\n\t}\n\t\n\tprivate _whenSelectInstrument = (event: MouseEvent): void => {\n\t\tif (event.target == this._instrumentAddButton) {\n\t\t\tthis._doc.record(new ChangeAddChannelInstrument(this._doc));\n\t\t} else if (event.target == this._instrumentRemoveButton) {\n\t\t\tthis._doc.record(new ChangeRemoveChannelInstrument(this._doc));\n\t\t} else {\n\t\t\tconst index: number = this._instrumentButtons.indexOf(<any>event.target);\n\t\t\tif (index != -1) {\n\t\t\t\tthis._doc.selection.selectInstrument(index);\n\t\t\t}\n\t\t}\n\t\tthis._refocusStage();\n\t}\n\t\n\tprivate _whenCustomizePressed = (): void => {\n\t\tthis._doc.record(new ChangeCustomizeInstrument(this._doc));\n\t}\n\t\n\tprivate _whenSetChipWave = (): void => {\n\t\tthis._doc.record(new ChangeChipWave(this._doc, this._chipWaveSelect.selectedIndex));\n\t}\n\t\n\tprivate _whenSetNoiseWave = (): void => {\n\t\tthis._doc.record(new ChangeNoiseWave(this._doc, this._chipNoiseSelect.selectedIndex));\n\t}\n\tprivate _whenSetTransition = (): void => {\n\t\tthis._doc.record(new ChangeTransition(this._doc, this._transitionSelect.selectedIndex));\n\t}\n\t\n\tprivate _whenSetEffects = (): void => {\n\t\tconst instrument: Instrument = this._doc.song.channels[this._doc.channel].instruments[this._doc.getCurrentInstrument()];\n\t\tconst oldValue: number = instrument.effects;\n\t\tconst toggleFlag: number = Config.effectOrder[this._effectsSelect.selectedIndex - 1];\n\t\tthis._doc.record(new ChangeToggleEffects(this._doc, toggleFlag));\n\t\tthis._effectsSelect.selectedIndex = 0;\n\t\tif (instrument.effects > oldValue) {\n\t\t\tthis._doc.addedEffect = true;\n\t\t}\n\t}\n\t\n\tprivate _whenSetVibrato = (): void => {\n\t\tthis._doc.record(new ChangeVibrato(this._doc, this._vibratoSelect.selectedIndex));\n\t}\n\t\n\tprivate _whenSetUnison = (): void => {\n\t\tthis._doc.record(new ChangeUnison(this._doc, this._unisonSelect.selectedIndex));\n\t}\n\t\n\tprivate _whenSetChord = (): void => {\n\t\tthis._doc.record(new ChangeChord(this._doc, this._chordSelect.selectedIndex));\n\t}\n\t\n\tprivate _addNewEnvelope = (): void => {\n\t\tthis._doc.record(new ChangeAddEnvelope(this._doc));\n\t\tthis._refocusStage();\n\t\tthis._doc.addedEnvelope = true;\n\t}\n\t\n\tprivate _zoomIn = (): void => {\n\t\tthis._doc.visibleOctaves = Math.max(1, this._doc.visibleOctaves - 1);\n\t\tthis._doc.savePreferences();\n\t\tthis._doc.notifier.changed();\n\t\tthis._refocusStage();\n\t}\n\t\n\tprivate _zoomOut = (): void => {\n\t\tthis._doc.visibleOctaves = Math.min(Config.pitchOctaves, this._doc.visibleOctaves + 1);\n\t\tthis._doc.savePreferences();\n\t\tthis._doc.notifier.changed();\n\t\tthis._refocusStage();\n\t}\n\t\n\tprivate _fileMenuHandler = (event:Event): void => {\n\t\tswitch (this._fileMenu.value) {\n\t\t\tcase \"new\":\n\t\t\t\tthis._doc.goBackToStart();\n\t\t\t\tfor (const channel of this._doc.song.channels) channel.muted = false;\n\t\t\t\tthis._doc.record(new ChangeSong(this._doc, \"\"), false, true);\n\t\t\t\tbreak;\n\t\t\tcase \"export\":\n\t\t\t\tthis._openPrompt(\"export\");\n\t\t\t\tbreak;\n\t\t\tcase \"import\":\n\t\t\t\tthis._openPrompt(\"import\");\n\t\t\t\tbreak;\n\t\t\tcase \"copyUrl\":\n\t\t\t\tthis._copyTextToClipboard(new URL(\"#\" + this._doc.song.toBase64String(), location.href).href);\n\t\t\t\tbreak;\n\t\t\tcase \"shareUrl\":\n\t\t\t\t(<any>navigator).share({ url: new URL(\"#\" + this._doc.song.toBase64String(), location.href).href });\n\t\t\t\tbreak;\n\t\t\tcase \"shortenUrl\":\n\t\t\t\twindow.open(\"https://tinyurl.com/api-create.php?url=\" + encodeURIComponent(new URL(\"#\" + this._doc.song.toBase64String(), location.href).href));\n\t\t\t\tbreak;\n\t\t\tcase \"viewPlayer\":\n\t\t\t\tlocation.href = \"player/#song=\" + this._doc.song.toBase64String();\n\t\t\t\tbreak;\n\t\t\tcase \"copyEmbed\":\n\t\t\t\tthis._copyTextToClipboard(`<iframe width=\"384\" height=\"60\" style=\"border: none;\" src=\"${new URL(\"player/#song=\" + this._doc.song.toBase64String(), location.href).href}\"></iframe>`);\n\t\t\t\tbreak;\n\t\t\tcase \"songRecovery\":\n\t\t\t\tthis._openPrompt(\"songRecovery\");\n\t\t\t\tbreak;\n\t\t}\n\t\tthis._fileMenu.selectedIndex = 0;\n\t}\n\t\n\tprivate _editMenuHandler = (event:Event): void => {\n\t\tswitch (this._editMenu.value) {\n\t\t\tcase \"undo\":\n\t\t\t\tthis._doc.undo();\n\t\t\t\tbreak;\n\t\t\tcase \"redo\":\n\t\t\t\tthis._doc.redo();\n\t\t\t\tbreak;\n\t\t\tcase \"copy\":\n\t\t\t\tthis._doc.selection.copy();\n\t\t\t\tbreak;\n\t\t\tcase \"insertBars\":\n\t\t\t\tthis._doc.selection.insertBars();\n\t\t\t\tbreak;\n\t\t\tcase \"deleteBars\":\n\t\t\t\tthis._doc.selection.deleteBars();\n\t\t\t\tbreak;\n\t\t\tcase \"insertChannel\":\n\t\t\t\tthis._doc.selection.insertChannel();\n\t\t\t\tbreak;\n\t\t\tcase \"deleteChannel\":\n\t\t\t\tthis._doc.selection.deleteChannel();\n\t\t\t\tbreak;\n\t\t\tcase \"pasteNotes\":\n\t\t\t\tthis._doc.selection.pasteNotes();\n\t\t\t\tbreak;\n\t\t\tcase \"pasteNumbers\":\n\t\t\t\tthis._doc.selection.pasteNumbers();\n\t\t\t\tbreak;\n\t\t\tcase \"transposeUp\":\n\t\t\t\tthis._doc.selection.transpose(true, false);\n\t\t\t\tbreak;\n\t\t\tcase \"transposeDown\":\n\t\t\t\tthis._doc.selection.transpose(false, false);\n\t\t\t\tbreak;\n\t\t\tcase \"selectAll\":\n\t\t\t\tthis._doc.selection.selectAll();\n\t\t\t\tbreak;\n\t\t\tcase \"selectChannel\":\n\t\t\t\tthis._doc.selection.selectChannel();\n\t\t\t\tbreak;\n\t\t\tcase \"duplicatePatterns\":\n\t\t\t\tthis._doc.selection.duplicatePatterns();\n\t\t\t\tbreak;\n\t\t\tcase \"barCount\":\n\t\t\t\tthis._openPrompt(\"barCount\");\n\t\t\t\tbreak;\n\t\t\tcase \"beatsPerBar\":\n\t\t\t\tthis._openPrompt(\"beatsPerBar\");\n\t\t\t\tbreak;\n\t\t\tcase \"moveNotesSideways\":\n\t\t\t\tthis._openPrompt(\"moveNotesSideways\");\n\t\t\t\tbreak;\n\t\t\tcase \"channelSettings\":\n\t\t\t\tthis._openPrompt(\"channelSettings\");\n\t\t\t\tbreak;\n\t\t}\n\t\tthis._editMenu.selectedIndex = 0;\n\t}\n\t\n\tprivate _optionsMenuHandler = (event:Event): void => {\n\t\tswitch (this._optionsMenu.value) {\n\t\t\tcase \"autoPlay\":\n\t\t\t\tthis._doc.autoPlay = !this._doc.autoPlay;\n\t\t\t\tbreak;\n\t\t\tcase \"autoFollow\":\n\t\t\t\tthis._doc.autoFollow = !this._doc.autoFollow;\n\t\t\t\tbreak;\n\t\t\tcase \"enableNotePreview\":\n\t\t\t\tthis._doc.enableNotePreview = !this._doc.enableNotePreview;\n\t\t\t\tbreak;\n\t\t\tcase \"showLetters\":\n\t\t\t\tthis._doc.showLetters = !this._doc.showLetters;\n\t\t\t\tbreak;\n\t\t\tcase \"showFifth\":\n\t\t\t\tthis._doc.showFifth = !this._doc.showFifth;\n\t\t\t\tbreak;\n\t\t\tcase \"notesOutsideScale\":\n\t\t\t\tthis._doc.notesOutsideScale = !this._doc.notesOutsideScale;\n\t\t\t\tbreak;\n\t\t\tcase \"setDefaultScale\":\n\t\t\t\tthis._doc.defaultScale = this._doc.song.scale;\n\t\t\t\tbreak;\n\t\t\tcase \"showChannels\":\n\t\t\t\tthis._doc.showChannels = !this._doc.showChannels;\n\t\t\t\tbreak;\n\t\t\tcase \"showScrollBar\":\n\t\t\t\tthis._doc.showScrollBar = !this._doc.showScrollBar;\n\t\t\t\tbreak;\n\t\t\tcase \"alwaysShowSettings\":\n\t\t\t\tthis._doc.alwaysShowSettings = !this._doc.alwaysShowSettings;\n\t\t\t\tbreak;\n\t\t\tcase \"instrumentCopyPaste\":\n\t\t\t\tthis._doc.instrumentCopyPaste = !this._doc.instrumentCopyPaste;\n\t\t\t\tbreak;\n\t\t\tcase \"enableChannelMuting\":\n\t\t\t\tthis._doc.enableChannelMuting = !this._doc.enableChannelMuting;\n\t\t\t\tfor (const channel of this._doc.song.channels) channel.muted = false;\n\t\t\t\tbreak;\n\t\t\tcase \"displayBrowserUrl\":\n\t\t\t\tthis._doc.toggleDisplayBrowserUrl();\n\t\t\t\tbreak;\n\t\t\tcase \"layout\":\n\t\t\t\tthis._openPrompt(\"layout\");\n\t\t\t\tbreak;\n\t\t\tcase \"colorTheme\":\n\t\t\t\tthis._doc.colorTheme = this._doc.colorTheme == \"light classic\" ? \"dark classic\" : \"light classic\";\n\t\t\t\tColorConfig.setTheme(this._doc.colorTheme);\n\t\t\t\tbreak;\n\t\t}\n\t\tthis._optionsMenu.selectedIndex = 0;\n\t\tthis._doc.notifier.changed();\n\t\tthis._doc.savePreferences();\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Dictionary, Config} from \"../synth/SynthConfig\";\nimport {Note, Pattern, Channel} from \"../synth/synth\";\nimport {SongDocument} from \"./SongDocument\";\nimport {ChangeGroup} from \"./Change\";\nimport {ChangeTrackSelection, ChangeChannelBar, ChangeDuplicateSelectedReusedPatterns, ChangeNoteAdded, ChangeNoteTruncate, ChangePatternNumbers, ChangePatternSelection, ChangeInsertBars, ChangeAddChannel, ChangeDeleteBars, ChangeRemoveChannel, ChangeEnsurePatternExists, ChangeNoteLength, ChangePaste, ChangeSetPatternInstruments, ChangeViewInstrument, ChangePatternsPerChannel, ChangePatternRhythm, ChangePatternScale, ChangeTranspose, ChangeChannelOrder, comparePatternNotes, unionOfUsedNotes, generateScaleMap, discardInvalidPatternInstruments, patternsContainSameInstruments} from \"./changes\";\n\ninterface PatternCopy {\n\tinstruments: number[];\n\tnotes: any[];\n}\n\ninterface ChannelCopy {\n\tisNoise: boolean;\n\tpatterns: Dictionary<PatternCopy>;\n\tbars: number[];\n}\n\ninterface SelectionCopy {\n\tpartDuration: number;\n\tchannels: ChannelCopy[];\n}\n\nexport class Selection {\n\tpublic boxSelectionX0: number = 0;\n\tpublic boxSelectionY0: number = 0;\n\tpublic boxSelectionX1: number = 0;\n\tpublic boxSelectionY1: number = 0;\n\tpublic digits: string = \"\";\n\tpublic instrumentDigits: string = \"\";\n\tpublic patternSelectionStart: number = 0;\n\tpublic patternSelectionEnd: number = 0;\n\tpublic patternSelectionActive: boolean = false;\n\t\n\tprivate _changeTranspose: ChangeGroup | null = null;\n\tprivate _changeReorder: ChangeGroup | null = null;\n\tprivate _changeTrack: ChangeGroup | null = null;\n\tprivate _changeInstrument: ChangeGroup | null = null;\n\t\n\tconstructor(private _doc: SongDocument) {}\n\t\n\tpublic toJSON(): {x0: number, x1: number, y0: number, y1: number, start: number, end: number} {\n\t\treturn {\n\t\t\t\"x0\": this.boxSelectionX0,\n\t\t\t\"x1\": this.boxSelectionX1,\n\t\t\t\"y0\": this.boxSelectionY0,\n\t\t\t\"y1\": this.boxSelectionY1,\n\t\t\t\"start\": this.patternSelectionStart,\n\t\t\t\"end\": this.patternSelectionEnd,\n\t\t};\n\t}\n\t\n\tpublic fromJSON(json: {x0: number, x1: number, y0: number, y1: number, start: number, end: number}): void {\n\t\tif (json == null) return;\n\t\tthis.boxSelectionX0 = +json[\"x0\"];\n\t\tthis.boxSelectionX1 = +json[\"x1\"];\n\t\tthis.boxSelectionY0 = +json[\"y0\"];\n\t\tthis.boxSelectionY1 = +json[\"y1\"];\n\t\tthis.patternSelectionStart = +json[\"start\"];\n\t\tthis.patternSelectionEnd = +json[\"end\"];\n\t\tthis.digits = \"\";\n\t\tthis.instrumentDigits = \"\";\n\t\tthis.patternSelectionActive = this.patternSelectionStart < this.patternSelectionEnd;\n\t}\n\t\n\tpublic selectionUpdated(): void {\n\t\tthis._doc.notifier.changed();\n\t\tthis.digits = \"\";\n\t\tthis.instrumentDigits = \"\";\n\t}\n\t\n\tpublic get boxSelectionBar(): number {\n\t\treturn Math.min(this.boxSelectionX0, this.boxSelectionX1);\n\t}\n\tpublic get boxSelectionChannel(): number {\n\t\treturn Math.min(this.boxSelectionY0, this.boxSelectionY1);\n\t}\n\tpublic get boxSelectionWidth(): number {\n\t\treturn Math.abs(this.boxSelectionX0 - this.boxSelectionX1) + 1;\n\t}\n\tpublic get boxSelectionHeight(): number {\n\t\treturn Math.abs(this.boxSelectionY0 - this.boxSelectionY1) + 1;\n\t}\n\tpublic scrollToSelection(): void {\n\t\tthis._doc.barScrollPos = Math.min(this._doc.barScrollPos, this.boxSelectionX1);\n\t\tthis._doc.barScrollPos = Math.max(this._doc.barScrollPos, this.boxSelectionX1 - (this._doc.trackVisibleBars - 1));\n\t\tthis._doc.channelScrollPos = Math.min(this._doc.channelScrollPos, this.boxSelectionY1);\n\t\tthis._doc.channelScrollPos = Math.max(this._doc.channelScrollPos, this.boxSelectionY1 - (this._doc.trackVisibleChannels - 1));\n\t}\n\t\n\tpublic setChannelBar(channelIndex: number, bar: number): void {\n\t\tif (channelIndex == this._doc.channel && bar == this._doc.bar) return;\n\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._changeTrack);\n\t\tthis._changeTrack = new ChangeGroup();\n\t\tthis._changeTrack.append(new ChangeChannelBar(this._doc, channelIndex, bar));\n\t\t// Don't erase existing redo history just to look at highlighted pattern.\n\t\tif (!this._doc.hasRedoHistory()) {\n\t\t\tthis._doc.record(this._changeTrack, canReplaceLastChange);\n\t\t}\n\t\tthis.selectionUpdated();\n\t}\n\t\n\tpublic setPattern(pattern: number): void {\n\t\tthis._doc.record(new ChangePatternNumbers(this._doc, pattern, this.boxSelectionBar, this.boxSelectionChannel, this.boxSelectionWidth, this.boxSelectionHeight));\n\t}\n\t\n\tpublic nextDigit(digit: string, forInstrument: boolean): void {\n\t\tconst channel: Channel = this._doc.song.channels[this.boxSelectionChannel];\n\t\t\n\t\tif (forInstrument) {\n\t\t\tthis.instrumentDigits += digit;\n\t\t\tvar parsed = parseInt(this.instrumentDigits);\n\t\t\tvar pattern: Pattern | null = this._doc.getCurrentPattern();\n\t\t\tif (parsed != 0 && parsed <= channel.instruments.length && pattern != null) {\n\t\t\t\tthis.selectInstrument(parsed - 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.instrumentDigits = digit;\n\t\t\tparsed = parseInt(this.instrumentDigits);\n\t\t\tif (parsed != 0 && parsed <= channel.instruments.length && pattern != null) {\n\t\t\t\tthis.selectInstrument(parsed - 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.instrumentDigits = \"\";\n\t\t}\n\t\telse {\n\t\t\tif (this.digits.length > 0 && this.digits != String(channel.bars[this.boxSelectionBar])) {\n\t\t\t\tthis.digits = \"\";\n\t\t\t}\n\t\t\t\n\t\t\tthis.digits += digit;\n\t\t\tlet parsed: number = parseInt(this.digits);\n\t\t\tif (parsed <= this._doc.song.patternsPerChannel) {\n\t\t\t\tthis.setPattern(parsed);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tthis.digits = digit;\n\t\t\tparsed = parseInt(this.digits);\n\t\t\tif (parsed <= this._doc.song.patternsPerChannel) {\n\t\t\t\tthis.setPattern(parsed);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tthis.digits = \"\";\n\t\t}\n\t}\n\t\n\tpublic insertBars(): void {\n\t\tthis._doc.record(new ChangeInsertBars(this._doc, this.boxSelectionBar + this.boxSelectionWidth, this.boxSelectionWidth));\n\t\tconst width: number = this.boxSelectionWidth;\n\t\tthis.boxSelectionX0 += width;\n\t\tthis.boxSelectionX1 += width;\n\t}\n\t\n\tpublic insertChannel(): void {\n\t\tconst group: ChangeGroup = new ChangeGroup();\n\t\tconst insertIndex: number = this.boxSelectionChannel + this.boxSelectionHeight;\n\t\tconst isNoise: boolean = this._doc.song.getChannelIsNoise(insertIndex - 1);\n\t\tgroup.append(new ChangeAddChannel(this._doc, insertIndex, isNoise));\n\t\tif (!group.isNoop()) {\n\t\t\tthis.boxSelectionY0 = this.boxSelectionY1 = insertIndex;\n\t\t\tgroup.append(new ChangeChannelBar(this._doc, insertIndex, this._doc.bar));\n\t\t\tthis._doc.record(group);\n\t\t}\n\t}\n\t\n\tpublic deleteBars(): void {\n\t\tconst group: ChangeGroup = new ChangeGroup();\n\t\tif (this._doc.selection.patternSelectionActive) {\n\t\t\t\n\t\t\tif (this.boxSelectionWidth > 1 || this.boxSelectionHeight > 1) {\n\t\t\t\tgroup.append(new ChangeDuplicateSelectedReusedPatterns(this._doc, this.boxSelectionBar, this.boxSelectionWidth, this.boxSelectionChannel, this.boxSelectionHeight));\n\t\t\t}\n\t\t\t\n\t\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\t\tfor (const pattern of this._eachSelectedPattern(channelIndex)) {\n\t\t\t\t\tgroup.append(new ChangeNoteTruncate(this._doc, pattern, this._doc.selection.patternSelectionStart, this._doc.selection.patternSelectionEnd));\n\t\t\t\t}\n\t\t\t}\n\t\t\tgroup.append(new ChangePatternSelection(this._doc, 0, 0));\n\t\t} else {\n\t\t\tgroup.append(new ChangeDeleteBars(this._doc, this.boxSelectionBar, this.boxSelectionWidth));\n\t\t\tconst width: number = this.boxSelectionWidth;\n\t\t\tthis.boxSelectionX0 = Math.max(0, this.boxSelectionX0 - width);\n\t\t\tthis.boxSelectionX1 = Math.max(0, this.boxSelectionX1 - width);\n\t\t}\n\t\tthis._doc.record(group);\n\t}\n\t\n\tpublic deleteChannel(): void {\n\t\tthis._doc.record(new ChangeRemoveChannel(this._doc, this.boxSelectionChannel, this.boxSelectionChannel + this.boxSelectionHeight - 1));\n\t\tthis.boxSelectionY0 = this.boxSelectionY1 = this._doc.channel;\n\t}\n\t\n\tprivate *_eachSelectedChannel(): IterableIterator<number> {\n\t\tfor (let channelIndex: number = this.boxSelectionChannel; channelIndex < this.boxSelectionChannel + this.boxSelectionHeight; channelIndex++) {\n\t\t\tyield channelIndex;\n\t\t}\n\t}\n\t\n\tprivate *_eachSelectedBar(): IterableIterator<number> {\n\t\tfor (let bar: number = this.boxSelectionBar; bar < this.boxSelectionBar + this.boxSelectionWidth; bar++) {\n\t\t\tyield bar;\n\t\t}\n\t}\n\t\n\tprivate *_eachSelectedPattern(channelIndex: number): IterableIterator<Pattern> {\n\t\tconst handledPatterns: Dictionary<boolean> = {};\n\t\tfor (const bar of this._eachSelectedBar()) {\n\t\t\tconst currentPatternIndex: number = this._doc.song.channels[channelIndex].bars[bar];\n\t\t\tif (currentPatternIndex == 0) continue;\n\t\t\tif (handledPatterns[String(currentPatternIndex)]) continue;\n\t\t\thandledPatterns[String(currentPatternIndex)] = true;\n\t\t\tconst pattern: Pattern | null = this._doc.song.getPattern(channelIndex, bar);\n\t\t\tif (pattern == null) throw new Error();\n\t\t\tyield pattern;\n\t\t}\n\t}\n\t\n\tprivate _parseCopiedInstrumentArray(patternCopy: any, channelIndex: number): number[] {\n\t\tconst instruments: number[] = Array.from(patternCopy[\"instruments\"]).map(i => (<any>i) >>> 0);\n\t\tdiscardInvalidPatternInstruments(instruments, this._doc.song, channelIndex);\n\t\treturn instruments;\n\t}\n\t\n\tprivate _patternIndexIsUnused(channelIndex: number, patternIndex: number): boolean {\n\t\tfor (let i: number = 0; i < this._doc.song.barCount; i++) {\n\t\t\tif (this._doc.song.channels[channelIndex].bars[i] == patternIndex) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tpublic copy(): void {\n\t\tconst channels: ChannelCopy[] = [];\n\t\t\n\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\tconst patterns: Dictionary<PatternCopy> = {};\n\t\t\tconst bars: number[] = [];\n\t\t\t\n\t\t\tfor (const bar of this._eachSelectedBar()) {\n\t\t\t\tconst patternNumber: number = this._doc.song.channels[channelIndex].bars[bar];\n\t\t\t\tbars.push(patternNumber);\n\t\t\t\tif (patterns[String(patternNumber)] == undefined) {\n\t\t\t\t\tconst pattern: Pattern | null = this._doc.song.getPattern(channelIndex, bar);\n\t\t\t\t\tlet instruments: number[] = this._doc.recentPatternInstruments[channelIndex];\n\t\t\t\t\tlet notes: Note[] = [];\n\t\t\t\t\tif (pattern != null) {\n\t\t\t\t\t\tinstruments = pattern.instruments.concat();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (this.patternSelectionActive) {\n\t\t\t\t\t\t\tfor (const note of pattern.cloneNotes()) {\n\t\t\t\t\t\t\t\tif (note.end <= this.patternSelectionStart) continue;\n\t\t\t\t\t\t\t\tif (note.start >= this.patternSelectionEnd) continue;\n\t\t\t\t\t\t\t\tnote.start -= this.patternSelectionStart;\n\t\t\t\t\t\t\t\tnote.end -= this.patternSelectionStart;\n\t\t\t\t\t\t\t\tif (note.start < 0 || note.end > this.patternSelectionEnd - this.patternSelectionStart) {\n\t\t\t\t\t\t\t\t\tnew ChangeNoteLength(null, note, Math.max(note.start, 0), Math.min(this.patternSelectionEnd - this.patternSelectionStart, note.end));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnotes.push(note);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnotes = pattern.notes;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tpatterns[String(patternNumber)] = {\"instruments\": instruments, \"notes\": notes};\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconst channelCopy: ChannelCopy = {\n\t\t\t\t\"isNoise\": this._doc.song.getChannelIsNoise(channelIndex),\n\t\t\t\t\"patterns\": patterns,\n\t\t\t\t\"bars\": bars,\n\t\t\t};\n\t\t\tchannels.push(channelCopy);\n\t\t}\n\t\t\n\t\tconst selectionCopy: SelectionCopy = {\n\t\t\t\"partDuration\": this.patternSelectionActive ? this.patternSelectionEnd - this.patternSelectionStart : this._doc.song.beatsPerBar * Config.partsPerBeat,\n\t\t\t\"channels\": channels,\n\t\t};\n\t\twindow.localStorage.setItem(\"selectionCopy\", JSON.stringify(selectionCopy));\n\t}\n\t\n\t// I'm sorry this function is so complicated!\n\t// Basically I'm trying to avoid accidentally modifying patterns that are used\n\t// elsewhere in the song (unless we're just pasting a single pattern) but I'm\n\t// also trying to reuse patterns where it makes sense to do so, especially \n\t// in the same channel it was copied from.\n\tpublic pasteNotes(): void {\n\t\tconst selectionCopy: SelectionCopy | null = JSON.parse(String(window.localStorage.getItem(\"selectionCopy\")));\n\t\tif (selectionCopy == null) return;\n\t\tconst channelCopies: ChannelCopy[] = selectionCopy[\"channels\"] || [];\n\t\tconst copiedPartDuration: number = selectionCopy[\"partDuration\"] >>> 0;\n\t\t\n\t\tconst group: ChangeGroup = new ChangeGroup();\n\t\tconst fillSelection: boolean = (this.boxSelectionWidth > 1 || this.boxSelectionHeight > 1);\n\t\t\n\t\tconst pasteHeight: number = fillSelection ? this.boxSelectionHeight : Math.min(channelCopies.length, this._doc.song.getChannelCount() - this.boxSelectionChannel);\n\t\tfor (let pasteChannel: number = 0; pasteChannel < pasteHeight; pasteChannel++) {\n\t\t\tconst channelCopy: ChannelCopy = channelCopies[pasteChannel % channelCopies.length];\n\t\t\tconst channelIndex: number = this.boxSelectionChannel + pasteChannel;\n\t\t\t\n\t\t\tconst isNoise: boolean = !!channelCopy[\"isNoise\"];\n\t\t\tconst patternCopies: Dictionary<PatternCopy> = channelCopy[\"patterns\"] || {};\n\t\t\tconst copiedBars: number[] = channelCopy[\"bars\"] || [];\n\t\t\tif (copiedBars.length == 0) continue;\n\t\t\tif (isNoise != this._doc.song.getChannelIsNoise(channelIndex)) continue;\n\t\t\t\n\t\t\tconst pasteWidth: number = fillSelection ? this.boxSelectionWidth : Math.min(copiedBars.length, this._doc.song.barCount - this.boxSelectionBar);\n\t\t\tif (!fillSelection && copiedBars.length == 1 && channelCopies.length == 1) {\n\t\t\t\t// Special case: if there's just one pattern being copied, try to insert it\n\t\t\t\t// into whatever pattern is already selected.\n\t\t\t\tconst copiedPatternIndex: number = copiedBars[0] >>> 0;\n\t\t\t\tconst bar: number = this.boxSelectionBar;\n\t\t\t\tconst currentPatternIndex: number = this._doc.song.channels[channelIndex].bars[bar];\n\t\t\t\tif (copiedPatternIndex == 0 && currentPatternIndex == 0) continue;\n\t\t\t\t\n\t\t\t\tconst patternCopy: PatternCopy = patternCopies[String(copiedPatternIndex)];\n\t\t\t\tconst instrumentsCopy: number[] = this._parseCopiedInstrumentArray(patternCopy, channelIndex);\n\t\t\t\t\n\t\t\t\tif (currentPatternIndex == 0) {\n\t\t\t\t\tconst existingPattern: Pattern | undefined = this._doc.song.channels[channelIndex].patterns[copiedPatternIndex - 1];\n\t\t\t\t\tif (existingPattern != undefined &&\n\t\t\t\t\t\t!this.patternSelectionActive &&\n\t\t\t\t\t\t((comparePatternNotes(patternCopy[\"notes\"], existingPattern.notes) && patternsContainSameInstruments(instrumentsCopy, existingPattern.instruments)) ||\n\t\t\t\t\t\tthis._patternIndexIsUnused(channelIndex, copiedPatternIndex)))\n\t\t\t\t\t{\n\t\t\t\t\t\tgroup.append(new ChangePatternNumbers(this._doc, copiedPatternIndex, bar, channelIndex, 1, 1));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgroup.append(new ChangeEnsurePatternExists(this._doc, channelIndex, bar));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst pattern: Pattern | null = this._doc.song.getPattern(channelIndex, bar);\n\t\t\t\tif (pattern == null) throw new Error();\n\t\t\t\tgroup.append(new ChangePaste(this._doc, pattern, patternCopy[\"notes\"], this.patternSelectionActive ? this.patternSelectionStart : 0, this.patternSelectionActive ? this.patternSelectionEnd : Config.partsPerBeat * this._doc.song.beatsPerBar, copiedPartDuration));\n\t\t\t\tif (currentPatternIndex == 0) group.append(new ChangeSetPatternInstruments(this._doc, channelIndex, instrumentsCopy, pattern));\n\t\t\t} else if (this.patternSelectionActive) {\n\t\t\t\tconst reusablePatterns: Dictionary<number> = {};\n\t\t\t\tconst usedPatterns: Dictionary<boolean> = {};\n\t\t\t\t\n\t\t\t\tgroup.append(new ChangeDuplicateSelectedReusedPatterns(this._doc, this.boxSelectionBar, pasteWidth, this.boxSelectionChannel, pasteHeight));\n\t\t\t\t\n\t\t\t\tfor (let pasteBar: number = 0; pasteBar < pasteWidth; pasteBar++) {\n\t\t\t\t\tconst bar: number = this.boxSelectionBar + pasteBar;\n\t\t\t\t\tconst copiedPatternIndex: number = copiedBars[pasteBar % copiedBars.length] >>> 0;\n\t\t\t\t\tconst currentPatternIndex: number = this._doc.song.channels[channelIndex].bars[bar];\n\t\t\t\t\tconst reusedIndex: string = [copiedPatternIndex, currentPatternIndex].join(\",\");\n\t\t\t\t\tif (copiedPatternIndex == 0 && currentPatternIndex == 0) continue;\n\t\t\t\t\tif (reusablePatterns[reusedIndex] != undefined) {\n\t\t\t\t\t\tgroup.append(new ChangePatternNumbers(this._doc, reusablePatterns[reusedIndex], bar, channelIndex, 1, 1));\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (currentPatternIndex == 0) {\n\t\t\t\t\t\tgroup.append(new ChangeEnsurePatternExists(this._doc, channelIndex, bar));\n\t\t\t\t\t\tconst patternCopy: PatternCopy = patternCopies[String(copiedPatternIndex)];\n\t\t\t\t\t\tconst instrumentsCopy: number[] = this._parseCopiedInstrumentArray(patternCopy, channelIndex);\n\t\t\t\t\t\tconst pattern: Pattern = this._doc.song.getPattern(channelIndex, bar)!;\n\t\t\t\t\t\tgroup.append(new ChangeSetPatternInstruments(this._doc, channelIndex, instrumentsCopy, pattern));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst pattern: Pattern | null = this._doc.song.getPattern(channelIndex, bar);\n\t\t\t\t\t\tif (pattern == null) throw new Error();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!usedPatterns[String(currentPatternIndex)]) {\n\t\t\t\t\t\t\tusedPatterns[String(currentPatternIndex)] = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// If this pattern is used here and elsewhere, it's not safe to modify it directly, so\n\t\t\t\t\t\t\t// make a duplicate of it and modify that instead.\n\t\t\t\t\t\t\tgroup.append(new ChangePatternNumbers(this._doc, 0, bar, channelIndex, 1, 1));\n\t\t\t\t\t\t\tgroup.append(new ChangeEnsurePatternExists(this._doc, channelIndex, bar));\n\t\t\t\t\t\t\tconst newPattern: Pattern | null = this._doc.song.getPattern(channelIndex, bar);\n\t\t\t\t\t\t\tif (newPattern == null) throw new Error();\n\t\t\t\t\t\t\tfor (const note of pattern.cloneNotes()) {\n\t\t\t\t\t\t\t\tgroup.append(new ChangeNoteAdded(this._doc, newPattern, note, newPattern.notes.length, false));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Don't overwrite the existing pattern's instruments if only part of the pattern content is being replaced.\n\t\t\t\t\t\t\t//group.append(new ChangeSetPatternInstruments(this._doc, channelIndex, pattern.instruments, newPattern));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst pattern: Pattern | null = this._doc.song.getPattern(channelIndex, bar);\n\t\t\t\t\tif (pattern == null) throw new Error();\n\t\t\t\t\tif (copiedPatternIndex == 0) {\n\t\t\t\t\t\tgroup.append(new ChangeNoteTruncate(this._doc, pattern, this.patternSelectionStart, this.patternSelectionEnd));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst patternCopy: PatternCopy = patternCopies[String(copiedPatternIndex)];\n\t\t\t\t\t\tgroup.append(new ChangePaste(this._doc, pattern, patternCopy[\"notes\"], this.patternSelectionStart, this.patternSelectionEnd, copiedPartDuration));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treusablePatterns[reusedIndex] = this._doc.song.channels[channelIndex].bars[bar];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tfor (let pasteBar: number = 0; pasteBar < pasteWidth; pasteBar++) {\n\t\t\t\t\tconst bar: number = this.boxSelectionBar + pasteBar;\n\t\t\t\t\tconst removedPattern: number = this._doc.song.channels[channelIndex].bars[bar];\n\t\t\t\t\tif (removedPattern != 0) {\n\t\t\t\t\t\tgroup.append(new ChangePatternNumbers(this._doc, 0, bar, channelIndex, 1, 1));\n\t\t\t\t\t\tif (this._patternIndexIsUnused(channelIndex, removedPattern)) {\n\t\t\t\t\t\t\t// When a pattern becomes unused when replaced by rectangular selection pasting,\n\t\t\t\t\t\t\t// remove all the notes from the pattern so that it may be reused.\n\t\t\t\t\t\t\tthis._doc.song.channels[channelIndex].patterns[removedPattern - 1].notes.length = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst reusablePatterns: Dictionary<number> = {};\n\t\t\t\tfor (let pasteBar: number = 0; pasteBar < pasteWidth; pasteBar++) {\n\t\t\t\t\tconst bar: number = this.boxSelectionBar + pasteBar;\n\t\t\t\t\tconst copiedPatternIndex: number = copiedBars[pasteBar % copiedBars.length] >>> 0;\n\t\t\t\t\tconst reusedIndex: string = String(copiedPatternIndex);\n\t\t\t\t\t\n\t\t\t\t\tif (copiedPatternIndex == 0) continue;\n\t\t\t\t\tif (reusablePatterns[reusedIndex] != undefined) {\n\t\t\t\t\t\tgroup.append(new ChangePatternNumbers(this._doc, reusablePatterns[reusedIndex], bar, channelIndex, 1, 1));\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst patternCopy: PatternCopy = patternCopies[String(copiedPatternIndex)];\n\t\t\t\t\tconst instrumentsCopy: number[] = this._parseCopiedInstrumentArray(patternCopy, channelIndex);\n\t\t\t\t\tconst existingPattern: Pattern | undefined = this._doc.song.channels[channelIndex].patterns[copiedPatternIndex - 1];\n\t\t\t\t\t\n\t\t\t\t\tif (existingPattern != undefined &&\n\t\t\t\t\t\tcopiedPartDuration == Config.partsPerBeat * this._doc.song.beatsPerBar &&\n\t\t\t\t\t\tcomparePatternNotes(patternCopy[\"notes\"], existingPattern.notes) &&\n\t\t\t\t\t\tpatternsContainSameInstruments(instrumentsCopy, existingPattern.instruments))\n\t\t\t\t\t{\n\t\t\t\t\t\tgroup.append(new ChangePatternNumbers(this._doc, copiedPatternIndex, bar, channelIndex, 1, 1));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (existingPattern != undefined && this._patternIndexIsUnused(channelIndex, copiedPatternIndex)) {\n\t\t\t\t\t\t\tgroup.append(new ChangePatternNumbers(this._doc, copiedPatternIndex, bar, channelIndex, 1, 1));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgroup.append(new ChangeEnsurePatternExists(this._doc, channelIndex, bar));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst pattern: Pattern | null = this._doc.song.getPattern(channelIndex, bar);\n\t\t\t\t\t\tif (pattern == null) throw new Error();\n\t\t\t\t\t\tgroup.append(new ChangePaste(this._doc, pattern, patternCopy[\"notes\"], this.patternSelectionActive ? this.patternSelectionStart : 0, this.patternSelectionActive ? this.patternSelectionEnd : Config.partsPerBeat * this._doc.song.beatsPerBar, copiedPartDuration));\n\t\t\t\t\t\tgroup.append(new ChangeSetPatternInstruments(this._doc, channelIndex, instrumentsCopy, pattern));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treusablePatterns[reusedIndex] = this._doc.song.channels[channelIndex].bars[bar];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._doc.record(group);\n\t}\n\t\n\tpublic pasteNumbers(): void {\n\t\tconst selectionCopy: SelectionCopy | null = JSON.parse(String(window.localStorage.getItem(\"selectionCopy\")));\n\t\tif (selectionCopy == null) return;\n\t\tconst channelCopies: ChannelCopy[] = selectionCopy[\"channels\"] || [];\n\t\t\n\t\tconst group: ChangeGroup = new ChangeGroup();\n\t\tconst fillSelection: boolean = (this.boxSelectionWidth > 1 || this.boxSelectionHeight > 1);\n\t\t\n\t\tconst pasteHeight: number = fillSelection ? this.boxSelectionHeight : Math.min(channelCopies.length, this._doc.song.getChannelCount() - this.boxSelectionChannel);\n\t\tfor (let pasteChannel: number = 0; pasteChannel < pasteHeight; pasteChannel++) {\n\t\t\tconst channelCopy: ChannelCopy = channelCopies[pasteChannel % channelCopies.length];\n\t\t\tconst channelIndex: number = this.boxSelectionChannel + pasteChannel;\n\t\t\t\n\t\t\tconst copiedBars: number[] = channelCopy[\"bars\"] || [];\n\t\t\tif (copiedBars.length == 0) continue;\n\t\t\t\n\t\t\tconst pasteWidth: number = fillSelection ? this.boxSelectionWidth : Math.min(copiedBars.length, this._doc.song.barCount - this.boxSelectionBar);\n\t\t\tfor (let pasteBar: number = 0; pasteBar < pasteWidth; pasteBar++) {\n\t\t\t\tconst copiedPatternIndex: number = copiedBars[pasteBar % copiedBars.length] >>> 0;\n\t\t\t\tconst bar: number = this.boxSelectionBar + pasteBar;\n\t\t\t\t\n\t\t\t\tif (copiedPatternIndex > this._doc.song.patternsPerChannel) {\n\t\t\t\t\tgroup.append(new ChangePatternsPerChannel(this._doc, copiedPatternIndex));\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tgroup.append(new ChangePatternNumbers(this._doc, copiedPatternIndex, bar, channelIndex, 1, 1));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._doc.record(group);\n\t}\n\t\n\tpublic selectAll(): void {\n\t\tnew ChangePatternSelection(this._doc, 0, 0);\n\t\tif (this.boxSelectionBar == 0 &&\n\t\t\tthis.boxSelectionChannel == 0 &&\n\t\t\tthis.boxSelectionWidth == this._doc.song.barCount &&\n\t\t\tthis.boxSelectionHeight == this._doc.song.getChannelCount())\n\t\t{\n\t\t\tthis.setTrackSelection(this._doc.bar, this._doc.bar, this._doc.channel, this._doc.channel);\n\t\t} else {\n\t\t\tthis.setTrackSelection(0, this._doc.song.barCount - 1, 0, this._doc.song.getChannelCount() - 1);\n\t\t}\n\t\tthis.selectionUpdated();\n\t}\n\t\n\tpublic selectChannel(): void {\n\t\tnew ChangePatternSelection(this._doc, 0, 0);\n\t\tif (this.boxSelectionBar == 0 && this.boxSelectionWidth == this._doc.song.barCount) {\n\t\t\tthis.setTrackSelection(this._doc.bar, this._doc.bar, this.boxSelectionY0, this.boxSelectionY1);\n\t\t} else {\n\t\t\tthis.setTrackSelection(0, this._doc.song.barCount - 1, this.boxSelectionY0, this.boxSelectionY1);\n\t\t}\n\t\tthis.selectionUpdated();\n\t}\n\t\n\tpublic duplicatePatterns(): void {\n\t\tthis._doc.record(new ChangeDuplicateSelectedReusedPatterns(this._doc, this.boxSelectionBar, this.boxSelectionWidth, this.boxSelectionChannel, this.boxSelectionHeight));\n\t}\n\t\n\tpublic muteChannels(allChannels: boolean): void {\n\t\tif (allChannels) {\n\t\t\tlet anyMuted: boolean = false;\n\t\t\tfor (let channelIndex: number = 0; channelIndex < this._doc.song.channels.length; channelIndex++) {\n\t\t\t\tif (this._doc.song.channels[channelIndex].muted) {\n\t\t\t\t\tanyMuted = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (let channelIndex: number = 0; channelIndex < this._doc.song.channels.length; channelIndex++) {\n\t\t\t\tthis._doc.song.channels[channelIndex].muted = !anyMuted;\n\t\t\t}\n\t\t} else {\n\t\t\tlet anyUnmuted: boolean = false;\n\t\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\t\tif (!this._doc.song.channels[channelIndex].muted) {\n\t\t\t\t\tanyUnmuted = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\t\tthis._doc.song.channels[channelIndex].muted = anyUnmuted;\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tpublic soloChannels(invert: boolean): void {\n\t\tlet alreadySoloed: boolean = true;\n\t\t\n\t\tfor (let channelIndex: number = 0; channelIndex < this._doc.song.channels.length; channelIndex++) {\n\t\t\tconst shouldBeMuted: boolean = (channelIndex < this.boxSelectionChannel || channelIndex >= this.boxSelectionChannel + this.boxSelectionHeight) ? !invert : invert;\n\t\t\tif (this._doc.song.channels[channelIndex].muted != shouldBeMuted) {\n\t\t\t\talreadySoloed = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (alreadySoloed) {\n\t\t\tfor (let channelIndex: number = 0; channelIndex < this._doc.song.channels.length; channelIndex++) {\n\t\t\t\tthis._doc.song.channels[channelIndex].muted = false;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (let channelIndex: number = 0; channelIndex < this._doc.song.channels.length; channelIndex++) {\n\t\t\t\tthis._doc.song.channels[channelIndex].muted = (channelIndex < this.boxSelectionChannel || channelIndex >= this.boxSelectionChannel + this.boxSelectionHeight) ? !invert : invert;\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._doc.notifier.changed();\n\t}\n\t\n\tpublic forceRhythm(): void {\n\t\tconst group: ChangeGroup = new ChangeGroup();\n\t\t\n\t\tif (this.boxSelectionWidth > 1 || this.boxSelectionHeight > 1) {\n\t\t\tgroup.append(new ChangeDuplicateSelectedReusedPatterns(this._doc, this.boxSelectionBar, this.boxSelectionWidth, this.boxSelectionChannel, this.boxSelectionHeight));\n\t\t}\n\t\t\n\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\tfor (const pattern of this._eachSelectedPattern(channelIndex)) {\n\t\t\t\tgroup.append(new ChangePatternRhythm(this._doc, pattern));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._doc.record(group);\n\t}\n\t\n\tpublic forceScale(): void {\n\t\tconst group: ChangeGroup = new ChangeGroup();\n\t\t\n\t\tif (this.boxSelectionWidth > 1 || this.boxSelectionHeight > 1) {\n\t\t\tgroup.append(new ChangeDuplicateSelectedReusedPatterns(this._doc, this.boxSelectionBar, this.boxSelectionWidth, this.boxSelectionChannel, this.boxSelectionHeight));\n\t\t}\n\t\t\n\t\tconst scaleFlags: boolean[] = [true, false, false, false, false, false, false, false, false, false, false, false];\n\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\tif (this._doc.song.getChannelIsNoise(channelIndex)) continue;\n\t\t\tfor (const pattern of this._eachSelectedPattern(channelIndex)) {\n\t\t\t\tunionOfUsedNotes(pattern, scaleFlags);\n\t\t\t}\n\t\t}\n\t\t\t\n\t\tconst scaleMap: number[] = generateScaleMap(scaleFlags, this._doc.song.scale);\n\t\t\t\n\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\tif (this._doc.song.getChannelIsNoise(channelIndex)) continue;\n\t\t\tfor (const pattern of this._eachSelectedPattern(channelIndex)) {\n\t\t\t\tgroup.append(new ChangePatternScale(this._doc, pattern, scaleMap));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._doc.record(group);\n\t}\n\t\n\tpublic setTrackSelection(newX0: number, newX1: number, newY0: number, newY1: number): void {\n\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._changeTrack);\n\t\tthis._changeTrack = new ChangeGroup();\n\t\tthis._changeTrack.append(new ChangeTrackSelection(this._doc, newX0, newX1, newY0, newY1));\n\t\t// Don't erase existing redo history just to change track selection.\n\t\tif (!this._doc.hasRedoHistory()) {\n\t\t\tthis._doc.record(this._changeTrack, canReplaceLastChange);\n\t\t}\n\t}\n\t\n\tpublic transpose(upward: boolean, octave: boolean): void {\n\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._changeTranspose);\n\t\tthis._changeTranspose = new ChangeGroup();\n\t\t\n\t\tif (this.boxSelectionWidth > 1 || this.boxSelectionHeight > 1) {\n\t\t\tthis._changeTranspose.append(new ChangeDuplicateSelectedReusedPatterns(this._doc, this.boxSelectionBar, this.boxSelectionWidth, this.boxSelectionChannel, this.boxSelectionHeight));\n\t\t}\n\t\t\n\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\tfor (const pattern of this._eachSelectedPattern(channelIndex)) {\n\t\t\t\tthis._changeTranspose.append(new ChangeTranspose(this._doc, channelIndex, pattern, upward, this._doc.notesOutsideScale, octave));\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._doc.record(this._changeTranspose, canReplaceLastChange);\n\t}\n\t\n\tpublic swapChannels(offset: number): void {\n\t\tconst possibleSectionBoundaries: number[] = [\n\t\t\tthis._doc.song.pitchChannelCount,\n\t\t\tthis._doc.song.pitchChannelCount + this._doc.song.noiseChannelCount,\n\t\t\tthis._doc.song.getChannelCount(),\n\t\t];\n\t\tlet channelSectionMin: number = 0;\n\t\tlet channelSectionMax: number = 0;\n\t\tfor (const nextBoundary of possibleSectionBoundaries) {\n\t\t\tif ((this.boxSelectionChannel < nextBoundary && offset < 0) || (this.boxSelectionChannel + this.boxSelectionHeight <= nextBoundary)) {\n\t\t\t\tchannelSectionMax = nextBoundary - 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tchannelSectionMin = nextBoundary;\n\t\t}\n\t\tconst newSelectionMin: number = Math.max(this.boxSelectionChannel, channelSectionMin);\n\t\tconst newSelectionMax: number = Math.min(this.boxSelectionChannel + this.boxSelectionHeight - 1, channelSectionMax);\n\t\toffset = Math.max(offset, channelSectionMin - newSelectionMin);\n\t\toffset = Math.min(offset, channelSectionMax - newSelectionMax);\n\t\t\n\t\tif (offset != 0) {\n\t\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._changeReorder);\n\t\t\tthis._changeReorder = new ChangeGroup();\n\t\t\tthis.boxSelectionY0 = newSelectionMin + offset;\n\t\t\tthis.boxSelectionY1 = newSelectionMax + offset;\n\t\t\tthis._changeReorder.append(new ChangeChannelOrder(this._doc, newSelectionMin, newSelectionMax, offset));\n\t\t\tthis._changeReorder.append(new ChangeChannelBar(this._doc, Math.max(this.boxSelectionY0, Math.min(this.boxSelectionY1, this._doc.channel + offset)), this._doc.bar));\n\t\t\tthis.selectionUpdated();\n\t\t\tthis._doc.record(this._changeReorder, canReplaceLastChange);\n\t\t}\n\t}\n\t\n\tpublic selectInstrument(instrument: number): void {\n\t\tif (this._doc.viewedInstrument[this._doc.channel] == instrument) {\n\t\t\tif (this._doc.song.layeredInstruments && this._doc.song.patternInstruments) {\n\t\t\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._changeInstrument);\n\t\t\t\tthis._changeInstrument = new ChangeGroup();\n\t\t\t\tconst instruments: number[] = this._doc.recentPatternInstruments[this._doc.channel];\n\t\t\t\tif (instruments.indexOf(instrument) == -1) {\n\t\t\t\t\tinstruments.push(instrument);\n\t\t\t\t\tconst maxLayers: number = this._doc.song.getMaxInstrumentsPerPattern(this._doc.channel);\n\t\t\t\t\tif (instruments.length > maxLayers) {\n\t\t\t\t\t\tinstruments.splice(0, instruments.length - maxLayers);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tinstruments.splice(instruments.indexOf(instrument), 1);\n\t\t\t\t\tif (instruments.length == 0) instruments[0] = 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.boxSelectionWidth > 1 || this.boxSelectionHeight > 1) {\n\t\t\t\t\tthis._changeInstrument.append(new ChangeDuplicateSelectedReusedPatterns(this._doc, this.boxSelectionBar, this.boxSelectionWidth, this.boxSelectionChannel, this.boxSelectionHeight));\n\t\t\t\t}\n\t\t\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\t\t\tfor (const pattern of this._eachSelectedPattern(channelIndex)) {\n\t\t\t\t\t\tthis._changeInstrument.append(new ChangeSetPatternInstruments(this._doc, channelIndex, instruments, pattern));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._doc.record(this._changeInstrument, canReplaceLastChange);\n\t\t\t}\n\t\t} else {\n\t\t\tconst canReplaceLastChange: boolean = this._doc.lastChangeWas(this._changeInstrument);\n\t\t\tthis._changeInstrument = new ChangeGroup();\n\t\t\tthis._changeInstrument.append(new ChangeViewInstrument(this._doc, instrument));\n\t\t\t\n\t\t\tif (!this._doc.song.layeredInstruments && this._doc.song.patternInstruments) {\n\t\t\t\tif (this.boxSelectionWidth > 1 || this.boxSelectionHeight > 1) {\n\t\t\t\t\tthis._changeInstrument.append(new ChangeDuplicateSelectedReusedPatterns(this._doc, this.boxSelectionBar, this.boxSelectionWidth, this.boxSelectionChannel, this.boxSelectionHeight));\n\t\t\t\t}\n\t\t\t\tconst instruments: number[] = [instrument];\n\t\t\t\tfor (const channelIndex of this._eachSelectedChannel()) {\n\t\t\t\t\tfor (const pattern of this._eachSelectedPattern(channelIndex)) {\n\t\t\t\t\t\tthis._changeInstrument.append(new ChangeSetPatternInstruments(this._doc, channelIndex, instruments, pattern));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._doc.record(this._changeInstrument, canReplaceLastChange);\n\t\t\t} else if (!this._doc.hasRedoHistory()) {\n\t\t\t\t// Don't erase existing redo history just to look at highlighted pattern.\n\t\t\t\tthis._doc.record(this._changeInstrument, canReplaceLastChange);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tpublic resetBoxSelection(): void {\n\t\tthis.boxSelectionX0 = this.boxSelectionX1 = this._doc.bar;\n\t\tthis.boxSelectionY0 = this.boxSelectionY1 = this._doc.channel;\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nexport class ChangeNotifier {\n\tprivate _watchers: (()=>void)[] = [];\n\tprivate _dirty: boolean = false;\n\t\n\tpublic watch(watcher: ()=>void): void {\n\t\tif (this._watchers.indexOf(watcher) == -1) {\n\t\t\tthis._watchers.push(watcher);\n\t\t}\n\t}\n\t\n\tpublic unwatch(watcher: ()=>void): void {\n\t\tconst index: number = this._watchers.indexOf(watcher);\n\t\tif (index != -1) {\n\t\t\tthis._watchers.splice(index, 1);\n\t\t}\n\t}\n\t\n\tpublic changed(): void {\n\t\tthis._dirty = true;\n\t}\n\t\n\tpublic notifyWatchers(): void {\n\t\tif (!this._dirty) return;\n\t\tthis._dirty = false;\n\t\tfor (const watcher of this._watchers.concat()) {\n\t\t\twatcher();\n\t\t}\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Scale, Config} from \"../synth/SynthConfig\";\nimport {Pattern, Channel, Song, Synth} from \"../synth/synth\";\nimport {SongRecovery, generateUid} from \"./SongRecovery\";\nimport {ColorConfig} from \"./ColorConfig\";\nimport {Layout} from \"./Layout\";\nimport {Selection} from \"./Selection\";\nimport {Change} from \"./Change\";\nimport {ChangeNotifier} from \"./ChangeNotifier\";\nimport {ChangeSong, setDefaultInstruments, discardInvalidPatternInstruments} from \"./changes\";\n\ninterface HistoryState {\n\tcanUndo: boolean;\n\tsequenceNumber: number;\n\tbar: number;\n\tchannel: number;\n\tinstrument: number;\n\trecoveryUid: string;\n\tprompt: string | null;\n\tselection: {x0: number, x1: number, y0: number, y1: number, start: number, end: number};\n}\n\nexport class SongDocument {\n\tpublic static readonly defaultVisibleOctaves: number = 3;\n\t\n\tpublic song: Song;\n\tpublic synth: Synth;\n\tpublic notifier: ChangeNotifier = new ChangeNotifier();\n\tpublic selection: Selection = new Selection(this);\n\tpublic channel: number = 0;\n\tpublic bar: number = 0;\n\tpublic autoPlay: boolean;\n\tpublic autoFollow: boolean;\n\tpublic enableNotePreview: boolean;\n\tpublic showFifth: boolean;\n\tpublic notesOutsideScale: boolean;\n\tpublic defaultScale: number;\n\tpublic showLetters: boolean;\n\tpublic showChannels: boolean;\n\tpublic showScrollBar: boolean;\n\tpublic alwaysShowSettings: boolean;\n\tpublic instrumentCopyPaste: boolean;\n\tpublic enableChannelMuting: boolean;\n\tpublic colorTheme: string;\n\tpublic layout: string;\n\tpublic displayBrowserUrl: boolean;\n\tpublic volume: number = 75;\n\tpublic visibleOctaves: number = SongDocument.defaultVisibleOctaves;\n\tpublic recentPatternInstruments: number[][] = [];\n\tpublic viewedInstrument: number[] = [];\n\t\n\tpublic trackVisibleBars: number = 16;\n\tpublic trackVisibleChannels: number = 4;\n\tpublic barScrollPos: number = 0;\n\tpublic channelScrollPos: number = 0;\n\tpublic prompt: string | null = null;\n\t\n\tpublic addedEffect: boolean = false;\n\tpublic addedEnvelope: boolean = false;\n\t\n\tprivate static readonly _maximumUndoHistory: number = 100;\n\tprivate _recovery: SongRecovery = new SongRecovery();\n\tprivate _recoveryUid: string;\n\tprivate _recentChange: Change | null = null;\n\tprivate _sequenceNumber: number = 0;\n\tprivate _lastSequenceNumber: number = 0;\n\tprivate _stateShouldBePushed: boolean = false;\n\tprivate _recordedNewSong: boolean = false;\n\tprivate _waitingToUpdateState: boolean = false;\n\t\n\tconstructor() {\n\t\tthis.notifier.watch(this._validateDocState);\n\t\t\n\t\tthis.autoPlay = window.localStorage.getItem(\"autoPlay\") == \"true\";\n\t\tthis.autoFollow = window.localStorage.getItem(\"autoFollow\") == \"true\";\n\t\tthis.enableNotePreview = window.localStorage.getItem(\"enableNotePreview\") != \"false\";\n\t\tthis.showFifth = window.localStorage.getItem(\"showFifth\") == \"true\";\n\t\tthis.notesOutsideScale = window.localStorage.getItem(\"notesOutsideScale\") == \"true\";\n\t\tthis.showLetters = window.localStorage.getItem(\"showLetters\") == \"true\";\n\t\tthis.showChannels = window.localStorage.getItem(\"showChannels\") == \"true\";\n\t\tthis.showScrollBar = window.localStorage.getItem(\"showScrollBar\") == \"true\";\n\t\tthis.alwaysShowSettings = window.localStorage.getItem(\"alwaysShowSettings\") == \"true\";\n\t\tthis.instrumentCopyPaste = window.localStorage.getItem(\"instrumentCopyPaste\") == \"true\";\n\t\tthis.enableChannelMuting = window.localStorage.getItem(\"enableChannelMuting\") == \"true\";\n\t\tthis.displayBrowserUrl = window.localStorage.getItem(\"displayBrowserUrl\") != \"false\";\n\t\tthis.layout = window.localStorage.getItem(\"layout\") || \"small\";\n\t\tthis.colorTheme = window.localStorage.getItem(\"colorTheme\") || \"dark classic\";\n\t\tthis.visibleOctaves = ((<any>window.localStorage.getItem(\"visibleOctaves\")) >>> 0) || SongDocument.defaultVisibleOctaves;\n\t\t\n\t\tconst defaultScale: Scale | undefined = Config.scales.dictionary[window.localStorage.getItem(\"defaultScale\")!];\n\t\tthis.defaultScale = (defaultScale != undefined) ? defaultScale.index : 0;\n\t\t\n\t\tif (window.localStorage.getItem(\"volume\") != null) {\n\t\t\tthis.volume = Math.min(<any>window.localStorage.getItem(\"volume\") >>> 0, 75);\n\t\t}\n\t\t\n\t\tif (window.localStorage.getItem(\"fullScreen\") != null) {\n\t\t\tif (window.localStorage.getItem(\"fullScreen\") == \"true\") this.layout = \"long\";\n\t\t\twindow.localStorage.removeItem(\"fullScreen\");\n\t\t}\n\t\t\n\t\tColorConfig.setTheme(this.colorTheme);\n\t\tLayout.setLayout(this.layout);\n\t\t\n\t\tif (window.sessionStorage.getItem(\"currentUndoIndex\") == null) {\n\t\t\twindow.sessionStorage.setItem(\"currentUndoIndex\", \"0\");\n\t\t\twindow.sessionStorage.setItem(\"oldestUndoIndex\", \"0\");\n\t\t\twindow.sessionStorage.setItem(\"newestUndoIndex\", \"0\");\n\t\t}\n\t\t\n\t\tlet songString: string = window.location.hash;\n\t\tif (songString == \"\") {\n\t\t\tsongString = this._getHash();\n\t\t}\n\t\tthis.song = new Song(songString);\n\t\tif (songString == \"\" || songString == undefined) {\n\t\t\tsetDefaultInstruments(this.song);\n\t\t\tthis.song.scale = this.defaultScale;\n\t\t}\n\t\tsongString = this.song.toBase64String();\n\t\tthis.synth = new Synth(this.song);\n\t\tthis.synth.volume = this._calcVolume();\n\t\t\n\t\tlet state: HistoryState | null = this._getHistoryState();\n\t\tif (state == null) {\n\t\t\t// When the page is first loaded, indicate that undo is NOT possible.\n\t\t\tstate = {canUndo: false, sequenceNumber: 0, bar: 0, channel: 0, instrument: 0, recoveryUid: generateUid(), prompt: null, selection: this.selection.toJSON()};\n\t\t}\n\t\tif (state.recoveryUid == undefined) state.recoveryUid = generateUid();\n\t\tthis._replaceState(state, songString);\n\t\twindow.addEventListener(\"hashchange\", this._whenHistoryStateChanged);\n\t\twindow.addEventListener(\"popstate\", this._whenHistoryStateChanged);\n\t\t\n\t\tthis.bar = state.bar | 0;\n\t\tthis.channel = state.channel | 0;\n\t\tfor (let i: number = 0; i <= this.channel; i++) this.viewedInstrument[i] = 0;\n\t\tthis.viewedInstrument[this.channel] = state.instrument | 0;\n\t\tthis._recoveryUid = state.recoveryUid;\n\t\t//this.barScrollPos = Math.max(0, this.bar - (this.trackVisibleBars - 6));\n\t\tthis.prompt = state.prompt;\n\t\tthis.selection.fromJSON(state.selection);\n\t\t\n\t\t// For all input events, catch them when they are about to finish bubbling,\n\t\t// presumably after all handlers are done updating the model, then update the\n\t\t// view before the screen renders. mouseenter and mouseleave do not bubble,\n\t\t// but they are immediately followed by mousemove which does. \n\t\tfor (const eventName of [\"input\", \"change\", \"click\", \"keyup\", \"keydown\", \"mousedown\", \"mousemove\", \"mouseup\", \"touchstart\", \"touchmove\", \"touchend\", \"touchcancel\"]) {\n\t\t\twindow.addEventListener(eventName, this._cleanDocument);\n\t\t}\n\t\t\n\t\tthis._validateDocState();\n\t}\n\t\n\tpublic toggleDisplayBrowserUrl() {\n\t\tconst state: HistoryState = this._getHistoryState()!;\n\t\tthis.displayBrowserUrl = !this.displayBrowserUrl;\n\t\tthis._replaceState(state, this.song.toBase64String());\n\t}\n\t\n\tprivate _getHistoryState(): HistoryState | null {\n\t\tif (this.displayBrowserUrl) {\n\t\t\treturn window.history.state;\n\t\t} else {\n\t\t\tconst json: any = JSON.parse(window.sessionStorage.getItem(window.sessionStorage.getItem(\"currentUndoIndex\")!)!);\n\t\t\treturn json == null ? null : json.state;\n\t\t}\n\t}\n\t\n\tprivate _getHash(): string {\n\t\tif (this.displayBrowserUrl) {\n\t\t\treturn window.location.hash;\n\t\t} else {\n\t\t\tconst json: any = JSON.parse(window.sessionStorage.getItem(window.sessionStorage.getItem(\"currentUndoIndex\")!)!);\n\t\t\treturn json == null ? \"\" : json.hash;\n\t\t}\n\t}\n\t\n\tprivate _replaceState(state: HistoryState, hash: string): void {\n\t\tif (this.displayBrowserUrl) {\n\t\t\twindow.history.replaceState(state, \"\", \"#\" + hash);\n\t\t} else {\n\t\t\twindow.sessionStorage.setItem(window.sessionStorage.getItem(\"currentUndoIndex\") || \"0\", JSON.stringify({state, hash}));\n\t\t\twindow.history.replaceState(null, \"\", location.pathname);\n\t\t}\n\t}\n\t\n\tprivate _pushState(state: HistoryState, hash: string): void {\n\t\tif (this.displayBrowserUrl) {\n\t\t\twindow.history.pushState(state, \"\", \"#\" + hash);\n\t\t} else {\n\t\t\tlet currentIndex: number = Number(window.sessionStorage.getItem(\"currentUndoIndex\"));\n\t\t\tlet oldestIndex: number = Number(window.sessionStorage.getItem(\"oldestUndoIndex\"));\n\t\t\tcurrentIndex = (currentIndex + 1) % SongDocument._maximumUndoHistory;\n\t\t\twindow.sessionStorage.setItem(\"currentUndoIndex\", String(currentIndex));\n\t\t\twindow.sessionStorage.setItem(\"newestUndoIndex\", String(currentIndex));\n\t\t\tif (currentIndex == oldestIndex) {\n\t\t\t\toldestIndex = (oldestIndex + 1) % SongDocument._maximumUndoHistory;\n\t\t\t\twindow.sessionStorage.setItem(\"oldestUndoIndex\", String(oldestIndex));\n\t\t\t}\n\t\t\twindow.sessionStorage.setItem(String(currentIndex), JSON.stringify({state, hash}));\n\t\t\twindow.history.replaceState(null, \"\", location.pathname);\n\t\t}\n\t\tthis._lastSequenceNumber = state.sequenceNumber;\n\t}\n\t\n\tpublic hasRedoHistory(): boolean {\n\t\treturn this._lastSequenceNumber > this._sequenceNumber;\n\t}\n\t\n\tprivate _forward(): void {\n\t\tif (this.displayBrowserUrl) {\n\t\t\twindow.history.forward();\n\t\t} else {\n\t\t\tlet currentIndex: number = Number(window.sessionStorage.getItem(\"currentUndoIndex\"));\n\t\t\tlet newestIndex: number = Number(window.sessionStorage.getItem(\"newestUndoIndex\"));\n\t\t\tif (currentIndex != newestIndex) {\n\t\t\t\tcurrentIndex = (currentIndex + 1) % SongDocument._maximumUndoHistory;\n\t\t\t\twindow.sessionStorage.setItem(\"currentUndoIndex\", String(currentIndex));\n\t\t\t\tsetTimeout(this._whenHistoryStateChanged);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate _back(): void {\n\t\tif (this.displayBrowserUrl) {\n\t\t\twindow.history.back();\n\t\t} else {\n\t\t\tlet currentIndex: number = Number(window.sessionStorage.getItem(\"currentUndoIndex\"));\n\t\t\tlet oldestIndex: number = Number(window.sessionStorage.getItem(\"oldestUndoIndex\"));\n\t\t\tif (currentIndex != oldestIndex) {\n\t\t\t\tcurrentIndex = (currentIndex + SongDocument._maximumUndoHistory - 1) % SongDocument._maximumUndoHistory;\n\t\t\t\twindow.sessionStorage.setItem(\"currentUndoIndex\", String(currentIndex));\n\t\t\t\tsetTimeout(this._whenHistoryStateChanged);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate _whenHistoryStateChanged = (): void => {\n\t\tif (window.history.state == null && window.location.hash != \"\") {\n\t\t\t// The user changed the hash directly.\n\t\t\tthis._sequenceNumber++;\n\t\t\tthis._resetSongRecoveryUid();\n\t\t\tconst state: HistoryState = {canUndo: true, sequenceNumber: this._sequenceNumber, bar: this.bar, channel: this.channel, instrument: this.viewedInstrument[this.channel], recoveryUid: this._recoveryUid, prompt: null, selection: this.selection.toJSON()};\n\t\t\tnew ChangeSong(this, window.location.hash);\n\t\t\tthis.prompt = state.prompt;\n\t\t\tif (this.displayBrowserUrl) {\n\t\t\t\tthis._replaceState(state, this.song.toBase64String());\n\t\t\t} else {\n\t\t\t\tthis._pushState(state, this.song.toBase64String());\n\t\t\t}\n\t\t\tthis.forgetLastChange();\n\t\t\tthis.notifier.notifyWatchers();\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tconst state: HistoryState | null = this._getHistoryState();\n\t\tif (state == null) throw new Error(\"History state is null.\");\n\t\t\n\t\t// Abort if we've already handled the current state. \n\t\tif (state.sequenceNumber == this._sequenceNumber) return;\n\t\t\n\t\tthis.bar = state.bar;\n\t\tthis.channel = state.channel;\n\t\tthis.viewedInstrument[this.channel] = state.instrument;\n\t\tthis._sequenceNumber = state.sequenceNumber;\n\t\tthis.prompt = state.prompt;\n\t\tnew ChangeSong(this, this._getHash());\n\t\t\n\t\tthis._recoveryUid = state.recoveryUid;\n\t\tthis.selection.fromJSON(state.selection);\n\t\t\n\t\t//this.barScrollPos = Math.min(this.bar, Math.max(this.bar - (this.trackVisibleBars - 1), this.barScrollPos));\n\t\t\n\t\tthis.forgetLastChange();\n\t\tthis.notifier.notifyWatchers();\n\t}\n\t\n\tprivate _cleanDocument = (): void => {\n\t\tthis.notifier.notifyWatchers();\n\t}\n\t\n\tprivate _validateDocState = (): void => {\n\t\tconst channelCount: number = this.song.getChannelCount();\n\t\tfor (let i: number = this.recentPatternInstruments.length; i < channelCount; i++) {\n\t\t\tthis.recentPatternInstruments[i] = [0];\n\t\t}\n\t\tthis.recentPatternInstruments.length = channelCount;\n\t\tfor (let i: number = 0; i < channelCount; i++) {\n\t\t\tif (i == this.channel) {\n\t\t\t\tif (this.song.patternInstruments) {\n\t\t\t\t\tconst pattern: Pattern | null = this.song.getPattern(this.channel, this.bar);\n\t\t\t\t\tif (pattern != null) {\n\t\t\t\t\t\tthis.recentPatternInstruments[i] = pattern.instruments.concat();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst channel: Channel = this.song.channels[this.channel];\n\t\t\t\t\tfor (let j: number = 0; j < channel.instruments.length; j++) {\n\t\t\t\t\t\tthis.recentPatternInstruments[i][j] = j;\n\t\t\t\t\t}\n\t\t\t\t\tthis.recentPatternInstruments[i].length = channel.instruments.length;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdiscardInvalidPatternInstruments(this.recentPatternInstruments[i], this.song, i);\n\t\t}\n\t\t\n\t\tfor (let i: number = this.viewedInstrument.length; i < channelCount; i++) {\n\t\t\tthis.viewedInstrument[i] = 0;\n\t\t}\n\t\tthis.viewedInstrument.length = channelCount;\n\t\tfor (let i: number = 0; i < channelCount; i++) {\n\t\t\tif (this.song.patternInstruments && !this.song.layeredInstruments && i == this.channel) {\n\t\t\t\tconst pattern: Pattern | null = this.song.getPattern(this.channel, this.bar);\n\t\t\t\tif (pattern != null) {\n\t\t\t\t\tthis.viewedInstrument[i] = pattern.instruments[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.viewedInstrument[i] = Math.min(this.viewedInstrument[i], this.song.channels[i].instruments.length - 1);\n\t\t}\n\t\t\n\t\tconst highlightedPattern: Pattern | null = this.getCurrentPattern();\n\t\tif (highlightedPattern != null && this.song.patternInstruments) {\n\t\t\tthis.recentPatternInstruments[this.channel] = highlightedPattern.instruments.concat();\n\t\t}\n\t\t\n\t\t// Normalize selection.\n\t\t// I'm allowing the doc.bar to drift outside the box selection while playing\n\t\t// because it may auto-follow the playhead outside the selection but it would\n\t\t// be annoying to lose your selection just because the song is playing.\n\t\tif ((!this.synth.playing && (this.bar < this.selection.boxSelectionBar || this.selection.boxSelectionBar + this.selection.boxSelectionWidth <= this.bar)) ||\n\t\t\tthis.channel < this.selection.boxSelectionChannel ||\n\t\t\tthis.selection.boxSelectionChannel + this.selection.boxSelectionHeight <= this.channel ||\n\t\t\tthis.song.barCount < this.selection.boxSelectionBar + this.selection.boxSelectionWidth ||\n\t\t\tchannelCount < this.selection.boxSelectionChannel + this.selection.boxSelectionHeight ||\n\t\t\t(this.selection.boxSelectionWidth == 1 && this.selection.boxSelectionHeight == 1))\n\t\t{\n\t\t\tthis.selection.resetBoxSelection();\n\t\t}\n\t}\n\t\n\tprivate _updateHistoryState = (): void => {\n\t\tthis._waitingToUpdateState = false;\n\t\tlet hash: string;\n\t\ttry {\n\t\t\t// Ensure that the song is not corrupted before saving it.\n\t\t\thash = this.song.toBase64String();\n\t\t} catch (error) {\n\t\t\twindow.alert(\"Whoops, the song data appears to have been corrupted! Please try to recover the last working version of the song from the \\\"Recover Recent Song...\\\" option in BeepBox's \\\"File\\\" menu.\");\n\t\t\treturn;\n\t\t}\n\t\tif (this._stateShouldBePushed) this._sequenceNumber++;\n\t\tif (this._recordedNewSong) {\n\t\t\tthis._resetSongRecoveryUid();\n\t\t} else {\n\t\t\tthis._recovery.saveVersion(this._recoveryUid, hash);\n\t\t}\n\t\tlet state: HistoryState = {canUndo: true, sequenceNumber: this._sequenceNumber, bar: this.bar, channel: this.channel, instrument: this.viewedInstrument[this.channel], recoveryUid: this._recoveryUid, prompt: this.prompt, selection: this.selection.toJSON()};\n\t\tif (this._stateShouldBePushed) {\n\t\t\tthis._pushState(state, hash);\n\t\t} else {\n\t\t\tthis._replaceState(state, hash);\n\t\t}\n\t\tthis._stateShouldBePushed = false;\n\t\tthis._recordedNewSong = false;\n\t}\n\t\n\tpublic record(change: Change, replace: boolean = false, newSong: boolean = false): void {\n\t\tif (change.isNoop()) {\n\t\t\tthis._recentChange = null;\n\t\t\tif (replace) this._back();\n\t\t} else {\n\t\t\tchange.commit();\n\t\t\tthis._recentChange = change;\n\t\t\tthis._stateShouldBePushed = this._stateShouldBePushed || !replace;\n\t\t\tthis._recordedNewSong = this._recordedNewSong || newSong;\n\t\t\tif (!this._waitingToUpdateState) {\n\t\t\t\t// Defer updating the url/history until all sequenced changes have\n\t\t\t\t// committed and the interface has rendered the latest changes to\n\t\t\t\t// improve perceived responsiveness.\n\t\t\t\twindow.requestAnimationFrame(this._updateHistoryState);\n\t\t\t\tthis._waitingToUpdateState = true;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate _resetSongRecoveryUid(): void {\n\t\tthis._recoveryUid = generateUid();\n\t}\n\t\n\tpublic openPrompt(prompt: string): void {\n\t\tthis.prompt = prompt;\n\t\tconst hash: string = this.song.toBase64String();\n\t\tthis._sequenceNumber++;\n\t\tconst state = {canUndo: true, sequenceNumber: this._sequenceNumber, bar: this.bar, channel: this.channel, instrument: this.viewedInstrument[this.channel], recoveryUid: this._recoveryUid, prompt: this.prompt, selection: this.selection.toJSON()};\n\t\tthis._pushState(state, hash);\n\t}\n\t\n\tpublic undo(): void {\n\t\tconst state: HistoryState = this._getHistoryState()!;\n\t\tif (state.canUndo) this._back();\n\t}\n\t\n\tpublic redo(): void {\n\t\tthis._forward();\n\t}\n\t\n\tpublic setProspectiveChange(change: Change | null): void {\n\t\tthis._recentChange = change;\n\t}\n\t\n\tpublic forgetLastChange(): void {\n\t\tthis._recentChange = null;\n\t}\n\t\n\tpublic lastChangeWas(change: Change | null): boolean {\n\t\treturn change != null && change == this._recentChange;\n\t}\n\t\n\tpublic goBackToStart(): void {\n\t\tthis.channel = 0;\n\t\tthis.bar = 0;\n\t\tthis.barScrollPos = 0;\n\t\tthis.notifier.changed();\n\t\tthis.synth.snapToStart();\n\t\tthis.notifier.changed();\n\t}\n\t\n\tpublic savePreferences(): void {\n\t\twindow.localStorage.setItem(\"autoPlay\", this.autoPlay ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"autoFollow\", this.autoFollow ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"enableNotePreview\", this.enableNotePreview ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"showFifth\", this.showFifth ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"notesOutsideScale\", this.notesOutsideScale ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"defaultScale\", Config.scales[this.defaultScale].name);\n\t\twindow.localStorage.setItem(\"showLetters\", this.showLetters ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"showChannels\", this.showChannels ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"showScrollBar\", this.showScrollBar ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"alwaysShowSettings\", this.alwaysShowSettings ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"enableChannelMuting\", this.enableChannelMuting ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"instrumentCopyPaste\", this.instrumentCopyPaste ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"displayBrowserUrl\", this.displayBrowserUrl ? \"true\" : \"false\");\n\t\twindow.localStorage.setItem(\"layout\", this.layout);\n\t\twindow.localStorage.setItem(\"colorTheme\", this.colorTheme);\n\t\twindow.localStorage.setItem(\"volume\", String(this.volume));\n\t\twindow.localStorage.setItem(\"visibleOctaves\", String(this.visibleOctaves));\n\t}\n\t\n\tpublic setVolume(val: number): void {\n\t\tthis.volume = val;\n\t\tthis.savePreferences();\n\t\tthis.synth.volume = this._calcVolume();\n\t}\n\t\n\tprivate _calcVolume(): number {\n\t\treturn Math.min(1.0, Math.pow(this.volume / 50.0, 0.5)) * Math.pow(2.0, (this.volume - 75.0) / 25.0);\n\t}\n\t\n\tpublic getCurrentPattern(barOffset: number = 0): Pattern | null {\n\t\treturn this.song.getPattern(this.channel, this.bar + barOffset);\n\t}\n\t\n\tpublic getCurrentInstrument(barOffset: number = 0): number {\n\t\treturn this.viewedInstrument[this.channel];\n\t}\n\t\n\tpublic getMobileLayout(): boolean {\n\t\treturn window.innerWidth <= 710;\n\t}\n\t\n\tpublic getBarWidth(): number {\n\t\treturn (!this.getMobileLayout() && this.enableChannelMuting && !this.getFullScreen()) ? 30 : 32;\n\t}\n\t\n\tpublic getChannelHeight(): number {\n\t\treturn 27;\n\t}\n\t\n\tpublic getFullScreen(): boolean {\n\t\treturn !this.getMobileLayout() && (this.layout != \"small\");\n\t}\n\t\n\tpublic getVisibleOctaveCount(): number {\n\t\treturn this.getFullScreen() ? this.visibleOctaves : SongDocument.defaultVisibleOctaves;\n\t}\n\t\n\tpublic getVisiblePitchCount(): number {\n\t\t return this.getVisibleOctaveCount() * Config.pitchesPerOctave + 1;\n\t}\n\t\n\tpublic getBaseVisibleOctave(channel: number): number {\n\t\tconst visibleOctaveCount: number = this.getVisibleOctaveCount();\n\t\treturn Math.max(0, Math.min(Config.pitchOctaves - visibleOctaveCount, Math.ceil(this.song.channels[channel].octave - visibleOctaveCount * 0.5)));\n\t}\n}\n","// Copyright (C) 2021 John Nesky, distributed under the MIT license.\n\nimport {Dictionary, DictionaryArray, EnvelopeType, InstrumentType, Transition, Chord, Envelope, Config} from \"../synth/SynthConfig\";\nimport {isMobile, EditorConfig} from \"./EditorConfig\";\nimport {ColorConfig} from \"./ColorConfig\";\nimport \"./style\"; // Import for the side effects, there's no exports.\nimport {SongEditor} from \"./SongEditor\";\nimport {NotePin, Note, Pattern, Instrument, Channel, Synth} from \"../synth/synth\";\nimport {SongDocument} from \"./SongDocument\";\nimport {ExportPrompt} from \"./ExportPrompt\";\nimport {ChangePreset} from \"./changes\";\n\nconst doc: SongDocument = new SongDocument();\nconst editor: SongEditor = new SongEditor(doc);\nconst beepboxEditorContainer: HTMLElement = document.getElementById(\"beepboxEditorContainer\")!;\nbeepboxEditorContainer.appendChild(editor.mainLayer);\neditor.whenUpdated();\neditor.mainLayer.focus();\n\n// don't autoplay on mobile devices, wait for input.\nif (!isMobile && doc.autoPlay) {\n\tfunction autoplay(): void {\n\t\tif (!document.hidden) {\n\t\t\tdoc.synth.play();\n\t\t\teditor.updatePlayButton();\n\t\t\twindow.removeEventListener(\"visibilitychange\", autoplay);\n\t\t}\n\t}\n\tif (document.hidden) {\n\t\t// Wait until the tab is visible to autoplay:\n\t\twindow.addEventListener(\"visibilitychange\", autoplay);\n\t} else {\n\t\tautoplay();\n\t}\n}\n\n// BeepBox uses browser history state as its own undo history. Browsers typically\n// remember scroll position for each history state, but BeepBox users would prefer not \n// auto scrolling when undoing. Sadly this tweak doesn't work on Edge or IE.\nif (\"scrollRestoration\" in history) history.scrollRestoration = \"manual\";\n\neditor.updatePlayButton();\n\nif (\"serviceWorker\" in navigator) {\n\tnavigator.serviceWorker.register(\"/service_worker.js\", {updateViaCache: \"all\", scope: \"/\"}).catch(() => {});\n}\n\n// When compiling synth.ts as a standalone module named \"beepbox\", expose these classes as members to JavaScript:\nexport {Dictionary, DictionaryArray, EnvelopeType, InstrumentType, Transition, Chord, Envelope, Config, NotePin, Note, Pattern, Instrument, Channel, Synth, ColorConfig, EditorConfig, SongDocument, SongEditor, ExportPrompt, ChangePreset};\n"],"names":["__values","button","div","p","h2","label","input","span","br","select","option"],"mappings":"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EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,EAAC,EAAC,gBAAgB,EAAC,SAAS,EAAC,UAAU,EAAC,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,EAAC,EAAC,gBAAgB,EAAC,SAAS,EAAC,UAAU,EAAC,CAAC,CAAC,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,EAAC,EAAC,gBAAgB,EAAC,SAAS,EAAC,UAAU,EAAC,CAAC,CAAC,EAAC,CAAC,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,EAAC,EAAC,gBAAgB,EAAC,SAAS,EAAC,UAAU,EAAC,CAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,EAAC,EAAC,gBAAgB,EAAC,SAAS,EAAC,UAAU,EAAC,CAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,EAAC,EAAC,gBAAgB,EAAC,SAAS,EAAC,UAAU,EAAC,CAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,EAAC,EAAC,gBAAgB,EAAC,SAAS,EAAC,UAAU,EAAC,CAAC,EAAE,EAAC,EAAE,EAAC,E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AAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE;QAC7C,EAAE,EAAE,EAAE,SAAS,EAAG,CAAC,EAAE,QAAQ,EAAE,C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"}